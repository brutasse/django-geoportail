/*

  Geoportal.js -- IGN France Geoportal Map Viewer Library

  Copyright 2007-2009 IGN France, released under the BSD license.
  Please see http://api.ign.fr/geoportail/api/doc/webmaster/license.html
  Please see http://api.ign.fr/geoportail/api/doc/fr/webmaster/licence.html
  for the full text of the license.

*/

/*
  Contains rewritting of http://hexmen.com/blog/2007/03/printf-sprintf/

  This code is unrestricted: you are free to use it however you like.

 */

/*
  Contains portions of Sarissa -- http://dev.abiss.gr/sarissa
     
  Sarissa is an ECMAScript library acting as a cross-browser wrapper for native XML APIs.
  The library supports Gecko based browsers like Mozilla and Firefox,
  Internet Explorer (5.5+ with MSXML3.0+), Konqueror, Safari and Opera
  @version 0.9.9.4
  @author: Copyright 2004-2008 Emmanouil Batsis, mailto: mbatsis at users full stop sourceforge full stop net

  Sarissa is free software distributed under Apache Software License 2.0 or higher (see <a href="asl.txt">asl.txt</a>).

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY 
  KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE 
  WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE 
  AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR 
  COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR 
  OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
  SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

  */

/*
  proj4js.js -- Javascript reprojection library.

  Authors:      Mike Adair madairATdmsolutions.ca
                Richard Greenwood richATgreenwoodmap.com
                Didier Richard didier.richardATign.fr
                Stephen Irons
  License:      LGPL as per: http://www.gnu.org/copyleft/lesser.html
                Note: This program is an almost direct port of the C library
                Proj4.
*/

/*
  Contains OpenLayers.js -- OpenLayers Map Viewer Library

  Copyright 2005-2007 MetaCarta, Inc., released under the BSD license.
  Please see http://svn.openlayers.org/trunk/openlayers/release-license.txt
  for the full text of the license.

  Includes compressed code under the following licenses:

  (For uncompressed versions of the code used please see the
  OpenLayers SVN repository: <http://openlayers.org/>)

*/

/* Contains portions of Prototype.js:
 *
 * Prototype JavaScript framework, version 1.4.0
 *  (c) 2005 Sam Stephenson <sam@conio.net>
 *
 *  Prototype is freely distributable under the terms of an MIT-style license.
 *  For details, see the Prototype web site: http://prototype.conio.net/
 *
/*--------------------------------------------------------------------------*/

/**  
*  
*  Contains portions of Rico <http://openrico.org/>
* 
*  Copyright 2005 Sabre Airline Solutions  
*  
*  Licensed under the Apache License, Version 2.0 (the "License"); you
*  may not use this file except in compliance with the License. You
*  may obtain a copy of the License at
*  
*         http://www.apache.org/licenses/LICENSE-2.0  
*  
*  Unless required by applicable law or agreed to in writing, software
*  distributed under the License is distributed on an "AS IS" BASIS,
*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
*  implied. See the License for the specific language governing
*  permissions and limitations under the License. 
*
**/

var OpenLayers={singleFile:true};(function(){var H=(typeof OpenLayers=="object"&&OpenLayers.singleFile);window.OpenLayers={_scriptName:(!H)?"lib/OpenLayers.js":"OpenLayers.js",_getScriptLocation:function(){var P="";var R=new RegExp("(^|(.*?\\/))("+OpenLayers._scriptName+")(\\?|$)");var M=document.getElementsByTagName("script");for(var O=0,L=M.length;O<L;O++){var Q=M[O].getAttribute("src");if(Q){var N=Q.match(R);if(N){P=N[1];break}}}return P}};if(!H){var I=new Array("OpenLayers/Util.js","OpenLayers/BaseTypes.js","OpenLayers/BaseTypes/Class.js","OpenLayers/BaseTypes/Bounds.js","OpenLayers/BaseTypes/Element.js","OpenLayers/BaseTypes/LonLat.js","OpenLayers/BaseTypes/Pixel.js","OpenLayers/BaseTypes/Size.js","OpenLayers/Console.js","OpenLayers/Tween.js","Rico/Corner.js","Rico/Color.js","OpenLayers/Ajax.js","OpenLayers/Events.js","OpenLayers/Request.js","OpenLayers/Request/XMLHttpRequest.js","OpenLayers/Projection.js","OpenLayers/Map.js","OpenLayers/Layer.js","OpenLayers/Icon.js","OpenLayers/Marker.js","OpenLayers/Marker/Box.js","OpenLayers/Popup.js","OpenLayers/Tile.js","OpenLayers/Tile/Image.js","OpenLayers/Tile/WFS.js","OpenLayers/Layer/Image.js","OpenLayers/Layer/SphericalMercator.js","OpenLayers/Layer/EventPane.js","OpenLayers/Layer/FixedZoomLevels.js","OpenLayers/Layer/Google.js","OpenLayers/Layer/VirtualEarth.js","OpenLayers/Layer/Yahoo.js","OpenLayers/Layer/HTTPRequest.js","OpenLayers/Layer/Grid.js","OpenLayers/Layer/MapGuide.js","OpenLayers/Layer/MapServer.js","OpenLayers/Layer/MapServer/Untiled.js","OpenLayers/Layer/KaMap.js","OpenLayers/Layer/KaMapCache.js","OpenLayers/Layer/MultiMap.js","OpenLayers/Layer/Markers.js","OpenLayers/Layer/Text.js","OpenLayers/Layer/WorldWind.js","OpenLayers/Layer/ArcGIS93Rest.js","OpenLayers/Layer/WMS.js","OpenLayers/Layer/WMS/Untiled.js","OpenLayers/Layer/ArcIMS.js","OpenLayers/Layer/GeoRSS.js","OpenLayers/Layer/Boxes.js","OpenLayers/Layer/XYZ.js","OpenLayers/Layer/TMS.js","OpenLayers/Layer/TileCache.js","OpenLayers/Popup/Anchored.js","OpenLayers/Popup/AnchoredBubble.js","OpenLayers/Popup/Framed.js","OpenLayers/Popup/FramedCloud.js","OpenLayers/Feature.js","OpenLayers/Feature/Vector.js","OpenLayers/Feature/WFS.js","OpenLayers/Handler.js","OpenLayers/Handler/Click.js","OpenLayers/Handler/Hover.js","OpenLayers/Handler/Point.js","OpenLayers/Handler/Path.js","OpenLayers/Handler/Polygon.js","OpenLayers/Handler/Feature.js","OpenLayers/Handler/Drag.js","OpenLayers/Handler/RegularPolygon.js","OpenLayers/Handler/Box.js","OpenLayers/Handler/MouseWheel.js","OpenLayers/Handler/Keyboard.js","OpenLayers/Control.js","OpenLayers/Control/Attribution.js","OpenLayers/Control/Button.js","OpenLayers/Control/ZoomBox.js","OpenLayers/Control/ZoomToMaxExtent.js","OpenLayers/Control/DragPan.js","OpenLayers/Control/Navigation.js","OpenLayers/Control/MouseDefaults.js","OpenLayers/Control/MousePosition.js","OpenLayers/Control/OverviewMap.js","OpenLayers/Control/KeyboardDefaults.js","OpenLayers/Control/PanZoom.js","OpenLayers/Control/PanZoomBar.js","OpenLayers/Control/ArgParser.js","OpenLayers/Control/Permalink.js","OpenLayers/Control/Scale.js","OpenLayers/Control/ScaleLine.js","OpenLayers/Control/Snapping.js","OpenLayers/Control/Split.js","OpenLayers/Control/LayerSwitcher.js","OpenLayers/Control/DrawFeature.js","OpenLayers/Control/DragFeature.js","OpenLayers/Control/ModifyFeature.js","OpenLayers/Control/Panel.js","OpenLayers/Control/SelectFeature.js","OpenLayers/Control/NavigationHistory.js","OpenLayers/Control/Measure.js","OpenLayers/Control/WMSGetFeatureInfo.js","OpenLayers/Geometry.js","OpenLayers/Geometry/Rectangle.js","OpenLayers/Geometry/Collection.js","OpenLayers/Geometry/Point.js","OpenLayers/Geometry/MultiPoint.js","OpenLayers/Geometry/Curve.js","OpenLayers/Geometry/LineString.js","OpenLayers/Geometry/LinearRing.js","OpenLayers/Geometry/Polygon.js","OpenLayers/Geometry/MultiLineString.js","OpenLayers/Geometry/MultiPolygon.js","OpenLayers/Geometry/Surface.js","OpenLayers/Renderer.js","OpenLayers/Renderer/Elements.js","OpenLayers/Renderer/SVG.js","OpenLayers/Renderer/Canvas.js","OpenLayers/Renderer/VML.js","OpenLayers/Layer/Vector.js","OpenLayers/Layer/Vector/RootContainer.js","OpenLayers/Strategy.js","OpenLayers/Strategy/Fixed.js","OpenLayers/Strategy/Cluster.js","OpenLayers/Strategy/Paging.js","OpenLayers/Strategy/BBOX.js","OpenLayers/Strategy/Save.js","OpenLayers/Protocol.js","OpenLayers/Protocol/HTTP.js","OpenLayers/Protocol/SQL.js","OpenLayers/Protocol/SQL/Gears.js","OpenLayers/Protocol/WFS.js","OpenLayers/Protocol/WFS/v1.js","OpenLayers/Protocol/WFS/v1_0_0.js","OpenLayers/Protocol/WFS/v1_1_0.js","OpenLayers/Layer/PointTrack.js","OpenLayers/Layer/GML.js","OpenLayers/Style.js","OpenLayers/StyleMap.js","OpenLayers/Rule.js","OpenLayers/Filter.js","OpenLayers/Filter/FeatureId.js","OpenLayers/Filter/Logical.js","OpenLayers/Filter/Comparison.js","OpenLayers/Filter/Spatial.js","OpenLayers/Format.js","OpenLayers/Format/XML.js","OpenLayers/Format/ArcXML.js","OpenLayers/Format/ArcXML/Features.js","OpenLayers/Format/GML.js","OpenLayers/Format/GML/Base.js","OpenLayers/Format/GML/v2.js","OpenLayers/Format/GML/v3.js","OpenLayers/Format/KML.js","OpenLayers/Format/GeoRSS.js","OpenLayers/Format/WFS.js","OpenLayers/Format/WFSCapabilities.js","OpenLayers/Format/WFSCapabilities/v1.js","OpenLayers/Format/WFSCapabilities/v1_0_0.js","OpenLayers/Format/WFSCapabilities/v1_1_0.js","OpenLayers/Format/WFSDescribeFeatureType.js","OpenLayers/Format/WMSDescribeLayer.js","OpenLayers/Format/WMSDescribeLayer/v1_1.js","OpenLayers/Format/WKT.js","OpenLayers/Format/OSM.js","OpenLayers/Format/GPX.js","OpenLayers/Format/Filter.js","OpenLayers/Format/Filter/v1.js","OpenLayers/Format/Filter/v1_0_0.js","OpenLayers/Format/Filter/v1_1_0.js","OpenLayers/Format/SLD.js","OpenLayers/Format/SLD/v1.js","OpenLayers/Format/SLD/v1_0_0.js","OpenLayers/Format/SLD/v1.js","OpenLayers/Format/WFST.js","OpenLayers/Format/WFST/v1.js","OpenLayers/Format/WFST/v1_0_0.js","OpenLayers/Format/WFST/v1_1_0.js","OpenLayers/Format/Text.js","OpenLayers/Format/JSON.js","OpenLayers/Format/GeoJSON.js","OpenLayers/Format/WMC.js","OpenLayers/Format/WMC/v1.js","OpenLayers/Format/WMC/v1_0_0.js","OpenLayers/Format/WMC/v1_1_0.js","OpenLayers/Format/WMSCapabilities.js","OpenLayers/Format/WMSCapabilities/v1_1.js","OpenLayers/Format/WMSCapabilities/v1_1_0.js","OpenLayers/Format/WMSCapabilities/v1_1_1.js","OpenLayers/Format/WMSGetFeatureInfo.js","OpenLayers/Layer/WFS.js","OpenLayers/Control/GetFeature.js","OpenLayers/Control/MouseToolbar.js","OpenLayers/Control/NavToolbar.js","OpenLayers/Control/PanPanel.js","OpenLayers/Control/Pan.js","OpenLayers/Control/ZoomIn.js","OpenLayers/Control/ZoomOut.js","OpenLayers/Control/ZoomPanel.js","OpenLayers/Control/EditingToolbar.js","OpenLayers/Lang.js","OpenLayers/Lang/en.js");var C=navigator.userAgent;var E=(C.match("MSIE")||C.match("Safari"));if(E){var B=new Array(I.length)}var J=OpenLayers._getScriptLocation()+"lib/";for(var D=0,G=I.length;D<G;D++){if(E){B[D]="<script src='"+J+I[D]+"'><\/script>"}else{var K=document.createElement("script");K.src=J+I[D];var F=document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body;F.appendChild(K)}}if(E){document.write(B.join(""))}}})();OpenLayers.VERSION_NUMBER="OpenLayers 2.8 -- $Revision: 9492 $";OpenLayers.String={startsWith:function(C,B){return(C.indexOf(B)==0)},contains:function(C,B){return(C.indexOf(B)!=-1)},trim:function(B){return B.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(G){var E=G.split("-");var C=E[0];for(var D=1,B=E.length;D<B;D++){var F=E[D];C+=F.charAt(0).toUpperCase()+F.substring(1)}return C},format:function(E,D,B){if(!D){D=window}var C=function(J,F){var I;var H=F.split(/\.+/);for(var G=0;G<H.length;G++){if(G==0){I=D}I=I[H[G]]}if(typeof I=="function"){I=B?I.apply(null,B):I()}if(typeof I=="undefined"){return"undefined"}else{return I}};return E.replace(OpenLayers.String.tokenRegEx,C)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(B){return OpenLayers.String.numberRegEx.test(B)},numericIf:function(B){return OpenLayers.String.isNumeric(B)?parseFloat(B):B}};if(!String.prototype.startsWith){String.prototype.startsWith=function(B){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.startsWith"}));return OpenLayers.String.startsWith(this,B)}}if(!String.prototype.contains){String.prototype.contains=function(B){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.contains"}));return OpenLayers.String.contains(this,B)}}if(!String.prototype.trim){String.prototype.trim=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.trim"}));return OpenLayers.String.trim(this)}}if(!String.prototype.camelize){String.prototype.camelize=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.String.camelize"}));return OpenLayers.String.camelize(this)}}OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(B,D){var C=0;if(D>0){C=parseFloat(B.toPrecision(D))}return C},format:function(D,B,H,J){B=(typeof B!="undefined")?B:0;H=(typeof H!="undefined")?H:OpenLayers.Number.thousandsSeparator;J=(typeof J!="undefined")?J:OpenLayers.Number.decimalSeparator;if(B!=null){D=parseFloat(D.toFixed(B))}var C=D.toString().split(".");if(C.length==1&&B==null){B=0}var E=C[0];if(H){var F=/(-?[0-9]+)([0-9]{3})/;while(F.test(E)){E=E.replace(F,"$1"+H+"$2")}}var G;if(B==0){G=E}else{var I=C.length>1?C[1]:"0";if(B!=null){I=I+new Array(B-I.length+1).join("0")}G=E+J+I}return G}};if(!Number.prototype.limitSigDigs){Number.prototype.limitSigDigs=function(B){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Number.limitSigDigs"}));return OpenLayers.Number.limitSigDigs(this,B)}}OpenLayers.Function={bind:function(D,C){var B=Array.prototype.slice.apply(arguments,[2]);return function(){var E=B.concat(Array.prototype.slice.apply(arguments,[0]));return D.apply(C,E)}},bindAsEventListener:function(C,B){return function(D){return C.call(B,D||window.event)}}};if(!Function.prototype.bind){Function.prototype.bind=function(){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bind"}));Array.prototype.unshift.apply(arguments,[this]);return OpenLayers.Function.bind.apply(null,arguments)}}if(!Function.prototype.bindAsEventListener){Function.prototype.bindAsEventListener=function(B){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Function.bindAsEventListener"}));return OpenLayers.Function.bindAsEventListener(this,B)}}OpenLayers.Array={filter:function(H,G,C){var E=[];if(Array.prototype.filter){E=H.filter(G,C)}else{var B=H.length;if(typeof G!="function"){throw new TypeError()}for(var D=0;D<B;D++){if(D in H){var F=H[D];if(G.call(C,F,D,H)){E.push(F)}}}}return E}};OpenLayers.Class=function(){var E=function(){if(arguments&&arguments[0]!=OpenLayers.Class.isPrototype){this.initialize.apply(this,arguments)}};var D={};var G,C;for(var F=0,B=arguments.length;F<B;++F){if(typeof arguments[F]=="function"){if(F==0&&B>1){C=arguments[F].prototype.initialize;arguments[F].prototype.initialize=function(){};D=new arguments[F];if(C===undefined){delete arguments[F].prototype.initialize}else{arguments[F].prototype.initialize=C}}G=arguments[F].prototype}else{G=arguments[F]}OpenLayers.Util.extend(D,G)}E.prototype=D;return E};OpenLayers.Class.isPrototype=function(){};OpenLayers.Class.create=function(){return function(){if(arguments&&arguments[0]!=OpenLayers.Class.isPrototype){this.initialize.apply(this,arguments)}}};OpenLayers.Class.inherit=function(){var E=arguments[0];var F=new E(OpenLayers.Class.isPrototype);for(var D=1,B=arguments.length;D<B;D++){if(typeof arguments[D]=="function"){var C=arguments[D];arguments[D]=new C(OpenLayers.Class.isPrototype)}OpenLayers.Util.extend(F,arguments[D])}return F};OpenLayers.Util={};OpenLayers.Util.getElement=function(){var E=[];for(var D=0,B=arguments.length;D<B;D++){var C=arguments[D];if(typeof C=="string"){C=document.getElementById(C)}if(arguments.length==1){return C}E.push(C)}return E};if(typeof window.$==="undefined"){window.$=OpenLayers.Util.getElement}OpenLayers.Util.extend=function(B,F){B=B||{};if(F){for(var E in F){var D=F[E];if(D!==undefined){B[E]=D}}var C=typeof window.Event=="function"&&F instanceof window.Event;if(!C&&F.hasOwnProperty&&F.hasOwnProperty("toString")){B.toString=F.toString}}return B};OpenLayers.Util.removeItem=function(D,C){for(var B=D.length-1;B>=0;B--){if(D[B]==C){D.splice(B,1)}}return D};OpenLayers.Util.clearArray=function(B){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"array = []"}));B.length=0};OpenLayers.Util.indexOf=function(E,D){for(var C=0,B=E.length;C<B;C++){if(E[C]==D){return C}}return -1};OpenLayers.Util.modifyDOMElement=function(F,I,E,G,B,D,H,C){if(I){F.id=I}if(E){F.style.left=E.x+"px";F.style.top=E.y+"px"}if(G){F.style.width=G.w+"px";F.style.height=G.h+"px"}if(B){F.style.position=B}if(D){F.style.border=D}if(H){F.style.overflow=H}if(parseFloat(C)>=0&&parseFloat(C)<1){F.style.filter="alpha(opacity="+(C*100)+")";F.style.opacity=C}else{if(parseFloat(C)==1){F.style.filter="";F.style.opacity=""}}};OpenLayers.Util.createDiv=function(B,J,I,G,F,D,C,H){var E=document.createElement("div");if(G){E.style.backgroundImage="url("+G+")"}if(!B){B=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!F){F="absolute"}OpenLayers.Util.modifyDOMElement(E,B,J,I,F,D,C,H);return E};OpenLayers.Util.createImage=function(B,I,H,F,E,D,G,J){var C=document.createElement("img");if(!B){B=OpenLayers.Util.createUniqueID("OpenLayersDiv")}if(!E){E="relative"}OpenLayers.Util.modifyDOMElement(C,B,I,H,E,D,null,G);if(J){C.style.display="none";OpenLayers.Event.observe(C,"load",OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,C));OpenLayers.Event.observe(C,"error",OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,C))}C.style.alt=B;C.galleryImg="no";if(F){C.src=F}return C};OpenLayers.Util.setOpacity=function(C,B){OpenLayers.Util.modifyDOMElement(C,null,null,null,null,null,null,B)};OpenLayers.Util.onImageLoad=function(){if(!this.viewRequestID||(this.map&&this.viewRequestID==this.map.viewRequestID)){this.style.backgroundColor="transparent";this.style.display=""}};OpenLayers.Util.onImageLoadErrorColor="pink";OpenLayers.IMAGE_RELOAD_ATTEMPTS=0;OpenLayers.Util.onImageLoadError=function(){this._attempts=(this._attempts)?(this._attempts+1):1;if(this._attempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS){var E=this.urls;if(E&&E instanceof Array&&E.length>1){var F=this.src.toString();var D,B;for(B=0;D=E[B];B++){if(F.indexOf(D)!=-1){break}}var G=Math.floor(E.length*Math.random());var C=E[G];B=0;while(C==D&&B++<4){G=Math.floor(E.length*Math.random());C=E[G]}this.src=F.replace(D,C)}else{this.src=this.src}}else{this.style.backgroundColor=OpenLayers.Util.onImageLoadErrorColor}this.style.display=""};OpenLayers.Util.alphaHackNeeded=null;OpenLayers.Util.alphaHack=function(){if(OpenLayers.Util.alphaHackNeeded==null){var E=navigator.appVersion.split("MSIE");var B=parseFloat(E[1]);var C=false;try{C=!!(document.body.filters)}catch(D){}OpenLayers.Util.alphaHackNeeded=(C&&(B>=5.5)&&(B<7))}return OpenLayers.Util.alphaHackNeeded};OpenLayers.Util.modifyAlphaImageDiv=function(B,C,K,J,H,G,D,E,I){OpenLayers.Util.modifyDOMElement(B,C,K,J,G,null,null,I);var F=B.childNodes[0];if(H){F.src=H}OpenLayers.Util.modifyDOMElement(F,B.id+"_innerImage",null,J,"relative",D);if(OpenLayers.Util.alphaHack()){if(B.style.display!="none"){B.style.display="inline-block"}if(E==null){E="scale"}B.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+F.src+"', sizingMethod='"+E+"')";if(parseFloat(B.style.opacity)>=0&&parseFloat(B.style.opacity)<1){B.style.filter+=" alpha(opacity="+B.style.opacity*100+")"}F.style.filter="alpha(opacity=0)"}};OpenLayers.Util.createAlphaImageDiv=function(C,K,J,H,G,D,E,I,L){var B=OpenLayers.Util.createDiv();var F=OpenLayers.Util.createImage(null,null,null,null,null,null,null,false);B.appendChild(F);if(L){F.style.display="none";OpenLayers.Event.observe(F,"load",OpenLayers.Function.bind(OpenLayers.Util.onImageLoad,B));OpenLayers.Event.observe(F,"error",OpenLayers.Function.bind(OpenLayers.Util.onImageLoadError,B))}OpenLayers.Util.modifyAlphaImageDiv(B,C,K,J,H,G,D,E,I);return B};OpenLayers.Util.upperCaseObject=function(C){var B={};for(var D in C){B[D.toUpperCase()]=C[D]}return B};OpenLayers.Util.applyDefaults=function(E,D){E=E||{};var C=typeof window.Event=="function"&&D instanceof window.Event;for(var B in D){if(E[B]===undefined||(!C&&D.hasOwnProperty&&D.hasOwnProperty(B)&&!E.hasOwnProperty(B))){E[B]=D[B]}}if(!C&&D&&D.hasOwnProperty&&D.hasOwnProperty("toString")&&!E.hasOwnProperty("toString")){E.toString=D.toString}return E};OpenLayers.Util.getParameterString=function(I){var H=[];for(var D in I){var F=I[D];if((F!=null)&&(typeof F!="function")){var C;if(typeof F=="object"&&F.constructor==Array){var G=[];for(var E=0,B=F.length;E<B;E++){G.push(encodeURIComponent(F[E]))}C=G.join(",")}else{C=encodeURIComponent(F)}H.push(encodeURIComponent(D)+"="+C)}}return H.join("&")};OpenLayers.ImgPath="";OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||(OpenLayers._getScriptLocation()+"img/")};OpenLayers.Util.Try=function(){var E=null;for(var D=0,B=arguments.length;D<B;D++){var C=arguments[D];try{E=C();break}catch(F){}}return E};OpenLayers.Util.getNodes=function(D,C){var B=OpenLayers.Util.Try(function(){return OpenLayers.Util._getNodes(D.documentElement.childNodes,C)},function(){return OpenLayers.Util._getNodes(D.childNodes,C)});return B};OpenLayers.Util._getNodes=function(D,F){var C=[];for(var E=0,B=D.length;E<B;E++){if(D[E].nodeName==F){C.push(D[E])}}return C};OpenLayers.Util.getTagText=function(D,E,C){var B=OpenLayers.Util.getNodes(D,E);if(B&&(B.length>0)){if(!C){C=0}if(B[C].childNodes.length>1){return B.childNodes[1].nodeValue}else{if(B[C].childNodes.length==1){return B[C].firstChild.nodeValue}}}else{return""}};OpenLayers.Util.getXmlNodeValue=function(B){var C=null;OpenLayers.Util.Try(function(){C=B.text;if(!C){C=B.textContent}if(!C){C=B.firstChild.nodeValue}},function(){C=B.textContent});return C};OpenLayers.Util.mouseLeft=function(B,D){var C=(B.relatedTarget)?B.relatedTarget:B.toElement;while(C!=D&&C!=null){C=C.parentNode}return(C!=D)};OpenLayers.Util.DEFAULT_PRECISION=14;OpenLayers.Util.toFloat=function(C,B){if(B==null){B=OpenLayers.Util.DEFAULT_PRECISION}var C;if(B==0){C=parseFloat(C)}else{C=parseFloat(parseFloat(C).toPrecision(B))}return C};OpenLayers.Util.rad=function(B){return B*Math.PI/180};OpenLayers.Util.distVincenty=function(F,D){var u=6378137,r=6356752.3142,j=1/298.257223563;var M=OpenLayers.Util.rad(D.lon-F.lon);var q=Math.atan((1-j)*Math.tan(OpenLayers.Util.rad(F.lat)));var m=Math.atan((1-j)*Math.tan(OpenLayers.Util.rad(D.lat)));var K=Math.sin(q),H=Math.cos(q);var J=Math.sin(m),G=Math.cos(m);var Q=M,N=2*Math.PI;var P=20;while(Math.abs(Q-N)>1e-12&&--P>0){var Y=Math.sin(Q),E=Math.cos(Q);var v=Math.sqrt((G*Y)*(G*Y)+(H*J-K*G*E)*(H*J-K*G*E));if(v==0){return 0}var g=K*J+H*G*E;var W=Math.atan2(v,g);var I=Math.asin(H*G*Y/v);var h=Math.cos(I)*Math.cos(I);var O=g-2*K*J/h;var T=j/16*h*(4+j*(4-3*h));N=Q;Q=M+(1-T)*j*Math.sin(I)*(W+T*v*(O+T*g*(-1+2*O*O)))}if(P==0){return NaN}var S=h*(u*u-r*r)/(r*r);var V=1+S/16384*(4096+S*(-768+S*(320-175*S)));var U=S/1024*(256+S*(-128+S*(74-47*S)));var Z=U*v*(O+U/4*(g*(-1+2*O*O)-U/6*O*(-3+4*v*v)*(-3+4*O*O)));var R=r*V*(W-Z);var l=R.toFixed(3)/1000;return l};OpenLayers.Util.getParameters=function(C){C=C||window.location.href;var B="";if(OpenLayers.String.contains(C,"?")){var D=C.indexOf("?")+1;var F=OpenLayers.String.contains(C,"#")?C.indexOf("#"):C.length;B=C.substring(D,F)}var N={};var E=B.split(/[&;]/);for(var I=0,J=E.length;I<J;++I){var H=E[I].split("=");if(H[0]){var L=decodeURIComponent(H[0]);var K=H[1]||"";K=K.split(",");for(var G=0,M=K.length;G<M;G++){K[G]=decodeURIComponent(K[G])}if(K.length==1){K=K[0]}N[L]=K}}return N};OpenLayers.Util.getArgs=function(B){OpenLayers.Console.warn(OpenLayers.i18n("methodDeprecated",{newMethod:"OpenLayers.Util.getParameters"}));return OpenLayers.Util.getParameters(B)};OpenLayers.Util.lastSeqID=0;OpenLayers.Util.createUniqueID=function(B){if(B==null){B="id_"}OpenLayers.Util.lastSeqID+=1;return B+OpenLayers.Util.lastSeqID};OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches;OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m;OpenLayers.METERS_PER_INCH=0.0254000508001016;OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:0.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:0.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:0.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:0.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:0.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:0.0254/OpenLayers.METERS_PER_INCH,MicroInch:0.0000254/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:0.01/OpenLayers.METERS_PER_INCH,Kilometer:1000/OpenLayers.METERS_PER_INCH,Yard:0.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:0.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:0.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:0.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:0.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:0.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:0.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:0.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:0.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:0.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:0.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:0.1/OpenLayers.METERS_PER_INCH,Millimeter:0.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:0.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:0.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:0.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:0.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:0.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:0.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:0.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:0.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":50000/OpenLayers.METERS_PER_INCH,"150kilometers":150000/OpenLayers.METERS_PER_INCH});OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1000,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:OpenLayers.INCHES_PER_UNIT.Meter*100,km:OpenLayers.INCHES_PER_UNIT.Meter*1000,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH});OpenLayers.DOTS_PER_INCH=72;OpenLayers.Util.normalizeScale=function(C){var B=(C>1)?(1/C):C;return B};OpenLayers.Util.getResolutionFromScale=function(E,B){if(B==null){B="degrees"}var D=OpenLayers.Util.normalizeScale(E);var C=1/(D*OpenLayers.INCHES_PER_UNIT[B]*OpenLayers.DOTS_PER_INCH);return C};OpenLayers.Util.getScaleFromResolution=function(C,B){if(B==null){B="degrees"}var D=C*OpenLayers.INCHES_PER_UNIT[B]*OpenLayers.DOTS_PER_INCH;return D};OpenLayers.Util.safeStopPropagation=function(B){OpenLayers.Event.stop(B,true)};OpenLayers.Util.pagePosition=function(F){var B=0,E=0;var C=F;var G=F;while(C){if(C==document.body){if(OpenLayers.Element.getStyle(G,"position")=="absolute"){break}}B+=C.offsetTop||0;E+=C.offsetLeft||0;G=C;try{C=C.offsetParent}catch(D){OpenLayers.Console.error(OpenLayers.i18n("pagePositionFailed",{elemId:C.id}));break}}C=F;while(C){B-=C.scrollTop||0;E-=C.scrollLeft||0;C=C.parentNode}return[E,B]};OpenLayers.Util.isEquivalentUrl=function(G,F,D){D=D||{};OpenLayers.Util.applyDefaults(D,{ignoreCase:true,ignorePort80:true,ignoreHash:true});var C=OpenLayers.Util.createUrlObject(G,D);var B=OpenLayers.Util.createUrlObject(F,D);for(var E in C){if(E!=="args"){if(C[E]!=B[E]){return false}}}for(var E in C.args){if(C.args[E]!=B.args[E]){return false}delete B.args[E]}for(var E in B.args){return false}return true};OpenLayers.Util.createUrlObject=function(C,K){K=K||{};if(!(/^\w+:\/\//).test(C)){var G=window.location;var E=G.port?":"+G.port:"";var H=G.protocol+"//"+G.host.split(":").shift()+E;if(C.indexOf("/")===0){C=H+C}else{var F=G.pathname.split("/");F.pop();C=H+F.join("/")+"/"+C}}if(K.ignoreCase){C=C.toLowerCase()}var I=document.createElement("a");I.href=C;var D={};D.host=I.host.split(":").shift();D.protocol=I.protocol;if(K.ignorePort80){D.port=(I.port=="80"||I.port=="0")?"":I.port}else{D.port=(I.port==""||I.port=="0")?"80":I.port}D.hash=(K.ignoreHash||I.hash==="#")?"":I.hash;var B=I.search;if(!B){var J=C.indexOf("?");B=(J!=-1)?C.substr(J):""}D.args=OpenLayers.Util.getParameters(B);D.pathname=(I.pathname.charAt(0)=="/")?I.pathname:"/"+I.pathname;return D};OpenLayers.Util.removeTail=function(C){var D=null;var B=C.indexOf("?");var E=C.indexOf("#");if(B==-1){D=(E!=-1)?C.substr(0,E):C}else{D=(E!=-1)?C.substr(0,Math.min(B,E)):C.substr(0,B)}return D};OpenLayers.Util.getBrowserName=function(){var C="";var B=navigator.userAgent.toLowerCase();if(B.indexOf("opera")!=-1){C="opera"}else{if(B.indexOf("msie")!=-1){C="msie"}else{if(B.indexOf("safari")!=-1){C="safari"}else{if(B.indexOf("mozilla")!=-1){if(B.indexOf("firefox")!=-1){C="firefox"}else{C="mozilla"}}}}}return C};OpenLayers.Util.getRenderedDimensions=function(C,M,N){var J,F;var B=document.createElement("div");B.style.visibility="hidden";var L=(N&&N.containerElement)?N.containerElement:document.body;if(M){if(M.w){J=M.w;B.style.width=J+"px"}else{if(M.h){F=M.h;B.style.height=F+"px"}}}if(N&&N.displayClass){B.className=N.displayClass}var G=document.createElement("div");G.innerHTML=C;G.style.overflow="visible";if(G.childNodes){for(var E=0,D=G.childNodes.length;E<D;E++){if(!G.childNodes[E].style){continue}G.childNodes[E].style.overflow="visible"}}B.appendChild(G);L.appendChild(B);var K=false;var I=B.parentNode;while(I&&I.tagName.toLowerCase()!="body"){var H=OpenLayers.Element.getStyle(I,"position");if(H=="absolute"){K=true;break}else{if(H&&H!="static"){break}}I=I.parentNode}if(!K){B.style.position="absolute"}if(!J){J=parseInt(G.scrollWidth);B.style.width=J+"px"}if(!F){F=parseInt(G.scrollHeight)}B.removeChild(G);L.removeChild(B);return new OpenLayers.Size(J,F)};OpenLayers.Util.getScrollbarWidth=function(){var D=OpenLayers.Util._scrollbarWidth;if(D==null){var F=null;var E=null;var B=0;var C=0;F=document.createElement("div");F.style.position="absolute";F.style.top="-1000px";F.style.left="-1000px";F.style.width="100px";F.style.height="50px";F.style.overflow="hidden";E=document.createElement("div");E.style.width="100%";E.style.height="200px";F.appendChild(E);document.body.appendChild(F);B=E.offsetWidth;F.style.overflow="scroll";C=E.offsetWidth;document.body.removeChild(document.body.lastChild);OpenLayers.Util._scrollbarWidth=(B-C);D=OpenLayers.Util._scrollbarWidth}return D};OpenLayers.Rico=new Object();OpenLayers.Rico.Corner={round:function(E,C){E=OpenLayers.Util.getElement(E);this._setOptions(C);var B=this.options.color;if(this.options.color=="fromElement"){B=this._background(E)}var D=this.options.bgColor;if(this.options.bgColor=="fromParent"){D=this._background(E.offsetParent)}this._roundCornersImpl(E,B,D)},changeColor:function(D,C){D.style.backgroundColor=C;var B=D.parentNode.getElementsByTagName("span");for(var E=0;E<B.length;E++){B[E].style.backgroundColor=C}},changeOpacity:function(D,G){var E=G;var B="alpha(opacity="+G*100+")";D.style.opacity=E;D.style.filter=B;var C=D.parentNode.getElementsByTagName("span");for(var F=0;F<C.length;F++){C[F].style.opacity=E;C[F].style.filter=B}},reRound:function(E,D){var C=E.parentNode.childNodes[0];var B=E.parentNode.childNodes[2];E.parentNode.removeChild(C);E.parentNode.removeChild(B);this.round(E.parentNode,D)},_roundCornersImpl:function(D,B,C){if(this.options.border){this._renderBorder(D,C)}if(this._isTopRounded()){this._roundTopCorners(D,B,C)}if(this._isBottomRounded()){this._roundBottomCorners(D,B,C)}},_renderBorder:function(E,F){var C="1px solid "+this._borderColor(F);var B="border-left: "+C;var G="border-right: "+C;var D="style='"+B+";"+G+"'";E.innerHTML="<div "+D+">"+E.innerHTML+"</div>"},_roundTopCorners:function(D,B,F){var E=this._createCorner(F);for(var C=0;C<this.options.numSlices;C++){E.appendChild(this._createCornerSlice(B,F,C,"top"))}D.style.paddingTop=0;D.insertBefore(E,D.firstChild)},_roundBottomCorners:function(D,B,F){var E=this._createCorner(F);for(var C=(this.options.numSlices-1);C>=0;C--){E.appendChild(this._createCornerSlice(B,F,C,"bottom"))}D.style.paddingBottom=0;D.appendChild(E)},_createCorner:function(C){var B=document.createElement("div");B.style.backgroundColor=(this._isTransparent()?"transparent":C);return B},_createCornerSlice:function(D,E,H,B){var F=document.createElement("span");var C=F.style;C.backgroundColor=D;C.display="block";C.height="1px";C.overflow="hidden";C.fontSize="1px";var G=this._borderColor(D,E);if(this.options.border&&H==0){C.borderTopStyle="solid";C.borderTopWidth="1px";C.borderLeftWidth="0px";C.borderRightWidth="0px";C.borderBottomWidth="0px";C.height="0px";C.borderColor=G}else{if(G){C.borderColor=G;C.borderStyle="solid";C.borderWidth="0px 1px"}}if(!this.options.compact&&(H==(this.options.numSlices-1))){C.height="2px"}this._setMargin(F,H,B);this._setBorder(F,H,B);return F},_setOptions:function(B){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:true,border:false,compact:false};OpenLayers.Util.extend(this.options,B||{});this.options.numSlices=this.options.compact?2:4;if(this._isTransparent()){this.options.blend=false}},_whichSideTop:function(){if(this._hasString(this.options.corners,"all","top")){return""}if(this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0){return""}if(this.options.corners.indexOf("tl")>=0){return"left"}else{if(this.options.corners.indexOf("tr")>=0){return"right"}}return""},_whichSideBottom:function(){if(this._hasString(this.options.corners,"all","bottom")){return""}if(this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0){return""}if(this.options.corners.indexOf("bl")>=0){return"left"}else{if(this.options.corners.indexOf("br")>=0){return"right"}}return""},_borderColor:function(B,C){if(B=="transparent"){return C}else{if(this.options.border){return this.options.border}else{if(this.options.blend){return this._blend(C,B)}else{return""}}}},_setMargin:function(E,F,C){var D=this._marginSize(F);var B=C=="top"?this._whichSideTop():this._whichSideBottom();if(B=="left"){E.style.marginLeft=D+"px";E.style.marginRight="0px"}else{if(B=="right"){E.style.marginRight=D+"px";E.style.marginLeft="0px"}else{E.style.marginLeft=D+"px";E.style.marginRight=D+"px"}}},_setBorder:function(E,F,C){var D=this._borderSize(F);var B=C=="top"?this._whichSideTop():this._whichSideBottom();if(B=="left"){E.style.borderLeftWidth=D+"px";E.style.borderRightWidth="0px"}else{if(B=="right"){E.style.borderRightWidth=D+"px";E.style.borderLeftWidth="0px"}else{E.style.borderLeftWidth=D+"px";E.style.borderRightWidth=D+"px"}}if(this.options.border!=false){E.style.borderLeftWidth=D+"px";E.style.borderRightWidth=D+"px"}},_marginSize:function(F){if(this._isTransparent()){return 0}var E=[5,3,2,1];var B=[3,2,1,0];var D=[2,1];var C=[1,0];if(this.options.compact&&this.options.blend){return C[F]}else{if(this.options.compact){return D[F]}else{if(this.options.blend){return B[F]}else{return E[F]}}}},_borderSize:function(F){var E=[5,3,2,1];var C=[2,1,1,1];var B=[1,0];var D=[0,2,0,0];if(this.options.compact&&(this.options.blend||this._isTransparent())){return 1}else{if(this.options.compact){return B[F]}else{if(this.options.blend){return C[F]}else{if(this.options.border){return D[F]}else{if(this._isTransparent()){return E[F]}}}}}return 0},_hasString:function(C){for(var B=1;B<arguments.length;B++){if(C.indexOf(arguments[B])>=0){return true}}return false},_blend:function(D,B){var C=OpenLayers.Rico.Color.createFromHex(D);C.blend(OpenLayers.Rico.Color.createFromHex(B));return C},_background:function(B){try{return OpenLayers.Rico.Color.createColorFromBackground(B).asHex()}catch(C){return"#ffffff"}},_isTransparent:function(){return this.options.color=="transparent"},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(B){return B.childNodes.length==1&&B.childNodes[0].nodeType==3}};(function(){if(window.google&&google.gears){return }var B=null;if(typeof GearsFactory!="undefined"){B=new GearsFactory()}else{try{B=new ActiveXObject("Gears.Factory");if(B.getBuildInfo().indexOf("ie_mobile")!=-1){B.privateSetGlobalObject(this)}}catch(C){if((typeof navigator.mimeTypes!="undefined")&&navigator.mimeTypes["application/x-googlegears"]){B=document.createElement("object");B.style.display="none";B.width=0;B.height=0;B.type="application/x-googlegears";document.documentElement.appendChild(B)}}}if(!B){return }if(!window.google){google={}}if(!google.gears){google.gears={factory:B}}})();OpenLayers.Element={visible:function(B){return OpenLayers.Util.getElement(B).style.display!="none"},toggle:function(){for(var D=0,B=arguments.length;D<B;D++){var C=OpenLayers.Util.getElement(arguments[D]);var E=OpenLayers.Element.visible(C)?"hide":"show";OpenLayers.Element[E](C)}},hide:function(){for(var D=0,B=arguments.length;D<B;D++){var C=OpenLayers.Util.getElement(arguments[D]);C.style.display="none"}},show:function(){for(var D=0,B=arguments.length;D<B;D++){var C=OpenLayers.Util.getElement(arguments[D]);C.style.display=""}},remove:function(B){B=OpenLayers.Util.getElement(B);B.parentNode.removeChild(B)},getHeight:function(B){B=OpenLayers.Util.getElement(B);return B.offsetHeight},getDimensions:function(C){C=OpenLayers.Util.getElement(C);if(OpenLayers.Element.getStyle(C,"display")!="none"){return{width:C.offsetWidth,height:C.offsetHeight}}var B=C.style;var F=B.visibility;var D=B.position;B.visibility="hidden";B.position="absolute";B.display="";var G=C.clientWidth;var E=C.clientHeight;B.display="none";B.position=D;B.visibility=F;return{width:G,height:E}},hasClass:function(C,B){var D=C.className;return(!!D&&new RegExp("(^|\\s)"+B+"(\\s|$)").test(D))},addClass:function(C,B){if(!OpenLayers.Element.hasClass(C,B)){C.className+=(C.className?" ":"")+B}return C},removeClass:function(C,B){var D=C.className;if(D){C.className=OpenLayers.String.trim(D.replace(new RegExp("(^|\\s+)"+B+"(\\s+|$)")," "))}return C},toggleClass:function(C,B){if(OpenLayers.Element.hasClass(C,B)){OpenLayers.Element.removeClass(C,B)}else{OpenLayers.Element.addClass(C,B)}return C},getStyle:function(D,E){D=OpenLayers.Util.getElement(D);var F=null;if(D&&D.style){F=D.style[OpenLayers.String.camelize(E)];if(!F){if(document.defaultView&&document.defaultView.getComputedStyle){var C=document.defaultView.getComputedStyle(D,null);F=C?C.getPropertyValue(E):null}else{if(D.currentStyle){F=D.currentStyle[OpenLayers.String.camelize(E)]}}}var B=["left","top","right","bottom"];if(window.opera&&(OpenLayers.Util.indexOf(B,E)!=-1)&&(OpenLayers.Element.getStyle(D,"position")=="static")){F="auto"}}return F=="auto"?null:F}};OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(B,C){this.w=parseFloat(B);this.h=parseFloat(C)},toString:function(){return("w="+this.w+",h="+this.h)},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(C){var B=false;if(C!=null){B=((this.w==C.w&&this.h==C.h)||(isNaN(this.w)&&isNaN(this.h)&&isNaN(C.w)&&isNaN(C.h)))}return B},CLASS_NAME:"OpenLayers.Size"});OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(B){alert(B)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"};(function(){var C=document.getElementsByTagName("script");for(var D=0,B=C.length;D<B;++D){if(C[D].src.indexOf("firebug.js")!=-1){if(console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}}})();OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(B,C,E,D){this.url=B;this.size=(C)?C:new OpenLayers.Size(20,20);this.offset=E?E:new OpenLayers.Pixel(-(this.size.w/2),-(this.size.h/2));this.calculateOffset=D;var F=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(F)},destroy:function(){this.erase();OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild);this.imageDiv.innerHTML="";this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(B){if(B!=null){this.size=B}this.draw()},setUrl:function(B){if(B!=null){this.url=B}this.draw()},draw:function(B){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute");this.moveTo(B);return this.imageDiv},erase:function(){if(this.imageDiv!=null&&this.imageDiv.parentNode!=null){OpenLayers.Element.remove(this.imageDiv)}},setOpacity:function(B){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,B)},moveTo:function(B){if(B!=null){this.px=B}if(this.imageDiv!=null){if(this.px==null){this.display(false)}else{if(this.calculateOffset){this.offset=this.calculateOffset(this.size)}var C=this.px.offset(this.offset);OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,C)}}},display:function(B){this.imageDiv.style.display=(B)?"":"none"},isDrawn:function(){var B=(this.imageDiv&&this.imageDiv.parentNode&&(this.imageDiv.parentNode.nodeType!=11));return B},CLASS_NAME:"OpenLayers.Icon"});OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:false,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:false,fixPadding:function(){if(typeof this.padding=="number"){this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding)}},panMapIfOutOfView:false,keepInMap:false,closeOnMove:false,map:null,initialize:function(H,D,G,C,F,E){if(H==null){H=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}this.id=H;this.lonlat=D;this.contentSize=(G!=null)?G:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT);if(C!=null){this.contentHTML=C}this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className=this.displayClass;var B=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(B,null,null,null,"relative",null,"hidden");var H=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(H,null,this.contentSize.clone(),null,"relative");this.contentDiv.className=this.contentDisplayClass;this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);if(F){this.addCloseBox(E)}this.registerEvents()},destroy:function(){this.id=null;this.lonlat=null;this.size=null;this.contentHTML=null;this.backgroundColor=null;this.opacity=null;this.border=null;if(this.closeOnMove&&this.map){this.map.events.unregister("movestart",this,this.hide)}this.events.destroy();this.events=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.groupDiv.removeChild(this.closeDiv)}this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;if(this.map!=null){this.map.removePopup(this)}this.map=null;this.div=null;this.autoSize=null;this.minSize=null;this.maxSize=null;this.padding=null;this.panMapIfOutOfView=null},draw:function(B){if(B==null){if((this.lonlat!=null)&&(this.map!=null)){B=this.map.getLayerPxFromLonLat(this.lonlat)}}if(this.closeOnMove){this.map.events.register("movestart",this,this.hide)}if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){this.map.events.register("movestart",this,function(){var C=document.defaultView.getComputedStyle(this.contentDiv,null);var D=C.getPropertyValue("overflow");if(D!="hidden"){this.contentDiv._oldOverflow=D;this.contentDiv.style.overflow="hidden"}});this.map.events.register("moveend",this,function(){var C=this.contentDiv._oldOverflow;if(C){this.contentDiv.style.overflow=C;this.contentDiv._oldOverflow=null}})}this.moveTo(B);if(!this.autoSize&&!this.size){this.setSize(this.contentSize)}this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();if(this.panMapIfOutOfView){this.panIntoView()}return this.div},updatePosition:function(){if((this.lonlat)&&(this.map)){var B=this.map.getLayerPxFromLonLat(this.lonlat);if(B){this.moveTo(B)}}},moveTo:function(B){if((B!=null)&&(this.div!=null)){this.div.style.left=B.x+"px";this.div.style.top=B.y+"px"}},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){if(this.visible()){this.hide()}else{this.show()}},show:function(){OpenLayers.Element.show(this.div);if(this.panMapIfOutOfView){this.panIntoView()}},hide:function(){OpenLayers.Element.hide(this.div)},setSize:function(D){this.size=D.clone();var C=this.getContentDivPadding();var B=C.left+C.right;var F=C.top+C.bottom;this.fixPadding();B+=this.padding.left+this.padding.right;F+=this.padding.top+this.padding.bottom;if(this.closeDiv){var E=parseInt(this.closeDiv.style.width);B+=E+C.right}this.size.w+=B;this.size.h+=F;if(OpenLayers.Util.getBrowserName()=="msie"){this.contentSize.w+=C.left+C.right;this.contentSize.h+=C.bottom+C.top}if(this.div!=null){this.div.style.width=this.size.w+"px";this.div.style.height=this.size.h+"px"}if(this.contentDiv!=null){this.contentDiv.style.width=D.w+"px";this.contentDiv.style.height=D.h+"px"}},updateSize:function(){var F="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>";var I=(this.map)?this.map.layerContainerDiv:document.body;var J=OpenLayers.Util.getRenderedDimensions(F,null,{displayClass:this.displayClass,containerElement:I});var H=this.getSafeContentSize(J);var G=null;if(H.equals(J)){G=J}else{var C=new OpenLayers.Size();C.w=(H.w<J.w)?H.w:null;C.h=(H.h<J.h)?H.h:null;if(C.w&&C.h){G=H}else{var E=OpenLayers.Util.getRenderedDimensions(F,C,{displayClass:this.contentDisplayClass,containerElement:I});var D=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if((D!="hidden")&&(E.equals(H))){var B=OpenLayers.Util.getScrollbarWidth();if(C.w){E.h+=B}else{E.w+=B}}G=this.getSafeContentSize(E)}}this.setSize(G)},setBackgroundColor:function(B){if(B!=undefined){this.backgroundColor=B}if(this.div!=null){this.div.style.backgroundColor=this.backgroundColor}},setOpacity:function(B){if(B!=undefined){this.opacity=B}if(this.div!=null){this.div.style.opacity=this.opacity;this.div.style.filter="alpha(opacity="+this.opacity*100+")"}},setBorder:function(B){if(B!=undefined){this.border=B}if(this.div!=null){this.div.style.border=this.border}},setContentHTML:function(B){if(B!=null){this.contentHTML=B}if((this.contentDiv!=null)&&(this.contentHTML!=null)&&(this.contentHTML!=this.contentDiv.innerHTML)){this.contentDiv.innerHTML=this.contentHTML;if(this.autoSize){this.registerImageListeners();this.updateSize()}}},registerImageListeners:function(){var G=function(){this.popup.updateSize();if(this.popup.visible()&&this.popup.panMapIfOutOfView){this.popup.panIntoView()}OpenLayers.Event.stopObserving(this.img,"load",this.img._onImageLoad)};var C=this.contentDiv.getElementsByTagName("img");for(var F=0,B=C.length;F<B;F++){var D=C[F];if(D.width==0||D.height==0){var E={popup:this,img:D};D._onImgLoad=OpenLayers.Function.bind(G,E);OpenLayers.Event.observe(D,"load",D._onImgLoad)}}},getSafeContentSize:function(L){var E=L.clone();var J=this.getContentDivPadding();var K=J.left+J.right;var H=J.top+J.bottom;this.fixPadding();K+=this.padding.left+this.padding.right;H+=this.padding.top+this.padding.bottom;if(this.closeDiv){var D=parseInt(this.closeDiv.style.width);K+=D+J.right}if(this.minSize){E.w=Math.max(E.w,(this.minSize.w-K));E.h=Math.max(E.h,(this.minSize.h-H))}if(this.maxSize){E.w=Math.min(E.w,(this.maxSize.w-K));E.h=Math.min(E.h,(this.maxSize.h-H))}if(this.map&&this.map.size){var G=0,F=0;if(this.keepInMap&&!this.panMapIfOutOfView){var I=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":G=I.x;F=this.map.size.h-I.y;break;case"tl":G=this.map.size.w-I.x;F=this.map.size.h-I.y;break;case"bl":G=this.map.size.w-I.x;F=I.y;break;case"br":G=I.x;F=I.y;break;default:G=I.x;F=this.map.size.h-I.y;break}}var B=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-H-F;var C=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-K-G;E.w=Math.min(E.w,C);E.h=Math.min(E.h,B)}return E},getContentDivPadding:function(){var B=this._contentDivPadding;if(!B){if(this.div.parentNode==null){this.div.style.display="none";document.body.appendChild(this.div)}B=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top"));this._contentDivPadding=B;if(this.div.parentNode==document.body){document.body.removeChild(this.div);this.div.style.display=""}}return B},addCloseBox:function(D){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,new OpenLayers.Size(17,17));this.closeDiv.className="olPopupCloseBox";var C=this.getContentDivPadding();this.closeDiv.style.right=C.right+"px";this.closeDiv.style.top=C.top+"px";this.groupDiv.appendChild(this.closeDiv);var B=D||function(E){this.hide();OpenLayers.Event.stop(E)};OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(B,this))},panIntoView:function(){var F=this.map.getSize();var E=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top)));var D=E.clone();if(E.x<this.map.paddingForPopups.left){D.x=this.map.paddingForPopups.left}else{if((E.x+this.size.w)>(F.w-this.map.paddingForPopups.right)){D.x=F.w-this.map.paddingForPopups.right-this.size.w}}if(E.y<this.map.paddingForPopups.top){D.y=this.map.paddingForPopups.top}else{if((E.y+this.size.h)>(F.h-this.map.paddingForPopups.bottom)){D.y=F.h-this.map.paddingForPopups.bottom-this.size.h}}var C=E.x-D.x;var B=E.y-D.y;this.map.pan(C,B)},registerEvents:function(){this.events=new OpenLayers.Events(this,this.div,null,true);this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,scope:this})},onmousedown:function(B){this.mousedown=true;OpenLayers.Event.stop(B,true)},onmousemove:function(B){if(this.mousedown){OpenLayers.Event.stop(B,true)}},onmouseup:function(B){if(this.mousedown){this.mousedown=false;OpenLayers.Event.stop(B,true)}},onclick:function(B){OpenLayers.Event.stop(B,true)},onmouseout:function(B){this.mousedown=false},ondblclick:function(B){OpenLayers.Event.stop(B,true)},CLASS_NAME:"OpenLayers.Popup"});OpenLayers.Popup.WIDTH=200;OpenLayers.Popup.HEIGHT=200;OpenLayers.Popup.COLOR="white";OpenLayers.Popup.OPACITY=1;OpenLayers.Popup.BORDER="0px";OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:true,initialize:function(B){B=B||{};OpenLayers.Util.extend(this,B);this.options=B},destroy:function(){this.options=null;this.format=null},read:function(){},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(B){},CLASS_NAME:"OpenLayers.Protocol"});OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:true,features:null,reqFeatures:null,priv:null,initialize:function(B){OpenLayers.Util.extend(this,B)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"});OpenLayers.Protocol.Response.SUCCESS=1;OpenLayers.Protocol.Response.FAILURE=0;OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:false,size:null,resolution:null,map:null,initialize:function(B,C){this.container=OpenLayers.Util.getElement(B)},destroy:function(){this.container=null;this.extent=null;this.size=null;this.resolution=null;this.map=null},supported:function(){return false},setExtent:function(B,C){this.extent=B.clone();if(C){this.resolution=null}},setSize:function(B){this.size=B.clone();this.resolution=null},getResolution:function(){this.resolution=this.resolution||this.map.getResolution();return this.resolution},drawFeature:function(B,C){if(C==null){C=B.style}if(B.geometry){var D=B.geometry.getBounds();if(D){if(!D.intersectsBounds(this.extent)){C={display:"none"}}var E=this.drawGeometry(B.geometry,C,B.id);if(C.display!="none"&&C.label&&E!==false){this.drawText(B.id,C,B.geometry.getCentroid())}else{this.removeText(B.id)}return E}}},drawGeometry:function(D,B,C){},drawText:function(D,C,B){},removeText:function(B){},clear:function(){},getFeatureIdFromEvent:function(B){},eraseFeatures:function(D){if(!(D instanceof Array)){D=[D]}for(var C=0,B=D.length;C<B;++C){this.eraseGeometry(D[C].geometry);this.removeText(D[C].id)}},eraseGeometry:function(B){},moveRoot:function(B){},getRenderLayerId:function(){return this.container.id},CLASS_NAME:"OpenLayers.Renderer"});OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:true,autoDestroy:true,initialize:function(B){OpenLayers.Util.extend(this,B);this.options=B;this.active=false},destroy:function(){this.deactivate();this.layer=null;this.options=null},setLayer:function(B){this.layer=B},activate:function(){if(!this.active){this.active=true;return true}return false},deactivate:function(){if(this.active){this.active=false;return true}return false},CLASS_NAME:"OpenLayers.Strategy"});OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(D,C,B){this.rgb={r:D,g:C,b:B}},setRed:function(B){this.rgb.r=B},setGreen:function(B){this.rgb.g=B},setBlue:function(B){this.rgb.b=B},setHue:function(C){var B=this.asHSB();B.h=C;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,B.b)},setSaturation:function(C){var B=this.asHSB();B.s=C;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,B.b)},setBrightness:function(B){var C=this.asHSB();C.b=B;this.rgb=OpenLayers.Rico.Color.HSBtoRGB(C.h,C.s,C.b)},darken:function(C){var B=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,Math.max(B.b-C,0))},brighten:function(C){var B=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(B.h,B.s,Math.min(B.b+C,1))},blend:function(B){this.rgb.r=Math.floor((this.rgb.r+B.rgb.r)/2);this.rgb.g=Math.floor((this.rgb.g+B.rgb.g)/2);this.rgb.b=Math.floor((this.rgb.b+B.rgb.b)/2)},isBright:function(){var B=this.asHSB();return this.asHSB().b>0.5},isDark:function(){return !this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}});OpenLayers.Rico.Color.createFromHex=function(E){if(E.length==4){var C=E;var E="#";for(var D=1;D<4;D++){E+=(C.charAt(D)+C.charAt(D))}}if(E.indexOf("#")==0){E=E.substring(1)}var G=E.substring(0,2);var F=E.substring(2,4);var B=E.substring(4,6);return new OpenLayers.Rico.Color(parseInt(G,16),parseInt(F,16),parseInt(B,16))};OpenLayers.Rico.Color.createColorFromBackground=function(E){var C=RicoUtil.getElementsComputedStyle(OpenLayers.Util.getElement(E),"backgroundColor","background-color");if(C=="transparent"&&E.parentNode){return OpenLayers.Rico.Color.createColorFromBackground(E.parentNode)}if(C==null){return new OpenLayers.Rico.Color(255,255,255)}if(C.indexOf("rgb(")==0){var B=C.substring(4,C.length-1);var D=B.split(",");return new OpenLayers.Rico.Color(parseInt(D[0]),parseInt(D[1]),parseInt(D[2]))}else{if(C.indexOf("#")==0){return OpenLayers.Rico.Color.createFromHex(C)}else{return new OpenLayers.Rico.Color(255,255,255)}}};OpenLayers.Rico.Color.HSBtoRGB=function(H,F,J){var D=0;var E=0;var K=0;if(F==0){D=parseInt(J*255+0.5);E=D;K=D}else{var G=(H-Math.floor(H))*6;var I=G-Math.floor(G);var C=J*(1-F);var B=J*(1-F*I);var L=J*(1-(F*(1-I)));switch(parseInt(G)){case 0:D=(J*255+0.5);E=(L*255+0.5);K=(C*255+0.5);break;case 1:D=(B*255+0.5);E=(J*255+0.5);K=(C*255+0.5);break;case 2:D=(C*255+0.5);E=(J*255+0.5);K=(L*255+0.5);break;case 3:D=(C*255+0.5);E=(B*255+0.5);K=(J*255+0.5);break;case 4:D=(L*255+0.5);E=(C*255+0.5);K=(J*255+0.5);break;case 5:D=(J*255+0.5);E=(C*255+0.5);K=(B*255+0.5);break}}return{r:parseInt(D),g:parseInt(E),b:parseInt(K)}};OpenLayers.Rico.Color.RGBtoHSB=function(B,F,K){var G;var E;var J;var L=(B>F)?B:F;if(K>L){L=K}var H=(B<F)?B:F;if(K<H){H=K}J=L/255;if(L!=0){E=(L-H)/L}else{E=0}if(E==0){G=0}else{var C=(L-B)/(L-H);var I=(L-F)/(L-H);var D=(L-K)/(L-H);if(B==L){G=D-I}else{if(F==L){G=2+C-D}else{G=4+I-C}}G=G/6;if(G<0){G=G+1}}return{h:G,s:E,b:J}};OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(E,B,C,D){if(E!=null){this.left=OpenLayers.Util.toFloat(E)}if(B!=null){this.bottom=OpenLayers.Util.toFloat(B)}if(C!=null){this.right=OpenLayers.Util.toFloat(C)}if(D!=null){this.top=OpenLayers.Util.toFloat(D)}},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(C){var B=false;if(C!=null){B=((this.left==C.left)&&(this.right==C.right)&&(this.top==C.top)&&(this.bottom==C.bottom))}return B},toString:function(){return("left-bottom=("+this.left+","+this.bottom+") right-top=("+this.right+","+this.top+")")},toArray:function(){return[this.left,this.bottom,this.right,this.top]},toBBOX:function(B){if(B==null){B=6}var C=Math.pow(10,B);var D=Math.round(this.left*C)/C+","+Math.round(this.bottom*C)/C+","+Math.round(this.right*C)/C+","+Math.round(this.top*C)/C;return D},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return(this.right-this.left)},getHeight:function(){return(this.top-this.bottom)},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){if(!this.centerLonLat){this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)}return this.centerLonLat},scale:function(G,I){if(I==null){I=this.getCenterLonLat()}var B=[];var F,E;if(I.CLASS_NAME=="OpenLayers.LonLat"){F=I.lon;E=I.lat}else{F=I.x;E=I.y}var D=(this.left-F)*G+F;var C=(this.bottom-E)*G+E;var J=(this.right-F)*G+F;var H=(this.top-E)*G+E;return new OpenLayers.Bounds(D,C,J,H)},add:function(B,D){if((B==null)||(D==null)){var C=OpenLayers.i18n("boundsAddError");OpenLayers.Console.error(C);return null}return new OpenLayers.Bounds(this.left+B,this.bottom+D,this.right+B,this.top+D)},extend:function(B){var C=null;if(B){switch(B.CLASS_NAME){case"OpenLayers.LonLat":C=new OpenLayers.Bounds(B.lon,B.lat,B.lon,B.lat);break;case"OpenLayers.Geometry.Point":C=new OpenLayers.Bounds(B.x,B.y,B.x,B.y);break;case"OpenLayers.Bounds":C=B;break}if(C){this.centerLonLat=null;if((this.left==null)||(C.left<this.left)){this.left=C.left}if((this.bottom==null)||(C.bottom<this.bottom)){this.bottom=C.bottom}if((this.right==null)||(C.right>this.right)){this.right=C.right}if((this.top==null)||(C.top>this.top)){this.top=C.top}}}},containsLonLat:function(C,B){return this.contains(C.lon,C.lat,B)},containsPixel:function(C,B){return this.contains(C.x,C.y,B)},contains:function(C,E,B){if(B==null){B=true}if(C==null||E==null){return false}C=OpenLayers.Util.toFloat(C);E=OpenLayers.Util.toFloat(E);var D=false;if(B){D=((C>=this.left)&&(C<=this.right)&&(E>=this.bottom)&&(E<=this.top))}else{D=((C>this.left)&&(C<this.right)&&(E>this.bottom)&&(E<this.top))}return D},intersectsBounds:function(F,C){if(C==null){C=true}var E=false;var I=(this.left==F.right||this.right==F.left||this.top==F.bottom||this.bottom==F.top);if(C||!I){var H=(((F.bottom>=this.bottom)&&(F.bottom<=this.top))||((this.bottom>=F.bottom)&&(this.bottom<=F.top)));var G=(((F.top>=this.bottom)&&(F.top<=this.top))||((this.top>F.bottom)&&(this.top<F.top)));var D=(((F.left>=this.left)&&(F.left<=this.right))||((this.left>=F.left)&&(this.left<=F.right)));var B=(((F.right>=this.left)&&(F.right<=this.right))||((this.right>=F.left)&&(this.right<=F.right)));E=((H||G)&&(D||B))}return E},containsBounds:function(H,C,B){if(C==null){C=false}if(B==null){B=true}var D=this.contains(H.left,H.bottom,B);var E=this.contains(H.right,H.bottom,B);var G=this.contains(H.left,H.top,B);var F=this.contains(H.right,H.top,B);return(C)?(D||E||G||F):(D&&E&&G&&F)},determineQuadrant:function(D){var C="";var B=this.getCenterLonLat();C+=(D.lat<B.lat)?"b":"t";C+=(D.lon<B.lon)?"l":"r";return C},transform:function(E,C){this.centerLonLat=null;var F=OpenLayers.Projection.transform({x:this.left,y:this.bottom},E,C);var B=OpenLayers.Projection.transform({x:this.right,y:this.bottom},E,C);var D=OpenLayers.Projection.transform({x:this.left,y:this.top},E,C);var G=OpenLayers.Projection.transform({x:this.right,y:this.top},E,C);this.left=Math.min(F.x,D.x);this.bottom=Math.min(F.y,B.y);this.right=Math.max(B.x,G.x);this.top=Math.max(D.y,G.y);return this},wrapDateLine:function(B,D){D=D||{};var E=D.leftTolerance||0;var C=D.rightTolerance||0;var F=this.clone();if(B){while(F.left<B.left&&(F.right-C)<=B.left){F=F.add(B.getWidth(),0)}while((F.left+E)>=B.right&&F.right>B.right){F=F.add(-B.getWidth(),0)}}return F},CLASS_NAME:"OpenLayers.Bounds"});OpenLayers.Bounds.fromString=function(C){var B=C.split(",");return OpenLayers.Bounds.fromArray(B)};OpenLayers.Bounds.fromArray=function(B){return new OpenLayers.Bounds(parseFloat(B[0]),parseFloat(B[1]),parseFloat(B[2]),parseFloat(B[3]))};OpenLayers.Bounds.fromSize=function(B){return new OpenLayers.Bounds(0,B.h,B.w,0)};OpenLayers.Bounds.oppositeQuadrant=function(B){var C="";C+=(B.charAt(0)=="t")?"b":"t";C+=(B.charAt(1)=="l")?"r":"l";return C};OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(C,B){this.lon=OpenLayers.Util.toFloat(C);this.lat=OpenLayers.Util.toFloat(B)},toString:function(){return("lon="+this.lon+",lat="+this.lat)},toShortString:function(){return(this.lon+", "+this.lat)},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(D,B){if((D==null)||(B==null)){var C=OpenLayers.i18n("lonlatAddError");OpenLayers.Console.error(C);return null}return new OpenLayers.LonLat(this.lon+D,this.lat+B)},equals:function(C){var B=false;if(C!=null){B=((this.lon==C.lon&&this.lat==C.lat)||(isNaN(this.lon)&&isNaN(this.lat)&&isNaN(C.lon)&&isNaN(C.lat)))}return B},transform:function(D,C){var B=OpenLayers.Projection.transform({x:this.lon,y:this.lat},D,C);this.lon=B.x;this.lat=B.y;return this},wrapDateLine:function(B){var C=this.clone();if(B){while(C.lon<B.left){C.lon+=B.getWidth()}while(C.lon>B.right){C.lon-=B.getWidth()}}return C},CLASS_NAME:"OpenLayers.LonLat"});OpenLayers.LonLat.fromString=function(C){var B=C.split(",");return new OpenLayers.LonLat(parseFloat(B[0]),parseFloat(B[1]))};OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(B,C){this.x=parseFloat(B);this.y=parseFloat(C)},toString:function(){return("x="+this.x+",y="+this.y)},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(B){var C=false;if(B!=null){C=((this.x==B.x&&this.y==B.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(B.x)&&isNaN(B.y)))}return C},add:function(B,D){if((B==null)||(D==null)){var C=OpenLayers.i18n("pixelAddError");OpenLayers.Console.error(C);return null}return new OpenLayers.Pixel(this.x+B,this.y+D)},offset:function(B){var C=this.clone();if(B){C=this.add(B.x,B.y)}return C},CLASS_NAME:"OpenLayers.Pixel"});OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:false,displayClass:"",title:"",active:null,handler:null,eventListeners:null,events:null,EVENT_TYPES:["activate","deactivate"],initialize:function(B){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,"");OpenLayers.Util.extend(this,B);this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}},destroy:function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var B in this.handlers){if(this.handlers.hasOwnProperty(B)&&typeof this.handlers[B].destroy=="function"){this.handlers[B].destroy()}}this.handlers=null}if(this.map){this.map.removeControl(this);this.map=null}},setMap:function(B){this.map=B;if(this.handler){this.handler.setMap(B)}},draw:function(B){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=function(){return(false)}}if(this.title!=""){this.div.title=this.title}}if(B!=null){this.position=B.clone()}this.moveTo(this.position);return this.div},moveTo:function(B){if((B!=null)&&(this.div!=null)){this.div.style.left=B.x+"px";this.div.style.top=B.y+"px"}},activate:function(){if(this.active){return false}if(this.handler){this.handler.activate()}this.active=true;if(this.map){OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("activate");return true},deactivate:function(){if(this.active){if(this.handler){this.handler.deactivate()}this.active=false;if(this.map){OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active")}this.events.triggerEvent("deactivate");return true}return false},CLASS_NAME:"OpenLayers.Control"});OpenLayers.Control.TYPE_BUTTON=1;OpenLayers.Control.TYPE_TOGGLE=2;OpenLayers.Control.TYPE_TOOL=3;OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){if(!OpenLayers.Lang.code){OpenLayers.Lang.setCode()}return OpenLayers.Lang.code},setCode:function(C){var E;if(!C){C=(OpenLayers.Util.getBrowserName()=="msie")?navigator.userLanguage:navigator.language}var D=C.split("-");D[0]=D[0].toLowerCase();if(typeof OpenLayers.Lang[D[0]]=="object"){E=D[0]}if(D[1]){var B=D[0]+"-"+D[1].toUpperCase();if(typeof OpenLayers.Lang[B]=="object"){E=B}}if(!E){OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+D.join("-")+" dictionary, falling back to default language");E=OpenLayers.Lang.defaultCode}OpenLayers.Lang.code=E},translate:function(C,B){var E=OpenLayers.Lang[OpenLayers.Lang.getCode()];var D=E[C];if(!D){D=C}if(B){D=OpenLayers.String.format(D,B)}return D}};OpenLayers.i18n=OpenLayers.Lang.translate;OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:true,anchor:null,initialize:function(I,E,H,D,C,G,F){var B=[I,E,H,D,G,F];OpenLayers.Popup.prototype.initialize.apply(this,B);this.anchor=(C!=null)?C:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null;this.relativePosition=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(D){var C=this.relativePosition;this.relativePosition=this.calculateRelativePosition(D);var E=this.calculateNewPx(D);var B=new Array(E);OpenLayers.Popup.prototype.moveTo.apply(this,B);if(this.relativePosition!=C){this.updateRelativePosition()}},setSize:function(C){OpenLayers.Popup.prototype.setSize.apply(this,arguments);if((this.lonlat)&&(this.map)){var B=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(B)}},calculateRelativePosition:function(C){var E=this.map.getLonLatFromLayerPx(C);var D=this.map.getExtent();var B=D.determineQuadrant(E);return OpenLayers.Bounds.oppositeQuadrant(B)},updateRelativePosition:function(){},calculateNewPx:function(C){var F=C.offset(this.anchor.offset);var B=this.size||this.contentSize;var E=(this.relativePosition.charAt(0)=="t");F.y+=(E)?-B.h:this.anchor.size.h;var D=(this.relativePosition.charAt(1)=="l");F.x+=(D)?-B.w:this.anchor.size.w;return F},CLASS_NAME:"OpenLayers.Popup.Anchored"});OpenLayers.Protocol.SQL=OpenLayers.Class(OpenLayers.Protocol,{databaseName:"ol",tableName:"ol_vector_features",postReadFiltering:true,initialize:function(B){OpenLayers.Protocol.prototype.initialize.apply(this,[B])},destroy:function(){OpenLayers.Protocol.prototype.destroy.apply(this)},supported:function(){return false},evaluateFilter:function(B,C){return C&&this.postReadFiltering?C.evaluate(B):true},CLASS_NAME:"OpenLayers.Protocol.SQL"});OpenLayers.Protocol.WFS=function(C){C=OpenLayers.Util.applyDefaults(C,OpenLayers.Protocol.WFS.DEFAULTS);var B=OpenLayers.Protocol.WFS["v"+C.version.replace(/\./g,"_")];if(!B){throw"Unsupported WFS version: "+C.version}return new B(C)};OpenLayers.Protocol.WFS.fromWMSLayer=function(E,D){var B,F;var H=E.params.LAYERS;var G=(H instanceof Array?H[0]:H).split(":");if(G.length>1){F=G[0]}B=G.pop();var C={url:E.url,featureType:B,featurePrefix:F,srsName:E.projection&&E.projection.getCode()||E.map&&E.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(D,C))};OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"};OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{canvas:null,features:null,geometryMap:null,initialize:function(B){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.root=document.createElement("canvas");this.container.appendChild(this.root);this.canvas=this.root.getContext("2d");this.features={};this.geometryMap={}},eraseGeometry:function(B){this.eraseFeatures(this.features[this.geometryMap[B.id]][0])},supported:function(){var B=document.createElement("canvas");return !!B.getContext},setExtent:function(B){this.extent=B.clone();this.resolution=null;this.redraw()},setSize:function(B){this.size=B.clone();this.root.style.width=B.w+"px";this.root.style.height=B.h+"px";this.root.width=B.w;this.root.height=B.h;this.resolution=null},drawFeature:function(B,C){if(C==null){C=B.style}C=OpenLayers.Util.extend({fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1},C);this.features[B.id]=[B,C];if(B.geometry){this.geometryMap[B.geometry.id]=B.id}this.redraw()},drawGeometry:function(E,D){var C=E.CLASS_NAME;if((C=="OpenLayers.Geometry.Collection")||(C=="OpenLayers.Geometry.MultiPoint")||(C=="OpenLayers.Geometry.MultiLineString")||(C=="OpenLayers.Geometry.MultiPolygon")){for(var B=0;B<E.components.length;B++){this.drawGeometry(E.components[B],D)}return }switch(E.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(E,D);break;case"OpenLayers.Geometry.LineString":this.drawLineString(E,D);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(E,D);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(E,D);break;default:break}},drawExternalGraphic:function(J,B){var F=new Image();F.src=B.externalGraphic;if(B.graphicTitle){F.title=B.graphicTitle}var D=B.graphicWidth||B.graphicHeight;var I=B.graphicHeight||B.graphicWidth;D=D?D:B.pointRadius*2;I=I?I:B.pointRadius*2;var H=(B.graphicXOffset!=undefined)?B.graphicXOffset:-(0.5*D);var E=(B.graphicYOffset!=undefined)?B.graphicYOffset:-(0.5*I);var G=B.graphicOpacity||B.fillOpacity;var C={img:F,x:(J[0]+H),y:(J[1]+E),width:D,height:I,canvas:this.canvas};F.onload=OpenLayers.Function.bind(function(){this.canvas.drawImage(this.img,this.x,this.y,this.width,this.height)},C)},setCanvasStyle:function(C,B){if(C=="fill"){this.canvas.globalAlpha=B.fillOpacity;this.canvas.fillStyle=B.fillColor}else{if(C=="stroke"){this.canvas.globalAlpha=B.strokeOpacity;this.canvas.strokeStyle=B.strokeColor;this.canvas.lineWidth=B.strokeWidth}else{this.canvas.globalAlpha=0;this.canvas.lineWidth=1}}},drawPoint:function(D,B){if(B.graphic!==false){var C=this.getLocalXY(D);if(B.externalGraphic){this.drawExternalGraphic(C,B)}else{if(B.fill!==false){this.setCanvasStyle("fill",B);this.canvas.beginPath();this.canvas.arc(C[0],C[1],6,0,Math.PI*2,true);this.canvas.fill()}if(B.stroke!==false){this.setCanvasStyle("stroke",B);this.canvas.beginPath();this.canvas.arc(C[0],C[1],6,0,Math.PI*2,true);this.canvas.stroke();this.setCanvasStyle("reset")}}}},drawLineString:function(E,C){if(C.stroke!==false){this.setCanvasStyle("stroke",C);this.canvas.beginPath();var F=this.getLocalXY(E.components[0]);this.canvas.moveTo(F[0],F[1]);for(var B=1;B<E.components.length;B++){var D=this.getLocalXY(E.components[B]);this.canvas.lineTo(D[0],D[1])}this.canvas.stroke()}this.setCanvasStyle("reset")},drawLinearRing:function(F,D){if(D.fill!==false){this.setCanvasStyle("fill",D);this.canvas.beginPath();var G=this.getLocalXY(F.components[0]);this.canvas.moveTo(G[0],G[1]);for(var C=1;C<F.components.length-1;C++){var E=this.getLocalXY(F.components[C]);this.canvas.lineTo(E[0],E[1])}this.canvas.fill()}if(D.stroke!==false){var B=this.canvas.lineWidth;this.setCanvasStyle("stroke",D);this.canvas.beginPath();var G=this.getLocalXY(F.components[0]);this.canvas.moveTo(G[0],G[1]);for(var C=1;C<F.components.length;C++){var E=this.getLocalXY(F.components[C]);this.canvas.lineTo(E[0],E[1])}this.canvas.stroke()}this.setCanvasStyle("reset")},drawPolygon:function(D,C){this.drawLinearRing(D.components[0],C);for(var B=1;B<D.components.length;B++){this.drawLinearRing(D.components[B],{fillOpacity:0,strokeWidth:0,strokeOpacity:0,strokeColor:"#000000",fillColor:"#000000"})}},drawText:function(C,E){E=OpenLayers.Util.extend({fontColor:"#000000",labelAlign:"cm"},E);var F=this.getLocalXY(C);this.setCanvasStyle("reset");this.canvas.fillStyle=E.fontColor;this.canvas.globalAlpha=1;var G=E.fontWeight+" "+E.fontSize+" "+E.fontFamily;if(this.canvas.fillText){var D=OpenLayers.Renderer.Canvas.LABEL_ALIGN[E.labelAlign[0]]||"middle";this.canvas.font=G;this.canvas.textAlign=D;this.canvas.fillText(E.label,F[0],F[1])}else{if(this.canvas.mozDrawText){this.canvas.mozTextStyle=G;var B=this.canvas.mozMeasureText(E.label);switch(E.labelAlign[0]){case"l":break;case"r":F[0]-=B;break;case"c":default:F[0]-=B/2}this.canvas.translate(F[0],F[1]);this.canvas.mozDrawText(E.label);this.canvas.translate(-1*F[0],-1*F[1])}}this.setCanvasStyle("reset")},getLocalXY:function(C){var D=this.getResolution();var E=this.extent;var B=(C.x/D+(-E.left/D));var F=((E.top/D)-C.y/D);return[B,F]},clear:function(){this.canvas.clearRect(0,0,this.root.width,this.root.height)},getFeatureIdFromEvent:function(B){var G=this.map.getLonLatFromPixel(B.xy);var C=this.getResolution();var F=new OpenLayers.Bounds(G.lon-C*5,G.lat-C*5,G.lon+C*5,G.lat+C*5);var D=F.toGeometry();for(var E in this.features){if(!this.features.hasOwnProperty(E)){continue}if(this.features[E][0].geometry.intersects(D)){return E}}return null},eraseFeatures:function(C){if(!(C instanceof Array)){C=[C]}for(var B=0;B<C.length;++B){delete this.features[C[B].id]}this.redraw()},redraw:function(){if(!this.locked){this.clear();var F=[];var C,D;for(var G in this.features){if(!this.features.hasOwnProperty(G)){continue}C=this.features[G][0];D=this.features[G][1];if(!C.geometry){continue}this.drawGeometry(C.geometry,D);if(D.label){F.push([C,D])}}var E;for(var B=0;len=F.length,B<len;++B){E=F[B];this.drawText(E[0].geometry.getCentroid(),E[1])}}},CLASS_NAME:"OpenLayers.Renderer.Canvas"});OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right"};OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(B){this.compare=B?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER;this.order=[];this.indices={};this.maxZIndex=0},insert:function(D){if(this.exists(D)){this.remove(D)}var G=D.id;this.determineZIndex(D);var E=-1;var F=this.order.length;var B;while(F-E>1){B=parseInt((E+F)/2);var C=this.compare(this,D,OpenLayers.Util.getElement(this.order[B]));if(C>0){E=B}else{F=B}}this.order.splice(F,0,G);this.indices[G]=this.getZIndex(D);return this.getNextElement(F)},remove:function(C){var E=C.id;var B=OpenLayers.Util.indexOf(this.order,E);if(B>=0){this.order.splice(B,1);delete this.indices[E];if(this.order.length>0){var D=this.order[this.order.length-1];this.maxZIndex=this.indices[D]}else{this.maxZIndex=0}}},clear:function(){this.order=[];this.indices={};this.maxZIndex=0},exists:function(B){return(this.indices[B.id]!=null)},getZIndex:function(B){return B._style.graphicZIndex},determineZIndex:function(B){var C=B._style.graphicZIndex;if(C==null){C=this.maxZIndex;B._style.graphicZIndex=C}else{if(C>this.maxZIndex){this.maxZIndex=C}}},getNextElement:function(C){var B=C+1;if(B<this.order.length){var D=OpenLayers.Util.getElement(this.order[B]);if(D==undefined){D=this.getNextElement(B)}return D}else{return null}},CLASS_NAME:"OpenLayers.ElementsIndexer"});OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(F,E,C){var B=F.getZIndex(E);var G=0;if(C){var D=F.getZIndex(C);G=B-D}return G},Z_ORDER_DRAWING_ORDER:function(D,C,B){var E=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(D,C,B);if(B&&E==0){E=1}return E},Z_ORDER_Y_ORDER:function(G,F,C){var H=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(G,F,C);if(C&&H==0){var D=F._geometry.getBounds().bottom;var E=C._geometry.getBounds().bottom;var B=E-D;H=(B==0)?1:B}return H}};OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",minimumSymbolizer:{strokeLinecap:"round",strokeOpacity:1,strokeDashstyle:"solid",fillOpacity:1,pointRadius:0},initialize:function(B,C){OpenLayers.Renderer.prototype.initialize.apply(this,arguments);this.rendererRoot=this.createRenderRoot();this.root=this.createRoot("_root");this.vectorRoot=this.createRoot("_vroot");this.textRoot=this.createRoot("_troot");this.root.appendChild(this.vectorRoot);this.root.appendChild(this.textRoot);this.rendererRoot.appendChild(this.root);this.container.appendChild(this.rendererRoot);if(C&&(C.zIndexing||C.yOrdering)){this.indexer=new OpenLayers.ElementsIndexer(C.yOrdering)}},destroy:function(){this.clear();this.rendererRoot=null;this.root=null;this.xmlns=null;OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){if(this.vectorRoot){while(this.vectorRoot.childNodes.length>0){this.vectorRoot.removeChild(this.vectorRoot.firstChild)}}if(this.textRoot){while(this.textRoot.childNodes.length>0){this.textRoot.removeChild(this.textRoot.firstChild)}}if(this.indexer){this.indexer.clear()}},getNodeType:function(C,B){},drawGeometry:function(H,E,G){var D=H.CLASS_NAME;var I=true;if((D=="OpenLayers.Geometry.Collection")||(D=="OpenLayers.Geometry.MultiPoint")||(D=="OpenLayers.Geometry.MultiLineString")||(D=="OpenLayers.Geometry.MultiPolygon")){for(var C=0,B=H.components.length;C<B;C++){I=this.drawGeometry(H.components[C],E,G)&&I}return I}I=false;if(E.display!="none"){if(E.backgroundGraphic){this.redrawBackgroundNode(H.id,H,E,G)}I=this.redrawNode(H.id,H,E,G)}if(I==false){var F=document.getElementById(H.id);if(F){if(F._style.backgroundGraphic){F.parentNode.removeChild(document.getElementById(H.id+this.BACKGROUND_ID_SUFFIX))}F.parentNode.removeChild(F)}}return I},redrawNode:function(H,G,C,F){var D=this.nodeFactory(H,this.getNodeType(G,C));D._featureId=F;D._geometry=G;D._geometryClass=G.CLASS_NAME;D._style=C;var B=this.drawGeometryNode(D,G,C);if(B===false){return false}D=B.node;if(this.indexer){var E=this.indexer.insert(D);if(E){this.vectorRoot.insertBefore(D,E)}else{this.vectorRoot.appendChild(D)}}else{if(D.parentNode!==this.vectorRoot){this.vectorRoot.appendChild(D)}}this.postDraw(D);return B.complete},redrawBackgroundNode:function(F,E,C,D){var B=OpenLayers.Util.extend({},C);B.externalGraphic=B.backgroundGraphic;B.graphicXOffset=B.backgroundXOffset;B.graphicYOffset=B.backgroundYOffset;B.graphicZIndex=B.backgroundGraphicZIndex;B.graphicWidth=B.backgroundWidth||B.graphicWidth;B.graphicHeight=B.backgroundHeight||B.graphicHeight;B.backgroundGraphic=null;B.backgroundXOffset=null;B.backgroundYOffset=null;B.backgroundGraphicZIndex=null;return this.redrawNode(F+this.BACKGROUND_ID_SUFFIX,E,B,null)},drawGeometryNode:function(D,F,C){C=C||D._style;OpenLayers.Util.applyDefaults(C,this.minimumSymbolizer);var B={isFilled:C.fill===undefined?true:C.fill,isStroked:C.stroke===undefined?!!C.strokeWidth:C.stroke};var E;switch(F.CLASS_NAME){case"OpenLayers.Geometry.Point":if(C.graphic===false){B.isFilled=false;B.isStroked=false}E=this.drawPoint(D,F);break;case"OpenLayers.Geometry.LineString":B.isFilled=false;E=this.drawLineString(D,F);break;case"OpenLayers.Geometry.LinearRing":E=this.drawLinearRing(D,F);break;case"OpenLayers.Geometry.Polygon":E=this.drawPolygon(D,F);break;case"OpenLayers.Geometry.Surface":E=this.drawSurface(D,F);break;case"OpenLayers.Geometry.Rectangle":E=this.drawRectangle(D,F);break;default:break}D._style=C;D._options=B;if(E!=false){return{node:this.setStyle(D,C,B,F),complete:E}}else{return false}},postDraw:function(B){},drawPoint:function(B,C){},drawLineString:function(B,C){},drawLinearRing:function(B,C){},drawPolygon:function(B,C){},drawRectangle:function(B,C){},drawCircle:function(B,C){},drawSurface:function(B,C){},removeText:function(C){var B=document.getElementById(C+this.LABEL_ID_SUFFIX);if(B){this.textRoot.removeChild(B)}},getFeatureIdFromEvent:function(B){var E=B.target;var C=E&&E.correspondingUseElement;var D=C?C:(E||B.srcElement);var F=D._featureId;return F},eraseGeometry:function(G){if((G.CLASS_NAME=="OpenLayers.Geometry.MultiPoint")||(G.CLASS_NAME=="OpenLayers.Geometry.MultiLineString")||(G.CLASS_NAME=="OpenLayers.Geometry.MultiPolygon")||(G.CLASS_NAME=="OpenLayers.Geometry.Collection")){for(var E=0,B=G.components.length;E<B;E++){this.eraseGeometry(G.components[E])}}else{var D=OpenLayers.Util.getElement(G.id);if(D&&D.parentNode){if(D.geometry){D.geometry.destroy();D.geometry=null}D.parentNode.removeChild(D);if(this.indexer){this.indexer.remove(D)}if(D._style.backgroundGraphic){var C=G.id+this.BACKGROUND_ID_SUFFIX;var F=OpenLayers.Util.getElement(C);if(F&&F.parentNode){F.parentNode.removeChild(F)}}}}},nodeFactory:function(D,B){var C=OpenLayers.Util.getElement(D);if(C){if(!this.nodeTypeCompare(C,B)){C.parentNode.removeChild(C);C=this.nodeFactory(D,B)}}else{C=this.createNode(B,D)}return C},nodeTypeCompare:function(C,B){},createNode:function(B,C){},moveRoot:function(C){var B=this.root;if(C.root.parentNode==this.rendererRoot){B=C.root}B.parentNode.removeChild(B);C.rendererRoot.appendChild(B)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(B){return(B!="circle")&&!!B},CLASS_NAME:"OpenLayers.Renderer.Elements"});OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]};OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:false,resolution:null,initialize:function(B){OpenLayers.Strategy.prototype.initialize.apply(this,[B])},activate:function(){var B=OpenLayers.Strategy.prototype.activate.call(this);if(B){this.layer.events.on({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this})}return B},deactivate:function(){var B=OpenLayers.Strategy.prototype.deactivate.call(this);if(B){this.clearCache();this.layer.events.un({beforefeaturesadded:this.cacheFeatures,moveend:this.cluster,scope:this})}return B},cacheFeatures:function(C){var B=true;if(!this.clustering){this.clearCache();this.features=C.features;this.cluster();B=false}return B},clearCache:function(){this.features=null},cluster:function(B){if((!B||B.zoomChanged)&&this.features){var D=this.layer.map.getResolution();if(D!=this.resolution||!this.clustersExist()){this.resolution=D;var I=[];var L,C,J;for(var F=0;F<this.features.length;++F){L=this.features[F];if(L.geometry){C=false;for(var E=0;E<I.length;++E){J=I[E];if(this.shouldCluster(J,L)){this.addToCluster(J,L);C=true;break}}if(!C){I.push(this.createCluster(this.features[F]))}}}this.layer.destroyFeatures();if(I.length>0){if(this.threshold>1){var H=I.slice();I=[];var K;for(var F=0,G=H.length;F<G;++F){K=H[F];if(K.attributes.count<this.threshold){Array.prototype.push.apply(I,K.cluster)}else{I.push(K)}}}this.clustering=true;this.layer.addFeatures(I);this.clustering=false}this.clusters=I}}},clustersExist:function(){var C=false;if(this.clusters&&this.clusters.length>0&&this.clusters.length==this.layer.features.length){C=true;for(var B=0;B<this.clusters.length;++B){if(this.clusters[B]!=this.layer.features[B]){C=false;break}}}return C},shouldCluster:function(B,C){var F=B.geometry.getBounds().getCenterLonLat();var D=C.geometry.getBounds().getCenterLonLat();var E=(Math.sqrt(Math.pow((F.lon-D.lon),2)+Math.pow((F.lat-D.lat),2))/this.resolution);return(E<=this.distance)},addToCluster:function(B,C){B.cluster.push(C);B.attributes.count+=1},createCluster:function(D){var C=D.geometry.getBounds().getCenterLonLat();var B=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(C.lon,C.lat),{count:1});B.cluster=[D];return B},CLASS_NAME:"OpenLayers.Strategy.Cluster"});OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:false,initialize:function(B){OpenLayers.Strategy.prototype.initialize.apply(this,[B])},destroy:function(){OpenLayers.Strategy.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Strategy.prototype.activate.apply(this,arguments)){this.layer.events.on({refresh:this.load,scope:this});if(this.layer.visibility==true||this.preload){this.load()}else{this.layer.events.on({visibilitychanged:this.load,scope:this})}return true}return false},deactivate:function(){var B=OpenLayers.Strategy.prototype.deactivate.call(this);if(B){this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this})}return B},load:function(B){this.layer.events.triggerEvent("loadstart");this.layer.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,scope:this},B));this.layer.events.un({visibilitychanged:this.load,scope:this})},merge:function(H){this.layer.destroyFeatures();var F=H.features;if(F&&F.length>0){var G=this.layer.projection;var E=this.layer.map.getProjectionObject();if(!E.equals(G)){var D;for(var C=0,B=F.length;C<B;++C){D=F[C].geometry;if(D){D.transform(G,E)}}}this.layer.addFeatures(F)}this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.Fixed"});OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:false,initialize:function(B){OpenLayers.Strategy.prototype.initialize.apply(this,[B])},activate:function(){var B=OpenLayers.Strategy.prototype.activate.call(this);if(B){this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this})}return B},deactivate:function(){var B=OpenLayers.Strategy.prototype.deactivate.call(this);if(B){this.clearCache();this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this})}return B},cacheFeatures:function(B){if(!this.paging){this.clearCache();this.features=B.features;this.pageNext(B)}},clearCache:function(){if(this.features){for(var B=0;B<this.features.length;++B){this.features[B].destroy()}}this.features=null;this.num=null},pageCount:function(){var B=this.features?this.features.length:0;return Math.ceil(B/this.length)},pageNum:function(){return this.num},pageLength:function(B){if(B&&B>0){this.length=B}return this.length},pageNext:function(B){var C=false;if(this.features){if(this.num===null){this.num=-1}var D=(this.num+1)*this.length;C=this.page(D,B)}return C},pagePrevious:function(){var B=false;if(this.features){if(this.num===null){this.num=this.pageCount()}var C=(this.num-1)*this.length;B=this.page(C)}return B},page:function(F,D){var E=false;if(this.features){if(F>=0&&F<this.features.length){var B=Math.floor(F/this.length);if(B!=this.num){this.paging=true;var C=this.features.slice(F,F+this.length);this.layer.removeFeatures(this.layer.features);this.num=B;if(D&&D.features){D.features=C}else{this.layer.addFeatures(C)}this.paging=false;E=true}}}return E},CLASS_NAME:"OpenLayers.Strategy.Paging"});OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{auto:false,timer:null,initialize:function(B){OpenLayers.Strategy.prototype.initialize.apply(this,[B])},activate:function(){var B=OpenLayers.Strategy.prototype.activate.call(this);if(B){if(this.auto){if(typeof this.auto==="number"){this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),this.auto*1000)}else{this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})}}}return B},deactivate:function(){var B=OpenLayers.Strategy.prototype.deactivate.call(this);if(B){if(this.auto){if(typeof this.auto==="number"){window.clearInterval(this.timer)}else{this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})}}}return B},triggerSave:function(C){var B=C.feature;if(B.state===OpenLayers.State.INSERT||B.state===OpenLayers.State.UPDATE||B.state===OpenLayers.State.DELETE){this.save([C.feature])}},save:function(E){if(!E){E=this.layer.features}var G=this.layer.projection;var D=this.layer.map.getProjectionObject();if(!D.equals(G)){var B=E.length;var F=new Array(B);var I,H;for(var C=0;C<B;++C){I=E[C];H=I.clone();H.fid=I.fid;H.state=I.state;H._original=I;H.geometry.transform(D,G);F[C]=H}E=F}this.layer.protocol.commit(E,{callback:this.onCommit,scope:this})},onCommit:function(E){if(E.success()){var C=E.reqFeatures;var B,J;var D=[];var I=E.insertIds||[];var F=0;for(var G=0,H=C.length;G<H;++G){J=C[G];J=J._original||J;B=J.state;if(B){if(B==OpenLayers.State.DELETE){D.push(J)}else{if(B==OpenLayers.State.INSERT){J.fid=I[F];++F}}J.state=null}}if(D.length>0){this.layer.destroyFeatures(D)}}},CLASS_NAME:"OpenLayers.Strategy.Save"});OpenLayers.Tween=OpenLayers.Class({INTERVAL:10,easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,interval:null,playing:false,initialize:function(B){this.easing=(B)?B:OpenLayers.Easing.Expo.easeOut},start:function(D,C,E,B){this.playing=true;this.begin=D;this.finish=C;this.duration=E;this.callbacks=B.callbacks;this.time=0;if(this.interval){window.clearInterval(this.interval);this.interval=null}if(this.callbacks&&this.callbacks.start){this.callbacks.start.call(this,this.begin)}this.interval=window.setInterval(OpenLayers.Function.bind(this.play,this),this.INTERVAL)},stop:function(){if(!this.playing){return }if(this.callbacks&&this.callbacks.done){this.callbacks.done.call(this,this.finish)}window.clearInterval(this.interval);this.interval=null;this.playing=false},play:function(){var E={};for(var C in this.begin){var B=this.begin[C];var D=this.finish[C];if(B==null||D==null||isNaN(B)||isNaN(D)){OpenLayers.Console.error("invalid value for Tween")}var F=D-B;E[C]=this.easing.apply(this,[this.time,B,F,this.duration])}this.time++;if(this.callbacks&&this.callbacks.eachStep){this.callbacks.eachStep.call(this,E)}if(this.time>this.duration){if(this.callbacks&&this.callbacks.done){this.callbacks.done.call(this,this.finish);this.playing=false}window.clearInterval(this.interval);this.interval=null}},CLASS_NAME:"OpenLayers.Tween"});OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"};OpenLayers.Easing.Linear={easeIn:function(C,B,E,D){return E*C/D+B},easeOut:function(C,B,E,D){return E*C/D+B},easeInOut:function(C,B,E,D){return E*C/D+B},CLASS_NAME:"OpenLayers.Easing.Linear"};OpenLayers.Easing.Expo={easeIn:function(C,B,E,D){return(C==0)?B:E*Math.pow(2,10*(C/D-1))+B},easeOut:function(C,B,E,D){return(C==D)?B+E:E*(-Math.pow(2,-10*C/D)+1)+B},easeInOut:function(C,B,E,D){if(C==0){return B}if(C==D){return B+E}if((C/=D/2)<1){return E/2*Math.pow(2,10*(C-1))+B}return E/2*(-Math.pow(2,-10*--C)+2)+B},CLASS_NAME:"OpenLayers.Easing.Expo"};OpenLayers.Easing.Quad={easeIn:function(C,B,E,D){return E*(C/=D)*C+B},easeOut:function(C,B,E,D){return -E*(C/=D)*(C-2)+B},easeInOut:function(C,B,E,D){if((C/=D/2)<1){return E/2*C*C+B}return -E/2*((--C)*(C-2)-1)+B},CLASS_NAME:"OpenLayers.Easing.Quad"};OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,arguments)},setMap:function(F){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var D=0,B=this.map.controls.length;D<B;D++){var E=this.map.controls[D];if((E!=this)&&(E.CLASS_NAME=="OpenLayers.Control.ArgParser")){if(E.displayProjection!=this.displayProjection){this.displayProjection=E.displayProjection}break}}if(D==this.map.controls.length){var C=OpenLayers.Util.getParameters();if(C.layers){this.layers=C.layers;this.map.events.register("addlayer",this,this.configureLayers);this.configureLayers()}if(C.lat&&C.lon){this.center=new OpenLayers.LonLat(parseFloat(C.lon),parseFloat(C.lat));if(C.zoom){this.zoom=parseInt(C.zoom)}this.map.events.register("changebaselayer",this,this.setCenter);this.setCenter()}}},setCenter:function(){if(this.map.baseLayer){this.map.events.unregister("changebaselayer",this,this.setCenter);if(this.displayProjection){this.center.transform(this.displayProjection,this.map.getProjectionObject())}this.map.setCenter(this.center,this.zoom)}},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var D=0,B=this.layers.length;D<B;D++){var C=this.map.layers[D];var E=this.layers.charAt(D);if(E=="B"){this.map.setBaseLayer(C)}else{if((E=="T")||(E=="F")){C.setVisibility(E=="T")}}}}},CLASS_NAME:"OpenLayers.Control.ArgParser"});OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this});this.updateAttribution();return this.div},updateAttribution:function(){var E=[];if(this.map&&this.map.layers){for(var D=0,B=this.map.layers.length;D<B;D++){var C=this.map.layers[D];if(C.attribution&&C.getVisibility()){E.push(C.attribution)}}this.div.innerHTML=E.join(this.separator)}},CLASS_NAME:"OpenLayers.Control.Attribution"});OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"});OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{activeColor:"darkblue",layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:true,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){OpenLayers.Event.stopObservingElement(this.div);OpenLayers.Event.stopObservingElement(this.minimizeDiv);OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.clearLayersArray("base");this.clearLayersArray("data");this.map.events.un({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this})},draw:function(){OpenLayers.Control.prototype.draw.apply(this);this.loadContents();if(!this.outsideViewport){this.minimizeControl()}this.redraw();return this.div},clearLayersArray:function(E){var F=this[E+"Layers"];if(F){for(var D=0,B=F.length;D<B;D++){var C=F[D];OpenLayers.Event.stopObservingElement(C.inputElem);OpenLayers.Event.stopObservingElement(C.labelSpan)}}this[E+"LayersDiv"].innerHTML="";this[E+"Layers"]=[]},checkRedraw:function(){var F=false;if(!this.layerStates.length||(this.map.layers.length!=this.layerStates.length)){F=true}else{for(var D=0,B=this.layerStates.length;D<B;D++){var E=this.layerStates[D];var C=this.map.layers[D];if((E.name!=C.name)||(E.inRange!=C.inRange)||(E.id!=C.id)||(E.visibility!=C.visibility)){F=true;break}}}return F},redraw:function(){if(!this.checkRedraw()){return this.div}this.clearLayersArray("base");this.clearLayersArray("data");var E=false;var M=false;var I=this.map.layers.length;this.layerStates=new Array(I);for(var G=0;G<I;G++){var H=this.map.layers[G];this.layerStates[G]={name:H.name,visibility:H.visibility,inRange:H.inRange,id:H.id}}var F=this.map.layers.slice();if(!this.ascending){F.reverse()}for(var G=0,I=F.length;G<I;G++){var H=F[G];var J=H.isBaseLayer;if(H.displayInLayerSwitcher){if(J){M=true}else{E=true}var L=(J)?(H==this.map.baseLayer):H.getVisibility();var K=document.createElement("input");K.id=this.id+"_input_"+H.name;K.name=(J)?"baseLayers":H.name;K.type=(J)?"radio":"checkbox";K.value=H.name;K.checked=L;K.defaultChecked=L;if(!J&&!H.inRange){K.disabled=true}var B={inputElem:K,layer:H,layerSwitcher:this};OpenLayers.Event.observe(K,"mouseup",OpenLayers.Function.bindAsEventListener(this.onInputClick,B));var C=document.createElement("span");if(!J&&!H.inRange){C.style.color="gray"}C.innerHTML=H.name;C.style.verticalAlign=(J)?"bottom":"baseline";OpenLayers.Event.observe(C,"click",OpenLayers.Function.bindAsEventListener(this.onInputClick,B));var O=document.createElement("br");var N=(J)?this.baseLayers:this.dataLayers;N.push({layer:H,inputElem:K,labelSpan:C});var D=(J)?this.baseLayersDiv:this.dataLayersDiv;D.appendChild(K);D.appendChild(C);D.appendChild(O)}}this.dataLbl.style.display=(E)?"":"none";this.baseLbl.style.display=(M)?"":"none";return this.div},onInputClick:function(B){if(!this.inputElem.disabled){if(this.inputElem.type=="radio"){this.inputElem.checked=true;this.layer.map.setBaseLayer(this.layer)}else{this.inputElem.checked=!this.inputElem.checked;this.layerSwitcher.updateMap()}}OpenLayers.Event.stop(B)},onLayerClick:function(B){this.updateMap()},updateMap:function(){for(var C=0,B=this.baseLayers.length;C<B;C++){var D=this.baseLayers[C];if(D.inputElem.checked){this.map.setBaseLayer(D.layer,false)}}for(var C=0,B=this.dataLayers.length;C<B;C++){var D=this.dataLayers[C];D.layer.setVisibility(D.inputElem.checked)}},maximizeControl:function(B){this.div.style.width="20em";this.div.style.height="";this.showControls(false);if(B!=null){OpenLayers.Event.stop(B)}},minimizeControl:function(B){this.div.style.width="0px";this.div.style.height="0px";this.showControls(true);if(B!=null){OpenLayers.Event.stop(B)}},showControls:function(B){this.maximizeDiv.style.display=B?"":"none";this.minimizeDiv.style.display=B?"none":"";this.layersDiv.style.display=B?"none":""},loadContents:function(){this.div.style.position="absolute";this.div.style.top="25px";this.div.style.right="0px";this.div.style.left="";this.div.style.fontFamily="sans-serif";this.div.style.fontWeight="bold";this.div.style.marginTop="3px";this.div.style.marginLeft="3px";this.div.style.marginBottom="3px";this.div.style.fontSize="smaller";this.div.style.color="white";this.div.style.backgroundColor="transparent";OpenLayers.Event.observe(this.div,"mouseup",OpenLayers.Function.bindAsEventListener(this.mouseUp,this));OpenLayers.Event.observe(this.div,"click",this.ignoreEvent);OpenLayers.Event.observe(this.div,"mousedown",OpenLayers.Function.bindAsEventListener(this.mouseDown,this));OpenLayers.Event.observe(this.div,"dblclick",this.ignoreEvent);this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";this.layersDiv.style.paddingTop="5px";this.layersDiv.style.paddingLeft="10px";this.layersDiv.style.paddingBottom="5px";this.layersDiv.style.paddingRight="75px";this.layersDiv.style.backgroundColor=this.activeColor;this.layersDiv.style.width="100%";this.layersDiv.style.height="100%";this.baseLbl=document.createElement("div");this.baseLbl.innerHTML=OpenLayers.i18n("baseLayer");this.baseLbl.style.marginTop="3px";this.baseLbl.style.marginLeft="3px";this.baseLbl.style.marginBottom="3px";this.baseLayersDiv=document.createElement("div");this.baseLayersDiv.style.paddingLeft="10px";this.dataLbl=document.createElement("div");this.dataLbl.innerHTML=OpenLayers.i18n("overlays");this.dataLbl.style.marginTop="3px";this.dataLbl.style.marginLeft="3px";this.dataLbl.style.marginBottom="3px";this.dataLayersDiv=document.createElement("div");this.dataLayersDiv.style.paddingLeft="10px";if(this.ascending){this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv);this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv)}else{this.layersDiv.appendChild(this.dataLbl);this.layersDiv.appendChild(this.dataLayersDiv);this.layersDiv.appendChild(this.baseLbl);this.layersDiv.appendChild(this.baseLayersDiv)}this.div.appendChild(this.layersDiv);OpenLayers.Rico.Corner.round(this.div,{corners:"tl bl",bgColor:"transparent",color:this.activeColor,blend:false});OpenLayers.Rico.Corner.changeOpacity(this.layersDiv,0.75);var D=OpenLayers.Util.getImagesLocation();var C=new OpenLayers.Size(18,18);var B=D+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,C,B,"absolute");this.maximizeDiv.style.top="5px";this.maximizeDiv.style.right="0px";this.maximizeDiv.style.left="";this.maximizeDiv.style.display="none";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));this.div.appendChild(this.maximizeDiv);var B=D+"layer-switcher-minimize.png";var C=new OpenLayers.Size(18,18);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,C,B,"absolute");this.minimizeDiv.style.top="5px";this.minimizeDiv.style.right="0px";this.minimizeDiv.style.left="";this.minimizeDiv.style.display="none";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));this.div.appendChild(this.minimizeDiv)},ignoreEvent:function(B){OpenLayers.Event.stop(B)},mouseDown:function(B){this.isMouseDown=true;this.ignoreEvent(B)},mouseUp:function(B){if(this.isMouseDown){this.isMouseDown=false;this.ignoreEvent(B)}},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"});OpenLayers.Control.MouseDefaults=OpenLayers.Class(OpenLayers.Control,{performedDrag:false,wheelObserver:null,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.handler){this.handler.destroy()}this.handler=null;this.map.events.un({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this});OpenLayers.Event.stopObserving(window,"DOMMouseScroll",this.wheelObserver);OpenLayers.Event.stopObserving(window,"mousewheel",this.wheelObserver);OpenLayers.Event.stopObserving(document,"mousewheel",this.wheelObserver);this.wheelObserver=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.map.events.on({click:this.defaultClick,dblclick:this.defaultDblClick,mousedown:this.defaultMouseDown,mouseup:this.defaultMouseUp,mousemove:this.defaultMouseMove,mouseout:this.defaultMouseOut,scope:this});this.registerWheelEvents()},registerWheelEvents:function(){this.wheelObserver=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this);OpenLayers.Event.observe(window,"DOMMouseScroll",this.wheelObserver);OpenLayers.Event.observe(window,"mousewheel",this.wheelObserver);OpenLayers.Event.observe(document,"mousewheel",this.wheelObserver)},defaultClick:function(C){if(!OpenLayers.Event.isLeftClick(C)){return }var B=!this.performedDrag;this.performedDrag=false;return B},defaultDblClick:function(C){var B=this.map.getLonLatFromViewPortPx(C.xy);this.map.setCenter(B,this.map.zoom+1);OpenLayers.Event.stop(C);return false},defaultMouseDown:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.mouseDragStart=B.xy.clone();this.performedDrag=false;if(B.shiftKey){this.map.div.style.cursor="crosshair";this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red");this.zoomBox.style.backgroundColor="white";this.zoomBox.style.filter="alpha(opacity=50)";this.zoomBox.style.opacity="0.50";this.zoomBox.style.fontSize="1px";this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox)}document.onselectstart=function(){return false};OpenLayers.Event.stop(B)},defaultMouseMove:function(F){this.mousePosition=F.xy.clone();if(this.mouseDragStart!=null){if(this.zoomBox){var E=Math.abs(this.mouseDragStart.x-F.xy.x);var C=Math.abs(this.mouseDragStart.y-F.xy.y);this.zoomBox.style.width=Math.max(1,E)+"px";this.zoomBox.style.height=Math.max(1,C)+"px";if(F.xy.x<this.mouseDragStart.x){this.zoomBox.style.left=F.xy.x+"px"}if(F.xy.y<this.mouseDragStart.y){this.zoomBox.style.top=F.xy.y+"px"}}else{var E=this.mouseDragStart.x-F.xy.x;var C=this.mouseDragStart.y-F.xy.y;var G=this.map.getSize();var B=new OpenLayers.Pixel(G.w/2+E,G.h/2+C);var D=this.map.getLonLatFromViewPortPx(B);this.map.setCenter(D,null,true);this.mouseDragStart=F.xy.clone();this.map.div.style.cursor="move"}this.performedDrag=true}},defaultMouseUp:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }if(this.zoomBox){this.zoomBoxEnd(B)}else{if(this.performedDrag){this.map.setCenter(this.map.center)}}document.onselectstart=null;this.mouseDragStart=null;this.map.div.style.cursor=""},defaultMouseOut:function(B){if(this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(B,this.map.div)){if(this.zoomBox){this.removeZoomBox()}this.mouseDragStart=null}},defaultWheelUp:function(B){if(this.map.getZoom()<=this.map.getNumZoomLevels()){this.map.setCenter(this.map.getLonLatFromPixel(B.xy),this.map.getZoom()+1)}},defaultWheelDown:function(B){if(this.map.getZoom()>0){this.map.setCenter(this.map.getLonLatFromPixel(B.xy),this.map.getZoom()-1)}},zoomBoxEnd:function(C){if(this.mouseDragStart!=null){if(Math.abs(this.mouseDragStart.x-C.xy.x)>5||Math.abs(this.mouseDragStart.y-C.xy.y)>5){var I=this.map.getLonLatFromViewPortPx(this.mouseDragStart);var B=this.map.getLonLatFromViewPortPx(C.xy);var H=Math.max(I.lat,B.lat);var D=Math.min(I.lat,B.lat);var G=Math.min(I.lon,B.lon);var E=Math.max(I.lon,B.lon);var F=new OpenLayers.Bounds(G,D,E,H);this.map.zoomToExtent(F)}else{var B=this.map.getLonLatFromViewPortPx(C.xy);this.map.setCenter(new OpenLayers.LonLat((B.lon),(B.lat)),this.map.getZoom()+1)}this.removeZoomBox()}},removeZoomBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null},onWheelEvent:function(D){var C=false;var B=OpenLayers.Event.element(D);while(B!=null){if(this.map&&B==this.map.div){C=true;break}B=B.parentNode}if(C){var E=0;if(!D){D=window.event}if(D.wheelDelta){E=D.wheelDelta/120;if(window.opera&&window.opera.version()<9.2){E=-E}}else{if(D.detail){E=-D.detail/3}}if(E){D.xy=this.mousePosition;if(E<0){this.defaultWheelDown(D)}else{this.defaultWheelUp(D)}}OpenLayers.Event.stop(D)}},CLASS_NAME:"OpenLayers.Control.MouseDefaults"});OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,lastXy:null,displayProjection:null,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.map){this.map.events.unregister("mousemove",this,this.redraw)}OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.left="";this.div.top="";this.element=this.div}this.redraw();return this.div},redraw:function(B){var D;if(B==null){D=new OpenLayers.LonLat(0,0)}else{if(this.lastXy==null||Math.abs(B.xy.x-this.lastXy.x)>this.granularity||Math.abs(B.xy.y-this.lastXy.y)>this.granularity){this.lastXy=B.xy;return }D=this.map.getLonLatFromPixel(B.xy);if(!D){return }if(this.displayProjection){D.transform(this.map.getProjectionObject(),this.displayProjection)}this.lastXy=B.xy}var C=this.formatOutput(D);if(C!=this.element.innerHTML){this.element.innerHTML=C}},formatOutput:function(C){var D=parseInt(this.numDigits);var B=this.prefix+C.lon.toFixed(D)+this.separator+C.lat.toFixed(D)+this.suffix;return B},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments);this.map.events.register("mousemove",this,this.redraw)},CLASS_NAME:"OpenLayers.Control.MousePosition"});OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,direction:null,type:OpenLayers.Control.TYPE_BUTTON,initialize:function(C,B){this.direction=C;this.CLASS_NAME+=this.direction;OpenLayers.Control.prototype.initialize.apply(this,[B])},trigger:function(){switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,this.slideFactor);break;case OpenLayers.Control.Pan.WEST:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(this.slideFactor,0);break}},CLASS_NAME:"OpenLayers.Control.Pan"});OpenLayers.Control.Pan.NORTH="North";OpenLayers.Control.Pan.SOUTH="South";OpenLayers.Control.Pan.EAST="East";OpenLayers.Control.Pan.WEST="West";OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(B){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y);OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);this.removeButtons();this.buttons=null;this.position=null},draw:function(C){OpenLayers.Control.prototype.draw.apply(this,arguments);C=this.position;this.buttons=[];var D=new OpenLayers.Size(18,18);var B=new OpenLayers.Pixel(C.x+D.w/2,C.y);this._addButton("panup","north-mini.png",B,D);C.y=B.y+D.h;this._addButton("panleft","west-mini.png",C,D);this._addButton("panright","east-mini.png",C.add(D.w,0),D);this._addButton("pandown","south-mini.png",B.add(0,D.h*2),D);this._addButton("zoomin","zoom-plus-mini.png",B.add(0,D.h*3+5),D);this._addButton("zoomworld","zoom-world-mini.png",B.add(0,D.h*4+5),D);this._addButton("zoomout","zoom-minus-mini.png",B.add(0,D.h*5+5),D);return this.div},_addButton:function(B,E,J,H){var G=OpenLayers.Util.getImagesLocation()+E;var C=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+B,J,H,G,"absolute");this.div.appendChild(C);OpenLayers.Event.observe(C,"mousedown",OpenLayers.Function.bindAsEventListener(this.buttonDown,C));OpenLayers.Event.observe(C,"dblclick",OpenLayers.Function.bindAsEventListener(this.doubleClick,C));OpenLayers.Event.observe(C,"click",OpenLayers.Function.bindAsEventListener(this.doubleClick,C));C.action=B;C.map=this.map;if(!this.slideRatio){var D=this.slideFactor;var F=function(){return D}}else{var I=this.slideRatio;var F=function(K){return this.map.getSize()[K]*I}}C.getSlideFactor=F;this.buttons.push(C);return C},_removeButton:function(B){OpenLayers.Event.stopObservingElement(B);B.map=null;this.div.removeChild(B);OpenLayers.Util.removeItem(this.buttons,B)},removeButtons:function(){for(var B=this.buttons.length-1;B>=0;--B){this._removeButton(this.buttons[B])}},doubleClick:function(B){OpenLayers.Event.stop(B);return false},buttonDown:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }switch(this.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent();break}OpenLayers.Event.stop(B)},CLASS_NAME:"OpenLayers.Control.PanZoom"});OpenLayers.Control.PanZoom.X=4;OpenLayers.Control.PanZoom.Y=4;OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,defaultControl:null,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.controls=[]},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var B=this.controls.length-1;B>=0;B--){if(this.controls[B].events){this.controls[B].events.un({activate:this.redraw,deactivate:this.redraw,scope:this})}OpenLayers.Event.stopObservingElement(this.controls[B].panel_div);this.controls[B].panel_div=null}},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var C=0,B=this.controls.length;C<B;C++){if(this.controls[C]==this.defaultControl){this.controls[C].activate()}}this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var C=0,B=this.controls.length;C<B;C++){this.controls[C].deactivate()}return true}else{return false}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);for(var C=0,B=this.controls.length;C<B;C++){this.map.addControl(this.controls[C]);this.controls[C].deactivate();this.controls[C].events.on({activate:this.redraw,deactivate:this.redraw,scope:this})}this.activate();return this.div},redraw:function(){this.div.innerHTML="";if(this.active){for(var D=0,B=this.controls.length;D<B;D++){var C=this.controls[D].panel_div;if(this.controls[D].active){C.className=this.controls[D].displayClass+"ItemActive"}else{C.className=this.controls[D].displayClass+"ItemInactive"}this.div.appendChild(C)}}},activateControl:function(D){if(!this.active){return false}if(D.type==OpenLayers.Control.TYPE_BUTTON){D.trigger();this.redraw();return }if(D.type==OpenLayers.Control.TYPE_TOGGLE){if(D.active){D.deactivate()}else{D.activate()}this.redraw();return }for(var C=0,B=this.controls.length;C<B;C++){if(this.controls[C]!=D){if(this.controls[C].type!=OpenLayers.Control.TYPE_TOGGLE){this.controls[C].deactivate()}}}D.activate()},addControls:function(C){if(!(C instanceof Array)){C=[C]}this.controls=this.controls.concat(C);for(var E=0,B=C.length;E<B;E++){var D=document.createElement("div");var F=document.createTextNode(" ");C[E].panel_div=D;if(C[E].title!=""){C[E].panel_div.title=C[E].title}OpenLayers.Event.observe(C[E].panel_div,"click",OpenLayers.Function.bind(this.onClick,this,C[E]));OpenLayers.Event.observe(C[E].panel_div,"mousedown",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop))}if(this.map){for(var E=0,B=C.length;E<B;E++){this.map.addControl(C[E]);C[E].deactivate();C[E].events.on({activate:this.redraw,deactivate:this.redraw,scope:this})}this.redraw()}},onClick:function(C,B){OpenLayers.Event.stop(B?B:window.event);this.activateControl(C)},getControlsBy:function(D,B){var E=(typeof B.test=="function");var C=OpenLayers.Array.filter(this.controls,function(F){return F[D]==B||(E&&B.test(F[D]))});return C},getControlsByName:function(B){return this.getControlsBy("name",B)},getControlsByClass:function(B){return this.getControlsBy("CLASS_NAME",B)},CLASS_NAME:"OpenLayers.Control.Panel"});OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,initialize:function(C,B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.element=OpenLayers.Util.getElement(C)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.element=document.createElement("div");this.div.appendChild(this.element)}this.map.events.register("moveend",this,this.updateScale);this.updateScale();return this.div},updateScale:function(){var B=this.map.getScale();if(!B){return }if(B>=9500&&B<=950000){B=Math.round(B/1000)+"K"}else{if(B>=950000){B=Math.round(B/1000000)+"M"}else{B=Math.round(B)}}this.element.innerHTML=OpenLayers.i18n("scale",{scaleDenom:B})},CLASS_NAME:"OpenLayers.Control.Scale"});OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,[B])},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.eTop){this.div.style.display="block";this.div.style.position="absolute";this.eTop=document.createElement("div");this.eTop.className=this.displayClass+"Top";var B=this.topInUnits.length;this.div.appendChild(this.eTop);if((this.topOutUnits=="")||(this.topInUnits=="")){this.eTop.style.visibility="hidden"}else{this.eTop.style.visibility="visible"}this.eBottom=document.createElement("div");this.eBottom.className=this.displayClass+"Bottom";this.div.appendChild(this.eBottom);if((this.bottomOutUnits=="")||(this.bottomInUnits=="")){this.eBottom.style.visibility="hidden"}else{this.eBottom.style.visibility="visible"}}this.map.events.register("moveend",this,this.update);this.update();return this.div},getBarLen:function(C){var E=parseInt(Math.log(C)/Math.log(10));var B=Math.pow(10,E);var D=parseInt(C/B);var F;if(D>5){F=5}else{if(D>2){F=2}else{F=1}}return F*B},update:function(){var I=this.map.getResolution();if(!I){return }var M=this.map.getUnits();var D=OpenLayers.INCHES_PER_UNIT;var J=this.maxWidth*I*D[M];var B;var E;if(J>100000){B=this.topOutUnits;E=this.bottomOutUnits}else{B=this.topInUnits;E=this.bottomInUnits}var G=J/D[B];var K=J/D[E];var H=this.getBarLen(G);var F=this.getBarLen(K);G=H/D[M]*D[B];K=F/D[M]*D[E];var C=G/I;var L=K/I;if(this.eBottom.style.visibility=="visible"){this.eBottom.style.width=Math.round(L)+"px";this.eBottom.innerHTML=F+" "+E}if(this.eTop.style.visibility=="visible"){this.eTop.style.width=Math.round(C)+"px";this.eTop.innerHTML=H+" "+B}},CLASS_NAME:"OpenLayers.Control.ScaleLine"});OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"});OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"});OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){if(this.map){this.map.zoomToMaxExtent()}},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"});OpenLayers.Event={observers:false,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(B){return B.target||B.srcElement},isLeftClick:function(B){return(((B.which)&&(B.which==1))||((B.button)&&(B.button==1)))},isRightClick:function(B){return(((B.which)&&(B.which==3))||((B.button)&&(B.button==2)))},stop:function(C,B){if(!B){if(C.preventDefault){C.preventDefault()}else{C.returnValue=false}}if(C.stopPropagation){C.stopPropagation()}else{C.cancelBubble=true}},findElement:function(D,C){var B=OpenLayers.Event.element(D);while(B.parentNode&&(!B.tagName||(B.tagName.toUpperCase()!=C.toUpperCase()))){B=B.parentNode}return B},observe:function(C,E,D,B){var F=OpenLayers.Util.getElement(C);B=B||false;if(E=="keypress"&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||F.attachEvent)){E="keydown"}if(!this.observers){this.observers={}}if(!F._eventCacheID){var G="eventCacheID_";if(F.id){G=F.id+"_"+G}F._eventCacheID=OpenLayers.Util.createUniqueID(G)}var H=F._eventCacheID;if(!this.observers[H]){this.observers[H]=[]}this.observers[H].push({element:F,name:E,observer:D,useCapture:B});if(F.addEventListener){F.addEventListener(E,D,B)}else{if(F.attachEvent){F.attachEvent("on"+E,D)}}},stopObservingElement:function(B){var C=OpenLayers.Util.getElement(B);var D=C._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[D])},_removeElementObservers:function(F){if(F){for(var C=F.length-1;C>=0;C--){var D=F[C];var B=new Array(D.element,D.name,D.observer,D.useCapture);var E=OpenLayers.Event.stopObserving.apply(this,B)}}},stopObserving:function(I,B,H,C){C=C||false;var G=OpenLayers.Util.getElement(I);var E=G._eventCacheID;if(B=="keypress"){if(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||G.detachEvent){B="keydown"}}var K=false;var D=OpenLayers.Event.observers[E];if(D){var F=0;while(!K&&F<D.length){var J=D[F];if((J.name==B)&&(J.observer==H)&&(J.useCapture==C)){D.splice(F,1);if(D.length==0){delete OpenLayers.Event.observers[E]}K=true;break}F++}}if(K){if(G.removeEventListener){G.removeEventListener(B,H,C)}else{if(G&&G.detachEvent){G.detachEvent("on"+B,H)}}}return K},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var B in OpenLayers.Event.observers){var C=OpenLayers.Event.observers[B];OpenLayers.Event._removeElementObservers.apply(this,[C])}OpenLayers.Event.observers=false}},CLASS_NAME:"OpenLayers.Event"};OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false);if(window.Event){OpenLayers.Util.applyDefaults(window.Event,OpenLayers.Event)}else{var Event=OpenLayers.Event}OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur"],listeners:null,object:null,element:null,eventTypes:null,eventHandler:null,fallThrough:null,includeXY:false,clearMouseListener:null,initialize:function(D,F,H,G,C){OpenLayers.Util.extend(this,C);this.object=D;this.fallThrough=G;this.listeners={};this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this);this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this);this.eventTypes=[];if(H!=null){for(var E=0,B=H.length;E<B;E++){this.addEventType(H[E])}}if(F!=null){this.attachToElement(F)}},destroy:function(){if(this.element){OpenLayers.Event.stopObservingElement(this.element);if(this.element.hasScrollEvent){OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)}}this.element=null;this.listeners=null;this.object=null;this.eventTypes=null;this.fallThrough=null;this.eventHandler=null},addEventType:function(B){if(!this.listeners[B]){this.eventTypes.push(B);this.listeners[B]=[]}},attachToElement:function(E){if(this.element){OpenLayers.Event.stopObservingElement(this.element)}this.element=E;for(var D=0,B=this.BROWSER_EVENTS.length;D<B;D++){var C=this.BROWSER_EVENTS[D];this.addEventType(C);OpenLayers.Event.observe(E,C,this.eventHandler)}OpenLayers.Event.observe(E,"dragstart",OpenLayers.Event.stop)},on:function(B){for(var C in B){if(C!="scope"){this.register(C,B.scope,B[C])}}},register:function(C,E,D){if((D!=null)&&(OpenLayers.Util.indexOf(this.eventTypes,C)!=-1)){if(E==null){E=this.object}var B=this.listeners[C];B.push({obj:E,func:D})}},registerPriority:function(C,E,D){if(D!=null){if(E==null){E=this.object}var B=this.listeners[C];if(B!=null){B.unshift({obj:E,func:D})}}},un:function(B){for(var C in B){if(C!="scope"){this.unregister(C,B.scope,B[C])}}},unregister:function(E,G,F){if(G==null){G=this.object}var D=this.listeners[E];if(D!=null){for(var C=0,B=D.length;C<B;C++){if(D[C].obj==G&&D[C].func==F){D.splice(C,1);break}}}},remove:function(B){if(this.listeners[B]!=null){this.listeners[B]=[]}},triggerEvent:function(F,C){var E=this.listeners[F];if(!E||E.length==0){return }if(C==null){C={}}C.object=this.object;C.element=this.element;if(!C.type){C.type=F}var E=E.slice(),G;for(var D=0,B=E.length;D<B;D++){var H=E[D];G=H.func.apply(H.obj,[C]);if((G!=undefined)&&(G==false)){break}}if(!this.fallThrough){OpenLayers.Event.stop(C,true)}return G},handleBrowserEvent:function(B){if(this.includeXY){B.xy=this.getMousePosition(B)}this.triggerEvent(B.type,B)},clearMouseCache:function(){this.element.scrolls=null;this.element.lefttop=null;this.element.offsets=null},getMousePosition:function(B){if(!this.includeXY){this.clearMouseCache()}else{if(!this.element.hasScrollEvent){OpenLayers.Event.observe(window,"scroll",this.clearMouseListener);this.element.hasScrollEvent=true}}if(!this.element.scrolls){this.element.scrolls=[(document.documentElement.scrollLeft||document.body.scrollLeft),(document.documentElement.scrollTop||document.body.scrollTop)]}if(!this.element.lefttop){this.element.lefttop=[(document.documentElement.clientLeft||0),(document.documentElement.clientTop||0)]}if(!this.element.offsets){this.element.offsets=OpenLayers.Util.pagePosition(this.element);this.element.offsets[0]+=this.element.scrolls[0];this.element.offsets[1]+=this.element.scrolls[1]}return new OpenLayers.Pixel((B.clientX+this.element.scrolls[0])-this.element.offsets[0]-this.element.lefttop[0],(B.clientY+this.element.scrolls[1])-this.element.offsets[1]-this.element.lefttop[1])},CLASS_NAME:"OpenLayers.Events"});OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:false,initialize:function(B){OpenLayers.Util.extend(this,B);this.options=B},destroy:function(){},read:function(B){OpenLayers.Console.userError(OpenLayers.i18n("readNotImplemented"))},write:function(B){OpenLayers.Console.userError(OpenLayers.i18n("writeNotImplemented"))},CLASS_NAME:"OpenLayers.Format"});OpenLayers.Lang.en={unhandledRequest:"Unhandled request return ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Base Layer",sameProjection:"The overview map only works when it is in the same projection as the main map",readNotImplemented:"Read not implemented.",writeNotImplemented:"Write not implemented.",noFID:"Can't update a feature for which there is no FID.",errorLoadingGML:"Error in loading GML file ${url}",browserNotSupported:"Your browser does not support vector rendering. Currently supported renderers are:\n${renderers}",componentShouldBe:"addFeatures : component should be an ${geomType}",getFeatureError:"getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.",minZoomLevelError:"The minZoomLevel property is only intended for use with the FixedZoomLevels-descendent layers. That this wfs layer checks for minZoomLevel is a relic of thepast. We cannot, however, remove it without possibly breaking OL based applications that may depend on it. Therefore we are deprecating it -- the minZoomLevel check below will be removed at 3.0. Please instead use min/max resolution setting as described here: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"WFS Transaction: SUCCESS ${response}",commitFailed:"WFS Transaction: FAILED ${response}",googleWarning:"The Google Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the Google Maps library script was either not included, or does not contain the correct API key for your site.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>click here</a>",getLayerWarning:"The ${layerType} Layer was unable to load correctly.<br><br>To get rid of this message, select a new BaseLayer in the layer switcher in the upper-right corner.<br><br>Most likely, this is because the ${layerLib} library script was not correctly included.<br><br>Developers: For help getting this working correctly, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>click here</a>",scale:"Scale = 1 : ${scaleDenom}",layerAlreadyAdded:"You tried to add the layer: ${layerName} to the map, but it has already been added",reprojectDeprecated:"You are using the 'reproject' option on the ${layerName} layer. This option is deprecated: its use was designed to support displaying data over commercial basemaps, but that functionality should now be achieved by using Spherical Mercator support. More information is available from http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"This method has been deprecated and will be removed in 3.0. Please use ${newMethod} instead.",boundsAddError:"You must pass both x and y values to the add function.",lonlatAddError:"You must pass both lon and lat values to the add function.",pixelAddError:"You must pass both x and y values to the add function.",unsupportedGeometryType:"Unsupported geometry type: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition failed: element with id ${elemId} may be misplaced.",end:"",filterEvaluateNotImplemented:"evaluate is not implemented for this filter type."};OpenLayers.Lang.es={unhandledRequest:"Respuesta a petición no gestionada ${statusText}",permalink:"Enlace permanente",overlays:"Capas superpuestas",baseLayer:"Capa Base",sameProjection:"El mini mapa sólo funciona si está en la misma proyección que el mapa principal",readNotImplemented:"Lectura no implementada.",writeNotImplemented:"Escritura no implementada.",noFID:"No se puede actualizar un elemento para el que no existe FID.",errorLoadingGML:"Error cargando el fichero GML ${url}",browserNotSupported:"Su navegador no soporta renderización vectorial. Los renderizadores soportados actualmente son:\n${renderers}",componentShouldBe:"addFeatures : el componente debe ser del tipo ${geomType}",getFeatureError:"getFeatureFromEvent llamado en una capa sin renderizador. Esto normalmente quiere decir que se ha destruido una capa, pero no el manejador asociado a ella.",minZoomLevelError:"La propiedad minZoomLevel debe sólo utilizarse con las capas que tienen FixedZoomLevels. El hecho de que una capa wfs compruebe minZoomLevel is una reliquia del pasado. Sin embargo, no podemos eliminarla sin discontinuar probablemente las aplicaciones OL que puedan depender de ello. Así pues estamos haciéndolo obsoleto --la comprobación minZoomLevel se eliminará en la versión 3.0. Utilice el ajuste de resolution min/max en su lugar, tal como se describe aquí: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transacción WFS: ÉXITO ${response}",commitFailed:"Transacción WFS: FALLÓ ${response}",googleWarning:"La capa Google no pudo ser cargada correctamente.<br><br>Para evitar este mensaje, seleccione una nueva Capa Base en el selector de capas en la esquina superior derecha.<br><br>Probablemente, esto se debe a que el script de la biblioteca de Google Maps no fue correctamente incluido en su página, o no contiene la clave del API correcta para su sitio.<br><br>Desarrolladores: Para ayudar a hacer funcionar esto correctamente, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>haga clic aquí</a>",getLayerWarning:"La capa ${layerType} no pudo ser cargada correctamente.<br><br>Para evitar este mensaje, seleccione una nueva Capa Base en el selector de capas en la esquina superior derecha.<br><br>Probablemente, esto se debe a que el script de la biblioteca ${layerLib} no fue correctamente incluido en su página.<br><br>Desarrolladores: Para ayudar a hacer funcionar esto correctamente, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>haga clic aquí</a>",scale:"Escala = 1 : ${scaleDenom}",layerAlreadyAdded:"Intentó añadir la capa: ${layerName} al mapa, pero ya había sido añadida previamente",reprojectDeprecated:"Está usando la opción 'reproject' en la capa ${layerName}. Esta opción está obsoleta: su uso fue diseñado para soportar la visualización de datos sobre mapas base comerciales, pero esa funcionalidad debería conseguirse ahora mediante el soporte de la proyección Spherical Mercator. Más información disponible en http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Este método está obsoleto y se eliminará en la versión 3.0. Por favor utilice el método ${newMethod} en su lugar.",boundsAddError:"Debe proporcionar los valores x e y a la función add.",lonlatAddError:"Debe proporcionar los valores lon y lat a la función add.",pixelAddError:"Debe proporcionar los valores x e y a la función add.",unsupportedGeometryType:"Tipo de geometría no soportada: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition falló: el elemento con id ${elemId} puede haberse colocado de manera errónea.",filterEvaluateNotImplemented:"evaluate no está implementado para este tipo de filtro.",end:""};OpenLayers.Lang.fr={unhandledRequest:"Requête non gérée, retournant ${statusText}",permalink:"Permalien",overlays:"Calques",baseLayer:"Calque de base",sameProjection:"La carte de situation ne fonctionne que lorsque sa projection est la même que celle de la carte principale",readNotImplemented:"Lecture non implémentée.",writeNotImplemented:"Ecriture non implémentée.",noFID:"Impossible de mettre à jour un objet sans identifiant (fid).",errorLoadingGML:"Erreur au chargement du fichier GML ${url}",browserNotSupported:"Votre navigateur ne supporte pas le rendu vectoriel. Les renderers actuellement supportés sont : \n${renderers}",componentShouldBe:"addFeatures : le composant devrait être de type ${geomType}",getFeatureError:"getFeatureFromEvent a été appelé sur un calque sans renderer. Cela signifie généralement que vous avez détruit cette couche, mais que vous avez conservé un handler qui lui était associé.",minZoomLevelError:"La propriété minZoomLevel doit seulement être utilisée pour des couches FixedZoomLevels-descendent. Le fait que cette couche WFS vérifie la présence de minZoomLevel est une relique du passé. Nous ne pouvons toutefois la supprimer sans casser des applications qui pourraient en dépendre. C'est pourquoi nous la déprécions -- la vérification du minZoomLevel sera supprimée en version 3.0. A la place, merci d'utiliser les paramètres de résolutions min/max tel que décrit sur : http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transaction WFS : SUCCES ${response}",commitFailed:"Transaction WFS : ECHEC ${response}",googleWarning:"La couche Google n'a pas été en mesure de se charger correctement.<br><br>Pour supprimer ce message, choisissez une nouvelle BaseLayer dans le sélecteur de couche en haut à droite.<br><br>Cela est possiblement causé par la non-inclusion de la librairie Google Maps, ou alors parce que la clé de l'API ne correspond pas à votre site.<br><br>Développeurs : pour savoir comment corriger ceci, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>cliquez ici</a>",getLayerWarning:"La couche ${layerType} n'est pas en mesure de se charger correctement.<br><br>Pour supprimer ce message, choisissez une nouvelle BaseLayer dans le sélecteur de couche en haut à droite.<br><br>Cela est possiblement causé par la non-inclusion de la librairie ${layerLib}.<br><br>Développeurs : pour savoir comment corriger ceci, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>cliquez ici</a>",scale:"Echelle ~ 1 : ${scaleDenom}",layerAlreadyAdded:"Vous avez essayé d'ajouter à la carte le calque : ${layerName}, mais il est déjà présent",reprojectDeprecated:"Vous utilisez l'option 'reproject' sur la couche ${layerName}. Cette option est dépréciée : Son usage permettait d'afficher des données au dessus de couches raster commerciales.Cette fonctionalité est maintenant supportée en utilisant le support de la projection Mercator Sphérique. Plus d'information est disponible sur http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Cette méthode est dépréciée, et sera supprimée à la version 3.0. Merci d'utiliser ${newMethod} à la place.",boundsAddError:"Vous devez passer les deux valeurs x et y à la fonction add.",lonlatAddError:"Vous devez passer les deux valeurs lon et lat à la fonction add.",pixelAddError:"Vous devez passer les deux valeurs x et y à la fonction add.",unsupportedGeometryType:"Type de géométrie non supporté : ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition a échoué: l'élément d'id ${elemId} pourrait être mal positionné.",end:""};OpenLayers.Lang.it={unhandledRequest:"Codice di ritorno della richiesta ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Livello base",sameProjection:"La mini mappa funziona solamente se ha la stessa proiezione della mappa principale",readNotImplemented:"Lettura non implementata.",writeNotImplemented:"Scrittura non implementata.",noFID:"Impossibile aggiornare un elemento grafico che non abbia il FID.",errorLoadingGML:"Errore nel caricamento del file GML ${url}",browserNotSupported:"Il tuo browser non supporta il rendering vettoriale. I renderizzatore attualemnte supportati sono:\n${renderers}",componentShouldBe:"addFeatures : il componente dovrebbe essere di tipo ${geomType}",getFeatureError:"getFeatureFromEvent chiamata su di un livello senza renderizzatore. Ciò significa che il livello è stato cancellato, ma non i gestori associati ad esso.",minZoomLevelError:"La proprietà minZoomLevel è da utilizzare solamente con livelli che abbiano FixedZoomLevels. Il fatto che questo livello wfs controlli la proprietà minZoomLevel è un retaggio del passato. Non possiamo comunque rimuoverla senza rompere le vecchie applicazioni che dipendono su di essa.Quindi siamo costretti a deprecarla -- minZoomLevel e sarà rimossa dalla vesione 3.0. Si prega di utilizzare i settaggi di risoluzione min/max come descritto qui: http://trac.openlayers.org/wiki/SettingZoomLevels",commitSuccess:"Transazione WFS: SUCCESS ${response}",commitFailed:"Transazione WFS: FAILED ${response}",googleWarning:"Il livello Google non è riuscito a caricare correttamente.<br><br>Per evitare questo messaggio, seleziona un nuovo BaseLayer nel selettore di livelli nell'angolo in alto a destra.<br><br>Più precisamente, ciò accade perchè la libreria Google Maps non è stata inclusa nella pagina, oppure non contiene la corretta API key per il tuo sito.<br><br>Sviluppatori: Per aiuto su come farlo funzionare correttamente, <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>clicca qui</a>",getLayerWarning:"Il livello ${layerType} non è riuscito a caricare correttamente.<br><br>Per evitare questo messaggio, seleziona un nuovo BaseLayer nel selettore di livelli nell'angolo in alto a destra.<br><br>Più precisamente, ciò accade perchè la libreria ${layerLib} non è stata inclusa nella pagina.<br><br>Sviluppatori: Per aiuto su come farlo funzionare correttamente, <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>clicca qui</a>",scale:"Scala = 1 : ${scaleDenom}",layerAlreadyAdded:"Stai cercando di aggiungere il livello: ${layerName} alla mappa, ma tale livello è già stato aggiunto.",reprojectDeprecated:"Stai utilizzando l'opzione 'reproject' sul livello ${layerName}. Questa opzione è deprecata: il suo utilizzo è stato introdotto persupportare il disegno dei dati sopra mappe commerciali, ma tale funzionalità dovrebbe essere ottenuta tramite l'utilizzo della proiezione Spherical Mercator. Per maggiori informazioni consultare qui http://trac.openlayers.org/wiki/SphericalMercator.",methodDeprecated:"Questo metodo è stato deprecato e sarà rimosso dalla versione 3.0. Si prega di utilizzare il metodo ${newMethod} in alternativa.",boundsAddError:"Devi specificare i valori di x e y alla funzione add.",lonlatAddError:"Devi specificare i valori di lon e lat alla funzione add.",pixelAddError:"Devi specificare i valori di x e y alla funzione add.",unsupportedGeometryType:"Tipo di geometria non supportata: ${geomType}",pagePositionFailed:"OpenLayers.Util.pagePosition fallita: l'elemento con id ${elemId} è posizionato in modo errato.",end:""};OpenLayers.Popup.AnchoredBubble=OpenLayers.Class(OpenLayers.Popup.Anchored,{rounded:false,initialize:function(H,D,G,C,B,F,E){this.padding=new OpenLayers.Bounds(0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE,0,OpenLayers.Popup.AnchoredBubble.CORNER_SIZE);OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments)},draw:function(B){OpenLayers.Popup.Anchored.prototype.draw.apply(this,arguments);this.setContentHTML();this.setBackgroundColor();this.setOpacity();return this.div},updateRelativePosition:function(){this.setRicoCorners()},setSize:function(B){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.setRicoCorners()},setBackgroundColor:function(B){if(B!=undefined){this.backgroundColor=B}if(this.div!=null){if(this.contentDiv!=null){this.div.style.background="transparent";OpenLayers.Rico.Corner.changeColor(this.groupDiv,this.backgroundColor)}}},setOpacity:function(B){OpenLayers.Popup.Anchored.prototype.setOpacity.call(this,B);if(this.div!=null){if(this.groupDiv!=null){OpenLayers.Rico.Corner.changeOpacity(this.groupDiv,this.opacity)}}},setBorder:function(B){this.border=0},setRicoCorners:function(){var B=this.getCornersToRound(this.relativePosition);var C={corners:B,color:this.backgroundColor,bgColor:"transparent",blend:false};if(!this.rounded){OpenLayers.Rico.Corner.round(this.div,C);this.rounded=true}else{OpenLayers.Rico.Corner.reRound(this.groupDiv,C);this.setBackgroundColor();this.setOpacity()}},getCornersToRound:function(){var B=["tl","tr","bl","br"];var C=OpenLayers.Bounds.oppositeQuadrant(this.relativePosition);OpenLayers.Util.removeItem(B,C);return B.join(" ")},CLASS_NAME:"OpenLayers.Popup.AnchoredBubble"});OpenLayers.Popup.AnchoredBubble.CORNER_SIZE=5;OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:false,positionBlocks:null,blocks:null,fixedRelativePosition:false,initialize:function(H,D,G,C,B,F,E){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments);if(this.fixedRelativePosition){this.updateRelativePosition();this.calculateRelativePosition=function(I){return this.relativePosition}}this.contentDiv.style.position="absolute";this.contentDiv.style.zIndex=1;if(F){this.closeDiv.style.zIndex=1}this.groupDiv.style.position="absolute";this.groupDiv.style.top="0px";this.groupDiv.style.left="0px";this.groupDiv.style.height="100%";this.groupDiv.style.width="100%"},destroy:function(){this.imageSrc=null;this.imageSize=null;this.isAlphaImage=null;this.fixedRelativePosition=false;this.positionBlocks=null;for(var B=0;B<this.blocks.length;B++){var C=this.blocks[B];if(C.image){C.div.removeChild(C.image)}C.image=null;if(C.div){this.groupDiv.removeChild(C.div)}C.div=null}this.blocks=null;OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(B){},setBorder:function(){},setOpacity:function(B){},setSize:function(B){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments);this.updateBlocks()},updateRelativePosition:function(){this.padding=this.positionBlocks[this.relativePosition].padding;if(this.closeDiv){var B=this.getContentDivPadding();this.closeDiv.style.right=B.right+this.padding.right+"px";this.closeDiv.style.top=B.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(B){var C=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);C=C.offset(this.positionBlocks[this.relativePosition].offset);return C},createBlocks:function(){this.blocks=[];var G=null;for(var F in this.positionBlocks){G=F;break}var B=this.positionBlocks[G];for(var E=0;E<B.blocks.length;E++){var I={};this.blocks.push(I);var C=this.id+"_FrameDecorationDiv_"+E;I.div=OpenLayers.Util.createDiv(C,null,null,null,"absolute",null,"hidden",null);var D=this.id+"_FrameDecorationImg_"+E;var H=(this.isAlphaImage)?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage;I.image=H(D,null,this.imageSize,this.imageSrc,"absolute",null,null,null);I.div.appendChild(I.image);this.groupDiv.appendChild(I.div)}},updateBlocks:function(){if(!this.blocks){this.createBlocks()}if(this.size&&this.relativePosition){var H=this.positionBlocks[this.relativePosition];for(var F=0;F<H.blocks.length;F++){var C=H.blocks[F];var E=this.blocks[F];var D=C.anchor.left;var I=C.anchor.bottom;var B=C.anchor.right;var K=C.anchor.top;var J=(isNaN(C.size.w))?this.size.w-(B+D):C.size.w;var G=(isNaN(C.size.h))?this.size.h-(I+K):C.size.h;E.div.style.width=(J<0?0:J)+"px";E.div.style.height=(G<0?0:G)+"px";E.div.style.left=(D!=null)?D+"px":"";E.div.style.bottom=(I!=null)?I+"px":"";E.div.style.right=(B!=null)?B+"px":"";E.div.style.top=(K!=null)?K+"px":"";E.image.style.left=C.position.x+"px";E.image.style.top=C.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px";this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"});OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,initialize:function(C,B){OpenLayers.Util.extend(this,B);this.projCode=C;if(window.Proj4js){this.proj=new Proj4js.Proj(C)}},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(B){if(B&&B.getCode){return this.getCode()==B.getCode()}else{return false}},destroy:function(){delete this.proj;delete this.projCode},CLASS_NAME:"OpenLayers.Projection"});OpenLayers.Projection.transforms={};OpenLayers.Projection.addTransform=function(D,C,B){if(!OpenLayers.Projection.transforms[D]){OpenLayers.Projection.transforms[D]={}}OpenLayers.Projection.transforms[D][C]=B};OpenLayers.Projection.transform=function(B,D,C){if(D.proj&&C.proj){B=Proj4js.transform(D.proj,C.proj,B)}else{if(D&&C&&OpenLayers.Projection.transforms[D.getCode()]&&OpenLayers.Projection.transforms[D.getCode()][C.getCode()]){OpenLayers.Projection.transforms[D.getCode()][C.getCode()](B)}}return B};OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,initialize:function(C){OpenLayers.Protocol.prototype.initialize.apply(this,[C]);if(!C.format){this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions))}if(!this.featureNS){var B=this.format.readNode;this.format.readNode=function(D,E){if(!this.featureNS&&D.prefix==this.featurePrefix){this.featureNS=D.namespaceURI;this.setNamespace("feature",this.featureNS)}return B.apply(this,arguments)}}},destroy:function(){if(this.options&&!this.options.format){this.format.destroy()}this.format=null;OpenLayers.Protocol.prototype.destroy.apply(this)},createCallback:function(D,B,C){return OpenLayers.Function.bind(function(){D.apply(this,[B,C])},this)},read:function(C){C=OpenLayers.Util.extend({},C);OpenLayers.Util.applyDefaults(C,this.options||{});var B=new OpenLayers.Protocol.Response({requestType:"read"});var D=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",C)]);B.priv=OpenLayers.Request.POST({url:C.url,callback:this.createCallback(this.handleRead,B,C),params:C.params,headers:C.headers,data:D});return B},handleRead:function(B,C){if(C.callback){var D=B.priv;if(D.status>=200&&D.status<300){B.features=this.parseFeatures(D);B.code=OpenLayers.Protocol.Response.SUCCESS}else{B.code=OpenLayers.Protocol.Response.FAILURE}C.callback.call(C.scope,B)}},parseFeatures:function(B){var C=B.responseXML;if(!C||!C.documentElement){C=B.responseText}if(!C||C.length<=0){return null}return this.format.read(C)},commit:function(D,C){C=OpenLayers.Util.extend({},C);OpenLayers.Util.applyDefaults(C,this.options);var B=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:D});B.priv=OpenLayers.Request.POST({url:C.url,data:this.format.write(D,C),callback:this.createCallback(this.handleCommit,B,C)});return B},handleCommit:function(B,C){if(C.callback){var D=B.priv;var E=D.responseXML;if(!E||!E.documentElement){E=D.responseText}var F=this.format.read(E)||{};B.insertIds=F.insertIds||[];B.code=(F.success)?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;C.callback.call(C.scope,B)}},filterDelete:function(F,D){D=OpenLayers.Util.extend({},D);OpenLayers.Util.applyDefaults(D,this.options);var C=new OpenLayers.Protocol.Response({requestType:"commit"});var B=this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});var E=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(D.featureNS?this.featurePrefix+":":"")+D.featureType}});if(D.featureNS){E.setAttribute("xmlns:"+this.featurePrefix,D.featureNS)}var H=this.format.writeNode("ogc:Filter",F);E.appendChild(H);B.appendChild(E);var G=OpenLayers.Format.XML.prototype.write.apply(this.format,[B]);return OpenLayers.Request.POST({url:this.url,callback:D.callback||function(){},data:G})},abort:function(B){if(B){B.priv.abort()}},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"});OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15000,translationParameters:null,symbolSize:{},isGecko:null,initialize:function(B){if(!this.supported()){return }OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.translationParameters={x:0,y:0};this.isGecko=(navigator.userAgent.toLowerCase().indexOf("gecko/")!=-1)},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments)},supported:function(){var B="http://www.w3.org/TR/SVG11/feature#";return(document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(B+"SVG","1.1")||document.implementation.hasFeature(B+"BasicStructure","1.1")))},inValidRange:function(B,F,C){var E=B+(C?0:this.translationParameters.x);var D=F+(C?0:this.translationParameters.y);return(E>=-this.MAX_PIXEL&&E<=this.MAX_PIXEL&&D>=-this.MAX_PIXEL&&D<=this.MAX_PIXEL)},setExtent:function(C,E){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var B=this.getResolution();var G=-C.left/B;var F=C.top/B;if(E){this.left=G;this.top=F;var D="0 0 "+this.size.w+" "+this.size.h;this.rendererRoot.setAttributeNS(null,"viewBox",D);this.translate(0,0);return true}else{var H=this.translate(G-this.left,F-this.top);if(!H){this.setExtent(C,true)}return H}},translate:function(B,D){if(!this.inValidRange(B,D,true)){return false}else{var C="";if(B||D){C="translate("+B+","+D+")"}this.root.setAttributeNS(null,"transform",C);this.translationParameters={x:B,y:D};return true}},setSize:function(B){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);this.rendererRoot.setAttributeNS(null,"width",this.size.w);this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(D,C){var B=null;switch(D.CLASS_NAME){case"OpenLayers.Geometry.Point":if(C.externalGraphic){B="image"}else{if(this.isComplexSymbol(C.graphicName)){B="use"}else{B="circle"}}break;case"OpenLayers.Geometry.Rectangle":B="rect";break;case"OpenLayers.Geometry.LineString":B="polyline";break;case"OpenLayers.Geometry.LinearRing":B="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":case"OpenLayers.Geometry.Surface":B="path";break;default:break}return B},setStyle:function(O,R,C){R=R||O._style;C=C||O._options;var J=parseFloat(O.getAttributeNS(null,"r"));var I=1;var E;if(O._geometryClass=="OpenLayers.Geometry.Point"&&J){O.style.visibility="";if(R.graphic===false){O.style.visibility="hidden"}else{if(R.externalGraphic){E=this.getPosition(O);if(R.graphicTitle){O.setAttributeNS(null,"title",R.graphicTitle)}if(R.graphicWidth&&R.graphicHeight){O.setAttributeNS(null,"preserveAspectRatio","none")}var N=R.graphicWidth||R.graphicHeight;var L=R.graphicHeight||R.graphicWidth;N=N?N:R.pointRadius*2;L=L?L:R.pointRadius*2;var S=(R.graphicXOffset!=undefined)?R.graphicXOffset:-(0.5*N);var F=(R.graphicYOffset!=undefined)?R.graphicYOffset:-(0.5*L);var B=R.graphicOpacity||R.fillOpacity;O.setAttributeNS(null,"x",(E.x+S).toFixed());O.setAttributeNS(null,"y",(E.y+F).toFixed());O.setAttributeNS(null,"width",N);O.setAttributeNS(null,"height",L);O.setAttributeNS(this.xlinkns,"href",R.externalGraphic);O.setAttributeNS(null,"style","opacity: "+B)}else{if(this.isComplexSymbol(R.graphicName)){var D=R.pointRadius*3;var K=D*2;var M=this.importSymbol(R.graphicName);var Q="#"+M;E=this.getPosition(O);I=this.symbolSize[M]/K;var G=O.parentNode;var H=O.nextSibling;if(G){G.removeChild(O)}O.setAttributeNS(this.xlinkns,"href",Q);O.setAttributeNS(null,"width",K);O.setAttributeNS(null,"height",K);O.setAttributeNS(null,"x",E.x-D);O.setAttributeNS(null,"y",E.y-D);if(H){G.insertBefore(O,H)}else{if(G){G.appendChild(O)}}}else{O.setAttributeNS(null,"r",R.pointRadius)}}}if(typeof R.rotation!="undefined"&&E){var P=OpenLayers.String.format("rotate(${0} ${1} ${2})",[R.rotation,E.x,E.y]);O.setAttributeNS(null,"transform",P)}}if(C.isFilled){O.setAttributeNS(null,"fill",R.fillColor);O.setAttributeNS(null,"fill-opacity",R.fillOpacity)}else{O.setAttributeNS(null,"fill","none")}if(C.isStroked){O.setAttributeNS(null,"stroke",R.strokeColor);O.setAttributeNS(null,"stroke-opacity",R.strokeOpacity);O.setAttributeNS(null,"stroke-width",R.strokeWidth*I);O.setAttributeNS(null,"stroke-linecap",R.strokeLinecap);O.setAttributeNS(null,"stroke-linejoin","round");O.setAttributeNS(null,"stroke-dasharray",this.dashStyle(R,I))}else{O.setAttributeNS(null,"stroke","none")}if(R.pointerEvents){O.setAttributeNS(null,"pointer-events",R.pointerEvents)}if(R.cursor!=null){O.setAttributeNS(null,"cursor",R.cursor)}return O},dashStyle:function(D,C){var B=D.strokeWidth*C;switch(D.strokeDashstyle){case"solid":return"none";case"dot":return[1,4*B].join();case"dash":return[4*B,4*B].join();case"dashdot":return[4*B,4*B,1,4*B].join();case"longdash":return[8*B,4*B].join();case"longdashdot":return[8*B,4*B,1,4*B].join();default:return D.strokeDashstyle.replace(/ /g,",")}},createNode:function(B,D){var C=document.createElementNS(this.xmlns,B);if(D){C.setAttributeNS(null,"id",D)}return C},nodeTypeCompare:function(C,B){return(B==C.nodeName)},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_svgRoot","svg")},createRoot:function(B){return this.nodeFactory(this.container.id+B,"g")},createDefs:function(){var B=this.nodeFactory(this.container.id+"_defs","defs");this.rendererRoot.appendChild(B);return B},drawPoint:function(B,C){return this.drawCircle(B,C,1)},drawCircle:function(E,F,C){var D=this.getResolution();var B=(F.x/D+this.left);var G=(this.top-F.y/D);if(this.inValidRange(B,G)){E.setAttributeNS(null,"cx",B);E.setAttributeNS(null,"cy",G);E.setAttributeNS(null,"r",C);return E}else{return false}},drawLineString:function(C,D){var B=this.getComponentsString(D.components);if(B.path){C.setAttributeNS(null,"points",B.path);return(B.complete?C:null)}else{return false}},drawLinearRing:function(C,D){var B=this.getComponentsString(D.components);if(B.path){C.setAttributeNS(null,"points",B.path);return(B.complete?C:null)}else{return false}},drawPolygon:function(C,H){var G="";var I=true;var B=true;var D,J;for(var E=0,F=H.components.length;E<F;E++){G+=" M";D=this.getComponentsString(H.components[E].components," ");J=D.path;if(J){G+=" "+J;B=D.complete&&B}else{I=false}}G+=" z";if(I){C.setAttributeNS(null,"d",G);C.setAttributeNS(null,"fill-rule","evenodd");return B?C:null}else{return false}},drawRectangle:function(D,E){var C=this.getResolution();var B=(E.x/C+this.left);var F=(this.top-E.y/C);if(this.inValidRange(B,F)){D.setAttributeNS(null,"x",B);D.setAttributeNS(null,"y",F);D.setAttributeNS(null,"width",E.width/C);D.setAttributeNS(null,"height",E.height/C);return D}else{return false}},drawSurface:function(F,H){var G=null;var C=true;for(var E=0,B=H.components.length;E<B;E++){if((E%3)==0&&(E/3)==0){var D=this.getShortString(H.components[E]);if(!D){C=false}G="M "+D}else{if((E%3)==1){var D=this.getShortString(H.components[E]);if(!D){C=false}G+=" C "+D}else{var D=this.getShortString(H.components[E]);if(!D){C=false}G+=" "+D}}}G+=" Z";if(C){F.setAttributeNS(null,"d",G);return F}else{return false}},drawText:function(D,B,J){var C=this.getResolution();var I=(J.x/C+this.left);var F=(J.y/C-this.top);var H=this.nodeFactory(D+this.LABEL_ID_SUFFIX,"text");var G=this.nodeFactory(D+this.LABEL_ID_SUFFIX+"_tspan","tspan");H.setAttributeNS(null,"x",I);H.setAttributeNS(null,"y",-F);H.setAttributeNS(null,"pointer-events","none");if(B.fontColor){H.setAttributeNS(null,"fill",B.fontColor)}if(B.fontFamily){H.setAttributeNS(null,"font-family",B.fontFamily)}if(B.fontSize){H.setAttributeNS(null,"font-size",B.fontSize)}if(B.fontWeight){H.setAttributeNS(null,"font-weight",B.fontWeight)}var E=B.labelAlign||"cm";H.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[E[0]]||"middle");if(this.isGecko){H.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[E[1]]||"central")}else{G.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[E[1]]||"-35%")}G.textContent=B.label;if(!H.parentNode){H.appendChild(G);this.textRoot.appendChild(H)}},getComponentsString:function(F,E){var H=[];var B=true;var G=F.length;var K=[];var I,J,C;for(var D=0;D<G;D++){J=F[D];H.push(J);I=this.getShortString(J);if(I){K.push(I)}else{if(D>0){if(this.getShortString(F[D-1])){K.push(this.clipLine(F[D],F[D-1]))}}if(D<G-1){if(this.getShortString(F[D+1])){K.push(this.clipLine(F[D],F[D+1]))}}B=false}}return{path:K.join(E||","),complete:B}},clipLine:function(F,I){if(I.equals(F)){return""}var G=this.getResolution();var C=this.MAX_PIXEL-this.translationParameters.x;var B=this.MAX_PIXEL-this.translationParameters.y;var E=I.x/G+this.left;var K=this.top-I.y/G;var D=F.x/G+this.left;var J=this.top-F.y/G;var H;if(D<-C||D>C){H=(J-K)/(D-E);D=D<0?-C:C;J=K+(D-E)*H}if(J<-B||J>B){H=(D-E)/(J-K);J=J<0?-B:B;D=E+(J-K)*H}return D+","+J},getShortString:function(C){var D=this.getResolution();var B=(C.x/D+this.left);var E=(this.top-C.y/D);if(this.inValidRange(B,E)){return B+","+E}else{return false}},getPosition:function(B){return({x:parseFloat(B.getAttributeNS(null,"cx")),y:parseFloat(B.getAttributeNS(null,"cy"))})},importSymbol:function(F){if(!this.defs){this.defs=this.createDefs()}var C=this.container.id+"-"+F;if(document.getElementById(C)!=null){return C}var E=OpenLayers.Renderer.symbol[F];if(!E){throw new Error(F+" is not a valid symbol name");return }var H=this.nodeFactory(C,"symbol");var D=this.nodeFactory(null,"polygon");H.appendChild(D);var M=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var K="";var J,I;for(var G=0;G<E.length;G=G+2){J=E[G];I=E[G+1];M.left=Math.min(M.left,J);M.bottom=Math.min(M.bottom,I);M.right=Math.max(M.right,J);M.top=Math.max(M.top,I);K+=" "+J+","+I}D.setAttributeNS(null,"points",K);var B=M.getWidth();var L=M.getHeight();var N=[M.left-B,M.bottom-L,B*3,L*3];H.setAttributeNS(null,"viewBox",N.join(" "));this.symbolSize[C]=Math.max(B,L)*3;this.defs.appendChild(H);return H.id},CLASS_NAME:"OpenLayers.Renderer.SVG"});OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"};OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"};OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(C){if(!this.supported()){return }if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);var F=document.createStyleSheet();var D=["shape","rect","oval","fill","stroke","imagedata","group","textbox"];for(var E=0,B=D.length;E<B;E++){F.addRule("olv\\:"+D[E],"behavior: url(#default#VML); position: absolute; display: inline-block;")}}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments);this.offset={x:0,y:0}},destroy:function(){OpenLayers.Renderer.Elements.prototype.destroy.apply(this,arguments)},supported:function(){return !!(document.namespaces)},setExtent:function(J,B){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var D=this.getResolution();var C=J.left/D;var G=J.top/D-this.size.h;if(B){this.offset={x:C,y:G};C=0;G=0}else{C=C-this.offset.x;G=G-this.offset.y}var L=C+" "+G;this.root.coordorigin=L;var I=[this.root,this.vectorRoot,this.textRoot];var H;for(var E=0,F=I.length;E<F;++E){H=I[E];var K=this.size.w+" "+this.size.h;H.coordsize=K}this.root.style.flip="y";return true},setSize:function(G){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);var E=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot];var D=this.size.w+"px";var H=this.size.h+"px";var C;for(var F=0,B=E.length;F<B;++F){C=E[F];C.style.width=D;C.style.height=H}},getNodeType:function(D,C){var B=null;switch(D.CLASS_NAME){case"OpenLayers.Geometry.Point":if(C.externalGraphic){B="olv:rect"}else{if(this.isComplexSymbol(C.graphicName)){B="olv:shape"}else{B="olv:oval"}}break;case"OpenLayers.Geometry.Rectangle":B="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":case"OpenLayers.Geometry.Surface":B="olv:shape";break;default:break}return B},setStyle:function(E,C,Q,L){C=C||E._style;Q=Q||E._options;var J=1;if(E._geometryClass=="OpenLayers.Geometry.Point"){if(C.externalGraphic){if(C.graphicTitle){E.title=C.graphicTitle}var D=C.graphicWidth||C.graphicHeight;var M=C.graphicHeight||C.graphicWidth;D=D?D:C.pointRadius*2;M=M?M:C.pointRadius*2;var G=this.getResolution();var I=(C.graphicXOffset!=undefined)?C.graphicXOffset:-(0.5*D);var F=(C.graphicYOffset!=undefined)?C.graphicYOffset:-(0.5*M);E.style.left=((L.x/G-this.offset.x)+I).toFixed();E.style.top=((L.y/G-this.offset.y)-(F+M)).toFixed();E.style.width=D+"px";E.style.height=M+"px";E.style.flip="y";C.fillColor="none";Q.isStroked=false}else{if(this.isComplexSymbol(C.graphicName)){var B=this.importSymbol(C.graphicName);E.path=B.path;E.coordorigin=B.left+","+B.bottom;var P=B.size;E.coordsize=P+","+P;this.drawCircle(E,L,C.pointRadius);E.style.flip="y"}else{this.drawCircle(E,L,C.pointRadius)}}}if(Q.isFilled){E.fillcolor=C.fillColor}else{E.filled="false"}var K=E.getElementsByTagName("fill");var O=(K.length==0)?null:K[0];if(!Q.isFilled){if(O){E.removeChild(O)}}else{if(!O){O=this.createNode("olv:fill",E.id+"_fill")}O.opacity=C.fillOpacity;if(E._geometryClass=="OpenLayers.Geometry.Point"&&C.externalGraphic){if(C.graphicOpacity){O.opacity=C.graphicOpacity}O.src=C.externalGraphic;O.type="frame";if(!(C.graphicWidth&&C.graphicHeight)){O.aspect="atmost"}}if(O.parentNode!=E){E.appendChild(O)}}if(typeof C.rotation!="undefined"){if(C.externalGraphic){this.graphicRotate(E,I,F);O.opacity=0}else{E.style.rotation=C.rotation}}if(Q.isStroked){E.strokecolor=C.strokeColor;E.strokeweight=C.strokeWidth+"px"}else{E.stroked=false}var H=E.getElementsByTagName("stroke");var N=(H.length==0)?null:H[0];if(!Q.isStroked){if(N){E.removeChild(N)}}else{if(!N){N=this.createNode("olv:stroke",E.id+"_stroke");E.appendChild(N)}N.opacity=C.strokeOpacity;N.endcap=!C.strokeLinecap||C.strokeLinecap=="butt"?"flat":C.strokeLinecap;N.dashstyle=this.dashStyle(C)}if(C.cursor!="inherit"&&C.cursor!=null){E.style.cursor=C.cursor}return E},graphicRotate:function(O,S,G){var R=R||O._style;var E=O._options;var B,K;if(!(R.graphicWidth&&R.graphicHeight)){var T=new Image();T.onreadystatechange=OpenLayers.Function.bind(function(){if(T.readyState=="complete"||T.readyState=="interactive"){B=T.width/T.height;K=Math.max(R.pointRadius*2,R.graphicWidth||0,R.graphicHeight||0);S=S*B;R.graphicWidth=K*B;R.graphicHeight=K;this.graphicRotate(O,S,G)}},this);T.src=R.externalGraphic;return }else{K=Math.max(R.graphicWidth,R.graphicHeight);B=R.graphicWidth/R.graphicHeight}var N=Math.round(R.graphicWidth||K*B);var L=Math.round(R.graphicHeight||K);O.style.width=N+"px";O.style.height=L+"px";var M=document.getElementById(O.id+"_image");if(!M){M=this.createNode("olv:imagedata",O.id+"_image");O.appendChild(M)}M.style.width=N+"px";M.style.height=L+"px";M.src=R.externalGraphic;M.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var P=R.rotation*Math.PI/180;var I=Math.sin(P);var F=Math.cos(P);var H="progid:DXImageTransform.Microsoft.Matrix(M11="+F+",M12="+(-I)+",M21="+I+",M22="+F+",SizingMethod='auto expand')\n";var C=R.graphicOpacity||R.fillOpacity;if(C&&C!=1){H+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+C+")\n"}O.style.filter=H;var Q=new OpenLayers.Geometry.Point(-S,-G);var D=new OpenLayers.Bounds(0,0,N,L).toGeometry();D.rotate(R.rotation,Q);var J=D.getBounds();O.style.left=Math.round(parseInt(O.style.left)+J.left)+"px";O.style.top=Math.round(parseInt(O.style.top)-J.bottom)+"px"},postDraw:function(B){var D=B._style.fillColor;var C=B._style.strokeColor;if(D=="none"&&B.fillcolor!=D){B.fillcolor=D}if(C=="none"&&B.strokecolor!=C){B.strokecolor=C}},setNodeDimension:function(C,F){var E=F.getBounds();if(E){var B=this.getResolution();var D=new OpenLayers.Bounds((E.left/B-this.offset.x).toFixed(),(E.bottom/B-this.offset.y).toFixed(),(E.right/B-this.offset.x).toFixed(),(E.top/B-this.offset.y).toFixed());C.style.left=D.left+"px";C.style.top=D.top+"px";C.style.width=D.getWidth()+"px";C.style.height=D.getHeight()+"px";C.coordorigin=D.left+" "+D.top;C.coordsize=D.getWidth()+" "+D.getHeight()}},dashStyle:function(B){var D=B.strokeDashstyle;switch(D){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return D;default:var C=D.split(/[ ,]/);if(C.length==2){if(1*C[0]>=2*C[1]){return"longdash"}return(C[0]==1||C[1]==1)?"dot":"dash"}else{if(C.length==4){return(1*C[0]>=2*C[1])?"longdashdot":"dashdot"}}return"solid"}},createNode:function(B,D){var C=document.createElement(B);if(D){C.id=D}C.unselectable="on";C.onselectstart=function(){return(false)};return C},nodeTypeCompare:function(D,C){var E=C;var B=E.indexOf(":");if(B!=-1){E=E.substr(B+1)}var F=D.nodeName;B=F.indexOf(":");if(B!=-1){F=F.substr(B+1)}return(E==F)},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(B){return this.nodeFactory(this.container.id+B,"olv:group")},drawPoint:function(B,C){return this.drawCircle(B,C,1)},drawCircle:function(E,F,B){if(!isNaN(F.x)&&!isNaN(F.y)){var C=this.getResolution();E.style.left=((F.x/C-this.offset.x).toFixed()-B)+"px";E.style.top=((F.y/C-this.offset.y).toFixed()-B)+"px";var D=B*2;E.style.width=D+"px";E.style.height=D+"px";return E}return false},drawLineString:function(B,C){return this.drawLine(B,C,false)},drawLinearRing:function(B,C){return this.drawLine(B,C,true)},drawLine:function(C,K,H){this.setNodeDimension(C,K);var D=this.getResolution();var B=K.components.length;var F=new Array(B);var I,L,J;for(var G=0;G<B;G++){I=K.components[G];L=(I.x/D-this.offset.x);J=(I.y/D-this.offset.y);F[G]=" "+L.toFixed()+","+J.toFixed()+" l "}var E=(H)?" x e":" e";C.path="m"+F.join("")+E;return C},drawPolygon:function(C,K){this.setNodeDimension(C,K);var D=this.getResolution();var M=[];var G,F,E,I,B,H,L,J;for(E=0,I=K.components.length;E<I;E++){G=K.components[E];M.push("m");for(F=0,B=G.components.length;F<B;F++){H=G.components[F];L=H.x/D-this.offset.x;J=H.y/D-this.offset.y;M.push(" "+L.toFixed()+","+J.toFixed());if(F==0){M.push(" l")}}M.push(" x ")}M.push("e");C.path=M.join("");return C},drawRectangle:function(C,D){var B=this.getResolution();C.style.left=(D.x/B-this.offset.x)+"px";C.style.top=(D.y/B-this.offset.y)+"px";C.style.width=D.width/B+"px";C.style.height=D.height/B+"px";return C},drawText:function(E,B,I){var H=this.nodeFactory(E+this.LABEL_ID_SUFFIX,"olv:rect");var G=this.nodeFactory(E+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox");var D=this.getResolution();H.style.left=(I.x/D-this.offset.x).toFixed()+"px";H.style.top=(I.y/D-this.offset.y).toFixed()+"px";H.style.flip="y";G.innerText=B.label;if(B.fillColor){G.style.color=B.fontColor}if(B.fontFamily){G.style.fontFamily=B.fontFamily}if(B.fontSize){G.style.fontSize=B.fontSize}if(B.fontWeight){G.style.fontWeight=B.fontWeight}G.style.whiteSpace="nowrap";G.inset="1px,0px,0px,0px";if(!H.parentNode){H.appendChild(G);this.textRoot.appendChild(H)}var F=B.labelAlign||"cm";var J=G.clientWidth*(OpenLayers.Renderer.VML.LABEL_SHIFT[F.substr(0,1)]);var C=G.clientHeight*(OpenLayers.Renderer.VML.LABEL_SHIFT[F.substr(1,1)]);H.style.left=parseInt(H.style.left)-J-1+"px";H.style.top=parseInt(H.style.top)+C+"px"},drawSurface:function(B,H){this.setNodeDimension(B,H);var C=this.getResolution();var J=[];var E,I,G;for(var D=0,F=H.components.length;D<F;D++){E=H.components[D];I=E.x/C-this.offset.x;G=E.y/C-this.offset.y;if((D%3)==0&&(D/3)==0){J.push("m")}else{if((D%3)==1){J.push(" c")}}J.push(" "+I+","+G)}J.push(" x e");B.path=J.join("");return B},moveRoot:function(C){var B=this.map.getLayer(C.container.id);if(B instanceof OpenLayers.Layer.Vector.RootContainer){B=this.map.getLayer(this.container.id)}B&&B.renderer.clear();OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments);B&&B.redraw()},importSymbol:function(E){var C=this.container.id+"-"+E;var B=this.symbolCache[C];if(B){return B}var D=OpenLayers.Renderer.symbol[E];if(!D){throw new Error(E+" is not a valid symbol name");return }var I=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0);var F=["m"];for(var G=0;G<D.length;G=G+2){x=D[G];y=D[G+1];I.left=Math.min(I.left,x);I.bottom=Math.min(I.bottom,y);I.right=Math.max(I.right,x);I.top=Math.max(I.top,y);F.push(x);F.push(y);if(G==0){F.push("l")}}F.push("x e");var J=F.join(" ");var H=(I.getWidth()-I.getHeight())/2;if(H>0){I.bottom=I.bottom-H;I.top=I.top+H}else{I.left=I.left-H;I.right=I.right+H}B={path:J,size:I.getWidth(),left:I.left,bottom:I.bottom};this.symbolCache[C]=B;return B},CLASS_NAME:"OpenLayers.Renderer.VML"});OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:0.5,r:1,t:0,m:0.5,b:1};OpenLayers.Tile=OpenLayers.Class({EVENT_TYPES:["loadstart","loadend","reload","unload"],events:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:false,initialize:function(E,B,F,C,D){this.layer=E;this.position=B.clone();this.bounds=F.clone();this.url=C;this.size=D.clone();this.id=OpenLayers.Util.createUniqueID("Tile_");this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES)},unload:function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("unload")}},destroy:function(){this.layer=null;this.bounds=null;this.size=null;this.position=null;this.events.destroy();this.events=null},clone:function(B){if(B==null){B=new OpenLayers.Tile(this.layer,this.position,this.bounds,this.url,this.size)}OpenLayers.Util.applyDefaults(B,this);return B},draw:function(){var B=this.layer.maxExtent;var C=(B&&this.bounds.intersectsBounds(B,false));this.shouldDraw=(C||this.layer.displayOutsideMaxExtent);this.clear();return this.shouldDraw},moveTo:function(C,B,D){if(D==null){D=true}this.bounds=C.clone();this.position=B.clone();if(D){this.draw()}},clear:function(){},getBoundsFromBaseLayer:function(B){var G=OpenLayers.i18n("reprojectDeprecated",{layerName:this.layer.name});OpenLayers.Console.warn(G);var E=this.layer.map.getLonLatFromLayerPx(B);var D=B.clone();D.x+=this.size.w;D.y+=this.size.h;var C=this.layer.map.getLonLatFromLayerPx(D);if(E.lon>C.lon){if(E.lon<0){E.lon=-180-(E.lon+180)}else{C.lon=180+C.lon+180}}var F=new OpenLayers.Bounds(E.lon,C.lat,C.lon,E.lat);return F},showTile:function(){if(this.shouldDraw){this.show()}},show:function(){},hide:function(){},CLASS_NAME:"OpenLayers.Tile"});OpenLayers.Control.MouseToolbar=OpenLayers.Class(OpenLayers.Control.MouseDefaults,{mode:null,buttons:null,direction:"vertical",buttonClicked:null,initialize:function(B,C){OpenLayers.Control.prototype.initialize.apply(this,arguments);this.position=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,OpenLayers.Control.MouseToolbar.Y);if(B){this.position=B}if(C){this.direction=C}this.measureDivs=[]},destroy:function(){for(var C in this.buttons){var B=this.buttons[C];B.map=null;B.events.destroy()}OpenLayers.Control.MouseDefaults.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);OpenLayers.Control.MouseDefaults.prototype.draw.apply(this,arguments);this.buttons={};var C=new OpenLayers.Size(28,28);var B=new OpenLayers.Pixel(OpenLayers.Control.MouseToolbar.X,0);this._addButton("zoombox","drag-rectangle-off.png","drag-rectangle-on.png",B,C,"Shift->Drag to zoom to area");B=B.add((this.direction=="vertical"?0:C.w),(this.direction=="vertical"?C.h:0));this._addButton("pan","panning-hand-off.png","panning-hand-on.png",B,C,"Drag the map to pan.");B=B.add((this.direction=="vertical"?0:C.w),(this.direction=="vertical"?C.h:0));this.switchModeTo("pan");return this.div},_addButton:function(B,F,E,J,H,I){var G=OpenLayers.Util.getImagesLocation()+F;var D=OpenLayers.Util.getImagesLocation()+E;var C=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MouseToolbar_"+B,J,H,G,"absolute");this.div.appendChild(C);C.imgLocation=G;C.activeImgLocation=D;C.events=new OpenLayers.Events(this,C,null,true);C.events.on({mousedown:this.buttonDown,mouseup:this.buttonUp,dblclick:OpenLayers.Event.stop,scope:this});C.action=B;C.title=I;C.alt=I;C.map=this.map;this.buttons[B]=C;return C},buttonDown:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.buttonClicked=B.element.action;OpenLayers.Event.stop(B)},buttonUp:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }if(this.buttonClicked!=null){if(this.buttonClicked==B.element.action){this.switchModeTo(B.element.action)}OpenLayers.Event.stop(B);this.buttonClicked=null}},defaultDblClick:function(C){this.switchModeTo("pan");this.performedDrag=false;var B=this.map.getLonLatFromViewPortPx(C.xy);this.map.setCenter(B,this.map.zoom+1);OpenLayers.Event.stop(C);return false},defaultMouseDown:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.mouseDragStart=B.xy.clone();this.performedDrag=false;this.startViaKeyboard=false;if(B.shiftKey&&this.mode!="zoombox"){this.switchModeTo("zoombox");this.startViaKeyboard=true}else{if(B.altKey&&this.mode!="measure"){this.switchModeTo("measure")}else{if(!this.mode){this.switchModeTo("pan")}}}switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red");this.zoomBox.style.backgroundColor="white";this.zoomBox.style.filter="alpha(opacity=50)";this.zoomBox.style.opacity="0.50";this.zoomBox.style.fontSize="1px";this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);this.performedDrag=true;break;case"measure":var D="";if(this.measureStart){var C=this.map.getLonLatFromViewPortPx(this.mouseDragStart);D=OpenLayers.Util.distVincenty(this.measureStart,C);D=Math.round(D*100)/100;D=D+"km";this.measureStartBox=this.measureBox}this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart);this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute");this.measureBox.style.width="4px";this.measureBox.style.height="4px";this.measureBox.style.fontSize="1px";this.measureBox.style.backgroundColor="red";this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBox);if(D){this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute");this.measureBoxDistance.innerHTML=D;this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBoxDistance);this.measureDivs.push(this.measureBoxDistance)}this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBox);this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move";break}document.onselectstart=function(){return false};OpenLayers.Event.stop(B)},switchModeTo:function(D){if(D!=this.mode){if(this.mode&&this.buttons[this.mode]){OpenLayers.Util.modifyAlphaImageDiv(this.buttons[this.mode],null,null,null,this.buttons[this.mode].imgLocation)}if(this.mode=="measure"&&D!="measure"){for(var C=0,B=this.measureDivs.length;C<B;C++){if(this.measureDivs[C]){this.map.layerContainerDiv.removeChild(this.measureDivs[C])}}this.measureDivs=[];this.measureStart=null}this.mode=D;if(this.buttons[D]){OpenLayers.Util.modifyAlphaImageDiv(this.buttons[D],null,null,null,this.buttons[D].activeImgLocation)}switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";break;default:this.map.div.style.cursor="";break}}},leaveMode:function(){this.switchModeTo("pan")},defaultMouseMove:function(F){if(this.mouseDragStart!=null){switch(this.mode){case"zoombox":var E=Math.abs(this.mouseDragStart.x-F.xy.x);var C=Math.abs(this.mouseDragStart.y-F.xy.y);this.zoomBox.style.width=Math.max(1,E)+"px";this.zoomBox.style.height=Math.max(1,C)+"px";if(F.xy.x<this.mouseDragStart.x){this.zoomBox.style.left=F.xy.x+"px"}if(F.xy.y<this.mouseDragStart.y){this.zoomBox.style.top=F.xy.y+"px"}break;default:var E=this.mouseDragStart.x-F.xy.x;var C=this.mouseDragStart.y-F.xy.y;var G=this.map.getSize();var B=new OpenLayers.Pixel(G.w/2+E,G.h/2+C);var D=this.map.getLonLatFromViewPortPx(B);this.map.setCenter(D,null,true);this.mouseDragStart=F.xy.clone()}this.performedDrag=true}},defaultMouseUp:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }switch(this.mode){case"zoombox":this.zoomBoxEnd(B);if(this.startViaKeyboard){this.leaveMode()}break;case"pan":if(this.performedDrag){this.map.setCenter(this.map.center)}}document.onselectstart=null;this.mouseDragStart=null;this.map.div.style.cursor="default"},defaultMouseOut:function(B){if(this.mouseDragStart!=null&&OpenLayers.Util.mouseLeft(B,this.map.div)){if(this.zoomBox){this.removeZoomBox();if(this.startViaKeyboard){this.leaveMode()}}this.mouseDragStart=null;this.map.div.style.cursor="default"}},defaultClick:function(B){if(this.performedDrag){this.performedDrag=false;return false}},CLASS_NAME:"OpenLayers.Control.MouseToolbar"});OpenLayers.Control.MouseToolbar.X=6;OpenLayers.Control.MouseToolbar.Y=300;OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,activateOnDraw:true,clearOnDeactivate:false,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:false,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.registry=OpenLayers.Util.extend({moveend:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution()}}},this.registry);this.clear();var C={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(C,this.previousOptions);this.previous=new OpenLayers.Control.Button(C);var D={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(D,this.nextOptions);this.next=new OpenLayers.Control.Button(D)},onPreviousChange:function(C,B){if(C&&!this.previous.active){this.previous.activate()}else{if(!C&&this.previous.active){this.previous.deactivate()}}},onNextChange:function(C,B){if(C&&!this.next.active){this.next.activate()}else{if(!C&&this.next.active){this.next.deactivate()}}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this);this.previous.destroy();this.next.destroy();this.deactivate();for(var B in this){this[B]=null}},setMap:function(B){this.map=B;this.next.setMap(B);this.previous.setMap(B)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);this.next.draw();this.previous.draw();if(this.activateOnDraw){this.activate()}},previousTrigger:function(){var C=this.previousStack.shift();var B=this.previousStack.shift();if(B!=undefined){this.nextStack.unshift(C);this.previousStack.unshift(B);this.restoring=true;this.restore(B);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}else{this.previousStack.unshift(C)}return B},nextTrigger:function(){var B=this.nextStack.shift();if(B!=undefined){this.previousStack.unshift(B);this.restoring=true;this.restore(B);this.restoring=false;this.onNextChange(this.nextStack[0],this.nextStack.length);this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}return B},clear:function(){this.previousStack=[];this.nextStack=[]},restore:function(C){var B=this.map.getZoomForResolution(C.resolution);this.map.setCenter(C.center,B)},setListeners:function(){this.listeners={};for(var B in this.registry){this.listeners[B]=OpenLayers.Function.bind(function(){if(!this.restoring){var C=this.registry[B].apply(this,arguments);this.previousStack.unshift(C);if(this.previousStack.length>1){this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)}if(this.previousStack.length>(this.limit+1)){this.previousStack.pop()}if(this.nextStack.length>0){this.nextStack=[];this.onNextChange(null,0)}}return true},this)}},activate:function(){var B=false;if(this.map){if(OpenLayers.Control.prototype.activate.apply(this)){if(this.listeners==null){this.setListeners()}for(var C in this.listeners){this.map.events.register(C,this,this.listeners[C])}B=true;if(this.previousStack.length==0){this.initStack()}}}return B},initStack:function(){if(this.map.getCenter()){this.listeners.moveend()}},deactivate:function(){var C=false;if(this.map){if(OpenLayers.Control.prototype.deactivate.apply(this)){for(var B in this.listeners){this.map.events.unregister(B,this,this.listeners[B])}if(this.clearOnDeactivate){this.clear()}C=true}}return C},CLASS_NAME:"OpenLayers.Control.NavigationHistory"});OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(B){OpenLayers.Control.Panel.prototype.initialize.apply(this,[B]);this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST)])},CLASS_NAME:"OpenLayers.Control.PanPanel"});OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoomBarDiv:null,divEvents:null,zoomWorldIcon:false,initialize:function(){OpenLayers.Control.PanZoom.prototype.initialize.apply(this,arguments)},destroy:function(){this._removeZoomBar();this.map.events.un({changebaselayer:this.redraw,scope:this});OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments)},setMap:function(B){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments);this.map.events.register("changebaselayer",this,this.redraw)},redraw:function(){if(this.div!=null){this.removeButtons();this._removeZoomBar()}this.draw()},draw:function(C){OpenLayers.Control.prototype.draw.apply(this,arguments);C=this.position.clone();this.buttons=[];var E=new OpenLayers.Size(18,18);var B=new OpenLayers.Pixel(C.x+E.w/2,C.y);var D=E.w;if(this.zoomWorldIcon){B=new OpenLayers.Pixel(C.x+E.w,C.y)}this._addButton("panup","north-mini.png",B,E);C.y=B.y+E.h;this._addButton("panleft","west-mini.png",C,E);if(this.zoomWorldIcon){this._addButton("zoomworld","zoom-world-mini.png",C.add(E.w,0),E);D*=2}this._addButton("panright","east-mini.png",C.add(D,0),E);this._addButton("pandown","south-mini.png",B.add(0,E.h*2),E);this._addButton("zoomin","zoom-plus-mini.png",B.add(0,E.h*3+5),E);B=this._addZoomBar(B.add(0,E.h*4+5));this._addButton("zoomout","zoom-minus-mini.png",B,E);return this.div},_addZoomBar:function(B){var F=OpenLayers.Util.getImagesLocation();var H=this.id+"_"+this.map.id;var C=this.map.getNumZoomLevels()-1-this.map.getZoom();var D=OpenLayers.Util.createAlphaImageDiv(H,B.add(-1,C*this.zoomStopHeight),new OpenLayers.Size(20,9),F+"slider.png","absolute");this.slider=D;this.sliderEvents=new OpenLayers.Events(this,D,null,true,{includeXY:true});this.sliderEvents.on({mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp,dblclick:this.doubleClick,click:this.doubleClick});var E=new OpenLayers.Size();E.h=this.zoomStopHeight*this.map.getNumZoomLevels();E.w=this.zoomStopWidth;var G=null;if(OpenLayers.Util.alphaHack()){var H=this.id+"_"+this.map.id;G=OpenLayers.Util.createAlphaImageDiv(H,B,new OpenLayers.Size(E.w,this.zoomStopHeight),F+"zoombar.png","absolute",null,"crop");G.style.height=E.h+"px"}else{G=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,B,E,F+"zoombar.png")}this.zoombarDiv=G;this.divEvents=new OpenLayers.Events(this,G,null,true,{includeXY:true});this.divEvents.on({mousedown:this.divClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick});this.div.appendChild(G);this.startTop=parseInt(G.style.top);this.div.appendChild(D);this.map.events.register("zoomend",this,this.moveZoomBar);B=B.add(0,this.zoomStopHeight*this.map.getNumZoomLevels());return B},_removeZoomBar:function(){this.sliderEvents.un({mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp,dblclick:this.doubleClick,click:this.doubleClick});this.sliderEvents.destroy();this.divEvents.un({mousedown:this.divClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick});this.divEvents.destroy();this.div.removeChild(this.zoombarDiv);this.zoombarDiv=null;this.div.removeChild(this.slider);this.slider=null;this.map.events.unregister("zoomend",this,this.moveZoomBar)},passEventToSlider:function(B){this.sliderEvents.handleBrowserEvent(B)},divClick:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }var F=B.xy.y;var E=OpenLayers.Util.pagePosition(B.object)[1];var D=(F-E)/this.zoomStopHeight;if(!this.map.fractionalZoom){D=Math.floor(D)}var C=(this.map.getNumZoomLevels()-1)-D;C=Math.min(Math.max(C,0),this.map.getNumZoomLevels()-1);this.map.zoomTo(C);OpenLayers.Event.stop(B)},zoomBarDown:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.map.events.on({mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this});this.mouseDragStart=B.xy.clone();this.zoomStart=B.xy.clone();this.div.style.cursor="move";this.zoombarDiv.offsets=null;OpenLayers.Event.stop(B)},zoomBarDrag:function(C){if(this.mouseDragStart!=null){var B=this.mouseDragStart.y-C.xy.y;var E=OpenLayers.Util.pagePosition(this.zoombarDiv);if((C.clientY-E[1])>0&&(C.clientY-E[1])<parseInt(this.zoombarDiv.style.height)-2){var D=parseInt(this.slider.style.top)-B;this.slider.style.top=D+"px";this.mouseDragStart=C.xy.clone()}OpenLayers.Event.stop(C)}},zoomBarUp:function(C){if(!OpenLayers.Event.isLeftClick(C)){return }if(this.zoomStart){this.div.style.cursor="";this.map.events.un({mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var B=this.zoomStart.y-C.xy.y;var D=this.map.zoom;if(this.map.fractionalZoom){D+=B/this.zoomStopHeight;D=Math.min(Math.max(D,0),this.map.getNumZoomLevels()-1)}else{D+=Math.round(B/this.zoomStopHeight)}this.map.zoomTo(D);this.moveZoomBar();this.mouseDragStart=null;OpenLayers.Event.stop(C)}},moveZoomBar:function(){var B=((this.map.getNumZoomLevels()-1)-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=B+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"});OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,base:"",displayProjection:null,initialize:function(C,D,B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.element=OpenLayers.Util.getElement(C);this.base=D||document.location.href},destroy:function(){if(this.element.parentNode==this.div){this.div.removeChild(this.element)}this.element=null;this.map.events.unregister("moveend",this,this.updateLink);OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(E){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var C=0,B=this.map.controls.length;C<B;C++){var D=this.map.controls[C];if(D.CLASS_NAME==this.argParserClass.CLASS_NAME){if(D.displayProjection!=this.displayProjection){this.displayProjection=D.displayProjection}break}}if(C==this.map.controls.length){this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.className=this.displayClass;this.element=document.createElement("a");this.element.innerHTML=OpenLayers.i18n("permalink");this.element.href="";this.div.appendChild(this.element)}this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this});this.updateLink();return this.div},updateLink:function(){var B=this.base;if(B.indexOf("?")!=-1){B=B.substring(0,B.indexOf("?"))}B+="?"+OpenLayers.Util.getParameterString(this.createParams());this.element.href=B},createParams:function(B,K,F){B=B||this.map.getCenter();var E=OpenLayers.Util.getParameters(this.base);if(B){E.zoom=K||this.map.getZoom();var J=B.lat;var C=B.lon;if(this.displayProjection){var D=OpenLayers.Projection.transform({x:C,y:J},this.map.getProjectionObject(),this.displayProjection);C=D.x;J=D.y}E.lat=Math.round(J*100000)/100000;E.lon=Math.round(C*100000)/100000;F=F||this.map.layers;E.layers="";for(var G=0,I=F.length;G<I;G++){var H=F[G];if(H.isBaseLayer){E.layers+=(H==this.map.baseLayer)?"B":"0"}else{E.layers+=(H.getVisibility())?"T":"F"}}}return E},CLASS_NAME:"OpenLayers.Control.Permalink"});OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(B){OpenLayers.Control.Panel.prototype.initialize.apply(this,[B]);this.addControls([new OpenLayers.Control.ZoomIn(),new OpenLayers.Control.ZoomToMaxExtent(),new OpenLayers.Control.ZoomOut()])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"});OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:false,initialize:function(B){OpenLayers.Format.prototype.initialize.apply(this,[B])},read:function(json,filter){try{if(/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var object=eval("("+json+")");if(typeof filter==="function"){function walk(k,v){if(v&&typeof v==="object"){for(var i in v){if(v.hasOwnProperty(i)){v[i]=walk(i,v[i])}}}return filter(k,v)}object=walk("",object)}if(this.keepData){this.data=object}return object}}catch(e){}return null},write:function(F,D){this.pretty=!!D;var B=null;var C=typeof F;if(this.serialize[C]){try{B=this.serialize[C].apply(this,[F])}catch(E){OpenLayers.Console.error("Trouble serializing: "+E)}}return B},writeIndent:function(){var C=[];if(this.pretty){for(var B=0;B<this.level;++B){C.push(this.indent)}}return C.join("")},writeNewline:function(){return(this.pretty)?this.newline:""},writeSpace:function(){return(this.pretty)?this.space:""},serialize:{object:function(D){if(D==null){return"null"}if(D.constructor==Date){return this.serialize.date.apply(this,[D])}if(D.constructor==Array){return this.serialize.array.apply(this,[D])}var G=["{"];this.level+=1;var E,C,F;var B=false;for(E in D){if(D.hasOwnProperty(E)){C=OpenLayers.Format.JSON.prototype.write.apply(this,[E,this.pretty]);F=OpenLayers.Format.JSON.prototype.write.apply(this,[D[E],this.pretty]);if(C!=null&&F!=null){if(B){G.push(",")}G.push(this.writeNewline(),this.writeIndent(),C,":",this.writeSpace(),F);B=true}}}this.level-=1;G.push(this.writeNewline(),this.writeIndent(),"}");return G.join("")},array:function(F){var D;var E=["["];this.level+=1;for(var C=0,B=F.length;C<B;++C){D=OpenLayers.Format.JSON.prototype.write.apply(this,[F[C],this.pretty]);if(D!=null){if(C>0){E.push(",")}E.push(this.writeNewline(),this.writeIndent(),D)}}this.level-=1;E.push(this.writeNewline(),this.writeIndent(),"]");return E.join("")},string:function(C){var B={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(/["\\\x00-\x1f]/.test(C)){return'"'+C.replace(/([\x00-\x1f\\"])/g,function(E,D){var F=B[D];if(F){return F}F=D.charCodeAt();return"\\u00"+Math.floor(F/16).toString(16)+(F%16).toString(16)})+'"'}return'"'+C+'"'},number:function(B){return isFinite(B)?String(B):"null"},"boolean":function(B){return String(B)},date:function(B){function C(D){return(D<10)?"0"+D:D}return'"'+B.getFullYear()+"-"+C(B.getMonth()+1)+"-"+C(B.getDate())+"T"+C(B.getHours())+":"+C(B.getMinutes())+":"+C(B.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"});OpenLayers.Format.WFST=function(C){C=OpenLayers.Util.applyDefaults(C,OpenLayers.Format.WFST.DEFAULTS);var B=OpenLayers.Format.WFST["v"+C.version.replace(/\./g,"_")];if(!B){throw"Unsupported WFST version: "+C.version}return new B(C)};OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"};OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.1",version:null,parser:null,initialize:function(B){OpenLayers.Format.prototype.initialize.apply(this,[B]);this.options=B},read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var D=F.documentElement;var C=this.version||D.getAttribute("version")||this.defaultVersion;if(!this.parser||this.parser.version!==C){var E=OpenLayers.Format.WMSCapabilities["v"+C.replace(/\./g,"_")];if(!E){throw"Can't find a WMS capabilities parser for version "+C}var G=new E(this.options)}var B=G.read(F);B.version=C;return B},CLASS_NAME:"OpenLayers.Format.WMSCapabilities"});OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(B){if(window.ActiveXObject){this.xmldom=new ActiveXObject("Microsoft.XMLDOM")}OpenLayers.Format.prototype.initialize.apply(this,[B]);this.namespaces=OpenLayers.Util.extend({},this.namespaces);this.namespaceAlias={};for(var C in this.namespaces){this.namespaceAlias[this.namespaces[C]]=C}},destroy:function(){this.xmldom=null;OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(B,C){this.namespaces[B]=C;this.namespaceAlias[C]=B},read:function(D){var B=D.indexOf("<");if(B>0){D=D.substring(B)}var C=OpenLayers.Util.Try(OpenLayers.Function.bind((function(){var E;if(window.ActiveXObject&&!this.xmldom){E=new ActiveXObject("Microsoft.XMLDOM")}else{E=this.xmldom}E.loadXML(D);return E}),this),function(){return new DOMParser().parseFromString(D,"text/xml")},function(){var E=new XMLHttpRequest();E.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(D),false);if(E.overrideMimeType){E.overrideMimeType("text/xml")}E.send(null);return E.responseXML});if(this.keepData){this.data=C}return C},write:function(C){var D;if(this.xmldom){D=C.xml}else{var B=new XMLSerializer();if(C.nodeType==1){var E=document.implementation.createDocument("","",null);if(E.importNode){C=E.importNode(C,true)}E.appendChild(C);D=B.serializeToString(E)}else{D=B.serializeToString(C)}}return D},createElementNS:function(D,B){var C;if(this.xmldom){if(typeof D=="string"){C=this.xmldom.createNode(1,B,D)}else{C=this.xmldom.createNode(1,B,"")}}else{C=document.createElementNS(D,B)}return C},createTextNode:function(C){var B;if(this.xmldom){B=this.xmldom.createTextNode(C)}else{B=document.createTextNode(C)}return B},getElementsByTagNameNS:function(F,E,D){var B=[];if(F.getElementsByTagNameNS){B=F.getElementsByTagNameNS(E,D)}else{var C=F.getElementsByTagName("*");var J,G;for(var H=0,I=C.length;H<I;++H){J=C[H];G=(J.prefix)?(J.prefix+":"+D):D;if((D=="*")||(G==J.nodeName)){if((E=="*")||(E==J.namespaceURI)){B.push(J)}}}}return B},getAttributeNodeNS:function(D,C,B){var J=null;if(D.getAttributeNodeNS){J=D.getAttributeNodeNS(C,B)}else{var F=D.attributes;var I,E;for(var G=0,H=F.length;G<H;++G){I=F[G];if(I.namespaceURI==C){E=(I.prefix)?(I.prefix+":"+B):B;if(E==I.nodeName){J=I;break}}}}return J},getAttributeNS:function(F,E,B){var C="";if(F.getAttributeNS){C=F.getAttributeNS(E,B)||""}else{var D=this.getAttributeNodeNS(F,E,B);if(D){C=D.nodeValue}}return C},getChildValue:function(B,D){var C=D||"";if(B){for(var E=B.firstChild;E;E=E.nextSibling){switch(E.nodeType){case 3:case 4:C+=E.nodeValue}}}return C},concatChildValues:function(C,E){var D="";var F=C.firstChild;var B;while(F){B=F.nodeValue;if(B){D+=B}F=F.nextSibling}if(D==""&&E!=undefined){D=E}return D},isSimpleContent:function(B){var D=true;for(var C=B.firstChild;C;C=C.nextSibling){if(C.nodeType===1){D=false;break}}return D},contentType:function(D){var F=false,C=false;var B=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY;for(var E=D.firstChild;E;E=E.nextSibling){switch(E.nodeType){case 1:C=true;break;case 8:break;default:F=true}if(C&&F){break}}if(C&&F){B=OpenLayers.Format.XML.CONTENT_TYPE.MIXED}else{if(C){return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX}else{if(F){return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}}}return B},hasAttributeNS:function(D,C,B){var E=false;if(D.hasAttributeNS){E=D.hasAttributeNS(C,B)}else{E=!!this.getAttributeNodeNS(D,C,B)}return E},setAttributeNS:function(E,D,B,F){if(E.setAttributeNS){E.setAttributeNS(D,B,F)}else{if(this.xmldom){if(D){var C=E.ownerDocument.createNode(2,B,D);C.nodeValue=F;E.setAttributeNode(C)}else{E.setAttribute(B,F)}}else{throw"setAttributeNS not implemented"}}},createElementNSPlus:function(C,B){B=B||{};var E=B.uri||this.namespaces[B.prefix];if(!E){var G=C.indexOf(":");E=this.namespaces[C.substring(0,G)]}if(!E){E=this.namespaces[this.defaultPrefix]}var D=this.createElementNS(E,C);if(B.attributes){this.setAttributes(D,B.attributes)}var F=B.value;if(F!=null){if(typeof F=="boolean"){F=String(F)}D.appendChild(this.createTextNode(F))}return D},setAttributes:function(D,F){var E,C;for(var B in F){if(F[B]!=null&&F[B].toString){E=F[B].toString();C=this.namespaces[B.substring(0,B.indexOf(":"))]||null;this.setAttributeNS(D,C,B,E)}}},readNode:function(D,F){if(!F){F={}}var E=this.readers[this.namespaceAlias[D.namespaceURI]];if(E){var C=D.localName||D.nodeName.split(":").pop();var B=E[C]||E["*"];if(B){B.apply(this,[D,F])}}return F},readChildNodes:function(E,F){if(!F){F={}}var D=E.childNodes;var G;for(var C=0,B=D.length;C<B;++C){G=D[C];if(G.nodeType==1){this.readNode(G,F)}}return F},writeNode:function(B,G,E){var F,D;var C=B.indexOf(":");if(C>0){F=B.substring(0,C);D=B.substring(C+1)}else{if(E){F=this.namespaceAlias[E.namespaceURI]}else{F=this.defaultPrefix}D=B}var H=this.writers[F][D].apply(this,[G]);if(E){E.appendChild(H)}return H},getChildEl:function(D,B,C){return D&&this.getThisOrNextEl(D.firstChild,B,C)},getNextEl:function(D,B,C){return D&&this.getThisOrNextEl(D.nextSibling,B,C)},getThisOrNextEl:function(E,B,D){outer:for(var C=E;C;C=C.nextSibling){switch(C.nodeType){case 1:if((!B||B===(C.localName||C.nodeName.split(":").pop()))&&(!D||D===C.namespaceURI)){break outer}C=null;break outer;case 3:if(/^\s*$/.test(C.nodeValue)){break}case 4:case 6:case 12:case 10:case 11:C=null;break outer}}return C||null},lookupNamespaceURI:function(F,G){var E=null;if(F){if(F.lookupNamespaceURI){E=F.lookupNamespaceURI(G)}else{outer:switch(F.nodeType){case 1:if(F.namespaceURI!==null&&F.prefix===G){E=F.namespaceURI;break outer}var C=F.attributes.length;if(C){var B;for(var D=0;D<C;++D){B=F.attributes[D];if(B.prefix==="xmlns"&&B.name==="xmlns:"+G){E=B.value||null;break outer}else{if(B.name==="xmlns"&&G===null){E=B.value||null;break outer}}}}E=this.lookupNamespaceURI(F.parentNode,G);break outer;case 2:E=this.lookupNamespaceURI(F.ownerElement,G);break outer;case 9:E=this.lookupNamespaceURI(F.documentElement,G);break outer;case 6:case 12:case 10:case 11:break outer;default:E=this.lookupNamespaceURI(F.parentNode,G);break outer}}}return E},CLASS_NAME:"OpenLayers.Format.XML"});OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3};OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype);OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:false,evt:null,initialize:function(D,C,B){OpenLayers.Util.extend(this,B);this.control=D;this.callbacks=C;if(D.map){this.setMap(D.map)}OpenLayers.Util.extend(this,B);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(B){this.map=B},checkModifiers:function(B){if(this.keyMask==null){return true}var C=(B.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(B.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(B.altKey?OpenLayers.Handler.MOD_ALT:0);return(C==this.keyMask)},activate:function(){if(this.active){return false}var D=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var C=0,B=D.length;C<B;C++){if(this[D[C]]){this.register(D[C],this[D[C]])}}this.active=true;return true},deactivate:function(){if(!this.active){return false}var D=OpenLayers.Events.prototype.BROWSER_EVENTS;for(var C=0,B=D.length;C<B;C++){if(this[D[C]]){this.unregister(D[C],this[D[C]])}}this.active=false;return true},callback:function(C,B){if(C&&this.callbacks[C]){this.callbacks[C].apply(this.control,B)}},register:function(B,C){this.map.events.registerPriority(B,this,C);this.map.events.registerPriority(B,this,this.setEvent)},unregister:function(B,C){this.map.events.unregister(B,this,C);this.map.events.unregister(B,this,this.setEvent)},setEvent:function(B){this.evt=B;return true},destroy:function(){this.deactivate();this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"});OpenLayers.Handler.MOD_NONE=0;OpenLayers.Handler.MOD_SHIFT=1;OpenLayers.Handler.MOD_CTRL=2;OpenLayers.Handler.MOD_ALT=4;OpenLayers.Lang.de=OpenLayers.Util.applyDefaults({unhandledRequest:"Unbehandelte Anfragerückmeldung ${statusText}",permalink:"Permalink",overlays:"Overlays",baseLayer:"Grundkarte",sameProjection:"Die Übersichtskarte funktioniert nur, wenn sie dieselbe Projektion wie die Hauptkarte verwendet",readNotImplemented:"Lesen nicht implementiert.",writeNotImplemented:"Schreiben nicht implementiert.",noFID:"Ein Feature, für das keine FID existiert, kann nicht aktualisiert werden.",errorLoadingGML:"Fehler beim Laden der GML-Datei ${url}",browserNotSupported:"Ihr Browser unterstützt keine Vektordarstellung. Aktuell unterstützte Renderer:\n${renderers}",componentShouldBe:"addFeatures : Komponente sollte vom Typ ${geomType} sein",commitSuccess:"WFS-Transaktion: ERFOLGREICH ${response}",commitFailed:"WFS-Transaktion: FEHLGESCHLAGEN ${response}",googleWarning:"Der Google-Layer konnte nicht korrekt geladen werden.<br><br>Um diese Meldung nicht mehr zu erhalten, wählen Sie einen anderen Hintergrundlayer aus dem LayerSwitcher in der rechten oberen Ecke.<br><br>Sehr wahrscheinlich tritt dieser Fehler auf, weil das Skript der Google-Maps-Bibliothek nicht eingebunden wurde oder keinen gültigen API-Schlüssel für Ihre URL enthält.<br><br>Entwickler: Für Hilfe zum korrekten Einbinden des Google-Layers <a href='http://trac.openlayers.org/wiki/Google' target='_blank'>hier klicken</a>",getLayerWarning:"Der ${layerType}-Layer konnte nicht korrekt geladen werden.<br><br>Um diese Meldung nicht mehr zu erhalten, wählen Sie einen anderen Hintergrundlayer aus dem LayerSwitcher in der rechten oberen Ecke.<br><br>Sehr wahrscheinlich tritt dieser Fehler auf, weil das Skript der \"${layerLib}\"-Bibliothek nicht eingebunden wurde.<br><br>Entwickler: Für Hilfe zum korrekten Einbinden von Layern <a href='http://trac.openlayers.org/wiki/${layerLib}' target='_blank'>hier klicken</a>",scale:"Maßstab = 1 : ${scaleDenom}",end:""},OpenLayers.Lang.en);OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1000},EVENT_TYPES:["preaddlayer","addlayer","removelayer","changelayer","movestart","move","moveend","zoomend","popupopen","popupclose","addmarker","removemarker","clearmarkers","mouseover","mouseout","mousemove","dragstart","drag","dragend","changebaselayer"],id:null,fractionalZoom:false,events:null,allOverlays:false,div:null,dragging:false,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,viewRequestID:0,tileSize:null,projection:"EPSG:4326",units:"degrees",resolutions:null,maxResolution:1.40625,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:true,panTween:null,eventListeners:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,paddingForPopups:null,initialize:function(I,E){if(arguments.length===1&&typeof I==="object"){E=I;I=E&&E.div}this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT);this.maxExtent=new OpenLayers.Bounds(-180,-90,180,90);this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15);this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css";OpenLayers.Util.extend(this,E);this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_");this.div=OpenLayers.Util.getElement(I);if(!this.div){this.div=document.createElement("div");this.div.style.height="1px";this.div.style.width="1px"}OpenLayers.Element.addClass(this.div,"olMap");var H=this.div.id+"_OpenLayers_ViewPort";this.viewPortDiv=OpenLayers.Util.createDiv(H,null,null,null,"relative",null,"hidden");this.viewPortDiv.style.width="100%";this.viewPortDiv.style.height="100%";this.viewPortDiv.className="olMapViewport";this.div.appendChild(this.viewPortDiv);H=this.div.id+"_OpenLayers_Container";this.layerContainerDiv=OpenLayers.Util.createDiv(H);this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1;this.viewPortDiv.appendChild(this.layerContainerDiv);this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES,this.fallThrough,{includeXY:true});this.updateSize();if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}this.events.register("movestart",this,this.updateSize);if(OpenLayers.String.contains(navigator.appName,"Microsoft")){this.events.register("resize",this,this.updateSize)}else{this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this);OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)}if(this.theme){var G=true;var D=document.getElementsByTagName("link");for(var F=0,B=D.length;F<B;++F){if(OpenLayers.Util.isEquivalentUrl(D.item(F).href,this.theme)){G=false;break}}if(G){var C=document.createElement("link");C.setAttribute("rel","stylesheet");C.setAttribute("type","text/css");C.setAttribute("href",this.theme);document.getElementsByTagName("head")[0].appendChild(C)}}this.layers=[];if(this.controls==null){if(OpenLayers.Control!=null){this.controls=[new OpenLayers.Control.Navigation(),new OpenLayers.Control.PanZoom(),new OpenLayers.Control.ArgParser(),new OpenLayers.Control.Attribution()]}else{this.controls=[]}}for(var F=0,B=this.controls.length;F<B;F++){this.addControlToMap(this.controls[F])}this.popups=[];this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy)},render:function(B){this.div=OpenLayers.Util.getElement(B);OpenLayers.Element.addClass(this.div,"olMap");this.events.attachToElement(this.div);this.viewPortDiv.parentNode.removeChild(this.viewPortDiv);this.div.appendChild(this.viewPortDiv);this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy){return false}OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;if(this.updateSizeDestroy){OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy)}else{this.events.unregister("resize",this,this.updateSize)}this.paddingForPopups=null;if(this.controls!=null){for(var B=this.controls.length-1;B>=0;--B){this.controls[B].destroy()}this.controls=null}if(this.layers!=null){for(var B=this.layers.length-1;B>=0;--B){this.layers[B].destroy(false)}this.layers=null}if(this.viewPortDiv){this.div.removeChild(this.viewPortDiv)}this.viewPortDiv=null;if(this.eventListeners){this.events.un(this.eventListeners);this.eventListeners=null}this.events.destroy();this.events=null},setOptions:function(B){OpenLayers.Util.extend(this,B)},getTileSize:function(){return this.tileSize},getBy:function(F,D,B){var E=(typeof B.test=="function");var C=OpenLayers.Array.filter(this[F],function(G){return G[D]==B||(E&&B.test(G[D]))});return C},getLayersBy:function(C,B){return this.getBy("layers",C,B)},getLayersByName:function(B){return this.getLayersBy("name",B)},getLayersByClass:function(B){return this.getLayersBy("CLASS_NAME",B)},getControlsBy:function(C,B){return this.getBy("controls",C,B)},getControlsByClass:function(B){return this.getControlsBy("CLASS_NAME",B)},getLayer:function(F){var C=null;for(var E=0,B=this.layers.length;E<B;E++){var D=this.layers[E];if(D.id==F){C=D;break}}return C},setLayerZIndex:function(C,B){C.setZIndex(this.Z_INDEX_BASE[C.isBaseLayer?"BaseLayer":"Overlay"]+B*5)},resetLayersZIndex:function(){for(var D=0,B=this.layers.length;D<B;D++){var C=this.layers[D];this.setLayerZIndex(C,D)}},addLayer:function(D){for(var C=0,B=this.layers.length;C<B;C++){if(this.layers[C]==D){var E=OpenLayers.i18n("layerAlreadyAdded",{layerName:D.name});OpenLayers.Console.warn(E);return false}}if(this.allOverlays){D.isBaseLayer=false}this.events.triggerEvent("preaddlayer",{layer:D});D.div.className="olLayerDiv";D.div.style.overflow="";this.setLayerZIndex(D,this.layers.length);if(D.isFixed){this.viewPortDiv.appendChild(D.div)}else{this.layerContainerDiv.appendChild(D.div)}this.layers.push(D);D.setMap(this);if(D.isBaseLayer||(this.allOverlays&&!this.baseLayer)){if(this.baseLayer==null){this.setBaseLayer(D)}else{D.setVisibility(false)}}else{D.redraw()}this.events.triggerEvent("addlayer",{layer:D});D.afterAdd()},addLayers:function(D){for(var C=0,B=D.length;C<B;C++){this.addLayer(D[C])}},removeLayer:function(D,F){if(F==null){F=true}if(D.isFixed){this.viewPortDiv.removeChild(D.div)}else{this.layerContainerDiv.removeChild(D.div)}OpenLayers.Util.removeItem(this.layers,D);D.removeMap(this);D.map=null;if(this.baseLayer==D){this.baseLayer=null;if(F){for(var C=0,B=this.layers.length;C<B;C++){var E=this.layers[C];if(E.isBaseLayer||this.allOverlays){this.setBaseLayer(E);break}}}}this.resetLayersZIndex();this.events.triggerEvent("removelayer",{layer:D})},getNumLayers:function(){return this.layers.length},getLayerIndex:function(B){return OpenLayers.Util.indexOf(this.layers,B)},setLayerIndex:function(E,C){var F=this.getLayerIndex(E);if(C<0){C=0}else{if(C>this.layers.length){C=this.layers.length}}if(F!=C){this.layers.splice(F,1);this.layers.splice(C,0,E);for(var D=0,B=this.layers.length;D<B;D++){this.setLayerZIndex(this.layers[D],D)}this.events.triggerEvent("changelayer",{layer:E,property:"order"});if(this.allOverlays){if(C===0){this.setBaseLayer(E)}else{if(this.baseLayer!==this.layers[0]){this.setBaseLayer(this.layers[0])}}}}},raiseLayer:function(C,D){var B=this.getLayerIndex(C)+D;this.setLayerIndex(C,B)},setBaseLayer:function(F){var E=null;if(this.baseLayer){E=this.baseLayer.getExtent()}if(F!=this.baseLayer){if(OpenLayers.Util.indexOf(this.layers,F)!=-1){if(this.baseLayer!=null&&!this.allOverlays){this.baseLayer.setVisibility(false)}this.baseLayer=F;this.viewRequestID++;if(!this.allOverlays){this.baseLayer.visibility=true}var B=this.getCenter();if(B!=null){var C=(E)?E.getCenterLonLat():B;var D=(E)?this.getZoomForExtent(E,true):this.getZoomForResolution(this.resolution,true);this.setCenter(C,D,false,true)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}}},addControl:function(C,B){this.controls.push(C);this.addControlToMap(C,B)},addControlToMap:function(C,B){C.outsideViewport=(C.div!=null);if(this.displayProjection&&!C.displayProjection){C.displayProjection=this.displayProjection}C.setMap(this);var D=C.draw(B);if(D){if(!C.outsideViewport){D.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length;this.viewPortDiv.appendChild(D)}}},getControl:function(F){var C=null;for(var D=0,B=this.controls.length;D<B;D++){var E=this.controls[D];if(E.id==F){C=E;break}}return C},removeControl:function(B){if((B)&&(B==this.getControl(B.id))){if(B.div&&(B.div.parentNode==this.viewPortDiv)){this.viewPortDiv.removeChild(B.div)}OpenLayers.Util.removeItem(this.controls,B)}},addPopup:function(B,E){if(E){for(var C=this.popups.length-1;C>=0;--C){this.removePopup(this.popups[C])}}B.map=this;this.popups.push(B);var D=B.draw();if(D){D.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length;this.layerContainerDiv.appendChild(D)}},removePopup:function(B){OpenLayers.Util.removeItem(this.popups,B);if(B.div){try{this.layerContainerDiv.removeChild(B.div)}catch(C){}}B.map=null},getSize:function(){var B=null;if(this.size!=null){B=this.size.clone()}return B},updateSize:function(){this.events.clearMouseCache();var D=this.getCurrentSize();var G=this.getSize();if(G==null){this.size=G=D}if(!D.equals(G)){this.size=D;for(var E=0,C=this.layers.length;E<C;E++){this.layers[E].onMapResize()}if(this.baseLayer!=null){var B=new OpenLayers.Pixel(D.w/2,D.h/2);var H=this.getLonLatFromViewPortPx(B);var F=this.getZoom();this.zoom=null;this.setCenter(this.getCenter(),F)}}},getCurrentSize:function(){var B=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);if(B.w==0&&B.h==0||isNaN(B.w)&&isNaN(B.h)){var C=OpenLayers.Element.getDimensions(this.div);B.w=C.width;B.h=C.height}if(B.w==0&&B.h==0||isNaN(B.w)&&isNaN(B.h)){B.w=parseInt(this.div.style.width);B.h=parseInt(this.div.style.height)}return B},calculateBounds:function(B,C){var F=null;if(B==null){B=this.getCenter()}if(C==null){C=this.getResolution()}if((B!=null)&&(C!=null)){var E=this.getSize();var G=E.w*C;var D=E.h*C;F=new OpenLayers.Bounds(B.lon-G/2,B.lat-D/2,B.lon+G/2,B.lat+D/2)}return F},getCenter:function(){var B=null;if(this.center){B=this.center.clone()}return B},getZoom:function(){return this.zoom},pan:function(E,D,F){F=OpenLayers.Util.applyDefaults(F,{animate:true,dragging:false});var G=this.getViewPortPxFromLonLat(this.getCenter());var C=G.add(E,D);if(!F.dragging||!C.equals(G)){var B=this.getLonLatFromViewPortPx(C);if(F.animate){this.panTo(B)}else{this.setCenter(B,null,F.dragging)}}},panTo:function(C){if(this.panMethod&&this.getExtent().scale(this.panRatio).containsLonLat(C)){if(!this.panTween){this.panTween=new OpenLayers.Tween(this.panMethod)}var B=this.getCenter();if(C.lon==B.lon&&C.lat==B.lat){return }var E={lon:B.lon,lat:B.lat};var D={lon:C.lon,lat:C.lat};this.panTween.start(E,D,this.panDuration,{callbacks:{start:OpenLayers.Function.bind(function(F){this.events.triggerEvent("movestart")},this),eachStep:OpenLayers.Function.bind(function(F){F=new OpenLayers.LonLat(F.lon,F.lat);this.moveTo(F,this.zoom,{dragging:true,noEvent:true})},this),done:OpenLayers.Function.bind(function(F){F=new OpenLayers.LonLat(F.lon,F.lat);this.moveTo(F,this.zoom,{noEvent:true});this.events.triggerEvent("moveend")},this)}})}else{this.setCenter(C)}},setCenter:function(D,B,C,E){this.moveTo(D,B,{dragging:C,forceZoomChange:E,caller:"setCenter"})},moveTo:function(H,N,Q){if(!Q){Q={}}var M=Q.dragging;var D=Q.forceZoomChange;var I=Q.noEvent;if(this.panTween&&Q.caller=="setCenter"){this.panTween.stop()}if(!this.center&&!this.isValidLonLat(H)){H=this.maxExtent.getCenterLonLat()}if(this.restrictedExtent!=null){if(H==null){H=this.getCenter()}if(N==null){N=this.getZoom()}var E=this.getResolutionForZoom(N);var O=this.calculateBounds(H,E);if(!this.restrictedExtent.containsBounds(O)){var P=this.restrictedExtent.getCenterLonLat();if(O.getWidth()>this.restrictedExtent.getWidth()){H=new OpenLayers.LonLat(P.lon,H.lat)}else{if(O.left<this.restrictedExtent.left){H=H.add(this.restrictedExtent.left-O.left,0)}else{if(O.right>this.restrictedExtent.right){H=H.add(this.restrictedExtent.right-O.right,0)}}}if(O.getHeight()>this.restrictedExtent.getHeight()){H=new OpenLayers.LonLat(H.lon,P.lat)}else{if(O.bottom<this.restrictedExtent.bottom){H=H.add(0,this.restrictedExtent.bottom-O.bottom)}else{if(O.top>this.restrictedExtent.top){H=H.add(0,this.restrictedExtent.top-O.top)}}}}}var C=D||((this.isValidZoomLevel(N))&&(N!=this.getZoom()));var F=(this.isValidLonLat(H))&&(!H.equals(this.center));if(C||F||!M){if(!this.dragging&&!I){this.events.triggerEvent("movestart")}if(F){if((!C)&&(this.center)){this.centerLayerContainer(H)}this.center=H.clone()}if((C)||(this.layerContainerOrigin==null)){this.layerContainerOrigin=this.center.clone();this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px"}if(C){this.zoom=N;this.resolution=this.getResolutionForZoom(N);this.viewRequestID++}var B=this.getExtent();if(this.baseLayer.visibility){this.baseLayer.moveTo(B,C,M);if(M){this.baseLayer.events.triggerEvent("move")}else{this.baseLayer.events.triggerEvent("moveend",{zoomChanged:C})}}B=this.baseLayer.getExtent();for(var G=0,K=this.layers.length;G<K;G++){var J=this.layers[G];if(J!==this.baseLayer&&!J.isBaseLayer){var L=J.calculateInRange();if(J.inRange!=L){J.inRange=L;if(!L){J.display(false)}this.events.triggerEvent("changelayer",{layer:J,property:"visibility"})}if(L&&J.visibility){J.moveTo(B,C,M);if(M){J.events.triggerEvent("move")}else{J.events.triggerEvent("moveend",{zoomChanged:C})}}}}if(C){for(var G=0,K=this.popups.length;G<K;G++){this.popups[G].updatePosition()}}this.events.triggerEvent("move");if(C){this.events.triggerEvent("zoomend")}}if(!M&&!I){this.events.triggerEvent("moveend")}this.dragging=!!M},centerLayerContainer:function(C){var B=this.getViewPortPxFromLonLat(this.layerContainerOrigin);var D=this.getViewPortPxFromLonLat(C);if((B!=null)&&(D!=null)){this.layerContainerDiv.style.left=Math.round(B.x-D.x)+"px";this.layerContainerDiv.style.top=Math.round(B.y-D.y)+"px"}},isValidZoomLevel:function(B){return((B!=null)&&(B>=0)&&(B<this.getNumZoomLevels()))},isValidLonLat:function(D){var C=false;if(D!=null){var B=this.getMaxExtent();C=B.containsLonLat(D)}return C},getProjection:function(){var B=this.getProjectionObject();return B?B.getCode():null},getProjectionObject:function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.projection}return B},getMaxResolution:function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.maxResolution}return B},getMaxExtent:function(C){var B=null;if(C&&C.restricted&&this.restrictedExtent){B=this.restrictedExtent}else{if(this.baseLayer!=null){B=this.baseLayer.maxExtent}}return B},getNumZoomLevels:function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.numZoomLevels}return B},getExtent:function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.getExtent()}return B},getResolution:function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.getResolution()}return B},getUnits:function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.units}return B},getScale:function(){var D=null;if(this.baseLayer!=null){var C=this.getResolution();var B=this.baseLayer.units;D=OpenLayers.Util.getScaleFromResolution(C,B)}return D},getZoomForExtent:function(D,C){var B=null;if(this.baseLayer!=null){B=this.baseLayer.getZoomForExtent(D,C)}return B},getResolutionForZoom:function(C){var B=null;if(this.baseLayer){B=this.baseLayer.getResolutionForZoom(C)}return B},getZoomForResolution:function(B,D){var C=null;if(this.baseLayer!=null){C=this.baseLayer.getZoomForResolution(B,D)}return C},zoomTo:function(B){if(this.isValidZoomLevel(B)){this.setCenter(null,B)}},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(E,D){var C=E.getCenterLonLat();if(this.baseLayer.wrapDateLine){var B=this.getMaxExtent();E=E.clone();while(E.right<E.left){E.right+=B.getWidth()}C=E.getCenterLonLat().wrapDateLine(B)}this.setCenter(C,this.getZoomForExtent(E,D))},zoomToMaxExtent:function(D){var C=(D)?D.restricted:true;var B=this.getMaxExtent({restricted:C});this.zoomToExtent(B)},zoomToScale:function(I,H){var E=OpenLayers.Util.getResolutionFromScale(I,this.baseLayer.units);var D=this.getSize();var G=D.w*E;var C=D.h*E;var B=this.getCenter();var F=new OpenLayers.Bounds(B.lon-G/2,B.lat-C/2,B.lon+G/2,B.lat+C/2);this.zoomToExtent(F,H)},getLonLatFromViewPortPx:function(B){var C=null;if(this.baseLayer!=null){C=this.baseLayer.getLonLatFromViewPortPx(B)}return C},getViewPortPxFromLonLat:function(C){var B=null;if(this.baseLayer!=null){B=this.baseLayer.getViewPortPxFromLonLat(C)}return B},getLonLatFromPixel:function(B){return this.getLonLatFromViewPortPx(B)},getPixelFromLonLat:function(C){var B=this.getViewPortPxFromLonLat(C);B.x=Math.round(B.x);B.y=Math.round(B.y);return B},getViewPortPxFromLayerPx:function(E){var D=null;if(E!=null){var C=parseInt(this.layerContainerDiv.style.left);var B=parseInt(this.layerContainerDiv.style.top);D=E.add(C,B)}return D},getLayerPxFromViewPortPx:function(D){var E=null;if(D!=null){var C=-parseInt(this.layerContainerDiv.style.left);var B=-parseInt(this.layerContainerDiv.style.top);E=D.add(C,B);if(isNaN(E.x)||isNaN(E.y)){E=null}}return E},getLonLatFromLayerPx:function(B){B=this.getViewPortPxFromLayerPx(B);return this.getLonLatFromViewPortPx(B)},getLayerPxFromLonLat:function(C){var B=this.getPixelFromLonLat(C);return this.getLayerPxFromViewPortPx(B)},CLASS_NAME:"OpenLayers.Map"});OpenLayers.Map.TILE_WIDTH=256;OpenLayers.Map.TILE_HEIGHT=256;OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(D,C){this.lonlat=D;var B=(C)?C:OpenLayers.Marker.defaultIcon();if(this.icon==null){this.icon=B}else{this.icon.url=B.url;this.icon.size=B.size;this.icon.offset=B.offset;this.icon.calculateOffset=B.calculateOffset}this.events=new OpenLayers.Events(this,this.icon.imageDiv,null)},destroy:function(){this.erase();this.map=null;this.events.destroy();this.events=null;if(this.icon!=null){this.icon.destroy();this.icon=null}},draw:function(B){return this.icon.draw(B)},erase:function(){if(this.icon!=null){this.icon.erase()}},moveTo:function(B){if((B!=null)&&(this.icon!=null)){this.icon.moveTo(B)}this.lonlat=this.map.getLonLatFromLayerPx(B)},isDrawn:function(){var B=(this.icon&&this.icon.isDrawn());return B},onScreen:function(){var C=false;if(this.map){var B=this.map.getExtent();C=B.containsLonLat(this.lonlat)}return C},inflate:function(C){if(this.icon){var B=new OpenLayers.Size(this.icon.size.w*C,this.icon.size.h*C);this.icon.setSize(B)}},setOpacity:function(B){this.icon.setOpacity(B)},setUrl:function(B){this.icon.setUrl(B)},display:function(B){this.icon.display(B)},CLASS_NAME:"OpenLayers.Marker"});OpenLayers.Marker.defaultIcon=function(){var B=OpenLayers.Util.getImagesLocation()+"marker.png";var C=new OpenLayers.Size(21,25);var D=function(E){return new OpenLayers.Pixel(-(E.w/2),-E.h)};return new OpenLayers.Icon(B,C,null,D)};OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:true,panMapIfOutOfView:true,imageSize:new OpenLayers.Size(676,736),isAlphaImage:false,fixedRelativePosition:false,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-638,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-638,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-638,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-638,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-638,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(600,660),initialize:function(H,D,G,C,B,F,E){this.imageSrc=OpenLayers.Util.getImagesLocation()+"cloud-popup-relative.png";OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments);this.contentDiv.className=this.contentDisplayClass},destroy:function(){OpenLayers.Popup.Framed.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Popup.FramedCloud"});OpenLayers.Request={DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:true,user:undefined,password:undefined,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},events:new OpenLayers.Events(this,null,["complete","success","failure"]),issue:function(E){var H=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});E=OpenLayers.Util.applyDefaults(E,H);var G=new OpenLayers.Request.XMLHttpRequest();var B=E.url;if(E.params){var F=OpenLayers.Util.getParameterString(E.params);if(F.length>0){var J=(B.indexOf("?")>-1)?"&":"?";B+=J+F}}if(E.proxy&&(B.indexOf("http")==0)){B=E.proxy+encodeURIComponent(B)}G.open(E.method,B,E.async,E.user,E.password);for(var I in E.headers){G.setRequestHeader(I,E.headers[I])}var C=(E.scope)?OpenLayers.Function.bind(E.callback,E.scope):E.callback;var K;if(E.success){K=(E.scope)?OpenLayers.Function.bind(E.success,E.scope):E.success}var D;if(E.failure){D=(E.scope)?OpenLayers.Function.bind(E.failure,E.scope):E.failure}var L=this.events;G.onreadystatechange=function(){if(G.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var M=L.triggerEvent("complete",{request:G,config:E,requestUrl:B});if(M!==false){C(G);if(!G.status||(G.status>=200&&G.status<300)){L.triggerEvent("success",{request:G,config:E,requestUrl:B});if(K){K(G)}}if(G.status&&(G.status<200||G.status>=300)){L.triggerEvent("failure",{request:G,config:E,requestUrl:B});if(D){D(G)}}}}};if(E.async===false){G.send(E.data)}else{window.setTimeout(function(){G.send(E.data)},0)}return G},GET:function(B){B=OpenLayers.Util.extend(B,{method:"GET"});return OpenLayers.Request.issue(B)},POST:function(B){B=OpenLayers.Util.extend(B,{method:"POST"});B.headers=B.headers?B.headers:{};if(!("CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(B.headers))){B.headers["Content-Type"]="application/xml"}return OpenLayers.Request.issue(B)},PUT:function(B){B=OpenLayers.Util.extend(B,{method:"PUT"});B.headers=B.headers?B.headers:{};if(!("CONTENT-TYPE" in OpenLayers.Util.upperCaseObject(B.headers))){B.headers["Content-Type"]="application/xml"}return OpenLayers.Request.issue(B)},DELETE:function(B){B=OpenLayers.Util.extend(B,{method:"DELETE"});return OpenLayers.Request.issue(B)},HEAD:function(B){B=OpenLayers.Util.extend(B,{method:"HEAD"});return OpenLayers.Request.issue(B)},OPTIONS:function(B){B=OpenLayers.Util.extend(B,{method:"OPTIONS"});return OpenLayers.Request.issue(B)}};OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,layerAlphaHack:null,isBackBuffer:false,lastRatio:1,isFirstDraw:true,backBufferTile:null,initialize:function(E,B,F,C,D){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=C;this.frame=document.createElement("div");this.frame.style.overflow="hidden";this.frame.style.position="absolute";this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack()},destroy:function(){if(this.imgDiv!=null){if(this.layerAlphaHack){OpenLayers.Event.stopObservingElement(this.imgDiv.childNodes[0].id)}OpenLayers.Event.stopObservingElement(this.imgDiv.id);if(this.imgDiv.parentNode==this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv.map=null}this.imgDiv.urls=null;this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"}this.imgDiv=null;if((this.frame!=null)&&(this.frame.parentNode==this.layer.div)){this.layer.div.removeChild(this.frame)}this.frame=null;if(this.backBufferTile){this.backBufferTile.destroy();this.backBufferTile=null}this.layer.events.unregister("loadend",this,this.resetBackBuffer);OpenLayers.Tile.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new OpenLayers.Tile.Image(this.layer,this.position,this.bounds,this.url,this.size)}B=OpenLayers.Tile.prototype.clone.apply(this,[B]);B.imgDiv=null;return B},draw:function(){if(this.layer!=this.layer.map.baseLayer&&this.layer.reproject){this.bounds=this.getBoundsFromBaseLayer(this.position)}var B=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1){if(B){if(!this.backBufferTile){this.backBufferTile=this.clone();this.backBufferTile.hide();this.backBufferTile.isBackBuffer=true;this.events.register("loadend",this,this.resetBackBuffer);this.layer.events.register("loadend",this,this.resetBackBuffer)}this.startTransition()}else{if(this.backBufferTile){this.backBufferTile.clear()}}}else{if(B&&this.isFirstDraw){this.events.register("loadend",this,this.showTile);this.isFirstDraw=false}}if(!B){return false}if(this.isLoading){this.events.triggerEvent("reload")}else{this.isLoading=true;this.events.triggerEvent("loadstart")}return this.renderTile()},resetBackBuffer:function(){this.showTile();if(this.backBufferTile&&(this.isFirstDraw||!this.layer.numLoadingTiles)){this.isFirstDraw=false;var B=this.layer.maxExtent;var C=(B&&this.bounds.intersectsBounds(B,false));if(C){this.backBufferTile.position=this.position;this.backBufferTile.bounds=this.bounds;this.backBufferTile.size=this.size;this.backBufferTile.imageSize=this.layer.imageSize||this.size;this.backBufferTile.imageOffset=this.layer.imageOffset;this.backBufferTile.resolution=this.layer.getResolution();this.backBufferTile.renderTile()}this.backBufferTile.hide()}},renderTile:function(){if(this.imgDiv==null){this.initImgDiv()}this.imgDiv.viewRequestID=this.layer.map.viewRequestID;if(this.layer.async){this.layer.getURLasync(this.bounds,this,"url",this.positionImage)}else{if(this.layer.url instanceof Array){this.imgDiv.urls=this.layer.url.slice()}this.url=this.layer.getURL(this.bounds);this.positionImage()}return true},positionImage:function(){if(this.layer==null){return }OpenLayers.Util.modifyDOMElement(this.frame,null,this.position,this.size);var B=this.layer.getImageSize();if(this.layerAlphaHack){OpenLayers.Util.modifyAlphaImageDiv(this.imgDiv,null,null,B,this.url)}else{OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,B);this.imgDiv.src=this.url}},clear:function(){if(this.imgDiv){this.hide();if(OpenLayers.Tile.Image.useBlankTile){this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"}}},initImgDiv:function(){var E=this.layer.imageOffset;var C=this.layer.getImageSize();if(this.layerAlphaHack){this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,E,C,null,"relative",null,null,null,true)}else{this.imgDiv=OpenLayers.Util.createImage(null,E,C,null,"relative",null,null,true)}this.imgDiv.className="olTileImage";this.frame.style.zIndex=this.isBackBuffer?0:1;this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);if(this.layer.opacity!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity)}this.imgDiv.map=this.layer.map;var D=function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("loadend")}};if(this.layerAlphaHack){OpenLayers.Event.observe(this.imgDiv.childNodes[0],"load",OpenLayers.Function.bind(D,this))}else{OpenLayers.Event.observe(this.imgDiv,"load",OpenLayers.Function.bind(D,this))}var B=function(){if(this.imgDiv._attempts>OpenLayers.IMAGE_RELOAD_ATTEMPTS){D.call(this)}};OpenLayers.Event.observe(this.imgDiv,"error",OpenLayers.Function.bind(B,this))},checkImgURL:function(){if(this.layer){var B=this.layerAlphaHack?this.imgDiv.firstChild.src:this.imgDiv.src;if(!OpenLayers.Util.isEquivalentUrl(B,this.url)){this.hide()}}},startTransition:function(){if(!this.backBufferTile||!this.backBufferTile.imgDiv){return }var E=1;if(this.backBufferTile.resolution){E=this.backBufferTile.resolution/this.layer.getResolution()}if(E!=this.lastRatio){if(this.layer.transitionEffect=="resize"){var D=new OpenLayers.LonLat(this.backBufferTile.bounds.left,this.backBufferTile.bounds.top);var C=new OpenLayers.Size(this.backBufferTile.size.w*E,this.backBufferTile.size.h*E);var B=this.layer.map.getLayerPxFromLonLat(D);OpenLayers.Util.modifyDOMElement(this.backBufferTile.frame,null,B,C);var F=this.backBufferTile.imageSize;F=new OpenLayers.Size(F.w*E,F.h*E);var G=this.backBufferTile.imageOffset;if(G){G=new OpenLayers.Pixel(G.x*E,G.y*E)}OpenLayers.Util.modifyDOMElement(this.backBufferTile.imgDiv,null,G,F);this.backBufferTile.show()}}else{if(this.layer.singleTile){this.backBufferTile.show()}else{this.backBufferTile.hide()}}this.lastRatio=E},show:function(){this.frame.style.display="";if(OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1){if(navigator.userAgent.toLowerCase().indexOf("gecko")!=-1){this.frame.scrollLeft=this.frame.scrollLeft}}},hide:function(){this.frame.style.display="none"},CLASS_NAME:"OpenLayers.Tile.Image"});OpenLayers.Tile.Image.useBlankTile=(OpenLayers.Util.getBrowserName()=="safari"||OpenLayers.Util.getBrowserName()=="opera");OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:new OpenLayers.Size(180,90),layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:false,handlers:null,resolutionFactor:1,initialize:function(B){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[B])},destroy:function(){if(!this.mapDiv){return }this.handlers.click.destroy();this.mapDiv.removeChild(this.extentRectangle);this.extentRectangle=null;this.rectEvents.destroy();this.rectEvents=null;this.ovmap.destroy();this.ovmap=null;this.element.removeChild(this.mapDiv);this.mapDiv=null;this.div.removeChild(this.element);this.element=null;if(this.maximizeDiv){OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.div.removeChild(this.maximizeDiv);this.maximizeDiv=null}if(this.minimizeDiv){OpenLayers.Event.stopObservingElement(this.minimizeDiv);this.div.removeChild(this.minimizeDiv);this.minimizeDiv=null}this.map.events.un({moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this});OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!(this.layers.length>0)){if(this.map.baseLayer){var E=this.map.baseLayer.clone();this.layers=[E]}else{this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}}this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1000;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.mapDiv.appendChild(this.extentRectangle);this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);if(!this.outsideViewport){this.div.className+=" "+this.displayClass+"Container";var F=OpenLayers.Util.getImagesLocation();var C=F+"layer-switcher-maximize.png";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,new OpenLayers.Size(18,18),C,"absolute");this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));this.div.appendChild(this.maximizeDiv);var C=F+"layer-switcher-minimize.png";this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,new OpenLayers.Size(18,18),C,"absolute");this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));this.div.appendChild(this.minimizeDiv);var G=["dblclick","mousedown"];for(var D=0,B=G.length;D<B;D++){OpenLayers.Event.observe(this.maximizeDiv,G[D],OpenLayers.Event.stop);OpenLayers.Event.observe(this.minimizeDiv,G[D],OpenLayers.Event.stop)}this.minimizeControl()}else{this.element.style.display=""}if(this.map.getExtent()){this.update()}this.map.events.register("moveend",this,this.update);return this.div},baseLayerDraw:function(){this.draw();this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(J){var E=this.handlers.drag.last.x-J.x;var C=this.handlers.drag.last.y-J.y;if(E!=0||C!=0){var H=this.rectPxBounds.top;var B=this.rectPxBounds.left;var F=Math.abs(this.rectPxBounds.getHeight());var D=this.rectPxBounds.getWidth();var G=Math.max(0,(H-C));G=Math.min(G,this.ovmap.size.h-this.hComp-F);var I=Math.max(0,(B-E));I=Math.min(I,this.ovmap.size.w-this.wComp-D);this.setRectPxBounds(new OpenLayers.Bounds(I,G+F,I+D,G))}},mapDivClick:function(J){var C=this.rectPxBounds.getCenterPixel();var F=J.xy.x-C.x;var E=J.xy.y-C.y;var H=this.rectPxBounds.top;var D=this.rectPxBounds.left;var K=Math.abs(this.rectPxBounds.getHeight());var B=this.rectPxBounds.getWidth();var G=Math.max(0,(H+E));G=Math.min(G,this.ovmap.size.h-K);var I=Math.max(0,(D+F));I=Math.min(I,this.ovmap.size.w-B);this.setRectPxBounds(new OpenLayers.Bounds(I,G+K,I+B,G));this.updateMapToRect()},maximizeControl:function(B){this.element.style.display="";this.showToggle(false);if(B!=null){OpenLayers.Event.stop(B)}},minimizeControl:function(B){this.element.style.display="none";this.showToggle(true);if(B!=null){OpenLayers.Event.stop(B)}},showToggle:function(B){this.maximizeDiv.style.display=B?"":"none";this.minimizeDiv.style.display=B?"none":""},update:function(){if(this.ovmap==null){this.createMap()}if(this.autoPan||!this.isSuitableOverview()){this.updateOverview()}this.updateRectToMap()},isSuitableOverview:function(){var C=this.map.getExtent();var B=this.map.maxExtent;var D=new OpenLayers.Bounds(Math.max(C.left,B.left),Math.max(C.bottom,B.bottom),Math.min(C.right,B.right),Math.min(C.top,B.top));if(this.ovmap.getProjection()!=this.map.getProjection()){D=D.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}var E=this.ovmap.getResolution()/this.map.getResolution();return((E>this.minRatio)&&(E<=this.maxRatio)&&(this.ovmap.getExtent().containsBounds(D)))},updateOverview:function(){var D=this.map.getResolution();var C=this.ovmap.getResolution();var E=C/D;if(E>this.maxRatio){C=this.minRatio*D}else{if(E<=this.minRatio){C=this.maxRatio*D}}var B;if(this.ovmap.getProjection()!=this.map.getProjection()){B=this.map.center.clone();B.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else{B=this.map.center}this.ovmap.setCenter(B,this.ovmap.getZoomForResolution(C*this.resolutionFactor));this.updateRectToMap()},createMap:function(){var C=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:false},this.mapOptions);this.ovmap=new OpenLayers.Map(this.mapDiv,C);OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy);this.ovmap.addLayers(this.layers);this.ovmap.zoomToMaxExtent();this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width"));this.wComp=(this.wComp)?this.wComp:2;this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width"));this.hComp=(this.hComp)?this.hComp:2;this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap});this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:true,"double":false,stopSingle:true,stopDouble:true,pixelTolerance:1,map:this.ovmap});this.handlers.click.activate();this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,true);this.rectEvents.register("mouseover",this,function(E){if(!this.handlers.drag.active&&!this.map.dragging){this.handlers.drag.activate()}});this.rectEvents.register("mouseout",this,function(E){if(!this.handlers.drag.dragging){this.handlers.drag.deactivate()}});if(this.ovmap.getProjection()!=this.map.getProjection()){var D=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units;var B=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=D&&B?OpenLayers.INCHES_PER_UNIT[D]/OpenLayers.INCHES_PER_UNIT[B]:1}},updateRectToMap:function(){var C;if(this.ovmap.getProjection()!=this.map.getProjection()){C=this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())}else{C=this.map.getExtent()}var B=this.getRectBoundsFromMapBounds(C);if(B){this.setRectPxBounds(B)}},updateMapToRect:function(){var B=this.getMapBoundsFromRectBounds(this.rectPxBounds);if(this.ovmap.getProjection()!=this.map.getProjection()){B=B.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())}this.map.panTo(B.getCenterLonLat())},setRectPxBounds:function(E){var H=Math.max(E.top,0);var F=Math.max(E.left,0);var C=Math.min(E.top+Math.abs(E.getHeight()),this.ovmap.size.h-this.hComp);var I=Math.min(E.left+E.getWidth(),this.ovmap.size.w-this.wComp);var D=Math.max(I-F,0);var J=Math.max(C-H,0);if(D<this.minRectSize||J<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var G=F+(D/2)-(this.minRectSize/2);var B=H+(J/2)-(this.minRectSize/2);this.extentRectangle.style.top=Math.round(B)+"px";this.extentRectangle.style.left=Math.round(G)+"px";this.extentRectangle.style.height=this.minRectSize+"px";this.extentRectangle.style.width=this.minRectSize+"px"}else{this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.extentRectangle.style.top=Math.round(H)+"px";this.extentRectangle.style.left=Math.round(F)+"px";this.extentRectangle.style.height=Math.round(J)+"px";this.extentRectangle.style.width=Math.round(D)+"px"}this.rectPxBounds=new OpenLayers.Bounds(Math.round(F),Math.round(C),Math.round(I),Math.round(H))},getRectBoundsFromMapBounds:function(E){var B=new OpenLayers.LonLat(E.left,E.bottom);var G=new OpenLayers.LonLat(E.right,E.top);var D=this.getOverviewPxFromLonLat(B);var C=this.getOverviewPxFromLonLat(G);var F=null;if(D&&C){F=new OpenLayers.Bounds(D.x,D.y,C.x,C.y)}return F},getMapBoundsFromRectBounds:function(E){var D=new OpenLayers.Pixel(E.left,E.bottom);var C=new OpenLayers.Pixel(E.right,E.top);var B=this.getLonLatFromOverviewPx(D);var F=this.getLonLatFromOverviewPx(C);return new OpenLayers.Bounds(B.lon,B.lat,F.lon,F.lat)},getLonLatFromOverviewPx:function(G){var D=this.ovmap.size;var C=this.ovmap.getResolution();var B=this.ovmap.getExtent().getCenterLonLat();var F=G.x-(D.w/2);var E=G.y-(D.h/2);return new OpenLayers.LonLat(B.lon+F*C,B.lat-E*C)},getOverviewPxFromLonLat:function(E){var C=this.ovmap.getResolution();var D=this.ovmap.getExtent();var B=null;if(D){B=new OpenLayers.Pixel(Math.round(1/C*(E.lon-D.left)),Math.round(1/C*(D.top-E.lat)))}return B},CLASS_NAME:"OpenLayers.Control.OverviewMap"});OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:OpenLayers.Popup.AnchoredBubble,popup:null,initialize:function(B,D,C){this.layer=B;this.lonlat=D;this.data=(C!=null)?C:{};this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){if((this.layer!=null)&&(this.layer.map!=null)){if(this.popup!=null){this.layer.map.removePopup(this.popup)}}this.layer=null;this.id=null;this.lonlat=null;this.data=null;if(this.marker!=null){this.destroyMarker(this.marker);this.marker=null}if(this.popup!=null){this.destroyPopup(this.popup);this.popup=null}},onScreen:function(){var C=false;if((this.layer!=null)&&(this.layer.map!=null)){var B=this.layer.map.getExtent();C=B.containsLonLat(this.lonlat)}return C},createMarker:function(){if(this.lonlat!=null){this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)}return this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(C){if(this.lonlat!=null){var D=this.id+"_popup";var B=(this.marker)?this.marker.icon:null;if(!this.popup){this.popup=new this.popupClass(D,this.lonlat,this.data.popupSize,this.data.popupContentHTML,B,C)}if(this.data.overflow!=null){this.popup.contentDiv.style.overflow=this.data.overflow}this.popup.feature=this}return this.popup},destroyPopup:function(){if(this.popup){this.popup.feature=null;this.popup.destroy();this.popup=null}},CLASS_NAME:"OpenLayers.Feature"});OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.0",version:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);this.options=B},read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var D=F.documentElement;var C=this.version;if(!C){C=D.getAttribute("version");if(!C){C=this.defaultVersion}}var E=OpenLayers.Format.WFSCapabilities["v"+C.replace(/\./g,"_")];if(!E){throw"Can't find a WFS capabilities parser for version "+C}var G=new E(this.options);var B=G.read(F);B.version=C;return B},CLASS_NAME:"OpenLayers.Format.WFSCapabilities"});OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},readers:{xsd:{schema:function(E,J){var F=[];var C={};var G={complexTypes:F,customTypes:C};this.readChildNodes(E,G);var H=E.attributes;var L,B;for(var I=0,K=H.length;I<K;++I){L=H[I];B=L.name;if(B.indexOf("xmlns")==0){this.setNamespace(B.split(":")[1]||"",L.value)}else{J[B]=L.value}}J.featureTypes=F;J.targetPrefix=this.namespaceAlias[J.targetNamespace];var M,D;for(var I=0,K=F.length;I<K;++I){M=F[I];D=C[M.typeName];if(C[M.typeName]){M.typeName=D.name}}},complexType:function(C,D){var B={typeName:C.getAttribute("name")};this.readChildNodes(C,B);D.complexTypes.push(B)},complexContent:function(B,C){this.readChildNodes(B,C)},extension:function(B,C){this.readChildNodes(B,C)},sequence:function(B,C){var D={elements:[]};this.readChildNodes(B,D);C.properties=D.elements},element:function(B,D){if(D.elements){var E={};var C=B.attributes;var H;for(var F=0,G=C.length;F<G;++F){H=C[F];E[H.name]=H.value}var I=E.type;if(!I){I={};this.readChildNodes(B,I);E.restriction=I;E.type=I.base}var K=I.base||I;E.localType=K.split(":").pop();D.elements.push(E)}if(D.complexTypes){var I=B.getAttribute("type");var J=I.split(":").pop();D.customTypes[J]={name:B.getAttribute("name"),type:I}}},simpleType:function(B,C){this.readChildNodes(B,C)},restriction:function(B,C){C.base=B.getAttribute("base");this.readRestriction(B,C)}}},readRestriction:function(E,G){var D=E.childNodes;var I,H,F;for(var C=0,B=D.length;C<B;++C){I=D[C];if(I.nodeType==1){H=I.nodeName.split(":").pop();F=I.getAttribute("value");if(!G[H]){G[H]=F}else{if(typeof G[H]=="string"){G[H]=[G[H]]}G[H].push(F)}}}},read:function(C){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}if(C&&C.nodeType==9){C=C.documentElement}var B={};this.readNode(C,B);return B},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"});OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:true,xy:true,stateName:null,initialize:function(B){this.stateName={};this.stateName[OpenLayers.State.INSERT]="wfs:Insert";this.stateName[OpenLayers.State.UPDATE]="wfs:Update";this.stateName[OpenLayers.State.DELETE]="wfs:Delete";OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},getSrsName:function(D,C){var B=C&&C.srsName;if(!B){if(D&&D.layer){B=D.layer.projection.getCode()}else{B=this.srsName}}return B},read:function(B){if(typeof B=="string"){B=OpenLayers.Format.XML.prototype.read.apply(this,[B])}if(B&&B.nodeType==9){B=B.documentElement}var C={};this.readNode(B,C);if(C.features){C=C.features}return C},readers:{wfs:{FeatureCollection:function(B,C){C.features=[];this.readChildNodes(B,C)}}},write:function(B){var C=this.writeNode("wfs:Transaction",B);var D=this.schemaLocationAttr();if(D){this.setAttributeNS(C,this.namespaces.xsi,"xsi:schemaLocation",D)}return OpenLayers.Format.XML.prototype.write.apply(this,[C])},writers:{wfs:{GetFeature:function(B){var C=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,maxFeatures:B&&B.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(B)}});this.writeNode("Query",B,C);return C},Query:function(B){B=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},B);var C=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(B.featureNS?B.featurePrefix+":":"")+B.featureType,srsName:B.srsName}});if(B.featureNS){C.setAttribute("xmlns:"+B.featurePrefix,B.featureNS)}if(B.filter){this.setFilterProperty(B.filter);this.writeNode("ogc:Filter",B.filter,C)}return C},Transaction:function(F){var G=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}});if(F){var C,E;for(var D=0,B=F.length;D<B;++D){E=F[D];C=this.stateName[E.state];if(C){this.writeNode(C,E,G)}}}return G},Insert:function(B){var C=this.createElementNSPlus("wfs:Insert");this.srsName=this.getSrsName(B);this.writeNode("feature:_typeName",B,C);return C},Update:function(C){var D=this.createElementNSPlus("wfs:Update",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});if(this.featureNS){D.setAttribute("xmlns:"+this.featurePrefix,this.featureNS)}this.writeNode("Property",{name:this.geometryName,value:C},D);for(var B in C.attributes){this.writeNode("Property",{name:B,value:C.attributes[B]},D)}this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[C.fid]}),D);return D},Property:function(C){var B=this.createElementNSPlus("wfs:Property");this.writeNode("Name",C.name,B);this.writeNode("Value",C.value,B);return B},Name:function(B){return this.createElementNSPlus("wfs:Name",{value:B})},Value:function(D){var C;if(D instanceof OpenLayers.Feature.Vector){C=this.createElementNSPlus("wfs:Value");this.srsName=this.getSrsName(D);var B=this.writeNode("feature:_geometry",D.geometry).firstChild;C.appendChild(B)}else{C=this.createElementNSPlus("wfs:Value",{value:D})}return C},Delete:function(B){var C=this.createElementNSPlus("wfs:Delete",{attributes:{typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});if(this.featureNS){C.setAttribute("xmlns:"+this.featurePrefix,this.featureNS)}this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[B.fid]}),C);return C}}},schemaLocationAttr:function(B){B=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},B);var G=OpenLayers.Util.extend({},this.schemaLocations);if(B.schema){G[B.featurePrefix]=B.schema}var F=[];var D;for(var C in G){D=this.namespaces[C];if(D){F.push(D+" "+G[C])}}var E=F.join(" ")||undefined;return E},setFilterProperty:function(D){if(D.filters){for(var C=0,B=D.filters.length;C<B;++C){this.setFilterProperty(D.filters[C])}}else{if(D instanceof OpenLayers.Filter.Spatial){D.property=this.geometryName}}},CLASS_NAME:"OpenLayers.Format.WFST.v1"});OpenLayers.Format.WMC=OpenLayers.Class({defaultVersion:"1.1.0",version:null,layerOptions:null,layerParams:null,parser:null,initialize:function(B){OpenLayers.Util.extend(this,B);this.options=B},read:function(F,D){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var C=F.documentElement;var B=this.version;if(!B){B=C.getAttribute("version");if(!B){B=this.defaultVersion}}if(!this.parser||this.parser.VERSION!=B){var H=OpenLayers.Format.WMC["v"+B.replace(/\./g,"_")];if(!H){throw"Can't find a WMC parser for version "+B}this.parser=new H(this.options)}var E=this.parser.read(F,D);var G;if(D.map){this.context=E;if(D.map instanceof OpenLayers.Map){G=this.mergeContextToMap(E,D.map)}else{G=this.contextToMap(E,D.map)}}else{G=E}return G},contextToMap:function(B,D){var C=new OpenLayers.Map(D,{maxExtent:B.maxExtent,projection:B.projection});C.addLayers(B.layers);C.setCenter(B.bounds.getCenterLonLat(),C.getZoomForExtent(B.bounds,true));return C},mergeContextToMap:function(B,C){C.addLayers(B.layers);return C},write:function(F,C){if(F.CLASS_NAME=="OpenLayers.Map"){F=this.mapToContext(F)}var B=(C&&C.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=B){var E=OpenLayers.Format.WMC["v"+B.replace(/\./g,"_")];if(!E){throw"Can't find a WMS capabilities parser for version "+B}this.parser=new E(this.options)}var D=this.parser.write(F,C);return D},mapToContext:function(C){var B={bounds:C.getExtent(),maxExtent:C.maxExtent,projection:C.projection,layers:C.layers,size:C.getSize()};return B},CLASS_NAME:"OpenLayers.Format.WMC"});OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.XML,{initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);this.options=B},read:function(D){if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}var B={};var C=D.documentElement;this.runChildNodes(B,C);return B},runChildNodes:function(G,F){var D=F.childNodes;var C,E;for(var B=0;B<D.length;++B){C=D[B];if(C.nodeType==1){E=this["read_cap_"+C.nodeName];if(E){E.apply(this,[G,C])}}}},read_cap_Capability:function(B,D){var C={layers:[]};this.runChildNodes(C,D);B.capability=C},read_cap_Request:function(D,C){var B={};this.runChildNodes(B,C);D.request=B},read_cap_GetMap:function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.getmap=B},read_cap_Format:function(C,B){if(C.formats){C.formats.push(this.getChildValue(B))}},read_cap_DCPType:function(D,C){var B=C.getElementsByTagName("OnlineResource");if(B.length>0){this.read_cap_OnlineResource(D,B[0])}},read_cap_Service:function(C,D){var B={};this.runChildNodes(B,D);C.service=B},read_cap_Layer:function(C,F,G){var I={formats:C.request.getmap.formats||[],styles:[],queryable:(F.getAttribute("queryable")==="1"||F.getAttribute("queryable")==="true")};if(G){I.styles=I.styles.concat(G.styles);I.llbbox=G.llbbox;I.minScale=G.minScale;I.maxScale=G.maxScale}var D=F.childNodes;var B,K,E;for(var H=0;H<D.length;++H){B=D[H];K=B.nodeName;E=this["read_cap_"+B.nodeName];if(E){if(K=="Layer"){E.apply(this,[C,B,I])}else{E.apply(this,[I,B])}}}if(I.name){var J=I.name.indexOf(":");if(J>0){I.prefix=I.name.substring(0,J)}C.layers.push(I)}},read_cap_ScaleHint:function(F,G){var E=G.getAttribute("min");var B=G.getAttribute("max");var D=Math.pow(2,0.5);var C=OpenLayers.INCHES_PER_UNIT.m;F.maxScale=parseFloat(((D*E)*C*OpenLayers.DOTS_PER_INCH).toPrecision(13));F.minScale=parseFloat(((D*B)*C*OpenLayers.DOTS_PER_INCH).toPrecision(13))},read_cap_Name:function(D,C){var B=this.getChildValue(C);if(B){D.name=B}},read_cap_Title:function(C,B){var D=this.getChildValue(B);if(D){C.title=D}},read_cap_Abstract:function(D,C){var B=this.getChildValue(C);if(B){D["abstract"]=B}},read_cap_LatLonBoundingBox:function(B,C){B.llbbox=[parseFloat(C.getAttribute("minx")),parseFloat(C.getAttribute("miny")),parseFloat(C.getAttribute("maxx")),parseFloat(C.getAttribute("maxy"))]},read_cap_Style:function(B,D){var C={};this.runChildNodes(C,D);B.styles.push(C)},read_cap_LegendURL:function(D,E){var C={width:E.getAttribute("width"),height:E.getAttribute("height")};var B=E.getElementsByTagName("OnlineResource");if(B.length>0){this.read_cap_OnlineResource(C,B[0])}D.legend=C},read_cap_OnlineResource:function(C,B){C.href=this.getAttributeNS(B,"http://www.w3.org/1999/xlink","href")},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"});OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.1.1",version:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);this.options=B},read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var D=F.documentElement;var C=this.version;if(!C){C=D.getAttribute("version");if(!C){C=this.defaultVersion}}if(C=="1.1.1"||C=="1.1.0"){C="1.1"}var E=OpenLayers.Format.WMSDescribeLayer["v"+C.replace(/\./g,"_")];if(!E){throw"Can't find a WMS DescribeLayer parser for version "+C}var G=new E(this.options);var B=G.read(F);B.version=C;return B},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"});OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},gmlFormat:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,arguments);OpenLayers.Util.extend(this,B);this.options=B},read:function(F){var B;if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var C=F.documentElement;if(C){var D=this;var E=this["read_"+C.nodeName];if(E){B=E.call(this,C)}else{B=new OpenLayers.Format.GML((this.options?this.options:{})).read(F)}}else{B=F}return B},read_msGMLOutput:function(H){var E=[];var C=this.getSiblingNodesByTagCriteria(H,this.layerIdentifier);if(C){for(var I=0,L=C.length;I<L;++I){var D=C[I];var J=D.nodeName;if(D.prefix){J=J.split(":")[1]}var J=J.replace(this.layerIdentifier,"");var K=this.getSiblingNodesByTagCriteria(D,this.featureIdentifier);if(K){for(var G=0;G<K.length;G++){var B=K[G];var M=this.parseGeometry(B);var F=this.parseAttributes(B);var N=new OpenLayers.Feature.Vector(M,F,null);N.type=J;E.push(N)}}}}return E},read_FeatureInfoResponse:function(G){var D=[];var I=this.getElementsByTagNameNS(G,"*","FIELDS");for(var H=0,J=I.length;H<J;H++){var B=I[H];var K=null;var F={};for(var E=0,L=B.attributes.length;E<L;E++){var C=B.attributes[E];F[C.nodeName]=C.nodeValue}D.push(new OpenLayers.Feature.Vector(K,F,null))}return D},getSiblingNodesByTagCriteria:function(G,J){var B=[];var D,F,E,H,C;if(G&&G.hasChildNodes()){D=G.childNodes;E=D.length;for(var I=0;I<E;I++){C=D[I];while(C&&C.nodeType!=1){C=C.nextSibling;I++}F=(C?C.nodeName:"");if(F.length>0&&F.indexOf(J)>-1){B.push(C)}else{H=this.getSiblingNodesByTagCriteria(C,J);if(H.length>0){(B.length==0)?B=H:B.push(H)}}}}return B},parseAttributes:function(E){var F={};if(E.nodeType==1){var D=E.childNodes;n=D.length;for(var G=0;G<n;++G){var C=D[G];if(C.nodeType==1){var J=C.childNodes;if(J.length==1){var I=J[0];if(I.nodeType==3||I.nodeType==4){var B=(C.prefix)?C.nodeName.split(":")[1]:C.nodeName;var H=I.nodeValue.replace(this.regExes.trimSpace,"");F[B]=H}}}}}return F},parseGeometry:function(C){if(!this.gmlFormat){this.gmlFormat=new OpenLayers.Format.GML()}var B=this.gmlFormat.parseFeature(C);var D=null;if(B&&B.geometry){D=B.geometry.clone();B.destroy()}return D},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"});OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:true,"double":false,pixelTolerance:0,stopSingle:false,stopDouble:false,timerId:null,down:null,rightclickTimerId:null,initialize:function(D,C,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments);if(this.pixelTolerance!=null){this.mousedown=function(E){this.down=E.xy;return true}}},mousedown:null,mouseup:function(C){var B=true;if(this.checkModifiers(C)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(C)){B=this.rightclick(C)}return B},rightclick:function(C){if(this.passesTolerance(C)){if(this.rightclickTimerId!=null){this.clearTimer();this.callback("dblrightclick",[C]);return !this.stopDouble}else{var B=this["double"]?OpenLayers.Util.extend({},C):this.callback("rightclick",[C]);var D=OpenLayers.Function.bind(this.delayedRightCall,this,B);this.rightclickTimerId=window.setTimeout(D,this.delay)}}return !this.stopSingle},delayedRightCall:function(B){this.rightclickTimerId=null;if(B){this.callback("rightclick",[B])}return !this.stopSingle},dblclick:function(B){if(this.passesTolerance(B)){if(this["double"]){this.callback("dblclick",[B])}this.clearTimer()}return !this.stopDouble},click:function(C){if(this.passesTolerance(C)){if(this.timerId!=null){this.clearTimer()}else{var B=this.single?OpenLayers.Util.extend({},C):null;this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,B),this.delay)}}return !this.stopSingle},passesTolerance:function(C){var D=true;if(this.pixelTolerance!=null&&this.down){var B=Math.sqrt(Math.pow(this.down.x-C.xy.x,2)+Math.pow(this.down.y-C.xy.y,2));if(B>this.pixelTolerance){D=false}}return D},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}if(this.rightclickTimerId!=null){window.clearTimeout(this.rightclickTimerId);this.rightclickTimerId=null}},delayedCall:function(B){this.timerId=null;if(B){this.callback("click",[B])}},deactivate:function(){var B=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();this.down=null;B=true}return B},CLASS_NAME:"OpenLayers.Handler.Click"});OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:false,stopDown:true,dragging:false,last:null,start:null,oldOnselectstart:null,interval:0,timeoutId:null,initialize:function(D,C,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments)},down:function(B){},move:function(B){},up:function(B){},out:function(B){},mousedown:function(C){var B=true;this.dragging=false;if(this.checkModifiers(C)&&OpenLayers.Event.isLeftClick(C)){this.started=true;this.start=C.xy;this.last=C.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(C);this.callback("down",[C.xy]);OpenLayers.Event.stop(C);if(!this.oldOnselectstart){this.oldOnselectstart=(document.onselectstart)?document.onselectstart:function(){return true};document.onselectstart=function(){return false}}B=!this.stopDown}else{this.started=false;this.start=null;this.last=null}return B},mousemove:function(B){if(this.started&&!this.timeoutId&&(B.xy.x!=this.last.x||B.xy.y!=this.last.y)){if(this.interval>0){this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)}this.dragging=true;this.move(B);this.callback("move",[B.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=function(){return false}}this.last=this.evt.xy}return true},removeTimeout:function(){this.timeoutId=null},mouseup:function(C){if(this.started){var B=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.up(C);this.callback("up",[C.xy]);if(B){this.callback("done",[C.xy])}document.onselectstart=this.oldOnselectstart}return true},mouseout:function(C){if(this.started&&OpenLayers.Util.mouseLeft(C,this.map.div)){var B=(this.start!=this.last);this.started=false;this.dragging=false;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown");this.out(C);this.callback("out",[]);if(B){this.callback("done",[C.xy])}if(document.onselectstart){document.onselectstart=this.oldOnselectstart}}return true},click:function(B){return(this.start==this.last)},activate:function(){var B=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragging=false;B=true}return B},deactivate:function(){var B=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.started=false;this.dragging=false;this.start=null;this.last=null;B=true;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")}return B},CLASS_NAME:"OpenLayers.Handler.Drag"});OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:true,stopDown:true,stopUp:false,initialize:function(E,C,D,B){OpenLayers.Handler.prototype.initialize.apply(this,[E,D,B]);this.layer=C},mousedown:function(B){this.down=B.xy;return this.handle(B)?!this.stopDown:true},mouseup:function(B){this.up=B.xy;return this.handle(B)?!this.stopUp:true},click:function(B){return this.handle(B)?!this.stopClick:true},mousemove:function(B){if(!this.callbacks.over&&!this.callbacks.out){return true}this.handle(B);return true},dblclick:function(B){return !this.handle(B)},geometryTypeMatches:function(B){return this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,B.geometry.CLASS_NAME)>-1},handle:function(B){if(this.feature&&!this.feature.layer){this.feature=null}var D=B.type;var G=false;var F=!!(this.feature);var E=(D=="click"||D=="dblclick");this.feature=this.layer.getFeatureFromEvent(B);if(this.feature&&!this.feature.layer){this.feature=null}if(this.lastFeature&&!this.lastFeature.layer){this.lastFeature=null}if(this.feature){var C=(this.feature!=this.lastFeature);if(this.geometryTypeMatches(this.feature)){if(F&&C){if(this.lastFeature){this.triggerCallback(D,"out",[this.lastFeature])}this.triggerCallback(D,"in",[this.feature])}else{if(!F||E){this.triggerCallback(D,"in",[this.feature])}}this.lastFeature=this.feature;G=true}else{if(this.lastFeature&&(F&&C||E)){this.triggerCallback(D,"out",[this.lastFeature])}this.feature=null}}else{if(this.lastFeature&&(F||E)){this.triggerCallback(D,"out",[this.lastFeature])}}return G},triggerCallback:function(E,F,C){var D=this.EVENTMAP[E][F];if(D){if(E=="click"&&this.up&&this.down){var B=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));if(B<=this.clickTolerance){this.callback(D,C)}}else{this.callback(D,C)}}},activate:function(){var B=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.moveLayerToTop();this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});B=true}return B},deactivate:function(){var B=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.moveLayerBack();this.feature=null;this.lastFeature=null;this.down=null;this.up=null;this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this});B=true}return B},handleMapEvents:function(B){if(!B.property||B.property=="order"){this.moveLayerToTop()}},moveLayerToTop:function(){var B=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(B)},moveLayerBack:function(){var B=this.layer.getZIndex()-1;if(B>=this.map.Z_INDEX_BASE.Feature){this.layer.setZIndex(B)}else{this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))}},CLASS_NAME:"OpenLayers.Handler.Feature"});OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:false,px:null,timerId:null,initialize:function(D,C,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments)},mousemove:function(B){if(this.passesTolerance(B.xy)){this.clearTimer();this.callback("move",[B]);this.px=B.xy;B=OpenLayers.Util.extend({},B);this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,B),this.delay)}return !this.stopMove},mouseout:function(B){if(OpenLayers.Util.mouseLeft(B,this.map.div)){this.clearTimer();this.callback("move",[B])}return true},passesTolerance:function(C){var D=true;if(this.pixelTolerance&&this.px){var B=Math.sqrt(Math.pow(this.px.x-C.x,2)+Math.pow(this.px.y-C.y,2));if(B<this.pixelTolerance){D=false}}return D},clearTimer:function(){if(this.timerId!=null){window.clearTimeout(this.timerId);this.timerId=null}},delayedCall:function(B){this.callback("pause",[B])},deactivate:function(){var B=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.clearTimer();B=true}return B},CLASS_NAME:"OpenLayers.Handler.Hover"});OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,initialize:function(D,C,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate();this.eventListener=null;OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){for(var C=0,B=this.KEY_EVENTS.length;C<B;C++){OpenLayers.Event.observe(document,this.KEY_EVENTS[C],this.eventListener)}return true}else{return false}},deactivate:function(){var D=false;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var C=0,B=this.KEY_EVENTS.length;C<B;C++){OpenLayers.Event.stopObserving(document,this.KEY_EVENTS[C],this.eventListener)}D=true}return D},handleKeyEvent:function(B){if(this.checkModifiers(B)){this.callback(B.type,[B])}},CLASS_NAME:"OpenLayers.Handler.Keyboard"});OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,mousePosition:null,initialize:function(D,C,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments);this.wheelListener=null},onWheelEvent:function(J){if(!this.map||!this.checkModifiers(J)){return }var G=false;var K=false;var F=false;var C=OpenLayers.Event.element(J);while((C!=null)&&!F&&!G){if(!G){try{if(C.currentStyle){D=C.currentStyle.overflow}else{var B=document.defaultView.getComputedStyle(C,null);var D=B.getPropertyValue("overflow")}G=(D&&(D=="auto")||(D=="scroll"))}catch(E){}}if(!K){for(var H=0,I=this.map.layers.length;H<I;H++){if(C==this.map.layers[H].div||C==this.map.layers[H].pane){K=true;break}}}F=(C==this.map.div);C=C.parentNode}if(!G&&F){if(K){this.wheelZoom(J)}OpenLayers.Event.stop(J)}},wheelZoom:function(B){var C=0;if(!B){B=window.event}if(B.wheelDelta){C=B.wheelDelta/120;if(window.opera&&window.opera.version()<9.2){C=-C}}else{if(B.detail){C=-B.detail/3}}if(C){if(this.mousePosition){B.xy=this.mousePosition}if(!B.xy){B.xy=this.map.getPixelFromLonLat(this.map.getCenter())}if(C<0){this.callback("down",[B,C])}else{this.callback("up",[B,C])}}},mousemove:function(B){this.mousePosition=B.xy},activate:function(B){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var C=this.wheelListener;OpenLayers.Event.observe(window,"DOMMouseScroll",C);OpenLayers.Event.observe(window,"mousewheel",C);OpenLayers.Event.observe(document,"mousewheel",C);return true}else{return false}},deactivate:function(B){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var C=this.wheelListener;OpenLayers.Event.stopObserving(window,"DOMMouseScroll",C);OpenLayers.Event.stopObserving(window,"mousewheel",C);OpenLayers.Event.stopObserving(document,"mousewheel",C);return true}else{return false}},CLASS_NAME:"OpenLayers.Handler.MouseWheel"});OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:null,alwaysInRange:null,EVENT_TYPES:["loadstart","loadend","loadcancel","visibilitychanged","move","moveend"],events:null,map:null,isBaseLayer:false,alpha:false,displayInLayerSwitcher:true,visibility:true,attribution:null,inRange:false,imageSize:null,imageOffset:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:false,wrapDateLine:false,transitionEffect:null,SUPPORTED_TRANSITIONS:["resize"],initialize:function(C,B){this.addOptions(B);this.name=C;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}}if(this.wrapDateLine){this.displayOutsideMaxExtent=true}},destroy:function(B){if(B==null){B=true}if(this.map!=null){this.map.removeLayer(this,B)}this.projection=null;this.map=null;this.name=null;this.div=null;this.options=null;if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy()}this.eventListeners=null;this.events=null},clone:function(B){if(B==null){B=new OpenLayers.Layer(this.name,this.options)}OpenLayers.Util.applyDefaults(B,this);B.map=null;return B},setName:function(B){if(B!=this.name){this.name=B;if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"name"})}}},addOptions:function(B){if(this.options==null){this.options={}}OpenLayers.Util.extend(this.options,B);OpenLayers.Util.extend(this,B)},onMapResize:function(){},redraw:function(){var C=false;if(this.map){this.inRange=this.calculateInRange();var D=this.getExtent();if(D&&this.inRange&&this.visibility){var B=true;this.moveTo(D,B,false);this.events.triggerEvent("moveend",{zoomChanged:B});C=true}}return C},moveTo:function(C,B,D){var E=this.visibility;if(!this.isBaseLayer){E=E&&this.inRange}this.display(E)},setMap:function(C){if(this.map==null){this.map=C;this.maxExtent=this.maxExtent||this.map.maxExtent;this.projection=this.projection||this.map.projection;if(this.projection&&typeof this.projection=="string"){this.projection=new OpenLayers.Projection(this.projection)}this.units=this.projection.getUnits()||this.units||this.map.units;this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var B=((this.visibility)&&(this.inRange));this.div.style.display=B?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(B){},getImageSize:function(){return(this.imageSize||this.tileSize)},setTileSize:function(B){var C=(B)?B:((this.tileSize)?this.tileSize:this.map.getTileSize());this.tileSize=C;if(this.gutter){this.imageOffset=new OpenLayers.Pixel(-this.gutter,-this.gutter);this.imageSize=new OpenLayers.Size(C.w+(2*this.gutter),C.h+(2*this.gutter))}},getVisibility:function(){return this.visibility},setVisibility:function(B){if(B!=this.visibility){this.visibility=B;this.display(B);this.redraw();if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"})}this.events.triggerEvent("visibilitychanged")}},display:function(B){var C=this.calculateInRange();if(B!=(this.div.style.display!="none")){this.div.style.display=(B&&C)?"block":"none"}},calculateInRange:function(){var C=false;if(this.alwaysInRange){C=true}else{if(this.map){var B=this.map.getResolution();C=((B>=this.minResolution)&&(B<=this.maxResolution))}}return C},setIsBaseLayer:function(B){if(B!=this.isBaseLayer){this.isBaseLayer=B;if(this.map!=null){this.map.events.triggerEvent("changebaselayer",{layer:this})}}},initResolutions:function(){var N=new Array("projection","units","scales","resolutions","maxScale","minScale","maxResolution","minResolution","minExtent","maxExtent","numZoomLevels","maxZoomLevel");var C=["projection","units"];var F=false;var E={};for(var G=0,J=N.length;G<J;G++){var P=N[G];if(this.options[P]&&OpenLayers.Util.indexOf(C,P)==-1){F=true}E[P]=this.options[P]||this.map[P]}if(this.alwaysInRange==null){this.alwaysInRange=!F}if((this.options.minScale!=null||this.options.maxScale!=null)&&this.options.scales==null){E.scales=null}if((this.options.minResolution!=null||this.options.maxResolution!=null)&&this.options.resolutions==null){E.resolutions=null}if((!E.numZoomLevels)&&(E.maxZoomLevel)){E.numZoomLevels=E.maxZoomLevel+1}if((E.scales!=null)||(E.resolutions!=null)){if(E.scales!=null){E.resolutions=[];for(var G=0,J=E.scales.length;G<J;G++){var D=E.scales[G];E.resolutions[G]=OpenLayers.Util.getResolutionFromScale(D,E.units)}}E.numZoomLevels=E.resolutions.length}else{if(E.minScale){E.maxResolution=OpenLayers.Util.getResolutionFromScale(E.minScale,E.units)}else{if(E.maxResolution=="auto"){var O=this.map.getSize();var M=E.maxExtent.getWidth()/O.w;var I=E.maxExtent.getHeight()/O.h;E.maxResolution=Math.max(M,I)}}if(E.maxScale!=null){E.minResolution=OpenLayers.Util.getResolutionFromScale(E.maxScale,E.units)}else{if((E.minResolution=="auto")&&(E.minExtent!=null)){var O=this.map.getSize();var M=E.minExtent.getWidth()/O.w;var I=E.minExtent.getHeight()/O.h;E.minResolution=Math.max(M,I)}}if(E.minResolution!=null&&this.options.numZoomLevels==undefined){var L=E.maxResolution/E.minResolution;E.numZoomLevels=Math.floor(Math.log(L)/Math.log(2))+1}E.resolutions=new Array(E.numZoomLevels);var B=2;if(typeof E.minResolution=="number"&&E.numZoomLevels>1){B=Math.pow((E.maxResolution/E.minResolution),(1/(E.numZoomLevels-1)))}for(var G=0;G<E.numZoomLevels;G++){var K=E.maxResolution/Math.pow(B,G);E.resolutions[G]=K}}E.resolutions.sort(function(R,Q){return(Q-R)});this.resolutions=E.resolutions;this.maxResolution=E.resolutions[0];var H=E.resolutions.length-1;this.minResolution=E.resolutions[H];this.scales=[];for(var G=0,J=E.resolutions.length;G<J;G++){this.scales[G]=OpenLayers.Util.getScaleFromResolution(E.resolutions[G],E.units)}this.minScale=this.scales[0];this.maxScale=this.scales[this.scales.length-1];this.numZoomLevels=E.numZoomLevels},getResolution:function(){var B=this.map.getZoom();return this.getResolutionForZoom(B)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(C,D){var E=this.map.getSize();var B=Math.max(C.getWidth()/E.w,C.getHeight()/E.h);return this.getZoomForResolution(B,D)},getDataExtent:function(){},getResolutionForZoom:function(D){D=Math.max(0,Math.min(D,this.resolutions.length-1));var C;if(this.map.fractionalZoom){var B=Math.floor(D);var E=Math.ceil(D);C=this.resolutions[B]-((D-B)*(this.resolutions[B]-this.resolutions[E]))}else{C=this.resolutions[Math.round(D)]}return C},getZoomForResolution:function(F,B){var N;if(this.map.fractionalZoom){var K=0;var D=this.resolutions.length-1;var E=this.resolutions[K];var C=this.resolutions[D];var J;for(var G=0,H=this.resolutions.length;G<H;++G){J=this.resolutions[G];if(J>=F){E=J;K=G}if(J<=F){C=J;D=G;break}}var I=E-C;if(I>0){N=K+((E-F)/I)}else{N=K}}else{var L;var M=Number.POSITIVE_INFINITY;for(var G=0,H=this.resolutions.length;G<H;G++){if(B){L=Math.abs(this.resolutions[G]-F);if(L>M){break}M=L}else{if(this.resolutions[G]<F){break}}}N=Math.max(0,G-1)}return N},getLonLatFromViewPortPx:function(C){var F=null;if(C!=null){var E=this.map.getSize();var B=this.map.getCenter();if(B){var D=this.map.getResolution();var H=C.x-(E.w/2);var G=C.y-(E.h/2);F=new OpenLayers.LonLat(B.lon+H*D,B.lat-G*D);if(this.wrapDateLine){F=F.wrapDateLine(this.maxExtent)}}}return F},getViewPortPxFromLonLat:function(E){var C=null;if(E!=null){var B=this.map.getResolution();var D=this.map.getExtent();C=new OpenLayers.Pixel((1/B*(E.lon-D.left)),(1/B*(D.top-E.lat)))}return C},setOpacity:function(C){if(C!=this.opacity){this.opacity=C;for(var E=0,B=this.div.childNodes.length;E<B;++E){var D=this.div.childNodes[E].firstChild;OpenLayers.Util.modifyDOMElement(D,null,null,null,null,null,null,C)}}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(B){this.div.style.zIndex=B},adjustBounds:function(C){if(this.gutter){var B=this.gutter*this.map.getResolution();C=new OpenLayers.Bounds(C.left-B,C.bottom-B,C.right+B,C.top+B)}if(this.wrapDateLine){var D={rightTolerance:this.getResolution()};C=C.wrapDateLine(this.maxExtent,D)}return C},CLASS_NAME:"OpenLayers.Layer"});OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(C,D,B){this.bounds=C;this.div=OpenLayers.Util.createDiv();this.div.style.overflow="hidden";this.events=new OpenLayers.Events(this,this.div,null);this.setBorder(D,B)},destroy:function(){this.bounds=null;this.div=null;OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(B,C){if(!B){B="red"}if(!C){C=2}this.div.style.border=C+"px solid "+B},draw:function(B,C){OpenLayers.Util.modifyDOMElement(this.div,null,B,C);return this.div},onScreen:function(){var C=false;if(this.map){var B=this.map.getExtent();C=B.containsBounds(this.bounds,true,true)}return C},display:function(B){this.div.style.display=(B)?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"});(function(){var E=window.XMLHttpRequest;var I=!!window.controllers,F=window.document.all&&!window.opera;function D(){this._object=E?new E:new window.ActiveXObject("Microsoft.XMLHTTP")}if(I&&E.wrapped){D.wrapped=E.wrapped}D.UNSENT=0;D.OPENED=1;D.HEADERS_RECEIVED=2;D.LOADING=3;D.DONE=4;D.prototype.readyState=D.UNSENT;D.prototype.responseText="";D.prototype.responseXML=null;D.prototype.status=0;D.prototype.statusText="";D.prototype.onreadystatechange=null;D.onreadystatechange=null;D.onopen=null;D.onsend=null;D.onabort=null;D.prototype.open=function(M,P,L,Q,K){this._async=L;var O=this,N=this.readyState;if(F){var J=function(){if(O._object.readyState!=D.DONE){B(O)}};if(L){window.attachEvent("onunload",J)}}this._object.onreadystatechange=function(){if(I&&!L){return }O.readyState=O._object.readyState;H(O);if(O._aborted){O.readyState=D.UNSENT;return }if(O.readyState==D.DONE){B(O);if(F&&L){window.detachEvent("onunload",J)}}if(N!=O.readyState){G(O)}N=O.readyState};if(D.onopen){D.onopen.apply(this,arguments)}this._object.open(M,P,L,Q,K);if(!L&&I){this.readyState=D.OPENED;G(this)}};D.prototype.send=function(J){if(D.onsend){D.onsend.apply(this,arguments)}if(J&&J.nodeType){J=window.XMLSerializer?new window.XMLSerializer().serializeToString(J):J.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._object.send(J);if(I&&!this._async){this.readyState=D.OPENED;H(this);while(this.readyState<D.DONE){this.readyState++;G(this);if(this._aborted){return }}}};D.prototype.abort=function(){if(D.onabort){D.onabort.apply(this,arguments)}if(this.readyState>D.UNSENT){this._aborted=true}this._object.abort();B(this)};D.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};D.prototype.getResponseHeader=function(J){return this._object.getResponseHeader(J)};D.prototype.setRequestHeader=function(J,K){if(!this._headers){this._headers={}}this._headers[J]=K;return this._object.setRequestHeader(J,K)};D.prototype.toString=function(){return"[object XMLHttpRequest]"};D.toString=function(){return"[XMLHttpRequest]"};function G(J){if(J.onreadystatechange){J.onreadystatechange.apply(J)}if(D.onreadystatechange){D.onreadystatechange.apply(J)}}function C(K){var J=K.responseXML;if(F&&J&&!J.documentElement&&K.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)){J=new ActiveXObject("Microsoft.XMLDOM");J.loadXML(K.responseText)}if(J){if((F&&J.parseError!=0)||(J.documentElement&&J.documentElement.tagName=="parsererror")){return null}}return J}function H(J){try{J.responseText=J._object.responseText}catch(K){}try{J.responseXML=C(J._object)}catch(K){}try{J.status=J._object.status}catch(K){}try{J.statusText=J._object.statusText}catch(K){}}function B(J){J._object.onreadystatechange=new window.Function;delete J._headers}if(!window.Function.prototype.apply){window.Function.prototype.apply=function(J,K){if(!K){K=[]}J.__func=this;J.__func(K[0],K[1],K[2],K[3],K[4]);delete J.__func}}OpenLayers.Request.XMLHttpRequest=D})();OpenLayers.ProxyHost="";OpenLayers.nullHandler=function(B){OpenLayers.Console.userError(OpenLayers.i18n("unhandledRequest",{statusText:B.statusText}))};OpenLayers.loadURL=function(E,H,C,F,D){if(typeof H=="string"){H=OpenLayers.Util.getParameters(H)}var G=(F)?F:OpenLayers.nullHandler;var B=(D)?D:OpenLayers.nullHandler;return OpenLayers.Request.GET({url:E,params:H,success:G,failure:B,scope:C})};OpenLayers.parseXMLString=function(D){var B=D.indexOf("<");if(B>0){D=D.substring(B)}var C=OpenLayers.Util.Try(function(){var E=new ActiveXObject("Microsoft.XMLDOM");E.loadXML(D);return E},function(){return new DOMParser().parseFromString(D,"text/xml")},function(){var E=new XMLHttpRequest();E.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(D),false);if(E.overrideMimeType){E.overrideMimeType("text/xml")}E.send(null);return E.responseXML});return C};OpenLayers.Ajax={emptyFunction:function(){},getTransport:function(){return OpenLayers.Util.Try(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||false},activeRequestCount:0};OpenLayers.Ajax.Responders={responders:[],register:function(C){for(var B=0;B<this.responders.length;B++){if(C==this.responders[B]){return }}this.responders.push(C)},unregister:function(B){OpenLayers.Util.removeItem(this.reponders,B)},dispatch:function(G,D,F){var B;for(var C=0;C<this.responders.length;C++){B=this.responders[C];if(B[G]&&typeof B[G]=="function"){try{B[G].apply(B,[D,F])}catch(E){}}}}};OpenLayers.Ajax.Responders.register({onCreate:function(){OpenLayers.Ajax.activeRequestCount++},onComplete:function(){OpenLayers.Ajax.activeRequestCount--}});OpenLayers.Ajax.Base=OpenLayers.Class({initialize:function(B){this.options={method:"post",asynchronous:true,contentType:"application/xml",parameters:""};OpenLayers.Util.extend(this.options,B||{});this.options.method=this.options.method.toLowerCase();if(typeof this.options.parameters=="string"){this.options.parameters=OpenLayers.Util.getParameters(this.options.parameters)}}});OpenLayers.Ajax.Request=OpenLayers.Class(OpenLayers.Ajax.Base,{_complete:false,initialize:function(C,B){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[B]);if(OpenLayers.ProxyHost&&OpenLayers.String.startsWith(C,"http")){C=OpenLayers.ProxyHost+encodeURIComponent(C)}this.transport=OpenLayers.Ajax.getTransport();this.request(C)},request:function(C){this.url=C;this.method=this.options.method;var E=OpenLayers.Util.extend({},this.options.parameters);if(this.method!="get"&&this.method!="post"){E._method=this.method;this.method="post"}this.parameters=E;if(E=OpenLayers.Util.getParameterString(E)){if(this.method=="get"){this.url+=((this.url.indexOf("?")>-1)?"&":"?")+E}else{if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){E+="&_="}}}try{var B=new OpenLayers.Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(B)}OpenLayers.Ajax.Responders.dispatch("onCreate",this,B);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){window.setTimeout(OpenLayers.Function.bind(this.respondToReadyState,this,1),10)}this.transport.onreadystatechange=OpenLayers.Function.bind(this.onStateChange,this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||E):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange()}}catch(D){this.dispatchException(D)}},onStateChange:function(){var B=this.transport.readyState;if(B>1&&!((B==4)&&this._complete)){this.respondToReadyState(this.transport.readyState)}},setRequestHeaders:function(){var F={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",OpenLayers:true};if(this.method=="post"){F["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){F.Connection="close"}}if(typeof this.options.requestHeaders=="object"){var D=this.options.requestHeaders;if(typeof D.push=="function"){for(var C=0,E=D.length;C<E;C+=2){F[D[C]]=D[C+1]}}else{for(var C in D){F[C]=D[C]}}}for(var B in F){this.transport.setRequestHeader(B,F[B])}},success:function(){var B=this.getStatus();return !B||(B>=200&&B<300)},getStatus:function(){try{return this.transport.status||0}catch(B){return 0}},respondToReadyState:function(B){var D=OpenLayers.Ajax.Request.Events[B];var C=new OpenLayers.Ajax.Response(this);if(D=="Complete"){try{this._complete=true;(this.options["on"+C.status]||this.options["on"+(this.success()?"Success":"Failure")]||OpenLayers.Ajax.emptyFunction)(C)}catch(E){this.dispatchException(E)}var F=C.getHeader("Content-type")}try{(this.options["on"+D]||OpenLayers.Ajax.emptyFunction)(C);OpenLayers.Ajax.Responders.dispatch("on"+D,this,C)}catch(E){this.dispatchException(E)}if(D=="Complete"){this.transport.onreadystatechange=OpenLayers.Ajax.emptyFunction}},getHeader:function(B){try{return this.transport.getResponseHeader(B)}catch(C){return null}},dispatchException:function(D){var E=this.options.onException;if(E){E(this,D);OpenLayers.Ajax.Responders.dispatch("onException",this,D)}else{var F=false;var B=OpenLayers.Ajax.Responders.responders;for(var C=0;C<B.length;C++){if(B[C].onException){F=true;break}}if(F){OpenLayers.Ajax.Responders.dispatch("onException",this,D)}else{throw D}}}});OpenLayers.Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];OpenLayers.Ajax.Response=OpenLayers.Class({status:0,statusText:"",initialize:function(D){this.request=D;var E=this.transport=D.transport,B=this.readyState=E.readyState;if((B>2&&!(!!(window.attachEvent&&!window.opera)))||B==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=E.responseText==null?"":String(E.responseText)}if(B==4){var C=E.responseXML;this.responseXML=C===undefined?null:C}},getStatus:OpenLayers.Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||""}catch(B){return""}},getHeader:OpenLayers.Ajax.Request.prototype.getHeader,getResponseHeader:function(B){return this.transport.getResponseHeader(B)}});OpenLayers.Ajax.getElementsByTagNameNS=function(C,B,D,F){var E=null;if(C.getElementsByTagNameNS){E=C.getElementsByTagNameNS(B,F)}else{E=C.getElementsByTagName(D+":"+F)}return E};OpenLayers.Ajax.serializeXMLToString=function(B){var C=new XMLSerializer();var D=C.serializeToString(B);return D};OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(C,B){},onDrag:function(C,B){},onComplete:function(C,B){},layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(C,B){OpenLayers.Control.prototype.initialize.apply(this,[B]);this.layer=C;this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks)),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},destroy:function(){this.layer=null;OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments))},deactivate:function(){this.handlers.drag.deactivate();this.handlers.feature.deactivate();this.feature=null;this.dragging=false;this.lastPixel=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(B){if(!this.handlers.drag.dragging){this.feature=B;this.handlers.drag.activate();this.over=true;OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over")}else{if(this.feature.id==B.id){this.over=true}else{this.over=false}}},downFeature:function(B){this.lastPixel=B;this.onStart(this.feature,B)},moveFeature:function(B){var C=this.map.getResolution();this.feature.geometry.move(C*(B.x-this.lastPixel.x),C*(this.lastPixel.y-B.y));this.layer.drawFeature(this.feature);this.lastPixel=B;this.onDrag(this.feature,B)},upFeature:function(B){if(!this.over){this.handlers.drag.deactivate()}},doneDragging:function(B){this.onComplete(this.feature,B)},outFeature:function(B){if(!this.handlers.drag.dragging){this.over=false;this.handlers.drag.deactivate();OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over");this.feature=null}else{if(this.feature.id==B.id){this.over=false}}},cancel:function(){this.handlers.drag.deactivate();this.over=false},setMap:function(B){this.handlers.drag.setMap(B);this.handlers.feature.setMap(B);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"});OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:false,interval:25,draw:function(){this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone},{interval:this.interval})},panMap:function(B){this.panned=true;this.map.pan(this.handler.last.x-B.x,this.handler.last.y-B.y,{dragging:this.handler.dragging,animate:false})},panMapDone:function(B){if(this.panned){this.panMap(B);this.panned=false}},CLASS_NAME:"OpenLayers.Control.DragPan"});OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{slideFactor:75,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.handler){this.handler.destroy()}this.handler=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress});this.activate()},defaultKeyPress:function(B){switch(B.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:var C=this.map.getSize();this.map.pan(0,-0.75*C.h);break;case 34:var C=this.map.getSize();this.map.pan(0,0.75*C.h);break;case 35:var C=this.map.getSize();this.map.pan(0.75*C.w,0);break;case 36:var C=this.map.getSize();this.map.pan(-0.75*C.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"});OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:false,maxFeatures:10,layers:null,queryVisible:false,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handlerOptions:null,handler:null,hoverRequest:null,EVENT_TYPES:["getfeatureinfo"],initialize:function(B){this.EVENT_TYPES=OpenLayers.Control.WMSGetFeatureInfo.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);B=B||{};B.handlerOptions=B.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[B]);if(!this.format){this.format=new OpenLayers.Format.WMSGetFeatureInfo(B.formatOptions)}if(this.hover){this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}))}else{this.handler=new OpenLayers.Handler.Click(this,{click:this.getInfoForClick},this.handlerOptions.click||{})}},activate:function(){if(!this.active){this.handler.activate()}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},getInfoForClick:function(B){OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");this.request(B.xy,{})},getInfoForHover:function(B){this.request(B.xy,{hover:true})},cancelHover:function(){if(this.hoverRequest){this.hoverRequest.abort();this.hoverRequest=null}},findLayers:function(){var G=[];var F=this.layers||this.map.layers;var E,C;for(var D=0,B=F.length;D<B;++D){E=F[D];if(E instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||E.getVisibility())){C=E.url instanceof Array?E.url[0]:E.url;if(!this.url){this.url=C}if(this.urlMatches(C)){G.push(E)}}}return G},urlMatches:function(C){var E=OpenLayers.Util.isEquivalentUrl(this.url,C);if(!E&&this.layerUrls){for(var D=0,B=this.layerUrls.length;D<B;++D){if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[D],C)){E=true;break}}}return E},request:function(B,J){J=J||{};var G=[];var H=[];var D=this.findLayers();if(D.length>0){for(var E=0,F=D.length;E<F;E++){G=G.concat(D[E].params.LAYERS);if(D[E].params.STYLES){H=H.concat(D[E].params.STYLES)}else{if(D[E].params.LAYERS instanceof Array){H=H.concat(new Array(D[E].params.LAYERS.length))}else{H=H.concat(D[E].params.LAYERS.replace(/[^,]/g,""))}}}var I={url:this.url,params:OpenLayers.Util.applyDefaults({service:"WMS",version:"1.1.0",request:"GetFeatureInfo",layers:G,query_layers:G,styles:H,bbox:this.map.getExtent().toBBOX(),srs:this.map.getProjection(),feature_count:this.maxFeatures,x:B.x,y:B.y,height:this.map.getSize().h,width:this.map.getSize().w,info_format:this.infoFormat},this.vendorParams),callback:function(K){this.handleResponse(B,K)},scope:this};var C=OpenLayers.Request.GET(I);if(J.hover===true){this.hoverRequest=C.priv}}else{OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")}},handleResponse:function(E,C){var D=C.responseXML;if(!D||!D.documentElement){D=C.responseText}var B=this.format.read(D);this.events.triggerEvent("getfeatureinfo",{text:C.responseText,features:B,request:C,xy:E});OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},setMap:function(B){this.handler.setMap(B);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"});OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"};OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,renderIntent:"default",initialize:function(D,B,C){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,B]);this.lonlat=null;this.geometry=D?D:null;this.state=null;this.attributes={};if(B){this.attributes=OpenLayers.Util.extend(this.attributes,B)}this.style=C?C:null},destroy:function(){if(this.layer){this.layer.removeFeatures(this);this.layer=null}this.geometry=null;OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(E){var D=false;if(this.layer&&this.layer.map){var B=this.layer.map.getExtent();if(E){var C=this.geometry.getBounds();D=B.intersectsBounds(C)}else{var F=B.toGeometry();D=F.intersects(this.geometry)}}return D},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(C,E,D){var B=false;if(this.geometry){B=this.geometry.atPoint(C,E,D)}return B},destroyPopup:function(){},move:function(B){if(!this.layer||!this.geometry.move){return }var C;if(B.CLASS_NAME=="OpenLayers.LonLat"){C=this.layer.getViewPortPxFromLonLat(B)}else{C=B}var E=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat());var D=this.layer.map.getResolution();this.geometry.move(D*(C.x-E.x),D*(E.y-C.y));this.layer.drawFeature(this);return E},toState:function(B){if(B==OpenLayers.State.UPDATE){switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=B;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:break}}else{if(B==OpenLayers.State.INSERT){switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=B;break}}else{if(B==OpenLayers.State.DELETE){switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=B;break}}else{if(B==OpenLayers.State.UNKNOWN){this.state=B}}}}},CLASS_NAME:"OpenLayers.Feature.Vector"});OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},select:{fillColor:"blue",fillOpacity:0.4,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer"},temporary:{fillColor:"#66cccc",fillOpacity:0.2,hoverFillColor:"white",hoverFillOpacity:0.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:0.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit"},"delete":{display:"none"}};OpenLayers.Feature.WFS=OpenLayers.Class(OpenLayers.Feature,{initialize:function(D,C){var B=arguments;var E=this.processXMLNode(C);B=new Array(D,E.lonlat,E);OpenLayers.Feature.prototype.initialize.apply(this,B);this.createMarker();this.layer.addMarker(this.marker)},destroy:function(){if(this.marker!=null){this.layer.removeMarker(this.marker)}OpenLayers.Feature.prototype.destroy.apply(this,arguments)},processXMLNode:function(C){var B=OpenLayers.Ajax.getElementsByTagNameNS(C,"http://www.opengis.net/gml","gml","Point");var E=OpenLayers.Util.getXmlNodeValue(OpenLayers.Ajax.getElementsByTagNameNS(B[0],"http://www.opengis.net/gml","gml","coordinates")[0]);var D=E.split(",");return{lonlat:new OpenLayers.LonLat(parseFloat(D[0]),parseFloat(D[1])),id:null}},CLASS_NAME:"OpenLayers.Feature.WFS"});OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.WFSCapabilities,{initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);this.options=B},read:function(D){if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}var B={};var C=D.documentElement;this.runChildNodes(B,C);return B},runChildNodes:function(G,F){var D=F.childNodes;var C,E;for(var B=0;B<D.length;++B){C=D[B];if(C.nodeType==1){E=this["read_cap_"+C.nodeName];if(E){E.apply(this,[G,C])}}}},read_cap_FeatureTypeList:function(D,C){var B={featureTypes:[]};this.runChildNodes(B,C);D.featureTypeList=B},read_cap_FeatureType:function(B,E,C){var D={};this.runChildNodes(D,E);B.featureTypes.push(D)},read_cap_Name:function(D,C){var B=this.getChildValue(C);if(B){D.name=B}},read_cap_Title:function(C,B){var D=this.getChildValue(B);if(D){C.title=D}},read_cap_Abstract:function(D,C){var B=this.getChildValue(C);if(B){D["abstract"]=B}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"});OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(B){var C=null;if(B==null){C=this.namespaces[this.defaultPrefix]}else{for(C in this.namespaces){if(this.namespaces[C]==B){break}}}return C},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(D){if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}var B=D.documentElement;this.rootPrefix=B.prefix;var C={version:B.getAttribute("version")};this.runChildNodes(C,B);return C},runChildNodes:function(F,E){var C=E.childNodes;var B,D,H,J;for(var G=0,I=C.length;G<I;++G){B=C[G];if(B.nodeType==1){H=this.getNamespacePrefix(B.namespaceURI);J=B.nodeName.split(":").pop();D=this["read_"+H+"_"+J];if(D){D.apply(this,[F,B])}}}},read_wmc_General:function(B,C){this.runChildNodes(B,C)},read_wmc_BoundingBox:function(B,C){B.projection=C.getAttribute("SRS");B.bounds=new OpenLayers.Bounds(parseFloat(C.getAttribute("minx")),parseFloat(C.getAttribute("miny")),parseFloat(C.getAttribute("maxx")),parseFloat(C.getAttribute("maxy")))},read_wmc_LayerList:function(B,C){B.layers=[];this.runChildNodes(B,C)},read_wmc_Layer:function(C,D){var E={params:this.layerParams||{},options:{visibility:(D.getAttribute("hidden")!="1"),queryable:(D.getAttribute("queryable")=="1")},formats:[],styles:[]};this.runChildNodes(E,D);E.params.layers=E.name;E.options.maxExtent=E.maxExtent;var B=this.getLayerFromInfo(E);C.layers.push(B)},getLayerFromInfo:function(D){var B=D.options;if(this.layerOptions){OpenLayers.Util.applyDefaults(B,this.layerOptions)}var C=new OpenLayers.Layer.WMS(D.title,D.href,D.params,B);return C},read_wmc_Extension:function(C,B){this.runChildNodes(C,B)},read_ol_units:function(C,B){C.options.units=this.getChildValue(B)},read_ol_maxExtent:function(D,C){var B=new OpenLayers.Bounds(C.getAttribute("minx"),C.getAttribute("miny"),C.getAttribute("maxx"),C.getAttribute("maxy"));D.maxExtent=B},read_ol_transparent:function(C,B){C.params.transparent=this.getChildValue(B)},read_ol_numZoomLevels:function(C,B){C.options.numZoomLevels=parseInt(this.getChildValue(B))},read_ol_opacity:function(C,B){C.options.opacity=parseFloat(this.getChildValue(B))},read_ol_singleTile:function(C,B){C.options.singleTile=(this.getChildValue(B)=="true")},read_ol_isBaseLayer:function(C,B){C.options.isBaseLayer=(this.getChildValue(B)=="true")},read_ol_displayInLayerSwitcher:function(C,B){C.options.displayInLayerSwitcher=(this.getChildValue(B)=="true")},read_wmc_Server:function(C,B){C.params.version=B.getAttribute("version");this.runChildNodes(C,B)},read_wmc_FormatList:function(C,B){this.runChildNodes(C,B)},read_wmc_Format:function(D,B){var C=this.getChildValue(B);D.formats.push(C);if(B.getAttribute("current")=="1"){D.params.format=C}},read_wmc_StyleList:function(C,B){this.runChildNodes(C,B)},read_wmc_Style:function(D,C){var B={};this.runChildNodes(B,C);if(C.getAttribute("current")=="1"){if(B.href){D.params.sld=B.href}else{if(B.body){D.params.sld_body=B.body}else{D.params.styles=B.name}}}D.styles.push(B)},read_wmc_SLD:function(B,C){this.runChildNodes(B,C)},read_sld_StyledLayerDescriptor:function(D,C){var B=OpenLayers.Format.XML.prototype.write.apply(this,[C]);D.body=B},read_wmc_OnlineResource:function(C,B){C.href=this.getAttributeNS(B,this.namespaces.xlink,"href")},read_wmc_Name:function(D,C){var B=this.getChildValue(C);if(B){D.name=B}},read_wmc_Title:function(C,B){var D=this.getChildValue(B);if(D){C.title=D}},read_wmc_MetadataURL:function(D,C){var E={};var B=C.getElementsByTagName("OnlineResource");if(B.length>0){this.read_wmc_OnlineResource(E,B[0])}D.options.metadataURL=E.href},read_wmc_Abstract:function(D,C){var B=this.getChildValue(C);if(B){D["abstract"]=B}},read_wmc_LatLonBoundingBox:function(B,C){B.llbbox=[parseFloat(C.getAttribute("minx")),parseFloat(C.getAttribute("miny")),parseFloat(C.getAttribute("maxx")),parseFloat(C.getAttribute("maxy"))]},read_wmc_LegendURL:function(D,E){var C={width:E.getAttribute("width"),height:E.getAttribute("height")};var B=E.getElementsByTagName("OnlineResource");if(B.length>0){this.read_wmc_OnlineResource(C,B[0])}D.legend=C},write:function(D,C){var B=this.createElementDefaultNS("ViewContext");this.setAttributes(B,{version:this.VERSION,id:(C&&typeof C.id=="string")?C.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")});this.setAttributeNS(B,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);B.appendChild(this.write_wmc_General(D));B.appendChild(this.write_wmc_LayerList(D));return OpenLayers.Format.XML.prototype.write.apply(this,[B])},createElementDefaultNS:function(D,C,B){var E=this.createElementNS(this.namespaces[this.defaultPrefix],D);if(C){E.appendChild(this.createTextNode(C))}if(B){this.setAttributes(E,B)}return E},setAttributes:function(C,E){var D;for(var B in E){D=E[B].toString();if(D.match(/[A-Z]/)){this.setAttributeNS(C,null,B,D)}else{C.setAttribute(B,D)}}},write_wmc_General:function(B){var D=this.createElementDefaultNS("General");if(B.size){D.appendChild(this.createElementDefaultNS("Window",null,{width:B.size.w,height:B.size.h}))}var C=B.bounds;D.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:C.left.toPrecision(10),miny:C.bottom.toPrecision(10),maxx:C.right.toPrecision(10),maxy:C.top.toPrecision(10),SRS:B.projection}));D.appendChild(this.createElementDefaultNS("Title",B.title));D.appendChild(this.write_ol_MapExtension(B));return D},write_ol_MapExtension:function(C){var E=this.createElementDefaultNS("Extension");var D=C.maxExtent;if(D){var B=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(B,{minx:D.left.toPrecision(10),miny:D.bottom.toPrecision(10),maxx:D.right.toPrecision(10),maxy:D.top.toPrecision(10)});E.appendChild(B)}return E},write_wmc_LayerList:function(E){var F=this.createElementDefaultNS("LayerList");var D;for(var C=0,B=E.layers.length;C<B;++C){D=E.layers[C];if(D instanceof OpenLayers.Layer.WMS){F.appendChild(this.write_wmc_Layer(D))}}return F},write_wmc_Layer:function(B){var C=this.createElementDefaultNS("Layer",null,{queryable:B.queryable?"1":"0",hidden:B.visibility?"0":"1"});C.appendChild(this.write_wmc_Server(B));C.appendChild(this.createElementDefaultNS("Name",B.params.LAYERS));C.appendChild(this.createElementDefaultNS("Title",B.name));if(B.metadataURL){C.appendChild(this.write_wmc_MetadataURL(B))}C.appendChild(this.write_wmc_FormatList(B));C.appendChild(this.write_wmc_StyleList(B));C.appendChild(this.write_wmc_LayerExtension(B));return C},write_wmc_LayerExtension:function(G){var E=this.createElementDefaultNS("Extension");var B=G.maxExtent;var J=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(J,{minx:B.left.toPrecision(10),miny:B.bottom.toPrecision(10),maxx:B.right.toPrecision(10),maxy:B.top.toPrecision(10)});E.appendChild(J);var D=G.params.TRANSPARENT;if(D){var K=this.createElementNS(this.namespaces.ol,"ol:transparent");K.appendChild(this.createTextNode(D));E.appendChild(K)}var I=["numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"];var C;for(var F=0,H=I.length;F<H;++F){C=this.createOLPropertyNode(G,I[F]);if(C){E.appendChild(C)}}return E},createOLPropertyNode:function(C,D){var B=null;if(C[D]!=null){B=this.createElementNS(this.namespaces.ol,"ol:"+D);B.appendChild(this.createTextNode(C[D].toString()))}return B},write_wmc_Server:function(B){var C=this.createElementDefaultNS("Server");this.setAttributes(C,{service:"OGC:WMS",version:B.params.VERSION});C.appendChild(this.write_wmc_OnlineResource(B.url));return C},write_wmc_MetadataURL:function(B){var C=this.createElementDefaultNS("MetadataURL");C.appendChild(this.write_wmc_OnlineResource(B.metadataURL));return C},write_wmc_FormatList:function(B){var C=this.createElementDefaultNS("FormatList");C.appendChild(this.createElementDefaultNS("Format",B.params.FORMAT,{current:"1"}));return C},write_wmc_StyleList:function(F){var E=this.createElementDefaultNS("StyleList");var D=this.createElementDefaultNS("Style",null,{current:"1"});if(F.params.SLD){var C=this.createElementDefaultNS("SLD");var H=this.write_wmc_OnlineResource(F.params.SLD);C.appendChild(H);D.appendChild(C)}else{if(F.params.SLD_BODY){var C=this.createElementDefaultNS("SLD");var G=F.params.SLD_BODY;var I=OpenLayers.Format.XML.prototype.read.apply(this,[G]);var J=I.documentElement;if(C.ownerDocument&&C.ownerDocument.importNode){J=C.ownerDocument.importNode(J,true)}C.appendChild(J);D.appendChild(C)}else{var B=F.params.STYLES?F.params.STYLES:this.defaultStyleName;D.appendChild(this.createElementDefaultNS("Name",B));D.appendChild(this.createElementDefaultNS("Title",this.defaultStyleTitle))}}E.appendChild(D);return E},write_wmc_OnlineResource:function(B){var C=this.createElementDefaultNS("OnlineResource");this.setAttributeNS(C,this.namespaces.xlink,"xlink:type","simple");this.setAttributeNS(C,this.namespaces.xlink,"xlink:href",B);return C},CLASS_NAME:"OpenLayers.Format.WMC.v1"});OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",initialize:function(B){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[B])},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"});OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",initialize:function(B){OpenLayers.Format.WMSCapabilities.v1_1.prototype.initialize.apply(this,[B])},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"});OpenLayers.Format.WMSDescribeLayer.v1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(B){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[B])},read:function(H){if(typeof H=="string"){H=OpenLayers.Format.XML.prototype.read.apply(this,[H])}var C=H.documentElement;var F=C.childNodes;var B=[];for(var E=0;E<F.length;++E){childNode=F[E];nodeName=childNode.nodeName;if(nodeName=="LayerDescription"){var I="";var G="";var D="";if(childNode.getAttribute("owsType")){I=childNode.getAttribute("owsType");G=childNode.getAttribute("owsURL")}else{if(childNode.getAttribute("wfs")!=""){I="WFS";G=childNode.getAttribute("wfs")}else{if(childNode.getAttribute("wcs")!=""){I="WCS";G=childNode.getAttribute("wcs")}}}query=childNode.getElementsByTagName("Query");if(query.length>0){D=query[0].getAttribute("typeName");if(!D){D=query[0].getAttribute("typename")}}B.push({owsType:I,owsURL:G,typeName:D})}}return B},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1"});OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxCharacteristics:null,initialize:function(D,C,B){OpenLayers.Handler.prototype.initialize.apply(this,arguments);var C={down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox};this.dragHandler=new OpenLayers.Handler.Drag(this,C,{keyMask:this.keyMask})},setMap:function(B){OpenLayers.Handler.prototype.setMap.apply(this,arguments);if(this.dragHandler){this.dragHandler.setMap(B)}},startBox:function(B){this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.dragHandler.start);this.zoomBox.className=this.boxDivClassName;this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(G){var E=this.dragHandler.start.x;var C=this.dragHandler.start.y;var D=Math.abs(E-G.x);var B=Math.abs(C-G.y);this.zoomBox.style.width=Math.max(1,D)+"px";this.zoomBox.style.height=Math.max(1,B)+"px";this.zoomBox.style.left=G.x<E?G.x+"px":E+"px";this.zoomBox.style.top=G.y<C?G.y+"px":C+"px";var F=this.getBoxCharacteristics();if(F.newBoxModel){if(G.x>E){this.zoomBox.style.width=Math.max(1,D-F.xOffset)+"px"}if(G.y>C){this.zoomBox.style.height=Math.max(1,B-F.yOffset)+"px"}}},endBox:function(C){var B;if(Math.abs(this.dragHandler.start.x-C.x)>5||Math.abs(this.dragHandler.start.y-C.y)>5){var H=this.dragHandler.start;var G=Math.min(H.y,C.y);var D=Math.max(H.y,C.y);var F=Math.min(H.x,C.x);var E=Math.max(H.x,C.x);B=new OpenLayers.Bounds(F,D,E,G)}else{B=this.dragHandler.start.clone()}this.removeBox();this.callback("done",[B])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox);this.zoomBox=null;this.boxCharacteristics=null;OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.dragHandler.activate();return true}else{return false}},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){this.dragHandler.deactivate();return true}else{return false}},getBoxCharacteristics:function(){if(!this.boxCharacteristics){var B=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width"))+1;var D=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"))+1;var C=OpenLayers.Util.getBrowserName()=="msie"?document.compatMode!="BackCompat":true;this.boxCharacteristics={xOffset:B,yOffset:D,newBoxModel:C}}return this.boxCharacteristics},CLASS_NAME:"OpenLayers.Handler.Box"});OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",persist:false,irregular:false,angle:null,fixedRadius:false,feature:null,layer:null,origin:null,initialize:function(D,C,B){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{});OpenLayers.Handler.prototype.initialize.apply(this,[D,C,B]);this.options=(B)?B:new Object()},setOptions:function(B){OpenLayers.Util.extend(this.options,B);OpenLayers.Util.extend(this,B)},activate:function(){var B=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var C={displayInLayerSwitcher:false,calculateInRange:function(){return true}};this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,C);this.map.addLayer(this.layer);B=true}return B},deactivate:function(){var B=false;if(OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)){if(this.dragging){this.cancel()}if(this.layer.map!=null){this.layer.destroy(false);if(this.feature){this.feature.destroy()}}this.layer=null;this.feature=null;B=true}return B},down:function(B){this.fixedRadius=!!(this.radius);var C=this.map.getLonLatFromPixel(B.xy);this.origin=new OpenLayers.Geometry.Point(C.lon,C.lat);if(!this.fixedRadius||this.irregular){this.radius=this.map.getResolution()}if(this.persist){this.clear()}this.feature=new OpenLayers.Feature.Vector();this.createGeometry();this.callback("create",[this.origin,this.feature]);this.layer.addFeatures([this.feature],{silent:true});this.layer.drawFeature(this.feature,this.style)},move:function(D){var G=this.map.getLonLatFromPixel(D.xy);var B=new OpenLayers.Geometry.Point(G.lon,G.lat);if(this.irregular){var H=Math.sqrt(2)*Math.abs(B.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,H)}else{if(this.fixedRadius){this.origin=B}else{this.calculateAngle(B,D);this.radius=Math.max(this.map.getResolution()/2,B.distanceTo(this.origin))}}this.modifyGeometry();if(this.irregular){var E=B.x-this.origin.x;var C=B.y-this.origin.y;var F;if(C==0){F=E/(this.radius*Math.sqrt(2))}else{F=E/C}this.feature.geometry.resize(1,this.origin,F);this.feature.geometry.move(E/2,C/2)}this.layer.drawFeature(this.feature,this.style)},up:function(B){this.finalize();if(this.start==this.last){this.callback("done",[B.xy])}},out:function(B){this.finalize()},createGeometry:function(){this.angle=Math.PI*((1/this.sides)-(1/2));if(this.snapAngle){this.angle+=this.snapAngle*(Math.PI/180)}this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var G,D,C,B;var E=this.feature.geometry.components[0];if(E.components.length!=(this.sides+1)){this.createGeometry();E=this.feature.geometry.components[0]}for(var F=0;F<this.sides;++F){B=E.components[F];G=this.angle+(F*2*Math.PI/this.sides);B.x=this.origin.x+(this.radius*Math.cos(G));B.y=this.origin.y+(this.radius*Math.sin(G));B.clearBounds()}},calculateAngle:function(B,C){var E=Math.atan2(B.y-this.origin.y,B.x-this.origin.x);if(this.snapAngle&&(this.snapToggle&&!C[this.snapToggle])){var D=(Math.PI/180)*this.snapAngle;this.angle=Math.round(E/D)*D}else{this.angle=E}},cancel:function(){this.callback("cancel",null);this.finalize()},finalize:function(){this.origin=null;this.radius=this.options.radius},clear:function(){this.layer.renderer.clear();this.layer.destroyFeatures()},callback:function(C,B){if(this.callbacks[C]){this.callbacks[C].apply(this.control,[this.feature.geometry.clone()])}if(!this.persist&&(C=="done"||C=="cancel")){this.clear()}},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"});OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:true,isBaseLayer:true,isFixed:true,pane:null,mapObject:null,initialize:function(C,B){OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(this.pane==null){this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane")}},destroy:function(){this.mapObject=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(B){OpenLayers.Layer.prototype.setMap.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1;this.pane.style.display=this.div.style.display;this.pane.style.width="100%";this.pane.style.height="100%";if(OpenLayers.Util.getBrowserName()=="msie"){this.pane.style.background="url("+OpenLayers.Util.getImagesLocation()+"blank.gif)"}if(this.isFixed){this.map.viewPortDiv.appendChild(this.pane)}else{this.map.layerContainerDiv.appendChild(this.pane)}this.loadMapObject();if(this.mapObject==null){this.loadWarningMessage()}},removeMap:function(B){if(this.pane&&this.pane.parentNode){this.pane.parentNode.removeChild(this.pane);this.pane=null}OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var H=this.map.getSize();var B=Math.min(H.w,300);var F=Math.min(H.h,200);var C=new OpenLayers.Size(B,F);var E=new OpenLayers.Pixel(H.w/2,H.h/2);var D=E.add(-C.w/2,-C.h/2);var G=OpenLayers.Util.createDiv(this.name+"_warning",D,C,null,null,null,"auto");G.style.padding="7px";G.style.backgroundColor="yellow";G.innerHTML=this.getWarningHTML();this.div.appendChild(G)},getWarningHTML:function(){return""},display:function(B){OpenLayers.Layer.prototype.display.apply(this,arguments);this.pane.style.display=this.div.style.display},setZIndex:function(B){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments);this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveTo:function(D,E,K){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(this.mapObject!=null){var F=this.map.getCenter();var H=this.map.getZoom();if(F!=null){var G=this.getMapObjectCenter();var C=this.getOLLonLatFromMapObjectLonLat(G);var I=this.getMapObjectZoom();var N=this.getOLZoomFromMapObjectZoom(I);if(!(F.equals(C))||!(H==N)){if(K&&this.dragPanMapObject&&this.smoothDragPan){var J=this.map.getViewPortPxFromLonLat(C);var L=this.map.getViewPortPxFromLonLat(F);this.dragPanMapObject(L.x-J.x,J.y-L.y)}else{var B=this.getMapObjectLonLatFromOLLonLat(F);var M=this.getMapObjectZoomFromOLZoom(H);this.setMapObjectCenter(B,M,K)}}}}},getLonLatFromViewPortPx:function(B){var C=null;if((this.mapObject!=null)&&(this.getMapObjectCenter()!=null)){var E=this.getMapObjectPixelFromOLPixel(B);var D=this.getMapObjectLonLatFromMapObjectPixel(E);C=this.getOLLonLatFromMapObjectLonLat(D)}return C},getViewPortPxFromLonLat:function(C){var B=null;if((this.mapObject!=null)&&(this.getMapObjectCenter()!=null)){var E=this.getMapObjectLonLatFromOLLonLat(C);var D=this.getMapObjectPixelFromMapObjectLonLat(E);B=this.getOLPixelFromMapObjectPixel(D)}return B},getOLLonLatFromMapObjectLonLat:function(E){var B=null;if(E!=null){var D=this.getLongitudeFromMapObjectLonLat(E);var C=this.getLatitudeFromMapObjectLonLat(E);B=new OpenLayers.LonLat(D,C)}return B},getMapObjectLonLatFromOLLonLat:function(B){var C=null;if(B!=null){C=this.getMapObjectLonLatFromLonLat(B.lon,B.lat)}return C},getOLPixelFromMapObjectPixel:function(E){var C=null;if(E!=null){var B=this.getXFromMapObjectPixel(E);var D=this.getYFromMapObjectPixel(E);C=new OpenLayers.Pixel(B,D)}return C},getMapObjectPixelFromOLPixel:function(B){var C=null;if(B!=null){C=this.getMapObjectPixelFromXY(B.x,B.y)}return C},CLASS_NAME:"OpenLayers.Layer.EventPane"});OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){var D=new Array("minZoomLevel","maxZoomLevel","numZoomLevels");for(var C=0,B=D.length;C<B;C++){var G=D[C];this[G]=(this.options[G]!=null)?this.options[G]:this.map[G]}if((this.minZoomLevel==null)||(this.minZoomLevel<this.MIN_ZOOM_LEVEL)){this.minZoomLevel=this.MIN_ZOOM_LEVEL}var H;var F=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(((this.options.numZoomLevels==null)&&(this.options.maxZoomLevel!=null))||((this.numZoomLevels==null)&&(this.maxZoomLevel!=null))){H=this.maxZoomLevel-this.minZoomLevel+1}else{H=this.numZoomLevels}if(H!=null){this.numZoomLevels=Math.min(H,F)}else{this.numZoomLevels=F}this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1;if(this.RESOLUTIONS!=null){var E=0;this.resolutions=[];for(var C=this.minZoomLevel;C<=this.maxZoomLevel;C++){this.resolutions[E++]=this.RESOLUTIONS[C]}this.maxResolution=this.resolutions[0];this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getResolution.apply(this,arguments)}else{var B=null;var D=this.map.getSize();var C=this.getExtent();if((D!=null)&&(C!=null)){B=Math.max(C.getWidth()/D.w,C.getHeight()/D.h)}return B}},getExtent:function(){var D=null;var C=this.map.getSize();var F=new OpenLayers.Pixel(0,0);var G=this.getLonLatFromViewPortPx(F);var B=new OpenLayers.Pixel(C.w,C.h);var E=this.getLonLatFromViewPortPx(B);if((G!=null)&&(E!=null)){D=new OpenLayers.Bounds(G.lon,E.lat,E.lon,G.lat)}return D},getZoomForResolution:function(B){if(this.resolutions!=null){return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments)}else{var C=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(C)}},getOLZoomFromMapObjectZoom:function(B){var C=null;if(B!=null){C=B-this.minZoomLevel}return C},getMapObjectZoomFromOLZoom:function(B){var C=null;if(B!=null){C=B+this.minZoomLevel}return C},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"});OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:false,initialize:function(E,D,F,C){var B=arguments;B=[E,C];OpenLayers.Layer.prototype.initialize.apply(this,B);this.url=D;this.params=OpenLayers.Util.extend({},F)},destroy:function(){this.url=null;this.params=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.prototype.clone.apply(this,[B]);return B},setUrl:function(B){this.url=B},mergeNewParams:function(B){this.params=OpenLayers.Util.extend(this.params,B);return this.redraw()},redraw:function(B){if(B){return this.mergeNewParams({_olSalt:Math.random()})}else{return OpenLayers.Layer.prototype.redraw.apply(this,[])}},selectUrl:function(F,E){var D=1;for(var C=0,B=F.length;C<B;C++){D*=F.charCodeAt(C)*this.URL_HASH_FACTOR;D-=Math.floor(D)}return E[Math.floor(D*E.length)]},getFullRequestString:function(G,F){var C=F||this.url;var H=OpenLayers.Util.extend({},this.params);H=OpenLayers.Util.extend(H,G);var B=OpenLayers.Util.getParameterString(H);if(C instanceof Array){C=this.selectUrl(B,C)}var E=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(C));for(var I in H){if(I.toUpperCase() in E){delete H[I]}}B=OpenLayers.Util.getParameterString(H);var J=C;if(B!=""){var D=C.charAt(C.length-1);if((D=="&")||(D=="?")){J+=B}else{if(C.indexOf("?")==-1){J+="?"+B}else{J+="&"+B}}}return J},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"});OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:true,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(D,C,F,E,B){this.url=C;this.extent=F;this.maxExtent=F;this.size=E;OpenLayers.Layer.prototype.initialize.apply(this,[D,B]);this.aspectRatio=(this.extent.getHeight()/this.size.h)/(this.extent.getWidth()/this.size.w)},destroy:function(){if(this.tile){this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null}OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.options)}B=OpenLayers.Layer.prototype.clone.apply(this,[B]);return B},setMap:function(B){if(this.options.maxResolution==null){this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w}OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(F,B,G){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var C=(this.tile==null);if(B||C){this.setTileSize();var E=new OpenLayers.LonLat(this.extent.left,this.extent.top);var D=this.map.getLayerPxFromLonLat(E);if(C){this.tile=new OpenLayers.Tile.Image(this,D,this.extent,null,this.tileSize);this.addTileMonitoringHooks(this.tile)}else{this.tile.size=this.tileSize.clone();this.tile.position=D.clone()}this.tile.draw()}},setTileSize:function(){var C=this.extent.getWidth()/this.map.getResolution();var B=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(C,B)},addTileMonitoringHooks:function(B){B.onLoadStart=function(){this.events.triggerEvent("loadstart")};B.events.register("loadstart",this,B.onLoadStart);B.onLoadEnd=function(){this.events.triggerEvent("loadend")};B.events.register("loadend",this,B.onLoadEnd);B.events.register("unload",this,B.onLoadEnd)},removeTileMonitoringHooks:function(B){B.unload();B.events.un({loadstart:B.onLoadStart,loadend:B.onLoadEnd,unload:B.onLoadEnd,scope:this})},setUrl:function(B){this.url=B;this.tile.draw()},getURL:function(B){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"});OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:false,markers:null,drawn:false,initialize:function(C,B){OpenLayers.Layer.prototype.initialize.apply(this,arguments);this.markers=[]},destroy:function(){this.clearMarkers();this.markers=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(C){if(C!=this.opacity){this.opacity=C;for(var D=0,B=this.markers.length;D<B;D++){this.markers[D].setOpacity(this.opacity)}}},moveTo:function(E,C,F){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);if(C||!this.drawn){for(var D=0,B=this.markers.length;D<B;D++){this.drawMarker(this.markers[D])}this.drawn=true}},addMarker:function(B){this.markers.push(B);if(this.opacity!=null){B.setOpacity(this.opacity)}if(this.map&&this.map.getExtent()){B.map=this.map;this.drawMarker(B)}},removeMarker:function(B){if(this.markers&&this.markers.length){OpenLayers.Util.removeItem(this.markers,B);B.erase()}},clearMarkers:function(){if(this.markers!=null){while(this.markers.length>0){this.removeMarker(this.markers[0])}}},drawMarker:function(B){var C=this.map.getLayerPxFromLonLat(B.lonlat);if(C==null){B.display(false)}else{if(!B.isDrawn()){var D=B.draw(C);this.div.appendChild(D)}else{if(B.icon){B.icon.moveTo(C)}}}},getDataExtent:function(){var C=null;if(this.markers&&(this.markers.length>0)){var C=new OpenLayers.Bounds();for(var E=0,B=this.markers.length;E<B;E++){var D=this.markers[E];C.extend(D.lonlat)}}return C},CLASS_NAME:"OpenLayers.Layer.Markers"});OpenLayers.Layer.SphericalMercator={getExtent:function(){var B=null;if(this.sphericalMercator){B=this.map.calculateBounds()}else{B=OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)}return B},initMercatorParameters:function(){this.RESOLUTIONS=[];var B=156543.0339;for(var C=0;C<=this.MAX_ZOOM_LEVEL;++C){this.RESOLUTIONS[C]=B/Math.pow(2,C)}this.units="m";this.projection="EPSG:900913"},forwardMercator:function(D,C){var B=D*20037508.34/180;var E=Math.log(Math.tan((90+C)*Math.PI/360))/(Math.PI/180);E=E*20037508.34/180;return new OpenLayers.LonLat(B,E)},inverseMercator:function(B,E){var D=(B/20037508.34)*180;var C=(E/20037508.34)*180;C=180/Math.PI*(2*Math.atan(Math.exp(C*Math.PI/180))-Math.PI/2);return new OpenLayers.LonLat(D,C)},projectForward:function(B){var C=OpenLayers.Layer.SphericalMercator.forwardMercator(B.x,B.y);B.x=C.lon;B.y=C.lat;return B},projectInverse:function(B){var C=OpenLayers.Layer.SphericalMercator.inverseMercator(B.x,B.y);B.x=C.lon;B.y=C.lat;return B}};OpenLayers.Projection.addTransform("EPSG:4326","EPSG:900913",OpenLayers.Layer.SphericalMercator.projectForward);OpenLayers.Projection.addTransform("EPSG:900913","EPSG:4326",OpenLayers.Layer.SphericalMercator.projectInverse);OpenLayers.Tile.WFS=OpenLayers.Class(OpenLayers.Tile,{features:null,url:null,request:null,initialize:function(E,B,F,C,D){OpenLayers.Tile.prototype.initialize.apply(this,arguments);this.url=C;this.features=[]},destroy:function(){OpenLayers.Tile.prototype.destroy.apply(this,arguments);this.destroyAllFeatures();this.features=null;this.url=null;if(this.request){this.request.abort();this.request=null}},clear:function(){this.destroyAllFeatures()},draw:function(){if(OpenLayers.Tile.prototype.draw.apply(this,arguments)){if(this.isLoading){this.events.triggerEvent("reload")}else{this.isLoading=true;this.events.triggerEvent("loadstart")}this.loadFeaturesForRegion(this.requestSuccess)}},loadFeaturesForRegion:function(C,B){if(this.request){this.request.abort()}this.request=OpenLayers.Request.GET({url:this.url,success:C,failure:B,scope:this})},requestSuccess:function(C){if(this.features){var E=C.responseXML;if(!E||!E.documentElement){E=C.responseText}if(this.layer.vectorMode){this.layer.addFeatures(this.layer.formatObject.read(E))}else{var B=new OpenLayers.Format.XML();if(typeof E=="string"){E=B.read(E)}var D=B.getElementsByTagNameNS(E,"http://www.opengis.net/gml","featureMember");this.addResults(D)}}if(this.events){this.events.triggerEvent("loadend")}this.request=null},addResults:function(D){for(var C=0;C<D.length;C++){var B=new this.layer.featureClass(this.layer,D[C]);this.features.push(B)}},destroyAllFeatures:function(){while(this.features.length>0){var B=this.features.shift();B.destroy()}},CLASS_NAME:"OpenLayers.Tile.WFS"});OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,EVENT_TYPES:["featureadded"],featureAdded:function(){},handlerOptions:null,initialize:function(C,D,B){this.EVENT_TYPES=OpenLayers.Control.DrawFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[B]);this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(G,F){this.layer.events.triggerEvent("sketchmodified",{vertex:G,feature:F})},create:function(G,F){this.layer.events.triggerEvent("sketchstarted",{vertex:G,feature:F})}},this.callbacks);this.layer=C;var E=this.layer.styleMap&&this.layer.styleMap.styles.temporary;if(E){this.handlerOptions=this.handlerOptions||{};this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":E})})}this.handler=new D(this,this.callbacks,this.handlerOptions)},drawFeature:function(D){var B=new OpenLayers.Feature.Vector(D);var C=this.layer.events.triggerEvent("sketchcomplete",{feature:B});if(C!==false){B.state=OpenLayers.State.INSERT;this.layer.addFeatures([B]);this.featureAdded(B);this.events.triggerEvent("featureadded",{feature:B})}},CLASS_NAME:"OpenLayers.Control.DrawFeature"});OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["measure","measurepartial"],handlerOptions:null,callbacks:null,displaySystem:"metric",geodesic:false,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:false,initialize:function(C,B){this.EVENT_TYPES=OpenLayers.Control.Measure.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[B]);this.callbacks=OpenLayers.Util.extend({done:this.measureComplete,point:this.measurePartial},this.callbacks);this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions);this.handler=new C(this,this.callbacks,this.handlerOptions)},cancel:function(){this.handler.cancel()},updateHandler:function(C,B){var D=this.active;if(D){this.deactivate()}this.handler=new C(this,this.callbacks,B);if(D){this.activate()}},measureComplete:function(B){if(this.delayedTrigger){window.clearTimeout(this.delayedTrigger)}this.measure(B,"measure")},measurePartial:function(B,C){this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.measure(C,"measurepartial")},this),this.partialDelay)},measure:function(E,C){var D,B;if(E.CLASS_NAME.indexOf("LineString")>-1){D=this.getBestLength(E);B=1}else{D=this.getBestArea(E);B=2}this.events.triggerEvent(C,{measure:D[0],units:D[1],order:B,geometry:E})},getBestArea:function(G){var C=this.displaySystemUnits[this.displaySystem];var F,E;for(var D=0,B=C.length;D<B;++D){F=C[D];E=this.getArea(G,F);if(E>1){break}}return[E,F]},getArea:function(G,B){var C,D;if(this.geodesic){C=G.getGeodesicArea(this.map.getProjectionObject());D="m"}else{C=G.getArea();D=this.map.getUnits()}var F=OpenLayers.INCHES_PER_UNIT[B];if(F){var E=OpenLayers.INCHES_PER_UNIT[D];C*=Math.pow((E/F),2)}return C},getBestLength:function(G){var C=this.displaySystemUnits[this.displaySystem];var F,E;for(var D=0,B=C.length;D<B;++D){F=C[D];E=this.getLength(G,F);if(E>1){break}}return[E,F]},getLength:function(G,B){var C,D;if(this.geodesic){C=G.getGeodesicLength(this.map.getProjectionObject());D="m"}else{C=G.getLength();D=this.map.getUnits()}var F=OpenLayers.INCHES_PER_UNIT[B];if(F){var E=OpenLayers.INCHES_PER_UNIT[D];C*=(E/F)}return C},CLASS_NAME:"OpenLayers.Control.Measure"});OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:false,alwaysZoom:false,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(I){if(I instanceof OpenLayers.Bounds){if(!this.out){var J=this.map.getLonLatFromPixel(new OpenLayers.Pixel(I.left,I.bottom));var N=this.map.getLonLatFromPixel(new OpenLayers.Pixel(I.right,I.top));var C=new OpenLayers.Bounds(J.lon,J.lat,N.lon,N.lat)}else{var H=Math.abs(I.right-I.left);var K=Math.abs(I.top-I.bottom);var F=Math.min((this.map.size.h/K),(this.map.size.w/H));var O=this.map.getExtent();var B=this.map.getLonLatFromPixel(I.getCenterPixel());var D=B.lon-(O.getWidth()/2)*F;var G=B.lon+(O.getWidth()/2)*F;var M=B.lat-(O.getHeight()/2)*F;var E=B.lat+(O.getHeight()/2)*F;var C=new OpenLayers.Bounds(D,M,G,E)}var L=this.map.getZoom();this.map.zoomToExtent(C);if(L==this.map.getZoom()&&this.alwaysZoom==true){this.map.zoomTo(L+(this.out?-1:1))}}else{if(!this.out){this.map.setCenter(this.map.getLonLatFromPixel(I),this.map.getZoom()+1)}else{this.map.setCenter(this.map.getLonLatFromPixel(I),this.map.getZoom()-1)}}},CLASS_NAME:"OpenLayers.Control.ZoomBox"});OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(B){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[B])},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"});OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{initialize:function(B){OpenLayers.Format.WFSCapabilities.v1.prototype.initialize.apply(this,[B])},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"});OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(B){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};OpenLayers.Format.prototype.initialize.apply(this,[B])},read:function(G){var F,E,I;var H=this.regExes.typeStr.exec(G);if(H){E=H[1].toLowerCase();I=H[2];if(this.parse[E]){F=this.parse[E].apply(this,[I])}if(this.internalProjection&&this.externalProjection){if(F&&F.CLASS_NAME=="OpenLayers.Feature.Vector"){F.geometry.transform(this.externalProjection,this.internalProjection)}else{if(F&&E!="geometrycollection"&&typeof F=="object"){for(var D=0,B=F.length;D<B;D++){var C=F[D];C.geometry.transform(this.externalProjection,this.internalProjection)}}}}}return F},write:function(B){var G,J,I,E,C;if(B.constructor==Array){G=B;C=true}else{G=[B];C=false}var D=[];if(C){D.push("GEOMETRYCOLLECTION(")}for(var F=0,H=G.length;F<H;++F){if(C&&F>0){D.push(",")}J=G[F].geometry;I=J.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[I]){return null}if(this.internalProjection&&this.externalProjection){J=J.clone();J.transform(this.internalProjection,this.externalProjection)}E=this.extract[I].apply(this,[J]);D.push(I.toUpperCase()+"("+E+")")}if(C){D.push(")")}return D.join("")},extract:{point:function(B){return B.x+" "+B.y},multipoint:function(D){var E=[];for(var C=0,B=D.components.length;C<B;++C){E.push(this.extract.point.apply(this,[D.components[C]]))}return E.join(",")},linestring:function(C){var E=[];for(var D=0,B=C.components.length;D<B;++D){E.push(this.extract.point.apply(this,[C.components[D]]))}return E.join(",")},multilinestring:function(D){var E=[];for(var C=0,B=D.components.length;C<B;++C){E.push("("+this.extract.linestring.apply(this,[D.components[C]])+")")}return E.join(",")},polygon:function(D){var E=[];for(var C=0,B=D.components.length;C<B;++C){E.push("("+this.extract.linestring.apply(this,[D.components[C]])+")")}return E.join(",")},multipolygon:function(E){var D=[];for(var C=0,B=E.components.length;C<B;++C){D.push("("+this.extract.polygon.apply(this,[E.components[C]])+")")}return D.join(",")}},parse:{point:function(C){var B=OpenLayers.String.trim(C).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(B[0],B[1]))},multipoint:function(F){var D=OpenLayers.String.trim(F).split(",");var E=[];for(var C=0,B=D.length;C<B;++C){E.push(this.parse.point.apply(this,[D[C]]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(E))},linestring:function(F){var D=OpenLayers.String.trim(F).split(",");var E=[];for(var C=0,B=D.length;C<B;++C){E.push(this.parse.point.apply(this,[D[C]]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(E))},multilinestring:function(G){var D;var C=OpenLayers.String.trim(G).split(this.regExes.parenComma);var F=[];for(var E=0,B=C.length;E<B;++E){D=C[E].replace(this.regExes.trimParens,"$1");F.push(this.parse.linestring.apply(this,[D]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(F))},polygon:function(I){var D,C,G;var H=OpenLayers.String.trim(I).split(this.regExes.parenComma);var F=[];for(var E=0,B=H.length;E<B;++E){D=H[E].replace(this.regExes.trimParens,"$1");C=this.parse.linestring.apply(this,[D]).geometry;G=new OpenLayers.Geometry.LinearRing(C.components);F.push(G)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(F))},multipolygon:function(G){var E;var C=OpenLayers.String.trim(G).split(this.regExes.doubleParenComma);var F=[];for(var D=0,B=C.length;D<B;++D){E=C[D].replace(this.regExes.trimParens,"$1");F.push(this.parse.polygon.apply(this,[E]).geometry)}return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(F))},geometrycollection:function(F){F=F.replace(/,\s*([A-Za-z])/g,"|$1");var E=OpenLayers.String.trim(F).split("|");var D=[];for(var C=0,B=E.length;C<B;++C){D.push(OpenLayers.Format.WKT.prototype.read.apply(this,[E[C]]))}return D}},CLASS_NAME:"OpenLayers.Format.WKT"});OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(B){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[B])},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"});OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(B){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[B])},read_sld_MinScaleDenominator:function(C,B){C.options.maxScale=this.getChildValue(B)},read_sld_MaxScaleDenominator:function(C,B){C.options.minScale=this.getChildValue(B)},write_wmc_Layer:function(C){var D=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[C]);if(C.options.resolutions||C.options.scales||C.options.minResolution||C.options.maxScale){var E=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");E.appendChild(this.createTextNode(C.maxScale.toPrecision(10)));D.insertBefore(E,D.childNodes[3])}if(C.options.resolutions||C.options.scales||C.options.maxResolution||C.options.minScale){var B=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");B.appendChild(this.createTextNode(C.minScale.toPrecision(10)));D.insertBefore(B,D.childNodes[4])}return D},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"});OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{initialize:function(C,B){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments)},drawMarker:function(B){var E=B.bounds;var G=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(E.left,E.top));var D=this.map.getLayerPxFromLonLat(new OpenLayers.LonLat(E.right,E.bottom));if(D==null||G==null){B.display(false)}else{var F=new OpenLayers.Size(Math.max(1,D.x-G.x),Math.max(1,D.y-G.y));var C=B.draw(G,F);if(!B.drawn){this.div.appendChild(C);B.drawn=true}}},removeMarker:function(B){OpenLayers.Util.removeItem(this.markers,B);if((B.div!=null)&&(B.div.parentNode==this.div)){this.div.removeChild(B.div)}},CLASS_NAME:"OpenLayers.Layer.Boxes"});OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:true,initialize:function(D,B,C){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[D,C]);this.location=B;this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadRSS:function(){if(!this.loaded){this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this});this.loaded=true}},moveTo:function(D,B,C){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadRSS()}},parseData:function(J){var N=J.responseXML;if(!N||!N.documentElement){N=OpenLayers.Format.XML.prototype.read(J.responseText)}if(this.useFeedTitle){var B=null;try{B=N.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(I){B=N.getElementsByTagName("title")[0].firstChild.nodeValue}if(B){this.setName(B)}}var R={};OpenLayers.Util.extend(R,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){R.externalProjection=this.projection;R.internalProjection=this.map.getProjectionObject()}var O=new OpenLayers.Format.GeoRSS(R);var C=O.read(N);for(var G=0,H=C.length;G<H;G++){var F={};var Q=C[G];if(!Q.geometry){continue}var L=Q.attributes.title?Q.attributes.title:"Untitled";var P=Q.attributes.description?Q.attributes.description:"No description.";var K=Q.attributes.link?Q.attributes.link:"";var M=Q.geometry.getBounds().getCenterLonLat();F.icon=this.icon==null?OpenLayers.Marker.defaultIcon():this.icon.clone();F.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120);if(L||P){F.title=L;F.description=P;var D='<div class="olLayerGeoRSSClose">[x]</div>';D+='<div class="olLayerGeoRSSTitle">';if(K){D+='<a class="link" href="'+K+'" target="_blank">'}D+=L;if(K){D+="</a>"}D+="</div>";D+='<div style="" class="olLayerGeoRSSDescription">';D+=P;D+="</div>";F.popupContentHTML=D}var Q=new OpenLayers.Feature(this,M,F);this.features.push(Q);var E=Q.createMarker();E.events.register("click",Q,this.markerClick);this.addMarker(E)}this.events.triggerEvent("loadend")},markerClick:function(D){var F=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!F)?this:null;for(var E=0,B=this.layer.map.popups.length;E<B;E++){this.layer.map.removePopup(this.layer.map.popups[E])}if(!F){var C=this.createPopup();OpenLayers.Event.observe(C.div,"click",OpenLayers.Function.bind(function(){for(var H=0,G=this.layer.map.popups.length;H<G;H++){this.layer.map.removePopup(this.layer.map.popups[H])}},this));this.layer.map.addPopup(C)}OpenLayers.Event.stop(D)},clearFeatures:function(){if(this.features!=null){while(this.features.length>0){var B=this.features[0];OpenLayers.Util.removeItem(this.features,B);B.destroy()}}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"});OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:19,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031,0.00000536441802978515,0.00000268220901489257],type:null,sphericalMercator:false,dragObject:null,termsOfUse:null,poweredBy:null,initialize:function(C,B){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);this.addContainerPxFunction();if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},loadMapObject:function(){try{this.mapObject=new GMap2(this.div);if(typeof this.mapObject.getDragObject=="function"){this.dragObject=this.mapObject.getDragObject()}else{this.dragPanMapObject=null}this.termsOfUse=this.div.lastChild;this.div.removeChild(this.termsOfUse);if(this.isFixed){this.map.viewPortDiv.appendChild(this.termsOfUse)}else{this.map.layerContainerDiv.appendChild(this.termsOfUse)}this.termsOfUse.style.zIndex="1100";this.termsOfUse.style.display=this.div.style.display;this.termsOfUse.style.right="";this.termsOfUse.style.bottom="";this.termsOfUse.className="olLayerGoogleCopyright";this.poweredBy=this.div.lastChild;this.div.removeChild(this.poweredBy);if(this.isFixed){this.map.viewPortDiv.appendChild(this.poweredBy)}else{this.map.layerContainerDiv.appendChild(this.poweredBy)}this.poweredBy.style.zIndex="1100";this.poweredBy.style.display=this.div.style.display;this.poweredBy.style.right="";this.poweredBy.style.bottom="";this.poweredBy.className="olLayerGooglePoweredBy gmnoprint"}catch(B){OpenLayers.Console.error(B)}},setMap:function(B){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments);if(this.type!=null){this.map.events.register("moveend",this,this.setMapType)}},setMapType:function(){if(this.mapObject.getCenter()!=null){if(OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)==-1){this.mapObject.addMapType(this.type)}this.mapObject.setMapType(this.type);this.map.events.unregister("moveend",this,this.setMapType)}},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded()){this.mapObject.checkResize()}else{if(!this._resized){var B=this;var C=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(C);delete B._resized;B.mapObject.checkResize();B.moveTo(B.map.getCenter(),B.map.getZoom())})}this._resized=true}},display:function(B){OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments);this.termsOfUse.style.display=this.div.style.display;this.poweredBy.style.display=this.div.style.display},removeMap:function(B){if(this.termsOfUse&&this.termsOfUse.parentNode){this.termsOfUse.parentNode.removeChild(this.termsOfUse);this.termsOfUse=null}if(this.poweredBy&&this.poweredBy.parentNode){this.poweredBy.parentNode.removeChild(this.poweredBy);this.poweredBy=null}OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(C){var D=null;if(C!=null){var B=C.getSouthWest();var E=C.getNorthEast();if(this.sphericalMercator){B=this.forwardMercator(B.lng(),B.lat());E=this.forwardMercator(E.lng(),E.lat())}else{B=new OpenLayers.LonLat(B.lng(),B.lat());E=new OpenLayers.LonLat(E.lng(),E.lat())}D=new OpenLayers.Bounds(B.lon,B.lat,E.lon,E.lat)}return D},getMapObjectBoundsFromOLBounds:function(D){var C=null;if(D!=null){var B=this.sphericalMercator?this.inverseMercator(D.bottom,D.left):new OpenLayers.LonLat(D.bottom,D.left);var E=this.sphericalMercator?this.inverseMercator(D.top,D.right):new OpenLayers.LonLat(D.top,D.right);C=new GLatLngBounds(new GLatLng(B.lat,B.lon),new GLatLng(E.lat,E.lon))}return C},addContainerPxFunction:function(){if((typeof GMap2!="undefined")&&!GMap2.prototype.fromLatLngToContainerPixel){GMap2.prototype.fromLatLngToContainerPixel=function(C){var B=this.fromLatLngToDivPixel(C);var D=this.getContainer().firstChild.firstChild;B.x+=D.offsetLeft;B.y+=D.offsetTop;return B}}},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},setMapObjectCenter:function(B,C){this.mapObject.setCenter(B,C)},dragPanMapObject:function(C,B){this.dragObject.moveBy(new GSize(-C,B))},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getMapObjectLonLatFromMapObjectPixel:function(B){return this.mapObject.fromContainerPixelToLatLng(B)},getMapObjectPixelFromMapObjectLonLat:function(B){return this.mapObject.fromLatLngToContainerPixel(B)},getMapObjectZoomFromMapObjectBounds:function(B){return this.mapObject.getBoundsZoomLevel(B)},getLongitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.lng(),B.lat()).lon:B.lng()},getLatitudeFromMapObjectLonLat:function(C){var B=this.sphericalMercator?this.forwardMercator(C.lng(),C.lat()).lat:C.lat();return B},getMapObjectLonLatFromLonLat:function(E,C){var D;if(this.sphericalMercator){var B=this.inverseMercator(E,C);D=new GLatLng(B.lat,B.lon)}else{D=new GLatLng(C,E)}return D},getXFromMapObjectPixel:function(B){return B.x},getYFromMapObjectPixel:function(B){return B.y},getMapObjectPixelFromXY:function(B,C){return new GPoint(B,C)},CLASS_NAME:"OpenLayers.Layer.Google"});OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,grid:null,singleTile:false,ratio:1.5,buffer:2,numLoadingTiles:0,initialize:function(D,C,E,B){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments);this.events.addEventType("tileloaded");this.grid=[]},destroy:function(){this.clearGrid();this.grid=null;this.tileSize=null;OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var G=0,C=this.grid.length;G<C;G++){var F=this.grid[G];for(var D=0,B=F.length;D<B;D++){var E=F[D];this.removeTileMonitoringHooks(E);E.destroy()}}this.grid=[]}},clone:function(B){if(B==null){B=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[B]);if(this.tileSize!=null){B.tileSize=this.tileSize.clone()}B.grid=[];return B},moveTo:function(E,B,F){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);E=E||this.map.getExtent();if(E!=null){var D=!this.grid.length||B;var C=this.getTilesBounds();if(this.singleTile){if(D||(!F&&!C.containsBounds(E))){this.initSingleTile(E)}}else{if(D||!C.containsBounds(E,true)){this.initGriddedTiles(E)}else{this.moveGriddedTiles(E)}}}},setTileSize:function(B){if(this.singleTile){B=this.map.getSize().clone();B.h=parseInt(B.h*this.ratio);B.w=parseInt(B.w*this.ratio)}OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[B])},getGridBounds:function(){var B="The getGridBounds() function is deprecated. It will be removed in 3.0. Please use getTilesBounds() instead.";OpenLayers.Console.warn(B);return this.getTilesBounds()},getTilesBounds:function(){var F=null;if(this.grid.length){var B=this.grid.length-1;var E=this.grid[B][0];var C=this.grid[0].length-1;var D=this.grid[0][C];F=new OpenLayers.Bounds(E.bounds.left,E.bounds.bottom,D.bounds.right,D.bounds.top)}return F},initSingleTile:function(G){var B=G.getCenterLonLat();var I=G.getWidth()*this.ratio;var C=G.getHeight()*this.ratio;var H=new OpenLayers.Bounds(B.lon-(I/2),B.lat-(C/2),B.lon+(I/2),B.lat+(C/2));var E=new OpenLayers.LonLat(H.left,H.top);var D=this.map.getLayerPxFromLonLat(E);if(!this.grid.length){this.grid[0]=[]}var F=this.grid[0][0];if(!F){F=this.addTile(H,D);this.addTileMonitoringHooks(F);F.draw();this.grid[0][0]=F}else{F.moveTo(H,D)}this.removeExcessTiles(1,1)},calculateGridLayout:function(B,P,F){var L=F*this.tileSize.w;var D=F*this.tileSize.h;var J=B.left-P.left;var M=Math.floor(J/L)-this.buffer;var K=J/L-M;var G=-K*this.tileSize.w;var N=P.left+M*L;var C=B.top-(P.bottom+D);var I=Math.ceil(C/D)+this.buffer;var O=I-C/D;var E=-O*this.tileSize.h;var H=P.bottom+I*D;return{tilelon:L,tilelat:D,tileoffsetlon:N,tileoffsetlat:H,tileoffsetx:G,tileoffsety:E}},initGriddedTiles:function(J){var H=this.map.getSize();var W=Math.ceil(H.h/this.tileSize.h)+Math.max(1,2*this.buffer);var Z=Math.ceil(H.w/this.tileSize.w)+Math.max(1,2*this.buffer);var P=this.maxExtent;var S=this.map.getResolution();var R=this.calculateGridLayout(J,P,S);var G=Math.round(R.tileoffsetx);var D=Math.round(R.tileoffsety);var L=R.tileoffsetlon;var O=R.tileoffsetlat;var F=R.tilelon;var K=R.tilelat;this.origin=new OpenLayers.Pixel(G,D);var V=G;var Y=L;var U=0;var B=parseInt(this.map.layerContainerDiv.style.left);var T=parseInt(this.map.layerContainerDiv.style.top);do{var I=this.grid[U++];if(!I){I=[];this.grid.push(I)}L=Y;G=V;var E=0;do{var C=new OpenLayers.Bounds(L,O,L+F,O+K);var N=G;N-=B;var M=D;M-=T;var Q=new OpenLayers.Pixel(N,M);var a=I[E++];if(!a){a=this.addTile(C,Q);this.addTileMonitoringHooks(a);I.push(a)}else{a.moveTo(C,Q,false)}L+=F;G+=this.tileSize.w}while((L<=J.right+F*this.buffer)||E<Z);O-=K;D+=this.tileSize.h}while((O>=J.bottom-K*this.buffer)||U<W);this.removeExcessTiles(U,E);this.spiralTileLoad()},spiralTileLoad:function(){var C=[];var I=["right","down","left","up"];var H=0;var B=-1;var K=OpenLayers.Util.indexOf(I,"right");var L=0;while(L<I.length){var J=H;var D=B;switch(I[K]){case"right":D++;break;case"down":J++;break;case"left":D--;break;case"up":J--;break}var G=null;if((J<this.grid.length)&&(J>=0)&&(D<this.grid[0].length)&&(D>=0)){G=this.grid[J][D]}if((G!=null)&&(!G.queued)){C.unshift(G);G.queued=true;L=0;H=J;B=D}else{K=(K+1)%4;L++}}for(var E=0,F=C.length;E<F;E++){var G=C[E];G.draw();G.queued=false}},addTile:function(C,B){},addTileMonitoringHooks:function(B){B.onLoadStart=function(){if(this.numLoadingTiles==0){this.events.triggerEvent("loadstart")}this.numLoadingTiles++};B.events.register("loadstart",this,B.onLoadStart);B.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded");if(this.numLoadingTiles==0){this.events.triggerEvent("loadend")}};B.events.register("loadend",this,B.onLoadEnd);B.events.register("unload",this,B.onLoadEnd)},removeTileMonitoringHooks:function(B){B.unload();B.events.un({loadstart:B.onLoadStart,loadend:B.onLoadEnd,unload:B.onLoadEnd,scope:this})},moveGriddedTiles:function(D){var C=this.buffer||1;while(true){var B=this.grid[0][0].position;var E=this.map.getViewPortPxFromLayerPx(B);if(E.x>-this.tileSize.w*(C-1)){this.shiftColumn(true)}else{if(E.x<-this.tileSize.w*C){this.shiftColumn(false)}else{if(E.y>-this.tileSize.h*(C-1)){this.shiftRow(true)}else{if(E.y<-this.tileSize.h*C){this.shiftRow(false)}else{break}}}}}},shiftRow:function(N){var D=(N)?0:(this.grid.length-1);var C=this.grid;var G=C[D];var F=this.map.getResolution();var I=(N)?-this.tileSize.h:this.tileSize.h;var H=F*-I;var M=(N)?C.pop():C.shift();for(var J=0,L=G.length;J<L;J++){var E=G[J];var B=E.bounds.clone();var K=E.position.clone();B.bottom=B.bottom+H;B.top=B.top+H;K.y=K.y+I;M[J].moveTo(B,K)}if(N){C.unshift(M)}else{C.push(M)}},shiftColumn:function(M){var E=(M)?-this.tileSize.w:this.tileSize.w;var D=this.map.getResolution();var K=D*E;for(var F=0,H=this.grid.length;F<H;F++){var L=this.grid[F];var J=(M)?0:(L.length-1);var C=L[J];var B=C.bounds.clone();var G=C.position.clone();B.left=B.left+K;B.right=B.right+K;G.x=G.x+E;var I=M?this.grid[F].pop():this.grid[F].shift();I.moveTo(B,G);if(M){L.unshift(I)}else{L.push(I)}}},removeExcessTiles:function(F,D){while(this.grid.length>F){var G=this.grid.pop();for(var C=0,B=G.length;C<B;C++){var E=G[C];this.removeTileMonitoringHooks(E);E.destroy()}}while(this.grid[0].length>D){for(var C=0,B=this.grid.length;C<B;C++){var G=this.grid[C];var E=G.pop();this.removeTileMonitoringHooks(E);E.destroy()}}},onMapResize:function(){if(this.singleTile){this.clearGrid();this.setTileSize()}},getTileBounds:function(E){var D=this.maxExtent;var G=this.getResolution();var F=G*this.tileSize.w;var C=G*this.tileSize.h;var I=this.getLonLatFromViewPortPx(E);var B=D.left+(F*Math.floor((I.lon-D.left)/F));var H=D.bottom+(C*Math.floor((I.lat-D.bottom)/C));return new OpenLayers.Bounds(B,H,B+F,H+C)},CLASS_NAME:"OpenLayers.Layer.Grid"});OpenLayers.Layer.MultiMap=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[9,1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125],type:null,initialize:function(C,B){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters();this.RESOLUTIONS.unshift(10)}},loadMapObject:function(){try{this.mapObject=new MultimapViewer(this.div)}catch(B){}},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"MM",layerLib:"MultiMap"})},setMapObjectCenter:function(B,C){this.mapObject.goToPosition(B,C)},getMapObjectCenter:function(){return this.mapObject.getCurrentPosition()},getMapObjectZoom:function(){return this.mapObject.getZoomFactor()},getMapObjectLonLatFromMapObjectPixel:function(B){B.x=B.x-(this.map.getSize().w/2);B.y=B.y-(this.map.getSize().h/2);return this.mapObject.getMapPositionAt(B)},getMapObjectPixelFromMapObjectLonLat:function(B){return this.mapObject.geoPosToContainerPixels(B)},getLongitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.lon,B.lat).lon:B.lon},getLatitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.lon,B.lat).lat:B.lat},getMapObjectLonLatFromLonLat:function(E,D){var B;if(this.sphericalMercator){var C=this.inverseMercator(E,D);B=new MMLatLon(C.lat,C.lon)}else{B=new MMLatLon(D,E)}return B},getXFromMapObjectPixel:function(B){return B.x},getYFromMapObjectPixel:function(B){return B.y},getMapObjectPixelFromXY:function(B,C){return new MMPoint(B,C)},CLASS_NAME:"OpenLayers.Layer.MultiMap"});OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(C,B){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments);this.features=new Array()},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments);this.clearFeatures();this.features=null},loadText:function(){if(!this.loaded){if(this.location!=null){var B=function(C){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:B,scope:this});this.loaded=true}}},moveTo:function(D,B,C){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadText()}},parseData:function(K){var M=K.responseText;var O={};OpenLayers.Util.extend(O,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){O.externalProjection=this.projection;O.internalProjection=this.map.getProjectionObject()}var C=new OpenLayers.Format.Text(O);var D=C.read(M);for(var H=0,I=D.length;H<I;H++){var G={};var N=D[H];var L;var J,E;L=new OpenLayers.LonLat(N.geometry.x,N.geometry.y);if(N.style.graphicWidth&&N.style.graphicHeight){J=new OpenLayers.Size(N.style.graphicWidth,N.style.graphicHeight)}if(N.style.graphicXOffset!==undefined&&N.style.graphicYOffset!==undefined){E=new OpenLayers.Pixel(N.style.graphicXOffset,N.style.graphicYOffset)}if(N.style.externalGraphic!=null){G.icon=new OpenLayers.Icon(N.style.externalGraphic,J,E)}else{G.icon=OpenLayers.Marker.defaultIcon();if(J!=null){G.icon.setSize(J)}}if((N.attributes.title!=null)&&(N.attributes.description!=null)){G.popupContentHTML="<h2>"+N.attributes.title+"</h2><p>"+N.attributes.description+"</p>"}G.overflow=N.attributes.overflow||"auto";var B=new OpenLayers.Feature(this,L,G);this.features.push(B);var F=B.createMarker();if((N.attributes.title!=null)&&(N.attributes.description!=null)){F.events.register("click",B,this.markerClick)}this.addMarker(F)}this.events.triggerEvent("loadend")},markerClick:function(C){var E=(this==this.layer.selectedFeature);this.layer.selectedFeature=(!E)?this:null;for(var D=0,B=this.layer.map.popups.length;D<B;D++){this.layer.map.removePopup(this.layer.map.popups[D])}if(!E){this.layer.map.addPopup(this.createPopup())}OpenLayers.Event.stop(C)},clearFeatures:function(){if(this.features!=null){while(this.features.length>0){var B=this.features[0];OpenLayers.Util.removeItem(this.features,B);B.destroy()}}},CLASS_NAME:"OpenLayers.Layer.Text"});OpenLayers.Layer.VirtualEarth=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:1,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062],type:null,sphericalMercator:false,initialize:function(C,B){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},loadMapObject:function(){var B=OpenLayers.Util.createDiv(this.name);var D=this.map.getSize();B.style.width=D.w+"px";B.style.height=D.h+"px";this.div.appendChild(B);try{this.mapObject=new VEMap(this.name)}catch(C){}if(this.mapObject!=null){try{this.mapObject.LoadMap(null,null,this.type,true);this.mapObject.AttachEvent("onmousedown",function(){return true})}catch(C){}this.mapObject.HideDashboard()}if(!this.mapObject||!this.mapObject.vemapcontrol||!this.mapObject.vemapcontrol.PanMap||(typeof this.mapObject.vemapcontrol.PanMap!="function")){this.dragPanMapObject=null}},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"VE",layerLib:"VirtualEarth"})},setMapObjectCenter:function(B,C){this.mapObject.SetCenterAndZoom(B,C)},getMapObjectCenter:function(){return this.mapObject.GetCenter()},dragPanMapObject:function(C,B){this.mapObject.vemapcontrol.PanMap(C,-B)},getMapObjectZoom:function(){return this.mapObject.GetZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(B){return(typeof VEPixel!="undefined")?this.mapObject.PixelToLatLong(B):this.mapObject.PixelToLatLong(B.x,B.y)},getMapObjectPixelFromMapObjectLonLat:function(B){return this.mapObject.LatLongToPixel(B)},getLongitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.Longitude,B.Latitude).lon:B.Longitude},getLatitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.Longitude,B.Latitude).lat:B.Latitude},getMapObjectLonLatFromLonLat:function(E,C){var D;if(this.sphericalMercator){var B=this.inverseMercator(E,C);D=new VELatLong(B.lat,B.lon)}else{D=new VELatLong(C,E)}return D},getXFromMapObjectPixel:function(B){return B.x},getYFromMapObjectPixel:function(B){return B.y},getMapObjectPixelFromXY:function(B,C){return(typeof VEPixel!="undefined")?new VEPixel(B,C):new Msn.VE.Pixel(B,C)},CLASS_NAME:"OpenLayers.Layer.VirtualEarth"});OpenLayers.Layer.Yahoo=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:17,RESOLUTIONS:[1.40625,0.703125,0.3515625,0.17578125,0.087890625,0.0439453125,0.02197265625,0.010986328125,0.0054931640625,0.00274658203125,0.001373291015625,0.0006866455078125,0.00034332275390625,0.000171661376953125,0.0000858306884765625,0.00004291534423828125,0.00002145767211914062,0.00001072883605957031],type:null,sphericalMercator:false,initialize:function(C,B){OpenLayers.Layer.EventPane.prototype.initialize.apply(this,arguments);OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,arguments);if(this.sphericalMercator){OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator);this.initMercatorParameters()}},loadMapObject:function(){try{var B=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject=new YMap(this.div,this.type,B);this.mapObject.disableKeyControls();this.mapObject.disableDragMap();if(!this.mapObject.moveByXY||(typeof this.mapObject.moveByXY!="function")){this.dragPanMapObject=null}}catch(C){}},onMapResize:function(){try{var B=this.getMapObjectSizeFromOLSize(this.map.getSize());this.mapObject.resizeTo(B)}catch(C){}},setMap:function(B){OpenLayers.Layer.EventPane.prototype.setMap.apply(this,arguments);this.map.events.register("moveend",this,this.fixYahooEventPane)},fixYahooEventPane:function(){var B=OpenLayers.Util.getElement("ygddfdiv");if(B!=null){if(B.parentNode!=null){B.parentNode.removeChild(B)}this.map.events.unregister("moveend",this,this.fixYahooEventPane)}},getWarningHTML:function(){return OpenLayers.i18n("getLayerWarning",{layerType:"Yahoo",layerLib:"Yahoo"})},getOLZoomFromMapObjectZoom:function(B){var C=null;if(B!=null){C=OpenLayers.Layer.FixedZoomLevels.prototype.getOLZoomFromMapObjectZoom.apply(this,[B]);C=18-C}return C},getMapObjectZoomFromOLZoom:function(B){var C=null;if(B!=null){C=OpenLayers.Layer.FixedZoomLevels.prototype.getMapObjectZoomFromOLZoom.apply(this,[B]);C=18-C}return C},setMapObjectCenter:function(B,C){this.mapObject.drawZoomAndCenter(B,C)},getMapObjectCenter:function(){return this.mapObject.getCenterLatLon()},dragPanMapObject:function(C,B){this.mapObject.moveByXY({x:-C,y:B})},getMapObjectZoom:function(){return this.mapObject.getZoomLevel()},getMapObjectLonLatFromMapObjectPixel:function(B){return this.mapObject.convertXYLatLon(B)},getMapObjectPixelFromMapObjectLonLat:function(B){return this.mapObject.convertLatLonXY(B)},getLongitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.Lon,B.Lat).lon:B.Lon},getLatitudeFromMapObjectLonLat:function(B){return this.sphericalMercator?this.forwardMercator(B.Lon,B.Lat).lat:B.Lat},getMapObjectLonLatFromLonLat:function(E,D){var B;if(this.sphericalMercator){var C=this.inverseMercator(E,D);B=new YGeoPoint(C.lat,C.lon)}else{B=new YGeoPoint(D,E)}return B},getXFromMapObjectPixel:function(B){return B.x},getYFromMapObjectPixel:function(B){return B.y},getMapObjectPixelFromXY:function(B,C){return new YCoordPoint(B,C)},getMapObjectSizeFromOLSize:function(B){return new YSize(B.w,B.h)},CLASS_NAME:"OpenLayers.Layer.Yahoo"});OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:false,initialize:function(B){this.params={};this.headers={};OpenLayers.Protocol.prototype.initialize.apply(this,arguments)},destroy:function(){this.params=null;this.headers=null;OpenLayers.Protocol.prototype.destroy.apply(this)},createCallback:function(D,B,C){return OpenLayers.Function.bind(function(){D.apply(this,[B,C])},this)},read:function(B){B=OpenLayers.Util.applyDefaults(B,this.options);var C=(B.readWithPOST!==undefined)?B.readWithPOST:this.readWithPOST;var D=new OpenLayers.Protocol.Response({requestType:"read"});if(B.filter&&B.filter instanceof OpenLayers.Filter.Spatial){if(B.filter.type==OpenLayers.Filter.Spatial.BBOX){B.params=OpenLayers.Util.extend(B.params,{bbox:B.filter.value.toArray()})}}if(C){D.priv=OpenLayers.Request.POST({url:B.url,callback:this.createCallback(this.handleRead,D,B),data:OpenLayers.Util.getParameterString(B.params),headers:{"Content-Type":"application/x-www-form-urlencoded"}})}else{D.priv=OpenLayers.Request.GET({url:B.url,callback:this.createCallback(this.handleRead,D,B),params:B.params,headers:B.headers})}return D},handleRead:function(C,B){this.handleResponse(C,B)},create:function(C,B){B=OpenLayers.Util.applyDefaults(B,this.options);var D=new OpenLayers.Protocol.Response({reqFeatures:C,requestType:"create"});D.priv=OpenLayers.Request.POST({url:B.url,callback:this.createCallback(this.handleCreate,D,B),headers:B.headers,data:this.format.write(C)});return D},handleCreate:function(C,B){this.handleResponse(C,B)},update:function(D,C){var B=C.url||D.url||this.options.url;C=OpenLayers.Util.applyDefaults(C,this.options);var E=new OpenLayers.Protocol.Response({reqFeatures:D,requestType:"update"});E.priv=OpenLayers.Request.PUT({url:B,callback:this.createCallback(this.handleUpdate,E,C),headers:C.headers,data:this.format.write(D)});return E},handleUpdate:function(C,B){this.handleResponse(C,B)},"delete":function(D,C){var B=C.url||D.url||this.options.url;C=OpenLayers.Util.applyDefaults(C,this.options);var E=new OpenLayers.Protocol.Response({reqFeatures:D,requestType:"delete"});E.priv=OpenLayers.Request.DELETE({url:B,callback:this.createCallback(this.handleDelete,E,C),headers:C.headers});return E},handleDelete:function(C,B){this.handleResponse(C,B)},handleResponse:function(D,B){var C=D.priv;if(B.callback){if(C.status>=200&&C.status<300){if(D.requestType!="delete"){D.features=this.parseFeatures(C)}D.code=OpenLayers.Protocol.Response.SUCCESS}else{D.code=OpenLayers.Protocol.Response.FAILURE}B.callback.call(B.scope,D)}},parseFeatures:function(B){var C=B.responseXML;if(!C||!C.documentElement){C=B.responseText}if(!C||C.length<=0){return null}return this.format.read(C)},commit:function(C,Q){Q=OpenLayers.Util.applyDefaults(Q,this.options);var E=[],M=0;var K={};K[OpenLayers.State.INSERT]=[];K[OpenLayers.State.UPDATE]=[];K[OpenLayers.State.DELETE]=[];var P,L,D=[];for(var F=0,J=C.length;F<J;++F){P=C[F];L=K[P.state];if(L){L.push(P);D.push(P)}}var H=(K[OpenLayers.State.INSERT].length>0?1:0)+K[OpenLayers.State.UPDATE].length+K[OpenLayers.State.DELETE].length;var O=true;var B=new OpenLayers.Protocol.Response({reqFeatures:D});function I(S){var R=S.features?S.features.length:0;var U=new Array(R);for(var T=0;T<R;++T){U[T]=S.features[T].fid}B.insertIds=U;N.apply(this,[S])}function N(R){this.callUserCallback(R,Q);O=O&&R.success();M++;if(M>=H){if(Q.callback){B.code=O?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE;Q.callback.apply(Q.scope,[B])}}}var G=K[OpenLayers.State.INSERT];if(G.length>0){E.push(this.create(G,OpenLayers.Util.applyDefaults({callback:I,scope:this},Q.create)))}G=K[OpenLayers.State.UPDATE];for(var F=G.length-1;F>=0;--F){E.push(this.update(G[F],OpenLayers.Util.applyDefaults({callback:N,scope:this},Q.update)))}G=K[OpenLayers.State.DELETE];for(var F=G.length-1;F>=0;--F){E.push(this["delete"](G[F],OpenLayers.Util.applyDefaults({callback:N,scope:this},Q["delete"])))}return E},abort:function(B){if(B){B.priv.abort()}},callUserCallback:function(D,B){var C=B[D.requestType];if(C&&C.callback){C.callback.call(C.scope,D)}},CLASS_NAME:"OpenLayers.Protocol.HTTP"});OpenLayers.Style=OpenLayers.Class({name:null,title:null,description:null,layerName:null,isDefault:false,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:false,propertyStyles:null,initialize:function(C,B){OpenLayers.Util.extend(this,B);this.rules=[];if(B&&B.rules){this.addRules(B.rules)}this.setDefaultStyle(C||OpenLayers.Feature.Vector.style["default"])},destroy:function(){for(var C=0,B=this.rules.length;C<B;C++){this.rules[C].destroy();this.rules[C]=null}this.rules=null;this.defaultStyle=null},createSymbolizer:function(K){var B=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),K);var J=this.rules;var I,C;var D=[];var G=false;for(var E=0,F=J.length;E<F;E++){I=J[E];var H=I.evaluate(K);if(H){if(I instanceof OpenLayers.Rule&&I.elseFilter){D.push(I)}else{G=true;this.applySymbolizer(I,B,K)}}}if(G==false&&D.length>0){G=true;for(var E=0,F=D.length;E<F;E++){this.applySymbolizer(D[E],B,K)}}if(J.length>0&&G==false){B.display="none"}return B},applySymbolizer:function(G,E,C){var B=C.geometry?this.getSymbolizerPrefix(C.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0];var D=G.symbolizer[B]||G.symbolizer;if(this.defaultsPerSymbolizer===true){var F=this.defaultStyle;OpenLayers.Util.applyDefaults(D,{pointRadius:F.pointRadius});if(D.stroke===true||D.graphic===true){OpenLayers.Util.applyDefaults(D,{strokeWidth:F.strokeWidth,strokeColor:F.strokeColor,strokeOpacity:F.strokeOpacity,strokeDashstyle:F.strokeDashstyle,strokeLinecap:F.strokeLinecap})}if(D.fill===true||D.graphic===true){OpenLayers.Util.applyDefaults(D,{fillColor:F.fillColor,fillOpacity:F.fillOpacity})}if(D.graphic===true){OpenLayers.Util.applyDefaults(D,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}}return this.createLiterals(OpenLayers.Util.extend(E,D),C)},createLiterals:function(E,D){var C=this.context||D.attributes||D.data;for(var B in this.propertyStyles){E[B]=OpenLayers.Style.createLiteral(E[B],C,D)}return E},findPropertyStyles:function(){var E={};var G=this.defaultStyle;this.addPropertyStyles(E,G);var I=this.rules;var F,H;for(var D=0,B=I.length;D<B;D++){F=I[D].symbolizer;for(var C in F){H=F[C];if(typeof H=="object"){this.addPropertyStyles(E,H)}else{this.addPropertyStyles(E,F);break}}}return E},addPropertyStyles:function(C,D){var E;for(var B in D){E=D[B];if(typeof E=="string"&&E.match(/\$\{\w+\}/)){C[B]=true}}return C},addRules:function(B){this.rules=this.rules.concat(B);this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(B){this.defaultStyle=B;this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(E){var D=OpenLayers.Style.SYMBOLIZER_PREFIXES;for(var C=0,B=D.length;C<B;C++){if(E.CLASS_NAME.indexOf(D[C])!=-1){return D[C]}}},CLASS_NAME:"OpenLayers.Style"});OpenLayers.Style.createLiteral=function(D,C,B){if(typeof D=="string"&&D.indexOf("${")!=-1){D=OpenLayers.String.format(D,C,[B]);D=(isNaN(D)||!D)?D:parseFloat(D)}return D};OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text"];OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,zoomBox:null,zoomWheelEnabled:true,handleRightClicks:false,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,initialize:function(B){this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate();if(this.dragPan){this.dragPan.destroy()}this.dragPan=null;if(this.zoomBox){this.zoomBox.destroy()}this.zoomBox=null;OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.dragPan.activate();if(this.zoomWheelEnabled){this.handlers.wheel.activate()}this.handlers.click.activate();this.zoomBox.activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){this.zoomBox.deactivate();this.dragPan.deactivate();this.handlers.click.deactivate();this.handlers.wheel.deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){if(this.handleRightClicks){this.map.viewPortDiv.oncontextmenu=function(){return false}}var B={dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick};var C={"double":true,stopDouble:true};this.handlers.click=new OpenLayers.Handler.Click(this,B,C);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown});this.activate()},defaultDblClick:function(C){var B=this.map.getLonLatFromViewPortPx(C.xy);this.map.setCenter(B,this.map.zoom+1)},defaultDblRightClick:function(C){var B=this.map.getLonLatFromViewPortPx(C.xy);this.map.setCenter(B,this.map.zoom-1)},wheelChange:function(I,D){var G=this.map.getZoom()+D;if(!this.map.isValidZoomLevel(G)){return }var J=this.map.getSize();var F=J.w/2-I.xy.x;var E=I.xy.y-J.h/2;var H=this.map.baseLayer.getResolutionForZoom(G);var B=this.map.getLonLatFromPixel(I.xy);var C=new OpenLayers.LonLat(B.lon+F*H,B.lat+E*H);this.map.setCenter(C,G)},wheelUp:function(B){this.wheelChange(B,1)},wheelDown:function(B){this.wheelChange(B,-1)},disableZoomWheel:function(){this.zoomWheelEnabled=false;this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=true;if(this.active){this.handlers.wheel.activate()}},CLASS_NAME:"OpenLayers.Control.Navigation"});OpenLayers.Filter=OpenLayers.Class({initialize:function(B){OpenLayers.Util.extend(this,B)},destroy:function(){},evaluate:function(B){return true},clone:function(){return null},CLASS_NAME:"OpenLayers.Filter"});OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null;this.bounds=null},clone:function(){return new OpenLayers.Geometry()},setBounds:function(B){if(B){this.bounds=B.clone()}},clearBounds:function(){this.bounds=null;if(this.parent){this.parent.clearBounds()}},extendBounds:function(C){var B=this.getBounds();if(!B){this.setBounds(C)}else{this.bounds.extend(C)}},getBounds:function(){if(this.bounds==null){this.calculateBounds()}return this.bounds},calculateBounds:function(){},distanceTo:function(C,B){},getVertices:function(B){},atPoint:function(F,I,G){var D=false;var E=this.getBounds();if((E!=null)&&(F!=null)){var C=(I!=null)?I:0;var B=(G!=null)?G:0;var H=new OpenLayers.Bounds(this.bounds.left-C,this.bounds.bottom-B,this.bounds.right+C,this.bounds.top+B);D=H.containsLonLat(F)}return D},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){return OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this))},CLASS_NAME:"OpenLayers.Geometry"});OpenLayers.Geometry.fromWKT=function(G){var H=arguments.callee.format;if(!H){H=new OpenLayers.Format.WKT();arguments.callee.format=H}var E;var C=H.read(G);if(C instanceof OpenLayers.Feature.Vector){E=C.geometry}else{if(C instanceof Array){var B=C.length;var F=new Array(B);for(var D=0;D<B;++D){F[D]=C[D].geometry}E=new OpenLayers.Geometry.Collection(F)}}return E};OpenLayers.Geometry.segmentsIntersect=function(B,g,C){var P=C&&C.point;var U=C&&C.tolerance;var F=false;var W=B.x1-g.x1;var b=B.y1-g.y1;var M=B.x2-B.x1;var T=B.y2-B.y1;var Q=g.y2-g.y1;var J=g.x2-g.x1;var Z=(Q*M)-(J*T);var E=(J*b)-(Q*W);var D=(M*b)-(T*W);if(Z==0){if(E==0&&D==0){F=true}}else{var a=E/Z;var Y=D/Z;if(a>=0&&a<=1&&Y>=0&&Y<=1){if(!P){F=true}else{var H=B.x1+(a*M);var G=B.y1+(a*T);F=new OpenLayers.Geometry.Point(H,G)}}}if(U){var O;if(F){if(P){var L=[B,g];var V,H,G;outer:for(var S=0;S<2;++S){V=L[S];for(var R=1;R<3;++R){H=V["x"+R];G=V["y"+R];O=Math.sqrt(Math.pow(H-F.x,2)+Math.pow(G-F.y,2));if(O<U){F.x=H;F.y=G;break outer}}}}}else{var L=[B,g];var N,f,H,G,K,I;outer:for(var S=0;S<2;++S){N=L[S];f=L[(S+1)%2];for(var R=1;R<3;++R){K={x:N["x"+R],y:N["y"+R]};I=OpenLayers.Geometry.distanceToSegment(K,f);if(I.distance<U){if(P){F=new OpenLayers.Geometry.Point(K.x,K.y)}else{F=true}break outer}}}}}return F};OpenLayers.Geometry.distanceToSegment=function(L,E){var D=L.x;var K=L.y;var C=E.x1;var J=E.y1;var B=E.x2;var G=E.y2;var N=B-C;var M=G-J;var I=((N*(D-C))+(M*(K-J)))/(Math.pow(N,2)+Math.pow(M,2));var H,F;if(I<=0){H=C;F=J}else{if(I>=1){H=B;F=G}else{H=C+I*N;F=J+I*M}}return{distance:Math.sqrt(Math.pow(H-D,2)+Math.pow(F-K,2)),x:H,y:F}};OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:true,initialize:function(E,D,F,C){var B=[];F=OpenLayers.Util.upperCaseObject(F);B.push(E,D,F,C);OpenLayers.Layer.Grid.prototype.initialize.apply(this,B);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((C==null)||(!C.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="jpg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"}}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);return B},getURL:function(F){F=this.adjustBounds(F);var E=this.projection.getCode().split(":");var D=E[E.length-1];var H=this.getImageSize();var I={BBOX:F.toBBOX(),SIZE:H.w+","+H.h,F:"image",BBOXSR:D,IMAGESR:D};if(this.layerDefs){var G=[];var B;for(B in this.layerDefs){if(this.layerDefs.hasOwnProperty(B)){if(this.layerDefs[B]){G.push(B);G.push(":");G.push(this.layerDefs[B]);G.push(";")}}}if(G.length>0){I.LAYERDEFS=G.join("")}}var C=this.getFullRequestString(I);return C},setLayerFilter:function(C,B){if(!this.layerDefs){this.layerDefs={}}if(B){this.layerDefs[C]=B}else{delete this.layerDefs[C]}},clearLayerFilter:function(B){if(B){delete this.layerDefs[B]}else{delete this.layerDefs}},mergeNewParams:function(D){var C=OpenLayers.Util.upperCaseObject(D);var B=[C];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,B)},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"});OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,units:null,resolution:OpenLayers.DOTS_PER_INCH,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(E,D,F,C){var B=[];B.push(E,D,F,C);OpenLayers.Layer.Grid.prototype.initialize.apply(this,B);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(D){D=this.adjustBounds(D);var E=this.map.getResolution();var F=Math.round((this.map.getScale()*10000))/10000;var C=Math.round(D.left/E);var B=-Math.round(D.top/E);return this.getFullRequestString({t:B,l:C,s:F})},addTile:function(D,B){var C=this.getURL(D);return new OpenLayers.Tile.Image(this,B,D,C,this.tileSize)},calculateGridLayout:function(B,P,F){var L=F*this.tileSize.w;var D=F*this.tileSize.h;var J=B.left;var M=Math.floor(J/L)-this.buffer;var K=J/L-M;var G=-K*this.tileSize.w;var N=M*L;var C=B.top;var I=Math.ceil(C/D)+this.buffer;var O=I-C/D;var E=-(O+1)*this.tileSize.h;var H=I*D;return{tilelon:L,tilelat:D,tileoffsetlon:N,tileoffsetlat:H,tileoffsetx:G,tileoffsety:E}},clone:function(B){if(B==null){B=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);if(this.tileSize!=null){B.tileSize=this.tileSize.clone()}B.grid=[];return B},getTileBounds:function(D){var F=this.getResolution();var E=F*this.tileSize.w;var C=F*this.tileSize.h;var H=this.getLonLatFromViewPortPx(D);var B=E*Math.floor(H.lon/E);var G=C*Math.floor(H.lat/C);return new OpenLayers.Bounds(B,G,B+E,G+C)},CLASS_NAME:"OpenLayers.Layer.KaMap"});OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,useHttpTile:false,singleTile:false,useOverlay:false,useAsyncOverlay:true,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,300),initialize:function(D,C,E,B){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(B==null||B.isBaseLayer==null){this.isBaseLayer=((this.transparent!="true")&&(this.transparent!=true))}if(B&&B.useOverlay!=null){this.useOverlay=B.useOverlay}if(this.singleTile){if(this.useOverlay){OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS);if(!this.useAsyncOverlay){this.params.version="1.0.0"}}else{OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS)}}else{if(this.useHttpTile){OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS)}else{OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS)}this.setTileSize(this.defaultSize)}},clone:function(B){if(B==null){B=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);return B},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},getURL:function(B){var E;var C=B.getCenterLonLat();var I=this.map.getCurrentSize();if(this.singleTile){var F={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:I.h*this.ratio,setdisplaywidth:I.w*this.ratio,setviewcenterx:C.lon,setviewcentery:C.lat,setviewscale:this.map.getScale()};if(this.useOverlay&&!this.useAsyncOverlay){var J={};J=OpenLayers.Util.extend(J,F);J.operation="GETVISIBLEMAPEXTENT";J.version="1.0.0";J.session=this.params.session;J.mapName=this.params.mapName;J.format="text/xml";E=this.getFullRequestString(J);OpenLayers.Request.GET({url:E,async:false})}E=this.getFullRequestString(F)}else{var H=this.map.getResolution();var G=Math.floor((B.left-this.maxExtent.left)/H);G=Math.round(G/this.tileSize.w);var D=Math.floor((this.maxExtent.top-B.top)/H);D=Math.round(D/this.tileSize.h);if(this.useHttpTile){E=this.getImageFilePath({tilecol:G,tilerow:D,scaleindex:this.resolutions.length-this.map.zoom-1})}else{E=this.getFullRequestString({tilecol:G,tilerow:D,scaleindex:this.resolutions.length-this.map.zoom-1})}}return E},getFullRequestString:function(G,F){var C=(F==null)?this.url:F;if(typeof C=="object"){C=C[Math.floor(Math.random()*C.length)]}var J=C;var H=OpenLayers.Util.extend({},this.params);H=OpenLayers.Util.extend(H,G);var E=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getArgs(C));for(var I in H){if(I.toUpperCase() in E){delete H[I]}}var B=OpenLayers.Util.getParameterString(H);B=B.replace(/,/g,"+");if(B!=""){var D=C.charAt(C.length-1);if((D=="&")||(D=="?")){J+=B}else{if(C.indexOf("?")==-1){J+="?"+B}else{J+="&"+B}}}return J},getImageFilePath:function(H,F){var D=(F==null)?this.url:F;if(typeof D=="object"){D=D[Math.floor(Math.random()*D.length)]}var C=D;var E="";var G="";if(H.tilerow<0){E="-"}if(H.tilerow==0){E+="0"}else{E+=Math.floor(Math.abs(H.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder}if(H.tilecol<0){G="-"}if(H.tilecol==0){G+="0"}else{G+=Math.floor(Math.abs(H.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder}var B="/S"+Math.floor(H.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+E+"/C"+G+"/"+(H.tilerow%this.params.tileRowsPerFolder)+"_"+(H.tilecol%this.params.tileColumnsPerFolder)+"."+this.params.format;if(this.params.querystring){B+="?"+this.params.querystring}C+=B;return C},calculateGridLayout:function(B,P,F){var L=F*this.tileSize.w;var D=F*this.tileSize.h;var J=B.left-P.left;var M=Math.floor(J/L)-this.buffer;var K=J/L-M;var G=-K*this.tileSize.w;var N=P.left+M*L;var C=P.top-B.top+D;var I=Math.floor(C/D)-this.buffer;var O=I-C/D;var E=O*this.tileSize.h;var H=P.top-D*I;return{tilelon:L,tilelat:D,tileoffsetlon:N,tileoffsetlat:H,tileoffsetx:G,tileoffsety:E}},CLASS_NAME:"OpenLayers.Layer.MapGuide"});OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(E,D,F,C){var B=[];B.push(E,D,F,C);OpenLayers.Layer.Grid.prototype.initialize.apply(this,B);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS);if(C==null||C.isBaseLayer==null){this.isBaseLayer=((this.params.transparent!="true")&&(this.params.transparent!=true))}},clone:function(B){if(B==null){B=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);return B},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},getURL:function(D){D=this.adjustBounds(D);var C=[D.left,D.bottom,D.right,D.top];var E=this.getImageSize();var B=this.getFullRequestString({mapext:C,imgext:C,map_size:[E.w,E.h],imgx:E.w/2,imgy:E.h/2,imgxy:[E.w,E.h]});return B},getFullRequestString:function(G,F){var C=(F==null)?this.url:F;var H=OpenLayers.Util.extend({},this.params);H=OpenLayers.Util.extend(H,G);var B=OpenLayers.Util.getParameterString(H);if(C instanceof Array){C=this.selectUrl(B,C)}var E=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(C));for(var I in H){if(I.toUpperCase() in E){delete H[I]}}B=OpenLayers.Util.getParameterString(H);var J=C;B=B.replace(/,/g,"+");if(B!=""){var D=C.charAt(C.length-1);if((D=="&")||(D=="?")){J+=B}else{if(C.indexOf("?")==-1){J+="?"+B}else{J+="&"+B}}}return J},CLASS_NAME:"OpenLayers.Layer.MapServer"});OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",isBaseLayer:true,tileOrigin:null,serverResolutions:null,initialize:function(E,D,C){var B=[];B.push(E,D,{},C);OpenLayers.Layer.Grid.prototype.initialize.apply(this,B)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new OpenLayers.Layer.TMS(this.name,this.url,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);return B},getURL:function(E){E=this.adjustBounds(E);var D=this.map.getResolution();var B=Math.round((E.left-this.tileOrigin.lon)/(D*this.tileSize.w));var H=Math.round((E.bottom-this.tileOrigin.lat)/(D*this.tileSize.h));var G=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,D):this.map.getZoom();var F=this.serviceVersion+"/"+this.layername+"/"+G+"/"+B+"/"+H+"."+this.type;var C=this.url;if(C instanceof Array){C=this.selectUrl(F,C)}return C+F},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},setMap:function(B){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.TMS"});OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,format:"image/png",serverResolutions:null,initialize:function(D,C,E,B){this.layername=E;OpenLayers.Layer.Grid.prototype.initialize.apply(this,[D,C,{},B]);this.extension=this.format.split("/")[1].toLowerCase();this.extension=(this.extension=="jpg")?"jpeg":this.extension},clone:function(B){if(B==null){B=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);return B},getURL:function(C){var G=this.map.getResolution();var H=this.maxExtent;var L=this.tileSize;var B=Math.round((C.left-H.left)/(G*L.w));var K=Math.round((C.bottom-H.bottom)/(G*L.h));var I=this.serverResolutions!=null?OpenLayers.Util.indexOf(this.serverResolutions,G):this.map.getZoom();function F(P,O){P=String(P);var M=[];for(var N=0;N<O;++N){M.push("0")}return M.join("").substring(0,O-P.length)+P}var E=[this.layername,F(I,2),F(parseInt(B/1000000),3),F((parseInt(B/1000)%1000),3),F((parseInt(B)%1000),3),F(parseInt(K/1000000),3),F((parseInt(K/1000)%1000),3),F((parseInt(K)%1000),3)+"."+this.extension];var J=E.join("/");var D=this.url;if(D instanceof Array){D=this.selectUrl(J,D)}D=(D.charAt(D.length-1)=="/")?D:D+"/";return D+J},addTile:function(D,B){var C=this.getURL(D);return new OpenLayers.Tile.Image(this,B,D,C,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.TileCache"});OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",exceptions:"application/vnd.ogc.se_inimage",format:"image/jpeg"},reproject:false,isBaseLayer:true,encodeBBOX:false,noMagic:false,initialize:function(E,D,F,C){var B=[];F=OpenLayers.Util.upperCaseObject(F);B.push(E,D,F,C);OpenLayers.Layer.Grid.prototype.initialize.apply(this,B);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(!this.noMagic&&this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((C==null)||(!C.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="image/jpeg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.Grid.prototype.clone.apply(this,[B]);return B},getURL:function(C){C=this.adjustBounds(C);var D=this.getImageSize();var E={BBOX:this.encodeBBOX?C.toBBOX():C.toArray(),WIDTH:D.w,HEIGHT:D.h};var B=this.getFullRequestString(E);return B},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},mergeNewParams:function(D){var C=OpenLayers.Util.upperCaseObject(D);var B=[C];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,B)},getFullRequestString:function(D,C){var B=this.map.getProjection();this.params.SRS=(B=="none")?null:B;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"});OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:true,lzd:null,zoomLevels:null,initialize:function(E,D,F,H,G,C){this.lzd=F;this.zoomLevels=H;var B=[];B.push(E,D,G,C);OpenLayers.Layer.Grid.prototype.initialize.apply(this,B);this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},getZoom:function(){var C=this.map.getZoom();var B=this.map.getMaxExtent();C=C-Math.log(this.maxResolution/(this.lzd/512))/Math.log(2);return C},getURL:function(F){F=this.adjustBounds(F);var E=this.getZoom();var C=this.map.getMaxExtent();var D=this.lzd/Math.pow(2,this.getZoom());var B=Math.floor((F.left-C.left)/D);var G=Math.floor((F.bottom-C.bottom)/D);if(this.map.getResolution()<=(this.lzd/512)&&this.getZoom()<=this.zoomLevels){return this.getFullRequestString({L:E,X:B,Y:G})}else{return OpenLayers.Util.getImagesLocation()+"blank.gif"}},CLASS_NAME:"OpenLayers.Layer.WorldWind"});OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:true,sphericalMercator:false,initialize:function(E,D,C){if(C&&C.sphericalMercator||this.sphericalMercator){C=OpenLayers.Util.extend({maxExtent:new OpenLayers.Bounds(-128*156543.0339,-128*156543.0339,128*156543.0339,128*156543.0339),maxResolution:156543.0339,numZoomLevels:19,units:"m",projection:"EPSG:900913"},C)}D=D||this.url;E=E||this.name;var B=[E,D,{},C];OpenLayers.Layer.Grid.prototype.initialize.apply(this,B)},clone:function(B){if(B==null){B=new OpenLayers.Layer.XYZ(this.name,this.url,this.options)}B=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[B]);if(this.tileSize!=null){B.tileSize=this.tileSize.clone()}B.grid=[];return B},getURL:function(B){var E=this.map.getResolution();var H=Math.round((B.left-this.maxExtent.left)/(E*this.tileSize.w));var G=Math.round((this.maxExtent.top-B.top)/(E*this.tileSize.h));var F=this.map.getZoom();var D=Math.pow(2,F);var C=this.url;var J=""+H+G+F;if(C instanceof Array){C=this.selectUrl(J,C)}var I=OpenLayers.String.format(C,{x:H,y:G,z:F});return I},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},setMap:function(B){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);if(!this.tileOrigin){this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom)}},CLASS_NAME:"OpenLayers.Layer.XYZ"});OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",attribution:"Data CC-By-SA by <a href='http://openstreetmap.org/'>OpenStreetMap</a>",sphericalMercator:true,url:"http://tile.openstreetmap.org/${z}/${x}/${y}.png",CLASS_NAME:"OpenLayers.Layer.OSM"});OpenLayers.Protocol.SQL.Gears=OpenLayers.Class(OpenLayers.Protocol.SQL,{FID_PREFIX:"__gears_fid__",NULL_GEOMETRY:"__gears_null_geometry__",NULL_FEATURE_STATE:"__gears_null_feature_state__",jsonParser:null,wktParser:null,fidRegExp:null,saveFeatureState:true,typeOfFid:"string",db:null,initialize:function(B){if(!this.supported()){return }OpenLayers.Protocol.SQL.prototype.initialize.apply(this,[B]);this.jsonParser=new OpenLayers.Format.JSON();this.wktParser=new OpenLayers.Format.WKT();this.fidRegExp=new RegExp("^"+this.FID_PREFIX);this.initializeDatabase()},initializeDatabase:function(){this.db=google.gears.factory.create("beta.database");this.db.open(this.databaseName);this.db.execute("CREATE TABLE IF NOT EXISTS "+this.tableName+" (fid TEXT UNIQUE, geometry TEXT, properties TEXT,  state TEXT)")},destroy:function(){this.db.close();this.db=null;this.jsonParser=null;this.wktParser=null;OpenLayers.Protocol.SQL.prototype.destroy.apply(this)},supported:function(){return !!(window.google&&google.gears)},read:function(C){C=OpenLayers.Util.applyDefaults(C,this.options);var D,E=[];var B=this.db.execute("SELECT * FROM "+this.tableName);while(B.isValidRow()){D=this.unfreezeFeature(B);if(this.evaluateFilter(D,C.filter)){if(!C.noFeatureStateReset){D.state=null}E.push(D)}B.next()}B.close();var F=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"read",features:E});if(C&&C.callback){C.callback.call(C.scope,F)}return F},unfreezeFeature:function(E){var B;var C=E.fieldByName("geometry");if(C==this.NULL_GEOMETRY){B=new OpenLayers.Feature.Vector()}else{B=this.wktParser.read(C)}B.attributes=this.jsonParser.read(E.fieldByName("properties"));B.fid=this.extractFidFromField(E.fieldByName("fid"));var D=E.fieldByName("state");if(D==this.NULL_FEATURE_STATE){D=null}B.state=D;return B},extractFidFromField:function(B){if(!B.match(this.fidRegExp)&&this.typeOfFid=="number"){B=parseFloat(B)}return B},create:function(C,B){B=OpenLayers.Util.applyDefaults(B,this.options);var D=this.createOrUpdate(C);D.requestType="create";if(B&&B.callback){B.callback.call(B.scope,D)}return D},update:function(C,B){B=OpenLayers.Util.applyDefaults(B,this.options);var D=this.createOrUpdate(C);D.requestType="update";if(B&&B.callback){B.callback.call(B.scope,D)}return D},createOrUpdate:function(F){if(!(F instanceof Array)){F=[F]}var D,B=F.length,C;var E=new Array(B);for(D=0;D<B;D++){C=F[D];var G=this.freezeFeature(C);this.db.execute("REPLACE INTO "+this.tableName+" (fid, geometry, properties, state) VALUES (?, ?, ?, ?)",G);var H=C.clone();H.fid=this.extractFidFromField(G[0]);E[D]=H}return new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,features:E,reqFeatures:F})},freezeFeature:function(C){C.fid=C.fid!=null?""+C.fid:OpenLayers.Util.createUniqueID(this.FID_PREFIX);var E=C.geometry!=null?C.geometry.toString():this.NULL_GEOMETRY;var B=this.jsonParser.write(C.attributes);var D=this.getFeatureStateForFreeze(C);return[C.fid,E,B,D]},getFeatureStateForFreeze:function(B){var C;if(!this.saveFeatureState){C=this.NULL_FEATURE_STATE}else{if(this.createdOffline(B)){C=OpenLayers.State.INSERT}else{C=B.state}}return C},"delete":function(G,D){if(!(G instanceof Array)){G=[G]}D=OpenLayers.Util.applyDefaults(D,this.options);var F,B,E;for(F=0,B=G.length;F<B;F++){E=G[F];if(this.saveFeatureState&&!this.createdOffline(E)){var C=E.clone();C.fid=E.fid;if(C.geometry){C.geometry.destroy();C.geometry=null}C.state=E.state;this.createOrUpdate(C)}else{this.db.execute("DELETE FROM "+this.tableName+" WHERE fid = ?",[E.fid])}}var H=new OpenLayers.Protocol.Response({code:OpenLayers.Protocol.Response.SUCCESS,requestType:"delete",reqFeatures:G});if(D&&D.callback){D.callback.call(D.scope,H)}return H},createdOffline:function(B){return(typeof B.fid=="string"&&!!(B.fid.match(this.fidRegExp)))},commit:function(D,M){var C,F=[],H=0,I=0;function K(N){if(++I<H){N.last=false}this.callUserCallback(M,N)}var L,J=[],B=[],E=[];for(var G=D.length-1;G>=0;G--){L=D[G];switch(L.state){case OpenLayers.State.INSERT:J.push(L);break;case OpenLayers.State.UPDATE:B.push(L);break;case OpenLayers.State.DELETE:E.push(L);break}}if(J.length>0){H++;C=OpenLayers.Util.applyDefaults({callback:K,scope:this},M.create);F.push(this.create(J,C))}if(B.length>0){H++;C=OpenLayers.Util.applyDefaults({callback:K,scope:this},M.update);F.push(this.update(B,C))}if(E.length>0){H++;C=OpenLayers.Util.applyDefaults({callback:K,scope:this},M["delete"]);F.push(this["delete"](E,C))}return F},clear:function(){this.db.execute("DELETE FROM "+this.tableName)},callUserCallback:function(B,D){var C=B[D.requestType];if(C&&C.callback){C.callback.call(C.scope,D)}if(D.last&&B.callback){B.callback.call(B.scope)}},CLASS_NAME:"OpenLayers.Protocol.SQL.Gears"});OpenLayers.Rule=OpenLayers.Class({id:null,name:"default",title:null,description:null,context:null,filter:null,elseFilter:false,symbolizer:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(B){this.symbolizer={};OpenLayers.Util.extend(this,B);this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var B in this.symbolizer){this.symbolizer[B]=null}this.symbolizer=null},evaluate:function(D){var C=this.getContext(D);var B=true;if(this.minScaleDenominator||this.maxScaleDenominator){var E=D.layer.map.getScale()}if(this.minScaleDenominator){B=E>=OpenLayers.Style.createLiteral(this.minScaleDenominator,C)}if(B&&this.maxScaleDenominator){B=E<OpenLayers.Style.createLiteral(this.maxScaleDenominator,C)}if(B&&this.filter){if(this.filter.CLASS_NAME=="OpenLayers.Filter.FeatureId"){B=this.filter.evaluate(D)}else{B=this.filter.evaluate(C)}}return B},getContext:function(C){var B=this.context;if(!B){B=C.attributes||C.data}if(typeof this.context=="function"){B=this.context(C)}return B},clone:function(){var B=OpenLayers.Util.extend({},this);B.symbolizer={};for(var C in this.symbolizer){value=this.symbolizer[C];type=typeof value;if(type==="object"){B.symbolizer[C]=OpenLayers.Util.extend({},value)}else{if(type==="string"){B.symbolizer[C]=value}}}B.filter=this.filter&&this.filter.clone();B.context=this.context&&OpenLayers.Util.extend({},this.context);return new OpenLayers.Rule(B)},CLASS_NAME:"OpenLayers.Rule"});OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:true,initialize:function(D,B){this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])};if(D instanceof OpenLayers.Style){this.styles["default"]=D;this.styles.select=D;this.styles.temporary=D;this.styles["delete"]=D}else{if(typeof D=="object"){for(var C in D){if(D[C] instanceof OpenLayers.Style){this.styles[C]=D[C]}else{if(typeof D[C]=="object"){this.styles[C]=new OpenLayers.Style(D[C])}else{this.styles["default"]=new OpenLayers.Style(D);this.styles.select=new OpenLayers.Style(D);this.styles.temporary=new OpenLayers.Style(D);this.styles["delete"]=new OpenLayers.Style(D);break}}}}}OpenLayers.Util.extend(this,B)},destroy:function(){for(var B in this.styles){this.styles[B].destroy()}this.styles=null},createSymbolizer:function(C,D){if(!C){C=new OpenLayers.Feature.Vector()}if(!this.styles[D]){D="default"}C.renderIntent=D;var B={};if(this.extendDefault&&D!="default"){B=this.styles["default"].createSymbolizer(C)}return OpenLayers.Util.extend(B,this.styles[D].createSymbolizer(C))},addUniqueValueRules:function(C,E,G,B){var F=[];for(var D in G){F.push(new OpenLayers.Rule({symbolizer:G[D],context:B,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:E,value:D})}))}this.styles[C].addRules(F)},CLASS_NAME:"OpenLayers.StyleMap"});OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(B){OpenLayers.Control.Panel.prototype.initialize.apply(this,[B]);this.addControls([new OpenLayers.Control.Navigation(),new OpenLayers.Control.ZoomBox()])},draw:function(){var B=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return B},CLASS_NAME:"OpenLayers.Control.NavToolbar"});OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:true,lowerBoundary:null,upperBoundary:null,initialize:function(B){OpenLayers.Filter.prototype.initialize.apply(this,[B])},evaluate:function(D){var B=false;switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:var C=D[this.property];var F=this.value;if(!this.matchCase&&typeof C=="string"&&typeof F=="string"){B=(C.toUpperCase()==F.toUpperCase())}else{B=(C==F)}break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:var C=D[this.property];var F=this.value;if(!this.matchCase&&typeof C=="string"&&typeof F=="string"){B=(C.toUpperCase()!=F.toUpperCase())}else{B=(C!=F)}break;case OpenLayers.Filter.Comparison.LESS_THAN:B=D[this.property]<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:B=D[this.property]>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:B=D[this.property]<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:B=D[this.property]>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:B=(D[this.property]>=this.lowerBoundary)&&(D[this.property]<=this.upperBoundary);break;case OpenLayers.Filter.Comparison.LIKE:var E=new RegExp(this.value,"gi");B=E.test(D[this.property]);break}return B},value2regex:function(E,C,B){if(E=="."){var D="'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison";OpenLayers.Console.error(D);return null}E=E?E:"*";C=C?C:".";B=B?B:"!";this.value=this.value.replace(new RegExp("\\"+B+"(.|$)","g"),"\\$1");this.value=this.value.replace(new RegExp("\\"+C,"g"),".");this.value=this.value.replace(new RegExp("\\"+E,"g"),".*");this.value=this.value.replace(new RegExp("\\\\.\\*","g"),"\\"+E);this.value=this.value.replace(new RegExp("\\\\\\.","g"),"\\"+C);return this.value},regex2value:function(){var B=this.value;B=B.replace(/!/g,"!!");B=B.replace(/(\\)?\\\./g,function(D,C){return C?D:"!."});B=B.replace(/(\\)?\\\*/g,function(D,C){return C?D:"!*"});B=B.replace(/\\\\/g,"\\");B=B.replace(/\.\*/g,"*");return B},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison(),this)},CLASS_NAME:"OpenLayers.Filter.Comparison"});OpenLayers.Filter.Comparison.EQUAL_TO="==";OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=";OpenLayers.Filter.Comparison.LESS_THAN="<";OpenLayers.Filter.Comparison.GREATER_THAN=">";OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=";OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=";OpenLayers.Filter.Comparison.BETWEEN="..";OpenLayers.Filter.Comparison.LIKE="~";OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,initialize:function(B){this.fids=[];OpenLayers.Filter.prototype.initialize.apply(this,[B])},evaluate:function(D){for(var C=0,B=this.fids.length;C<B;C++){var E=D.fid||D.id;if(E==this.fids[C]){return true}}return false},clone:function(){var B=new OpenLayers.Filter.FeatureId();OpenLayers.Util.extend(B,this);B.fids=this.fids.slice();return B},CLASS_NAME:"OpenLayers.Filter.FeatureId"});OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(B){this.filters=[];OpenLayers.Filter.prototype.initialize.apply(this,[B])},destroy:function(){this.filters=null;OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(D){switch(this.type){case OpenLayers.Filter.Logical.AND:for(var C=0,B=this.filters.length;C<B;C++){if(this.filters[C].evaluate(D)==false){return false}}return true;case OpenLayers.Filter.Logical.OR:for(var C=0,B=this.filters.length;C<B;C++){if(this.filters[C].evaluate(D)==true){return true}}return false;case OpenLayers.Filter.Logical.NOT:return(!this.filters[0].evaluate(D))}},clone:function(){var D=[];for(var C=0,B=this.filters.length;C<B;++C){D.push(this.filters[C].clone())}return new OpenLayers.Filter.Logical({type:this.type,filters:D})},CLASS_NAME:"OpenLayers.Filter.Logical"});OpenLayers.Filter.Logical.AND="&&";OpenLayers.Filter.Logical.OR="||";OpenLayers.Filter.Logical.NOT="!";OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,initialize:function(B){OpenLayers.Filter.prototype.initialize.apply(this,[B])},evaluate:function(D){var B=false;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(D.geometry){var C=this.value;if(this.value.CLASS_NAME=="OpenLayers.Bounds"){C=this.value.toGeometry()}if(D.geometry.intersects(C)){B=true}}break;default:OpenLayers.Console.error(OpenLayers.i18n("filterEvaluateNotImplemented"));break}return B},clone:function(){var B=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(B)},CLASS_NAME:"OpenLayers.Filter.Spatial"});OpenLayers.Filter.Spatial.BBOX="BBOX";OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS";OpenLayers.Filter.Spatial.DWITHIN="DWITHIN";OpenLayers.Filter.Spatial.WITHIN="WITHIN";OpenLayers.Filter.Spatial.CONTAINS="CONTAINS";OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(B){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.components=[];if(B!=null){this.addComponents(B)}},destroy:function(){this.components.length=0;this.components=null},clone:function(){var geometry=eval("new "+this.CLASS_NAME+"()");for(var i=0,len=this.components.length;i<len;i++){geometry.addComponent(this.components[i].clone())}OpenLayers.Util.applyDefaults(geometry,this);return geometry},getComponentsString:function(){var C=[];for(var D=0,B=this.components.length;D<B;D++){C.push(this.components[D].toShortString())}return C.join(",")},calculateBounds:function(){this.bounds=null;if(this.components&&this.components.length>0){this.setBounds(this.components[0].getBounds());for(var C=1,B=this.components.length;C<B;C++){this.extendBounds(this.components[C].getBounds())}}},addComponents:function(D){if(!(D instanceof Array)){D=[D]}for(var C=0,B=D.length;C<B;C++){this.addComponent(D[C])}},addComponent:function(C,B){var E=false;if(C){if(this.componentTypes==null||(OpenLayers.Util.indexOf(this.componentTypes,C.CLASS_NAME)>-1)){if(B!=null&&(B<this.components.length)){var F=this.components.slice(0,B);var D=this.components.slice(B,this.components.length);F.push(C);this.components=F.concat(D)}else{this.components.push(C)}C.parent=this;this.clearBounds();E=true}}return E},removeComponents:function(C){if(!(C instanceof Array)){C=[C]}for(var B=C.length-1;B>=0;--B){this.removeComponent(C[B])}},removeComponent:function(B){OpenLayers.Util.removeItem(this.components,B);this.clearBounds()},getLength:function(){var D=0;for(var C=0,B=this.components.length;C<B;C++){D+=this.components[C].getLength()}return D},getArea:function(){var D=0;for(var C=0,B=this.components.length;C<B;C++){D+=this.components[C].getArea()}return D},getGeodesicArea:function(C){var E=0;for(var D=0,B=this.components.length;D<B;D++){E+=this.components[D].getGeodesicArea(C)}return E},getCentroid:function(){return this.components.length&&this.components[0].getCentroid()},getGeodesicLength:function(C){var E=0;for(var D=0,B=this.components.length;D<B;D++){E+=this.components[D].getGeodesicLength(C)}return E},move:function(C,E){for(var D=0,B=this.components.length;D<B;D++){this.components[D].move(C,E)}},rotate:function(E,C){for(var D=0,B=this.components.length;D<B;++D){this.components[D].rotate(E,C)}},resize:function(E,B,D){for(var C=0;C<this.components.length;++C){this.components[C].resize(E,B,D)}return this},distanceTo:function(H,I){var C=!(I&&I.edge===false);var B=C&&I&&I.details;var J,D;var E=Number.POSITIVE_INFINITY;for(var F=0,G=this.components.length;F<G;++F){J=this.components[F].distanceTo(H,I);distance=B?J.distance:J;if(distance<E){E=distance;D=J;if(E==0){break}}}return D},equals:function(E){var C=true;if(!E||!E.CLASS_NAME||(this.CLASS_NAME!=E.CLASS_NAME)){C=false}else{if(!(E.components instanceof Array)||(E.components.length!=this.components.length)){C=false}else{for(var D=0,B=this.components.length;D<B;++D){if(!this.components[D].equals(E.components[D])){C=false;break}}}}return C},transform:function(F,D){if(F&&D){for(var E=0,B=this.components.length;E<B;E++){var C=this.components[E];C.transform(F,D)}this.bounds=null}return this},intersects:function(E){var C=false;for(var D=0,B=this.components.length;D<B;++D){C=E.intersects(this.components[D]);if(C){break}}return C},getVertices:function(C){var D=[];for(var E=0,B=this.components.length;E<B;++E){Array.prototype.push.apply(D,this.components[E].getVertices(C))}return D},CLASS_NAME:"OpenLayers.Geometry.Collection"});OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(B,C){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=parseFloat(B);this.y=parseFloat(C)},clone:function(B){if(B==null){B=new OpenLayers.Geometry.Point(this.x,this.y)}OpenLayers.Util.applyDefaults(B,this);return B},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(G,K){var E=!(K&&K.edge===false);var B=E&&K&&K.details;var C,F,I,D,H,J;if(G instanceof OpenLayers.Geometry.Point){F=this.x;I=this.y;D=G.x;H=G.y;C=Math.sqrt(Math.pow(F-D,2)+Math.pow(I-H,2));J=!B?C:{x0:F,y0:I,x1:D,y1:H,distance:C}}else{J=G.distanceTo(this,K);if(B){J={x0:J.x1,y0:J.y1,x1:J.x0,y1:J.y0,distance:J.distance}}}return J},equals:function(B){var C=false;if(B!=null){C=((this.x==B.x&&this.y==B.y)||(isNaN(this.x)&&isNaN(this.y)&&isNaN(B.x)&&isNaN(B.y)))}return C},toShortString:function(){return(this.x+", "+this.y)},move:function(B,C){this.x=this.x+B;this.y=this.y+C;this.clearBounds()},rotate:function(E,C){E*=Math.PI/180;var B=this.distanceTo(C);var D=E+Math.atan2(this.y-C.y,this.x-C.x);this.x=C.x+(B*Math.cos(D));this.y=C.y+(B*Math.sin(D));this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(D,B,C){C=(C==undefined)?1:C;this.x=B.x+(D*C*(this.x-B.x));this.y=B.y+(D*(this.y-B.y));this.clearBounds();return this},intersects:function(C){var B=false;if(C.CLASS_NAME=="OpenLayers.Geometry.Point"){B=this.equals(C)}else{B=C.intersects(this)}return B},transform:function(C,B){if((C&&B)){OpenLayers.Projection.transform(this,C,B);this.bounds=null}return this},getVertices:function(B){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"});OpenLayers.Geometry.Rectangle=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,width:null,height:null,initialize:function(C,E,D,B){OpenLayers.Geometry.prototype.initialize.apply(this,arguments);this.x=C;this.y=E;this.width=D;this.height=B},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x+this.width,this.y+this.height)},getLength:function(){var B=(2*this.width)+(2*this.height);return B},getArea:function(){var B=this.width*this.height;return B},CLASS_NAME:"OpenLayers.Geometry.Rectangle"});OpenLayers.Geometry.Surface=OpenLayers.Class(OpenLayers.Geometry,{initialize:function(){OpenLayers.Geometry.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Geometry.Surface"});OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(D,C,E,B){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments);this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||DEFAULT_FORMAT]},getURL:function(B){B=this.adjustBounds(B);var G=this.map.getResolution();var F=Math.round((this.map.getScale()*10000))/10000;var E=Math.round(B.left/G);var D=-Math.round(B.top/G);var J=Math.floor(E/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w;var I=Math.floor(D/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h;var C=this.url;if(C instanceof Array){C=this.selectUrl(paramsString,C)}var H=[C,"/",this.params.map,"/",F,"/",this.params.g.replace(/\s/g,"_"),"/def/t",I,"/l",J,"/t",D,"l",E,".",this.extension];return H.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"});OpenLayers.Layer.MapServer.Untiled=OpenLayers.Class(OpenLayers.Layer.MapServer,{singleTile:true,initialize:function(D,C,F,B){OpenLayers.Layer.MapServer.prototype.initialize.apply(this,arguments);var E="The OpenLayers.Layer.MapServer.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.MapServer class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(E)},clone:function(B){if(B==null){B=new OpenLayers.Layer.MapServer.Untiled(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.MapServer.prototype.clone.apply(this,[B]);return B},CLASS_NAME:"OpenLayers.Layer.MapServer.Untiled"});OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{EVENT_TYPES:["beforefeatureadded","beforefeaturesadded","featureadded","featuresadded","beforefeatureremoved","featureremoved","featuresremoved","beforefeatureselected","featureselected","featureunselected","beforefeaturemodified","featuremodified","afterfeaturemodified","vertexmodified","sketchstarted","sketchmodified","sketchcomplete","refresh"],isBaseLayer:false,isFixed:false,isVector:true,features:null,selectedFeatures:null,unrenderedFeatures:null,reportError:true,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:false,initialize:function(D,C){this.EVENT_TYPES=OpenLayers.Layer.Vector.prototype.EVENT_TYPES.concat(OpenLayers.Layer.prototype.EVENT_TYPES);OpenLayers.Layer.prototype.initialize.apply(this,arguments);if(!this.renderer||!this.renderer.supported()){this.assignRenderer()}if(!this.renderer||!this.renderer.supported()){this.renderer=null;this.displayError()}if(!this.styleMap){this.styleMap=new OpenLayers.StyleMap()}this.features=[];this.selectedFeatures=[];this.unrenderedFeatures={};if(this.strategies){for(var E=0,B=this.strategies.length;E<B;E++){this.strategies[E].setLayer(this)}}},destroy:function(){if(this.strategies){var D,C,B;for(C=0,B=this.strategies.length;C<B;C++){D=this.strategies[C];if(D.autoDestroy){D.destroy()}}this.strategies=null}if(this.protocol){if(this.protocol.autoDestroy){this.protocol.destroy()}this.protocol=null}this.destroyFeatures();this.features=null;this.selectedFeatures=null;this.unrenderedFeatures=null;if(this.renderer){this.renderer.destroy()}this.renderer=null;this.geometryType=null;this.drawn=null;OpenLayers.Layer.prototype.destroy.apply(this,arguments)},refresh:function(B){if(this.calculateInRange()&&this.visibility){this.events.triggerEvent("refresh",B)}},assignRenderer:function(){for(var D=0,B=this.renderers.length;D<B;D++){var C=OpenLayers.Renderer[this.renderers[D]];if(C&&C.prototype.supported()){this.renderer=new C(this.div,this.rendererOptions);break}}},displayError:function(){if(this.reportError){OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))}},setMap:function(B){OpenLayers.Layer.prototype.setMap.apply(this,arguments);if(!this.renderer){this.map.removeLayer(this)}else{this.renderer.map=this.map;this.renderer.setSize(this.map.getSize())}},afterAdd:function(){if(this.strategies){var D,C,B;for(C=0,B=this.strategies.length;C<B;C++){D=this.strategies[C];if(D.autoActivate){D.activate()}}}},removeMap:function(D){if(this.strategies){var E,C,B;for(C=0,B=this.strategies.length;C<B;C++){E=this.strategies[C];if(E.autoActivate){E.deactivate()}}}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);this.renderer.setSize(this.map.getSize())},moveTo:function(H,C,I){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var F=true;if(!I){this.renderer.root.style.visibility="hidden";this.div.style.left=-parseInt(this.map.layerContainerDiv.style.left)+"px";this.div.style.top=-parseInt(this.map.layerContainerDiv.style.top)+"px";var G=this.map.getExtent();F=this.renderer.setExtent(G,C);this.renderer.root.style.visibility="visible";if(navigator.userAgent.toLowerCase().indexOf("gecko")!=-1){this.div.scrollLeft=this.div.scrollLeft}if(!C&&F){for(var E in this.unrenderedFeatures){var D=this.unrenderedFeatures[E];this.drawFeature(D)}}}if(!this.drawn||C||!F){this.drawn=true;var D;for(var E=0,B=this.features.length;E<B;E++){this.renderer.locked=(E!==(B-1));D=this.features[E];this.drawFeature(D)}}},display:function(B){OpenLayers.Layer.prototype.display.apply(this,arguments);var C=this.div.style.display;if(C!=this.renderer.root.style.display){this.renderer.root.style.display=C}},addFeatures:function(C,J){if(!(C instanceof Array)){C=[C]}var H=!J||!J.silent;if(H){var B={features:C};var G=this.events.triggerEvent("beforefeaturesadded",B);if(G===false){return }C=B.features}for(var D=0,F=C.length;D<F;D++){if(D!=(C.length-1)){this.renderer.locked=true}else{this.renderer.locked=false}var I=C[D];if(this.geometryType&&!(I.geometry instanceof this.geometryType)){var E=OpenLayers.i18n("componentShouldBe",{geomType:this.geometryType.prototype.CLASS_NAME});throw E}this.features.push(I);I.layer=this;if(!I.style&&this.style){I.style=OpenLayers.Util.extend({},this.style)}if(H){if(this.events.triggerEvent("beforefeatureadded",{feature:I})===false){continue}this.preFeatureInsert(I)}this.drawFeature(I);if(H){this.events.triggerEvent("featureadded",{feature:I});this.onFeatureInsert(I)}}if(H){this.events.triggerEvent("featuresadded",{features:C})}},removeFeatures:function(F,B){if(!F||F.length===0){return }if(!(F instanceof Array)){F=[F]}if(F===this.features){F=F.slice()}var E=!B||!B.silent;for(var D=F.length-1;D>=0;D--){if(D!=0&&F[D-1].geometry){this.renderer.locked=true}else{this.renderer.locked=false}var C=F[D];delete this.unrenderedFeatures[C.id];if(E){this.events.triggerEvent("beforefeatureremoved",{feature:C})}this.features=OpenLayers.Util.removeItem(this.features,C);C.layer=null;if(C.geometry){this.renderer.eraseFeatures(C)}if(OpenLayers.Util.indexOf(this.selectedFeatures,C)!=-1){OpenLayers.Util.removeItem(this.selectedFeatures,C)}if(E){this.events.triggerEvent("featureremoved",{feature:C})}}if(E){this.events.triggerEvent("featuresremoved",{features:F})}},destroyFeatures:function(E,B){var D=(E==undefined);if(D){E=this.features}if(E){this.removeFeatures(E,B);for(var C=E.length-1;C>=0;C--){E[C].destroy()}}},drawFeature:function(B,C){if(!this.drawn){return }if(typeof C!="object"){if(!C&&B.state===OpenLayers.State.DELETE){C="delete"}var D=C||B.renderIntent;C=B.style||this.style;if(!C){C=this.styleMap.createSymbolizer(B,D)}}if(!this.renderer.drawFeature(B,C)){this.unrenderedFeatures[B.id]=B}else{delete this.unrenderedFeatures[B.id]}},eraseFeatures:function(B){this.renderer.eraseFeatures(B)},getFeatureFromEvent:function(B){if(!this.renderer){OpenLayers.Console.error(OpenLayers.i18n("getFeatureError"));return null}var C=this.renderer.getFeatureIdFromEvent(B);return this.getFeatureById(C)},getFeatureById:function(E){var D=null;for(var C=0,B=this.features.length;C<B;++C){if(this.features[C].id==E){D=this.features[C];break}}return D},onFeatureInsert:function(B){},preFeatureInsert:function(B){},getDataExtent:function(){var C=null;if(this.features&&(this.features.length>0)){C=new OpenLayers.Bounds();for(var D=0,B=this.features.length;D<B;D++){C.extend(this.features[D].geometry.getBounds())}}return C},CLASS_NAME:"OpenLayers.Layer.Vector"});OpenLayers.Layer.WMS.Untiled=OpenLayers.Class(OpenLayers.Layer.WMS,{singleTile:true,initialize:function(D,C,F,B){OpenLayers.Layer.WMS.prototype.initialize.apply(this,arguments);var E="The OpenLayers.Layer.WMS.Untiled class is deprecated and will be removed in 3.0. Instead, you should use the normal OpenLayers.Layer.WMS class, passing it the option 'singleTile' as true.";OpenLayers.Console.warn(E)},clone:function(B){if(B==null){B=new OpenLayers.Layer.WMS.Untiled(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.WMS.prototype.clone.apply(this,[B]);return B},CLASS_NAME:"OpenLayers.Layer.WMS.Untiled"});OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:false,click:true,clickout:true,toggle:false,clickTolerance:5,hover:false,box:false,maxFeatures:10,features:null,hoverFeature:null,handlerOptions:null,handlers:null,hoverResponse:null,EVENT_TYPES:["featureselected","featureunselected","clickout","beforefeatureselected","hoverfeature","outfeature"],initialize:function(B){this.EVENT_TYPES=OpenLayers.Control.GetFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);B.handlerOptions=B.handlerOptions||{};OpenLayers.Control.prototype.initialize.apply(this,[B]);this.features={};this.handlers={};if(this.click){this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectSingle},this.handlerOptions.click||{})}if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}))}if(this.hover){this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250}))}},activate:function(){if(!this.active){for(var B in this.handlers){this.handlers[B].activate()}}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){for(var B in this.handlers){this.handlers[B].deactivate()}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(B){var D;for(var C=this.features.length-1;C>=0;--C){D=this.features[C];if(!B||B.except!=D){this.unselect(D)}}},selectSingle:function(B){OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");var C=this.pixelToBounds(B.xy);this.setModifiers(B);this.request(C,{single:true})},selectBox:function(B){if(B instanceof OpenLayers.Bounds){var E=this.map.getLonLatFromPixel(new OpenLayers.Pixel(B.left,B.bottom));var C=this.map.getLonLatFromPixel(new OpenLayers.Pixel(B.right,B.top));var D=new OpenLayers.Bounds(E.lon,E.lat,C.lon,C.lat);this.setModifiers(this.handlers.box.dragHandler.evt);this.request(D)}},selectHover:function(B){var C=this.pixelToBounds(B.xy);this.request(C,{single:true,hover:true})},cancelHover:function(){if(this.hoverResponse){this.protocol.abort(this.hoverResponse);this.hoverResponse=null}},request:function(E,C){C=C||{};var D=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:E});var B=this.protocol.read({maxFeatures:C.single==true?this.maxFeatures:undefined,filter:D,callback:function(F){if(F.code==1){if(F.features.length){if(C.single==true){this.selectBestFeature(F.features,E.getCenterLonLat(),C)}else{this.select(F.features)}}else{if(C.hover){this.hoverSelect()}else{this.events.triggerEvent("clickout");if(this.clickout){this.unselectAll()}}}}OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});if(C.hover==true){this.hoverResponse=B}},selectBestFeature:function(C,B,J){J=J||{};if(C.length){var H=new OpenLayers.Geometry.Point(B.lon,B.lat);var I,E,F;var G=Number.MAX_VALUE;for(var D=0;D<C.length;++D){I=C[D];if(I.geometry){F=H.distanceTo(I.geometry,{edge:false});if(F<G){G=F;E=I;if(G==0){break}}}}if(J.hover==true){this.hoverSelect(E)}else{this.select(E||C)}}},setModifiers:function(B){this.modifiers={multiple:this.multiple||(this.multipleKey&&B[this.multipleKey]),toggle:this.toggle||(this.toggleKey&&B[this.toggleKey])}},select:function(E){if(!this.modifiers.multiple&&!this.modifiers.toggle){this.unselectAll()}if(!(E instanceof Array)){E=[E]}var D;for(var C=0,B=E.length;C<B;++C){D=E[C];if(this.features[D.fid||D.id]){if(this.modifiers.toggle){this.unselect(this.features[D.fid||D.id])}}else{cont=this.events.triggerEvent("beforefeatureselected",{feature:D});if(cont!==false){this.features[D.fid||D.id]=D;this.events.triggerEvent("featureselected",{feature:D})}}}},hoverSelect:function(B){var D=B?B.fid||B.id:null;var C=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;if(C&&C!=D){this.events.triggerEvent("outfeature",{feature:this.hoverFeature});this.hoverFeature=null}if(D&&D!=C){this.events.triggerEvent("hoverfeature",{feature:B});this.hoverFeature=B}},unselect:function(B){delete this.features[B.fid||B.id];this.events.triggerEvent("featureunselected",{feature:B})},unselectAll:function(){for(var B in this.features){this.unselect(this.features[B])}},setMap:function(C){for(var B in this.handlers){this.handlers[B].setMap(C)}OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(C){var F=C.add(-this.clickTolerance/2,this.clickTolerance/2);var B=C.add(this.clickTolerance/2,-this.clickTolerance/2);var D=this.map.getLonLatFromPixel(F);var E=this.map.getLonLatFromPixel(B);return new OpenLayers.Bounds(D.lon,D.lat,E.lon,E.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"});OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesnap","snap","unsnap"],DEFAULTS:{tolerance:10,node:true,edge:true,vertex:true},greedy:true,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(B){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[B]);this.options=B||{};if(this.options.layer){this.setLayer(this.options.layer)}var C=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(C,this.DEFAULTS);this.setTargets(this.options.targets);if(this.targets.length===0&&this.layer){this.addTargetLayer(this.layer)}this.geoToleranceCache={}},setLayer:function(B){if(this.active){this.deactivate();this.layer=B;this.activate()}else{this.layer=B}},setTargets:function(C){this.targets=[];if(C&&C.length){var E;for(var D=0,B=C.length;D<B;++D){E=C[D];if(E instanceof OpenLayers.Layer.Vector){this.addTargetLayer(E)}else{this.addTarget(E)}}}},addTargetLayer:function(B){this.addTarget({layer:B})},addTarget:function(B){B=OpenLayers.Util.applyDefaults(B,this.defaults);B.nodeTolerance=B.nodeTolerance||B.tolerance;B.vertexTolerance=B.vertexTolerance||B.tolerance;B.edgeTolerance=B.edgeTolerance||B.tolerance;this.targets.push(B)},removeTargetLayer:function(C){var D;for(var B=this.targets.length-1;B>=0;--B){D=this.targets[B];if(D.layer===C){this.removeTarget(D)}}},removeTarget:function(B){return OpenLayers.Util.removeItem(this.targets,B)},activate:function(){var B=OpenLayers.Control.prototype.activate.call(this);if(B){if(this.layer&&this.layer.events){this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})}}return B},deactivate:function(){var B=OpenLayers.Control.prototype.deactivate.call(this);if(B){if(this.layer&&this.layer.events){this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this})}}this.feature=null;this.point=null;return B},onSketchModified:function(B){this.feature=B.feature;this.considerSnapping(B.vertex,B.vertex)},onVertexModified:function(B){this.feature=B.feature;var C=this.layer.map.getLonLatFromViewPortPx(B.pixel);this.considerSnapping(B.vertex,new OpenLayers.Geometry.Point(C.lon,C.lat))},considerSnapping:function(I,E){var B={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null};var D=false;var J,G;for(var C=0,F=this.targets.length;C<F;++C){G=this.targets[C];J=this.testTarget(G,E);if(J){if(this.greedy){B=J;B.target=G;D=true;break}else{if((J.rank<B.rank)||(J.rank===B.rank&&J.dist<B.dist)){B=J;B.target=G;D=true}}}}if(D){var H=this.events.triggerEvent("beforesnap",{point:I,x:B.x,y:B.y,distance:B.dist,layer:B.target.layer,snapType:this.precedence[B.rank]});if(H!==false){I.x=B.x;I.y=B.y;this.point=I;this.events.triggerEvent("snap",{point:I,snapType:this.precedence[B.rank],layer:B.target.layer,distance:B.dist})}else{D=false}}if(this.point&&!D){I.x=E.x;I.y=E.y;this.point=null;this.events.triggerEvent("unsnap",{point:I})}},testTarget:function(W,G){var U={node:this.getGeoTolerance(W.nodeTolerance),vertex:this.getGeoTolerance(W.vertexTolerance),edge:this.getGeoTolerance(W.edgeTolerance)};var H=Math.max(U.node,U.vertex,U.edge);var I={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY};var F=false;var D=W.layer.features;var C,B,E,V,M,N,L;var K=this.precedence.length;var J=new OpenLayers.LonLat(G.x,G.y);for(var S=0,T=D.length;S<T;++S){C=D[S];if(C!==this.feature&&!C._sketch&&C.state!==OpenLayers.State.DELETE&&(!W.filter||W.filter.evaluate(C.attributes))){if(C.atPoint(J,H,H)){for(var R=0,O=Math.min(I.rank+1,K);R<O;++R){B=this.precedence[R];if(W[B]){if(B==="edge"){M=C.geometry.distanceTo(G,{details:true});N=M.distance;if(N<=U[B]&&N<I.dist){I={rank:R,dist:N,x:M.x0,y:M.y0};F=true;break}}else{E=C.geometry.getVertices(B==="node");L=false;for(var Q=0,P=E.length;Q<P;++Q){V=E[Q];N=V.distanceTo(G);if(N<=U[B]&&(R<I.rank||(R===I.rank&&N<I.dist))){I={rank:R,dist:N,x:V.x,y:V.y};F=true;L=true}}if(L){break}}}}}}}return F?I:null},getGeoTolerance:function(B){var C=this.layer.map.getResolution();if(C!==this.resolution){this.resolution=C;this.geoToleranceCache={}}var D=this.geoToleranceCache[B];if(D===undefined){D=B*C;this.geoToleranceCache[B]=D}return D},destroy:function(){if(this.active){this.deactivate()}delete this.layer;delete this.targets;OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"});OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,parser:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},write:function(D,C){var B=(C&&C.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=B){var E=OpenLayers.Format.Filter["v"+B.replace(/\./g,"_")];if(!E){throw"Can't find a Filter parser for version "+B}this.parser=new E(this.options)}return this.parser.write(D)},read:function(D){if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}var B=this.version;if(!B){B=this.defaultVersion}if(!this.parser||this.parser.VERSION!=B){var E=OpenLayers.Format.Filter["v"+B.replace(/\./g,"_")];if(!E){throw"Can't find a Filter parser for version "+B}this.parser=new E(this.options)}var C=this.parser.read(D);return C},CLASS_NAME:"OpenLayers.Format.Filter"});OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:"1.0.0",version:null,namedLayersAsArray:false,parser:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},write:function(E,D){var C=(D&&D.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=C){var F=OpenLayers.Format.SLD["v"+C.replace(/\./g,"_")];if(!F){throw"Can't find a SLD parser for version "+C}this.parser=new F(this.options)}var B=this.parser.write(E);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},read:function(F,D){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var C=F.documentElement;var B=this.version;if(!B){B=C.getAttribute("version");if(!B){B=this.defaultVersion}}if(!this.parser||this.parser.VERSION!=B){var G=OpenLayers.Format.SLD["v"+B.replace(/\./g,"_")];if(!G){throw"Can't find a SLD parser for version "+B}this.parser=new G(this.options)}var E=this.parser.read(F,D);return E},CLASS_NAME:"OpenLayers.Format.SLD"});OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:true,initialize:function(B){B=B||{};if(B.extractStyles!==false){B.defaultStyle={externalGraphic:OpenLayers.Util.getImagesLocation()+"marker.png",graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5}}OpenLayers.Format.prototype.initialize.apply(this,[B])},read:function(K){var B=K.split("\n");var C;var H=[];for(var U=0;U<(B.length-1);U++){var T=B[U].replace(/^\s*/,"").replace(/\s*$/,"");if(T.charAt(0)!="#"){if(!C){C=T.split("\t")}else{var M=T.split("\t");var E=new OpenLayers.Geometry.Point(0,0);var I={};var Q=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null;var R,S,D,O;var L=false;for(var J=0;J<M.length;J++){if(M[J]){if(C[J]=="point"){var P=M[J].split(",");E.y=parseFloat(P[0]);E.x=parseFloat(P[1]);L=true}else{if(C[J]=="lat"){E.y=parseFloat(M[J]);L=true}else{if(C[J]=="lon"){E.x=parseFloat(M[J]);L=true}else{if(C[J]=="title"){I.title=M[J]}else{if(C[J]=="image"||C[J]=="icon"&&Q){Q.externalGraphic=M[J]}else{if(C[J]=="iconSize"&&Q){var N=M[J].split(",");Q.graphicWidth=parseFloat(N[0]);Q.graphicHeight=parseFloat(N[1])}else{if(C[J]=="iconOffset"&&Q){var G=M[J].split(",");Q.graphicXOffset=parseFloat(G[0]);Q.graphicYOffset=parseFloat(G[1])}else{if(C[J]=="description"){I.description=M[J]}else{if(C[J]=="overflow"){I.overflow=M[J]}else{I[C[J]]=M[J]}}}}}}}}}}}if(L){if(this.internalProjection&&this.externalProjection){E.transform(this.externalProjection,this.internalProjection)}var F=new OpenLayers.Feature.Vector(E,I,Q);H.push(F)}}}}return H},CLASS_NAME:"OpenLayers.Format.Text"});OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(B){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},addPoint:function(B,C){this.addComponent(B,C)},removePoint:function(B){this.removeComponent(B)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"});OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:false,drawing:false,mouseDown:false,lastDown:null,lastUp:null,persist:false,layerOptions:null,initialize:function(D,C,B){if(!(B&&B.layerOptions&&B.layerOptions.styleMap)){this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})}OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments)){return false}var B=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:function(){return true}},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,B);this.map.addLayer(this.layer);return true},createFeature:function(B){var C=this.map.getLonLatFromPixel(B);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(C.lon,C.lat));this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],{silent:true})},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){return false}if(this.drawing){this.cancel()}this.destroyFeature();if(this.layer.map!=null){this.layer.destroy(false)}this.layer=null;return true},destroyFeature:function(){if(this.layer){this.layer.destroyFeatures()}this.point=null},finalize:function(C){var B=C?"cancel":"done";this.drawing=false;this.mouseDown=false;this.lastDown=null;this.lastUp=null;this.callback(B,[this.geometryClone()]);if(C||!this.persist){this.destroyFeature()}},cancel:function(){this.finalize(true)},click:function(B){OpenLayers.Event.stop(B);return false},dblclick:function(B){OpenLayers.Event.stop(B);return false},modifyFeature:function(B){var C=this.map.getLonLatFromPixel(B);this.point.geometry.x=C.lon;this.point.geometry.y=C.lat;this.callback("modify",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var B=this.point&&this.point.geometry;if(B&&this.multi){B=new OpenLayers.Geometry.MultiPoint([B])}return B},geometryClone:function(){var B=this.getGeometry();return B&&B.clone()},mousedown:function(B){if(!this.checkModifiers(B)){return true}if(this.lastDown&&this.lastDown.equals(B.xy)){return true}this.drawing=true;if(this.lastDown==null){if(this.persist){this.destroyFeature()}this.createFeature(B.xy)}else{this.modifyFeature(B.xy)}this.lastDown=B.xy;return false},mousemove:function(B){if(this.drawing){this.modifyFeature(B.xy)}return true},mouseup:function(B){if(this.drawing){this.finalize();return false}else{return true}},CLASS_NAME:"OpenLayers.Handler.Point"});OpenLayers.Layer.GML=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:false,format:null,formatOptions:null,initialize:function(E,D,C){var B=[];B.push(E,C);OpenLayers.Layer.Vector.prototype.initialize.apply(this,B);this.url=D},setVisibility:function(B,C){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadGML()}},moveTo:function(D,B,C){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadGML()}},loadGML:function(){if(!this.loaded){this.events.triggerEvent("loadstart");OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this});this.loaded=true}},setUrl:function(B){this.url=B;this.destroyFeatures();this.loaded=false;this.loadGML()},requestSuccess:function(D){var E=D.responseXML;if(!E||!E.documentElement){E=D.responseText}var B={};OpenLayers.Util.extend(B,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){B.externalProjection=this.projection;B.internalProjection=this.map.getProjectionObject()}var C=this.format?new this.format(B):new OpenLayers.Format.GML(B);this.addFeatures(C.read(E));this.events.triggerEvent("loadend")},requestFailure:function(B){OpenLayers.Console.userError(OpenLayers.i18n("errorLoadingGML",{url:this.url}));this.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Layer.GML"});OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,initialize:function(C,B){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments)},addNodes:function(G){if(G.length<2){OpenLayers.Console.error("At least two point features have to be added to createa line from");return }var K=new Array(G.length-1);var H,B,I;for(var D=0,F=G.length;D<F;D++){H=G[D];I=H.geometry;if(!I){var E=H.lonlat;I=new OpenLayers.Geometry.Point(E.lon,E.lat)}else{if(I.CLASS_NAME!="OpenLayers.Geometry.Point"){OpenLayers.Console.error("Only features with point geometries are supported.");return }}if(D>0){var C=(this.dataFrom!=null)?(G[D+this.dataFrom].data||G[D+this.dataFrom].attributes):null;var J=new OpenLayers.Geometry.LineString([B,I]);K[D-1]=new OpenLayers.Feature.Vector(J,C)}B=I}this.addFeatures(K)},CLASS_NAME:"OpenLayers.Layer.PointTrack"});OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0};OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:false,layers:null,initialize:function(C,B){OpenLayers.Layer.Vector.prototype.initialize.apply(this,arguments)},display:function(){},getFeatureFromEvent:function(B){var E=this.layers;var D;for(var C=0;C<E.length;C++){D=E[C].getFeatureFromEvent(B);if(D){return D}}},setMap:function(B){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);this.collectRoots();B.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(B){B.events.unregister("changelayer",this,this.handleChangeLayer);this.resetRoots();OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){var C;for(var B=0;B<this.map.layers.length;++B){C=this.map.layers[B];if(OpenLayers.Util.indexOf(this.layers,C)!=-1){C.renderer.moveRoot(this.renderer)}}},resetRoots:function(){var C;for(var B=0;B<this.layers.length;++B){C=this.layers[B];if(this.renderer&&C.renderer.getRenderLayerId()==this.id){this.renderer.moveRoot(C.renderer)}}},handleChangeLayer:function(B){var C=B.layer;if(B.property=="order"&&OpenLayers.Util.indexOf(this.layers,C)!=-1){this.resetRoots();this.collectRoots()}},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"});OpenLayers.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.Vector,OpenLayers.Layer.Markers,{isBaseLayer:false,tile:null,ratio:2,DEFAULT_PARAMS:{service:"WFS",version:"1.0.0",request:"GetFeature"},featureClass:null,format:null,formatObject:null,formatOptions:null,vectorMode:true,encodeBBOX:false,extractAttributes:false,initialize:function(E,D,F,C){if(C==undefined){C={}}if(C.featureClass||!OpenLayers.Layer.Vector||!OpenLayers.Feature.Vector){this.vectorMode=false}OpenLayers.Util.extend(C,{reportError:false});var B=[];B.push(E,C);OpenLayers.Layer.Vector.prototype.initialize.apply(this,B);if(!this.renderer||!this.vectorMode){this.vectorMode=false;if(!C.featureClass){C.featureClass=OpenLayers.Feature.WFS}OpenLayers.Layer.Markers.prototype.initialize.apply(this,B)}if(this.params&&this.params.typename&&!this.options.typename){this.options.typename=this.params.typename}if(!this.options.geometry_column){this.options.geometry_column="the_geom"}this.params=OpenLayers.Util.applyDefaults(F,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));this.url=D},destroy:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments)}if(this.tile){this.tile.destroy()}this.tile=null;this.ratio=null;this.featureClass=null;this.format=null;if(this.formatObject&&this.formatObject.destroy){this.formatObject.destroy()}this.formatObject=null;this.formatOptions=null;this.vectorMode=null;this.encodeBBOX=null;this.extractAttributes=null},setMap:function(C){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);var B={extractAttributes:this.extractAttributes};OpenLayers.Util.extend(B,this.formatOptions);if(this.map&&!this.projection.equals(this.map.getProjectionObject())){B.externalProjection=this.projection;B.internalProjection=this.map.getProjectionObject()}this.formatObject=this.format?new this.format(B):new OpenLayers.Format.GML(B)}else{OpenLayers.Layer.Markers.prototype.setMap.apply(this,arguments)}},moveTo:function(B,C,O){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments)}if(O){return false}if(C){if(this.vectorMode){this.renderer.clear()}}if(this.options.minZoomLevel){OpenLayers.Console.warn(OpenLayers.i18n("minZoomLevelError"));if(this.map.getZoom()<this.options.minZoomLevel){return null}}if(B==null){B=this.map.getExtent()}var N=(this.tile==null);var H=(!N&&!this.tile.bounds.containsBounds(B));if(C||N||(!O&&H)){var D=B.getCenterLonLat();var M=B.getWidth()*this.ratio;var I=B.getHeight()*this.ratio;var K=new OpenLayers.Bounds(D.lon-(M/2),D.lat-(I/2),D.lon+(M/2),D.lat+(I/2));var P=this.map.getSize();P.w=P.w*this.ratio;P.h=P.h*this.ratio;var J=new OpenLayers.LonLat(K.left,K.top);var L=this.map.getLayerPxFromLonLat(J);var E=this.getFullRequestString();var G=null;var F=this.params.filter||this.params.FILTER;if(F){G={FILTER:F}}else{G={BBOX:this.encodeBBOX?K.toBBOX():K.toArray()}}if(this.map&&!this.projection.equals(this.map.getProjectionObject())){var Q=K.clone();Q.transform(this.map.getProjectionObject(),this.projection);if(!F){G.BBOX=this.encodeBBOX?Q.toBBOX():Q.toArray()}}E+="&"+OpenLayers.Util.getParameterString(G);if(!this.tile){this.tile=new OpenLayers.Tile.WFS(this,L,K,E,P);this.addTileMonitoringHooks(this.tile);this.tile.draw()}else{if(this.vectorMode){this.destroyFeatures();this.renderer.clear()}else{this.clearMarkers()}this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null;this.tile=new OpenLayers.Tile.WFS(this,L,K,E,P);this.addTileMonitoringHooks(this.tile);this.tile.draw()}}},addTileMonitoringHooks:function(B){B.onLoadStart=function(){if(this==this.layer.tile){this.layer.events.triggerEvent("loadstart")}};B.events.register("loadstart",B,B.onLoadStart);B.onLoadEnd=function(){if(this==this.layer.tile){this.layer.events.triggerEvent("tileloaded");this.layer.events.triggerEvent("loadend")}};B.events.register("loadend",B,B.onLoadEnd);B.events.register("unload",B,B.onLoadEnd)},removeTileMonitoringHooks:function(B){B.unload();B.events.un({loadstart:B.onLoadStart,loadend:B.onLoadEnd,unload:B.onLoadEnd,scope:B})},onMapResize:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.onMapResize.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.onMapResize.apply(this,arguments)}},display:function(){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.display.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.display.apply(this,arguments)}},mergeNewParams:function(D){var C=OpenLayers.Util.upperCaseObject(D);var B=[C];return OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams.apply(this,B)},clone:function(B){if(B==null){B=new OpenLayers.Layer.WFS(this.name,this.url,this.params,this.options)}if(this.vectorMode){B=OpenLayers.Layer.Vector.prototype.clone.apply(this,[B])}else{B=OpenLayers.Layer.Markers.prototype.clone.apply(this,[B])}return B},getFullRequestString:function(D,C){var B=this.projection.getCode()||this.map.getProjection();this.params.SRS=(B=="none")?null:B;return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},commit:function(){if(!this.writer){var B={};if(this.map&&!this.projection.equals(this.map.getProjectionObject())){B.externalProjection=this.projection;B.internalProjection=this.map.getProjectionObject()}this.writer=new OpenLayers.Format.WFS(B,this)}var C=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:C,success:this.commitSuccess,failure:this.commitFailure,scope:this})},commitSuccess:function(D){var B=D.responseText;if(B.indexOf("SUCCESS")!=-1){this.commitReport(OpenLayers.i18n("commitSuccess",{response:B}));for(var C=0;C<this.features.length;C++){this.features[C].state=null}}else{if(B.indexOf("FAILED")!=-1||B.indexOf("Exception")!=-1){this.commitReport(OpenLayers.i18n("commitFailed",{response:B}))}}},commitFailure:function(B){},commitReport:function(C,B){OpenLayers.Console.userError(C)},refresh:function(){if(this.tile){if(this.vectorMode){this.renderer.clear();this.features.length=0}else{this.clearMarkers();this.markers.length=0}this.tile.draw()}},getDataExtent:function(){var B;if(this.vectorMode){B=OpenLayers.Layer.Vector.prototype.getDataExtent.apply(this)}else{B=OpenLayers.Layer.Markers.prototype.getDataExtent.apply(this)}return B},setOpacity:function(B){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.setOpacity.apply(this,[B])}else{OpenLayers.Layer.Markers.prototype.setOpacity.apply(this,[B])}},CLASS_NAME:"OpenLayers.Layer.WFS"});OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,initialize:function(B){OpenLayers.Strategy.prototype.initialize.apply(this,[B])},activate:function(){var B=OpenLayers.Strategy.prototype.activate.call(this);if(B){this.layer.events.on({moveend:this.update,scope:this});this.layer.events.on({refresh:this.update,scope:this})}return B},deactivate:function(){var B=OpenLayers.Strategy.prototype.deactivate.call(this);if(B){this.layer.events.un({moveend:this.update,scope:this});this.layer.events.un({refresh:this.update,scope:this})}return B},update:function(C){var B=this.getMapBounds();if((C&&C.force)||this.invalidBounds(B)){this.calculateBounds(B);this.resolution=this.layer.map.getResolution();this.triggerRead()}},getMapBounds:function(){var B=this.layer.map.getExtent();if(!this.layer.projection.equals(this.layer.map.getProjectionObject())){B=B.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection)}return B},invalidBounds:function(B){if(!B){B=this.getMapBounds()}var D=!this.bounds||!this.bounds.containsBounds(B);if(!D&&this.resFactor){var C=this.resolution/this.layer.map.getResolution();D=(C>=this.resFactor||C<=(1/this.resFactor))}return D},calculateBounds:function(C){if(!C){C=this.getMapBounds()}var B=C.getCenterLonLat();var E=C.getWidth()*this.ratio;var D=C.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(B.lon-(E/2),B.lat-(D/2),B.lon+(E/2),B.lat+(D/2))},triggerRead:function(){this.layer.protocol.abort(this.response);this.layer.events.triggerEvent("loadstart");this.response=this.layer.protocol.read({filter:this.createFilter(),callback:this.merge,scope:this})},createFilter:function(){var B=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});if(this.layer.filter){B=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,B]})}return B},merge:function(H){this.layer.destroyFeatures();var F=H.features;if(F&&F.length>0){var G=this.layer.projection;var E=this.layer.map.getProjectionObject();if(!E.equals(G)){var D;for(var C=0,B=F.length;C<B;++C){D=F[C].geometry;if(D){D.transform(G,E)}}}this.layer.addFeatures(F)}this.layer.events.triggerEvent("loadend")},CLASS_NAME:"OpenLayers.Strategy.BBOX"});OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforefeaturehighlighted","featurehighlighted","featureunhighlighted"],multipleKey:null,toggleKey:null,multiple:false,clickout:true,toggle:false,hover:false,highlightOnly:false,box:false,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(D,B){this.EVENT_TYPES=OpenLayers.Control.SelectFeature.prototype.EVENT_TYPES.concat(OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[B]);if(this.scope===null){this.scope=this}if(D instanceof Array){this.layers=D;this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:D})}else{this.layer=D}var C={click:this.clickFeature,clickout:this.clickoutFeature};if(this.hover){C.over=this.overFeature;C.out=this.outFeature}this.callbacks=OpenLayers.Util.extend(C,this.callbacks);this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})};if(this.box){this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"})}},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this,arguments);if(this.layers){this.layer.destroy()}},activate:function(){if(!this.active){if(this.layers){this.map.addLayer(this.layer)}this.handlers.feature.activate();if(this.box&&this.handlers.box){this.handlers.box.activate()}}return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){this.handlers.feature.deactivate();if(this.handlers.box){this.handlers.box.deactivate()}if(this.layers){this.map.removeLayer(this.layer)}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(C){var G=this.layers||[this.layer];var F,E;for(var B=0;B<G.length;++B){F=G[B];for(var D=F.selectedFeatures.length-1;D>=0;--D){E=F.selectedFeatures[D];if(!C||C.except!=E){this.unselect(E)}}}},clickFeature:function(B){if(!this.hover){var C=(OpenLayers.Util.indexOf(B.layer.selectedFeatures,B)>-1);if(C){if(this.toggleSelect()){this.unselect(B)}else{if(!this.multipleSelect()){this.unselectAll({except:B})}}}else{if(!this.multipleSelect()){this.unselectAll({except:B})}this.select(B)}}},multipleSelect:function(){return this.multiple||(this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey])},toggleSelect:function(){return this.toggle||(this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey])},clickoutFeature:function(B){if(!this.hover&&this.clickout){this.unselectAll()}},overFeature:function(C){var B=C.layer;if(this.hover){if(this.highlightOnly){this.highlight(C)}else{if(OpenLayers.Util.indexOf(B.selectedFeatures,C)==-1){this.select(C)}}}},outFeature:function(B){if(this.hover){if(this.highlightOnly){if(B._lastHighlighter==this.id){if(B._prevHighlighter&&B._prevHighlighter!=this.id){delete B._lastHighlighter;var C=this.map.getControl(B._prevHighlighter);if(C){C.highlight(B)}}else{this.unhighlight(B)}}}else{this.unselect(B)}}},highlight:function(D){var C=D.layer;var B=this.events.triggerEvent("beforefeaturehighlighted",{feature:D});if(B!==false){D._prevHighlighter=D._lastHighlighter;D._lastHighlighter=this.id;var E=this.selectStyle||this.renderIntent;C.drawFeature(D,E);this.events.triggerEvent("featurehighlighted",{feature:D})}},unhighlight:function(C){var B=C.layer;C._lastHighlighter=C._prevHighlighter;delete C._prevHighlighter;B.drawFeature(C,C.style||C.layer.style||"default");this.events.triggerEvent("featureunhighlighted",{feature:C})},select:function(D){var B=this.onBeforeSelect.call(this.scope,D);var C=D.layer;if(B!==false){B=C.events.triggerEvent("beforefeatureselected",{feature:D});if(B!==false){C.selectedFeatures.push(D);this.highlight(D);C.events.triggerEvent("featureselected",{feature:D});this.onSelect.call(this.scope,D)}}},unselect:function(C){var B=C.layer;this.unhighlight(C);OpenLayers.Util.removeItem(B.selectedFeatures,C);B.events.triggerEvent("featureunselected",{feature:C});this.onUnselect.call(this.scope,C)},selectBox:function(F){if(F instanceof OpenLayers.Bounds){var I=this.map.getLonLatFromPixel(new OpenLayers.Pixel(F.left,F.bottom));var K=this.map.getLonLatFromPixel(new OpenLayers.Pixel(F.right,F.top));var B=new OpenLayers.Bounds(I.lon,I.lat,K.lon,K.lat);if(!this.multipleSelect()){this.unselectAll()}var J=this.multiple;this.multiple=true;var E=this.layers||[this.layer];var G;for(var C=0;C<E.length;++C){G=E[C];for(var D=0,H=G.features.length;D<H;++D){var L=G.features[D];if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,L.geometry.CLASS_NAME)>-1){if(B.toGeometry().intersects(L.geometry)){if(OpenLayers.Util.indexOf(G.selectedFeatures,L)==-1){this.select(L)}}}}}this.multiple=J}},setMap:function(B){this.handlers.feature.setMap(B);if(this.box){this.handlers.box.setMap(B)}OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.SelectFeature"});OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(B){var C={};this.readers.ogc.Filter.apply(this,[B,C]);return C.filter},readers:{ogc:{Filter:function(C,B){var D={fids:[],filters:[]};this.readChildNodes(C,D);if(D.fids.length>0){B.filter=new OpenLayers.Filter.FeatureId({fids:D.fids})}else{if(D.filters.length>0){B.filter=D.filters[0]}}},FeatureId:function(B,C){var D=B.getAttribute("fid");if(D){C.fids.push(D)}},And:function(C,D){var B=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(C,B);D.filters.push(B)},Or:function(C,D){var B=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(C,B);D.filters.push(B)},Not:function(C,D){var B=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsLessThan:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsGreaterThan:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsLessThanOrEqualTo:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsGreaterThanOrEqualTo:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsBetween:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsLike:function(E,F){var D=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(E,D);var G=E.getAttribute("wildCard");var C=E.getAttribute("singleChar");var B=E.getAttribute("escape");D.value2regex(G,C,B);F.filters.push(D)},Literal:function(B,C){C.value=OpenLayers.String.numericIf(this.getChildValue(B))},PropertyName:function(C,B){B.property=this.getChildValue(C)},LowerBoundary:function(C,B){B.lowerBoundary=OpenLayers.String.numericIf(this.readOgcExpression(C))},UpperBoundary:function(C,B){B.upperBoundary=OpenLayers.String.numericIf(this.readOgcExpression(C))},Intersects:function(B,C){this.readSpatial(B,C,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(B,C){this.readSpatial(B,C,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(B,C){this.readSpatial(B,C,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(B,C){this.readSpatial(B,C,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(B,C){C.distance=parseInt(this.getChildValue(B));C.distanceUnits=B.getAttribute("units")}}},readSpatial:function(D,E,C){var B=new OpenLayers.Filter.Spatial({type:C});this.readChildNodes(D,B);B.value=B.components[0];delete B.components;E.filters.push(B)},readOgcExpression:function(B){var D={};this.readChildNodes(B,D);var C=D.value;if(!C){C=this.getChildValue(B)}return C},write:function(B){return this.writers.ogc.Filter.apply(this,[B])},writers:{ogc:{Filter:function(D){var E=this.createElementNSPlus("ogc:Filter");var C=D.CLASS_NAME.split(".").pop();if(C=="FeatureId"){for(var B=0;B<D.fids.length;++B){this.writeNode("FeatureId",D.fids[B],E)}}else{this.writeNode(this.getFilterType(D),D,E)}return E},FeatureId:function(B){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:B}})},And:function(D){var E=this.createElementNSPlus("ogc:And");var C;for(var B=0;B<D.filters.length;++B){C=D.filters[B];this.writeNode(this.getFilterType(C),C,E)}return E},Or:function(D){var E=this.createElementNSPlus("ogc:Or");var C;for(var B=0;B<D.filters.length;++B){C=D.filters[B];this.writeNode(this.getFilterType(C),C,E)}return E},Not:function(C){var D=this.createElementNSPlus("ogc:Not");var B=C.filters[0];this.writeNode(this.getFilterType(B),B,D);return D},PropertyIsLessThan:function(B){var C=this.createElementNSPlus("ogc:PropertyIsLessThan");this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},PropertyIsGreaterThan:function(B){var C=this.createElementNSPlus("ogc:PropertyIsGreaterThan");this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},PropertyIsLessThanOrEqualTo:function(B){var C=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},PropertyIsGreaterThanOrEqualTo:function(B){var C=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},PropertyIsBetween:function(B){var C=this.createElementNSPlus("ogc:PropertyIsBetween");this.writeNode("PropertyName",B,C);this.writeNode("LowerBoundary",B,C);this.writeNode("UpperBoundary",B,C);return C},PropertyIsLike:function(B){var C=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.regex2value(),C);return C},PropertyName:function(B){return this.createElementNSPlus("ogc:PropertyName",{value:B.property})},Literal:function(B){return this.createElementNSPlus("ogc:Literal",{value:B})},LowerBoundary:function(B){var C=this.createElementNSPlus("ogc:LowerBoundary");this.writeNode("Literal",B.lowerBoundary,C);return C},UpperBoundary:function(B){var C=this.createElementNSPlus("ogc:UpperBoundary");this.writeNode("Literal",B.upperBoundary,C);return C},INTERSECTS:function(B){return this.writeSpatial(B,"Intersects")},WITHIN:function(B){return this.writeSpatial(B,"Within")},CONTAINS:function(B){return this.writeSpatial(B,"Contains")},DWITHIN:function(B){var C=this.writeSpatial(B,"DWithin");this.writeNode("Distance",B,C);return C},Distance:function(B){return this.createElementNSPlus("ogc:Distance",{attributes:{units:B.distanceUnits},value:B.distance})}}},getFilterType:function(B){var C=this.filterMap[B.type];if(!C){throw"Filter writing not supported for rule type: "+B.type}return C},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS"},CLASS_NAME:"OpenLayers.Format.Filter.v1"});OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(B){OpenLayers.Geometry.MultiPoint.prototype.initialize.apply(this,arguments)},getLength:function(){var D=0;if(this.components&&(this.components.length>1)){for(var C=1,B=this.components.length;C<B;C++){D+=this.components[C-1].distanceTo(this.components[C])}}return D},getGeodesicLength:function(C){var F=this;if(C){var D=new OpenLayers.Projection("EPSG:4326");if(!D.equals(C)){F=this.clone().transform(C,D)}}var G=0;if(F.components&&(F.components.length>1)){var I,H;for(var E=1,B=F.components.length;E<B;E++){I=F.components[E-1];H=F.components[E];G+=OpenLayers.Util.distVincenty({lon:I.x,lat:I.y},{lon:H.x,lat:H.y})}}return G*1000},CLASS_NAME:"OpenLayers.Geometry.Curve"});OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,clickout:true,toggle:true,layer:null,feature:null,vertices:null,virtualVertices:null,selectControl:null,dragControl:null,handlers:null,deleteCodes:null,virtualStyle:null,mode:null,modified:false,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(E,D){this.layer=E;this.vertices=[];this.virtualVertices=[];this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer());this.virtualStyle.fillOpacity=0.3;this.virtualStyle.strokeOpacity=0.3;this.deleteCodes=[46,68];this.mode=OpenLayers.Control.ModifyFeature.RESHAPE;OpenLayers.Control.prototype.initialize.apply(this,[D]);if(!(this.deleteCodes instanceof Array)){this.deleteCodes=[this.deleteCodes]}var G=this;var B={geometryTypes:this.geometryTypes,clickout:this.clickout,toggle:this.toggle,onBeforeSelect:this.beforeSelectFeature,onSelect:this.selectFeature,onUnselect:this.unselectFeature,scope:this};this.selectControl=new OpenLayers.Control.SelectFeature(E,B);var C={geometryTypes:["OpenLayers.Geometry.Point"],snappingOptions:this.snappingOptions,onStart:function(I,H){G.dragStart.apply(G,[I,H])},onDrag:function(I,H){G.dragVertex.apply(G,[I,H])},onComplete:function(H){G.dragComplete.apply(G,[H])}};this.dragControl=new OpenLayers.Control.DragFeature(E,C);var F={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,F)}},destroy:function(){this.layer=null;this.selectControl.destroy();this.dragControl.destroy();OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return(this.selectControl.activate()&&this.handlers.keyboard.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments))},deactivate:function(){var B=false;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.layer.removeFeatures(this.vertices,{silent:true});this.layer.removeFeatures(this.virtualVertices,{silent:true});this.vertices=[];this.dragControl.deactivate();if(this.feature&&this.feature.geometry&&this.feature.layer){this.selectControl.unselect.apply(this.selectControl,[this.feature])}this.selectControl.deactivate();this.handlers.keyboard.deactivate();B=true}return B},beforeSelectFeature:function(B){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:B})},selectFeature:function(B){this.feature=B;this.modified=false;this.resetVertices();this.dragControl.activate();this.onModificationStart(this.feature)},unselectFeature:function(B){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[];if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});delete this.dragHandle}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});delete this.radiusHandle}this.feature=null;this.dragControl.deactivate();this.onModificationEnd(B);this.layer.events.triggerEvent("afterfeaturemodified",{feature:B,modified:this.modified});this.modified=false},dragStart:function(C,B){if(C!=this.feature&&!C.geometry.parent&&C!=this.dragHandle&&C!=this.radiusHandle){if(this.feature){this.selectControl.clickFeature.apply(this.selectControl,[this.feature])}if(this.geometryTypes==null||OpenLayers.Util.indexOf(this.geometryTypes,C.geometry.CLASS_NAME)!=-1){this.selectControl.clickFeature.apply(this.selectControl,[C]);this.dragControl.overFeature.apply(this.dragControl,[C]);this.dragControl.lastPixel=B;this.dragControl.handlers.drag.started=true;this.dragControl.handlers.drag.start=B;this.dragControl.handlers.drag.last=B}}},dragVertex:function(C,B){this.modified=true;if(this.feature.geometry.CLASS_NAME=="OpenLayers.Geometry.Point"){if(this.feature!=C){this.feature=C}this.layer.events.triggerEvent("vertexmodified",{vertex:C.geometry,feature:this.feature,pixel:B})}else{if(C._index){C.geometry.parent.addComponent(C.geometry,C._index);delete C._index;OpenLayers.Util.removeItem(this.virtualVertices,C);this.vertices.push(C)}else{if(C==this.dragHandle){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[];if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}}else{if(C!==this.radiusHandle){this.layer.events.triggerEvent("vertexmodified",{vertex:C.geometry,feature:this.feature,pixel:B})}}}if(this.virtualVertices.length>0){this.layer.destroyFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}this.layer.drawFeature(this.feature,this.selectControl.renderIntent)}this.layer.drawFeature(C)},dragComplete:function(B){this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE){this.feature.state=OpenLayers.State.UPDATE}},resetVertices:function(){if(this.dragControl.feature){this.dragControl.outFeature(this.dragControl.feature)}if(this.vertices.length>0){this.layer.removeFeatures(this.vertices,{silent:true});this.vertices=[]}if(this.virtualVertices.length>0){this.layer.removeFeatures(this.virtualVertices,{silent:true});this.virtualVertices=[]}if(this.dragHandle){this.layer.destroyFeatures([this.dragHandle],{silent:true});this.dragHandle=null}if(this.radiusHandle){this.layer.destroyFeatures([this.radiusHandle],{silent:true});this.radiusHandle=null}if(this.feature&&this.feature.geometry.CLASS_NAME!="OpenLayers.Geometry.Point"){if((this.mode&OpenLayers.Control.ModifyFeature.DRAG)){this.collectDragHandle()}if((this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE))){this.collectRadiusHandle()}if(this.mode&OpenLayers.Control.ModifyFeature.RESHAPE){if(!(this.mode&OpenLayers.Control.ModifyFeature.RESIZE)){this.collectVertices()}}}},handleKeypress:function(B){var C=B.keyCode;if(this.feature&&OpenLayers.Util.indexOf(this.deleteCodes,C)!=-1){var D=this.dragControl.feature;if(D&&OpenLayers.Util.indexOf(this.vertices,D)!=-1&&!this.dragControl.handlers.drag.dragging&&D.geometry.parent){D.geometry.parent.removeComponent(D.geometry);this.layer.drawFeature(this.feature,this.selectControl.renderIntent);this.resetVertices();this.setFeatureState();this.onModification(this.feature);this.layer.events.triggerEvent("featuremodified",{feature:this.feature})}}},collectVertices:function(){this.vertices=[];this.virtualVertices=[];var B=this;function C(I){var E,F,J,G;if(I.CLASS_NAME=="OpenLayers.Geometry.Point"){F=new OpenLayers.Feature.Vector(I);F._sketch=true;B.vertices.push(F)}else{var D=I.components.length;if(I.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){D-=1}for(E=0;E<D;++E){J=I.components[E];if(J.CLASS_NAME=="OpenLayers.Geometry.Point"){F=new OpenLayers.Feature.Vector(J);F._sketch=true;B.vertices.push(F)}else{C(J)}}if(I.CLASS_NAME!="OpenLayers.Geometry.MultiPoint"){for(E=0,G=I.components.length;E<G-1;++E){var M=I.components[E];var N=I.components[E+1];if(M.CLASS_NAME=="OpenLayers.Geometry.Point"&&N.CLASS_NAME=="OpenLayers.Geometry.Point"){var K=(M.x+N.x)/2;var H=(M.y+N.y)/2;var L=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(K,H),null,B.virtualStyle);L.geometry.parent=I;L._index=E+1;L._sketch=true;B.virtualVertices.push(L)}}}}}C.call(this,this.feature.geometry);this.layer.addFeatures(this.virtualVertices,{silent:true});this.layer.addFeatures(this.vertices,{silent:true})},collectDragHandle:function(){var E=this.feature.geometry;var B=E.getBounds().getCenterLonLat();var D=new OpenLayers.Geometry.Point(B.lon,B.lat);var C=new OpenLayers.Feature.Vector(D);D.move=function(F,G){OpenLayers.Geometry.Point.prototype.move.call(this,F,G);E.move(F,G)};C._sketch=true;this.dragHandle=C;this.layer.addFeatures([this.dragHandle],{silent:true})},collectRadiusHandle:function(){var I=this.feature.geometry;var B=I.getBounds();var C=B.getCenterLonLat();var J=new OpenLayers.Geometry.Point(C.lon,C.lat);var H=new OpenLayers.Geometry.Point(B.right,B.bottom);var G=new OpenLayers.Feature.Vector(H);var D=(this.mode&OpenLayers.Control.ModifyFeature.RESIZE);var F=(this.mode&OpenLayers.Control.ModifyFeature.RESHAPE);var E=(this.mode&OpenLayers.Control.ModifyFeature.ROTATE);H.move=function(U,T){OpenLayers.Geometry.Point.prototype.move.call(this,U,T);var V=this.x-J.x;var Q=this.y-J.y;var W=V-U;var R=Q-T;if(E){var L=Math.atan2(R,W);var K=Math.atan2(Q,V);var O=K-L;O*=180/Math.PI;I.rotate(O,J)}if(D){var N,S;if(F){N=Q/R;S=(V/W)/N}else{var P=Math.sqrt((W*W)+(R*R));var M=Math.sqrt((V*V)+(Q*Q));N=M/P}I.resize(N,J,S)}};G._sketch=true;this.radiusHandle=G;this.layer.addFeatures([this.radiusHandle],{silent:true})},setMap:function(B){this.selectControl.setMap(B);this.dragControl.setMap(B);OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.ModifyFeature"});OpenLayers.Control.ModifyFeature.RESHAPE=1;OpenLayers.Control.ModifyFeature.RESIZE=2;OpenLayers.Control.ModifyFeature.ROTATE=4;OpenLayers.Control.ModifyFeature.DRAG=8;OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{initialize:function(B){OpenLayers.Geometry.Curve.prototype.initialize.apply(this,arguments)},removeComponent:function(B){if(this.components&&(this.components.length>2)){OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments)}},intersects:function(L){var D=false;var K=L.CLASS_NAME;if(K=="OpenLayers.Geometry.LineString"||K=="OpenLayers.Geometry.LinearRing"||K=="OpenLayers.Geometry.Point"){var O=this.getSortedSegments();var M;if(K=="OpenLayers.Geometry.Point"){M=[{x1:L.x,y1:L.y,x2:L.x,y2:L.y}]}else{M=L.getSortedSegments()}var R,H,F,B,Q,P,E,C;outer:for(var I=0,J=O.length;I<J;++I){R=O[I];H=R.x1;F=R.x2;B=R.y1;Q=R.y2;inner:for(var G=0,N=M.length;G<N;++G){P=M[G];if(P.x1>F){break}if(P.x2<H){continue}E=P.y1;C=P.y2;if(Math.min(E,C)>Math.max(B,Q)){continue}if(Math.max(E,C)<Math.min(B,Q)){continue}if(OpenLayers.Geometry.segmentsIntersect(R,P)){D=true;break outer}}}}else{D=L.intersects(this)}return D},getSortedSegments:function(){var B=this.components.length-1;var C=new Array(B);for(var D=0;D<B;++D){point1=this.components[D];point2=this.components[D+1];if(point1.x<point2.x){C[D]={x1:point1.x,y1:point1.y,x2:point2.x,y2:point2.y}}else{C[D]={x1:point2.x,y1:point2.y,x2:point1.x,y2:point1.y}}}function E(G,F){return G.x1-F.x1}return C.sort(E)},splitWithSegment:function(R,C){var D=!(C&&C.edge===false);var O=C&&C.tolerance;var B=[];var T=this.getVertices();var N=[];var V=[];var I=false;var F,E,L;var J,Q,U;var G={point:true,tolerance:O};var H=null;for(var M=0,K=T.length-2;M<=K;++M){F=T[M];N.push(F.clone());E=T[M+1];U={x1:F.x,y1:F.y,x2:E.x,y2:E.y};L=OpenLayers.Geometry.segmentsIntersect(R,U,G);if(L instanceof OpenLayers.Geometry.Point){if((L.x===R.x1&&L.y===R.y1)||(L.x===R.x2&&L.y===R.y2)||L.equals(F)||L.equals(E)){Q=true}else{Q=false}if(Q||D){if(!L.equals(V[V.length-1])){V.push(L.clone())}if(M===0){if(L.equals(F)){continue}}if(L.equals(E)){continue}I=true;if(!L.equals(F)){N.push(L)}B.push(new OpenLayers.Geometry.LineString(N));N=[L.clone()]}}}if(I){N.push(E.clone());B.push(new OpenLayers.Geometry.LineString(N))}if(V.length>0){var P=R.x1<R.x2?1:-1;var S=R.y1<R.y2?1:-1;H={lines:B,points:V.sort(function(Y,W){return(P*Y.x-P*W.x)||(S*Y.y-S*W.y)})}}return H},split:function(V,C){var L=null;var E=C&&C.mutual;var J,F,K,D;if(V instanceof OpenLayers.Geometry.LineString){var U=this.getVertices();var H,G,T,I,B,N;var Q=[];K=[];for(var R=0,M=U.length-2;R<=M;++R){H=U[R];G=U[R+1];T={x1:H.x,y1:H.y,x2:G.x,y2:G.y};D=D||[V];if(E){Q.push(H.clone())}for(var P=0;P<D.length;++P){I=D[P].splitWithSegment(T,C);if(I){B=I.lines;if(B.length>0){B.unshift(P,1);Array.prototype.splice.apply(D,B);P+=B.length-2}if(E){for(var O=0,S=I.points.length;O<S;++O){N=I.points[O];if(!N.equals(H)){Q.push(N);K.push(new OpenLayers.Geometry.LineString(Q));if(N.equals(G)){Q=[]}else{Q=[N.clone()]}}}}}}}if(E&&K.length>0&&Q.length>0){Q.push(G.clone());K.push(new OpenLayers.Geometry.LineString(Q))}}else{L=V.splitWith(this,C)}if(D&&D.length>1){F=true}else{D=[]}if(K&&K.length>1){J=true}else{K=[]}if(F||J){if(E){L=[K,D]}else{L=D}}return L},splitWith:function(C,B){return C.split(this,B)},getVertices:function(B){var C;if(B===true){C=[this.components[0],this.components[this.components.length-1]]}else{if(B===false){C=this.components.slice(1,this.components.length-1)}else{C=this.components.slice()}}return C},distanceTo:function(I,H){var J=!(H&&H.edge===false);var Z=J&&H&&H.details;var P,F={};var S=Number.POSITIVE_INFINITY;if(I instanceof OpenLayers.Geometry.Point){var Q=this.getSortedSegments();var O=I.x;var N=I.y;var W;for(var U=0,V=Q.length;U<V;++U){W=Q[U];P=OpenLayers.Geometry.distanceToSegment(I,W);if(P.distance<S){S=P.distance;F=P;if(S===0){break}}else{if(W.x2>O&&((N>W.y1&&N<W.y2)||(N<W.y1&&N>W.y2))){break}}}if(Z){F={distance:F.distance,x0:F.x,y0:F.y,x1:O,y1:N}}else{F=F.distance}}else{if(I instanceof OpenLayers.Geometry.LineString){var E=this.getSortedSegments();var D=I.getSortedSegments();var C,B,M,Y,G;var L=D.length;var K={point:true};outer:for(var U=0,V=E.length;U<V;++U){C=E[U];Y=C.x1;G=C.y1;for(var T=0;T<L;++T){B=D[T];M=OpenLayers.Geometry.segmentsIntersect(C,B,K);if(M){S=0;F={distance:0,x0:M.x,y0:M.y,x1:M.x,y1:M.y};break outer}else{P=OpenLayers.Geometry.distanceToSegment({x:Y,y:G},B);if(P.distance<S){S=P.distance;F={distance:S,x0:Y,y0:G,x1:P.x,y1:P.y}}}}}if(!Z){F=F.distance}if(S!==0){if(C){P=I.distanceTo(new OpenLayers.Geometry.Point(C.x2,C.y2),H);var R=Z?P.distance:P;if(R<S){if(Z){F={distance:S,x0:P.x1,y0:P.y1,x1:P.x0,y1:P.y0}}else{F=R}}}}}else{F=I.distanceTo(this,H);if(Z){F={distance:F.distance,x0:F.x1,y0:F.y1,x1:F.x0,y1:F.y0}}}}return F},CLASS_NAME:"OpenLayers.Geometry.LineString"});OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{extractWaypoints:true,extractTracks:true,extractRoutes:true,extractAttributes:true,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(T){if(typeof T=="string"){T=OpenLayers.Format.XML.prototype.read.apply(this,[T])}var D=[];if(this.extractTracks){var P=T.getElementsByTagName("trk");for(var O=0,Q=P.length;O<Q;O++){var J={};if(this.extractAttributes){J=this.parseAttributes(P[O])}var H=this.getElementsByTagNameNS(P[O],P[O].namespaceURI,"trkseg");for(var N=0,G=H.length;N<G;N++){var I=this.extractSegment(H[N],"trkpt");D.push(new OpenLayers.Feature.Vector(I,J))}}}if(this.extractRoutes){var B=T.getElementsByTagName("rte");for(var M=0,L=B.length;M<L;M++){var J={};if(this.extractAttributes){J=this.parseAttributes(B[M])}var S=this.extractSegment(B[M],"rtept");D.push(new OpenLayers.Feature.Vector(S,J))}}if(this.extractWaypoints){var C=T.getElementsByTagName("wpt");for(var K=0,Q=C.length;K<Q;K++){var J={};if(this.extractAttributes){J=this.parseAttributes(C[K])}var F=new OpenLayers.Geometry.Point(C[K].getAttribute("lon"),C[K].getAttribute("lat"));D.push(new OpenLayers.Feature.Vector(F,J))}}if(this.internalProjection&&this.externalProjection){for(var R=0,E=D.length;R<E;R++){D[R].geometry.transform(this.externalProjection,this.internalProjection)}}return D},extractSegment:function(F,G){var E=this.getElementsByTagNameNS(F,F.namespaceURI,G);var C=[];for(var D=0,B=E.length;D<B;D++){C.push(new OpenLayers.Geometry.Point(E[D].getAttribute("lon"),E[D].getAttribute("lat")))}return new OpenLayers.Geometry.LineString(C)},parseAttributes:function(C){var B={};var E=C.firstChild;while(E){if(E.nodeType==1){var D=E.firstChild;if(D.nodeType==3||D.nodeType==4){name=(E.prefix)?E.nodeName.split(":")[1]:E.nodeName;if(name!="trkseg"&&name!="rtept"){B[name]=D.nodeValue}}}E=E.nextSibling}return B},CLASS_NAME:"OpenLayers.Format.GPX"});OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],initialize:function(B){OpenLayers.Geometry.LineString.prototype.initialize.apply(this,arguments)},addComponent:function(B,C){var D=false;var E=this.components.pop();if(C!=null||!B.equals(E)){D=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments)}var F=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[F]);return D},removeComponent:function(B){if(this.components.length>4){this.components.pop();OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var C=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[C])}},move:function(C,E){for(var D=0,B=this.components.length;D<B-1;D++){this.components[D].move(C,E)}},rotate:function(E,C){for(var D=0,B=this.components.length;D<B-1;++D){this.components[D].rotate(E,C)}},resize:function(F,C,E){for(var D=0,B=this.components.length;D<B-1;++D){this.components[D].resize(F,C,E)}return this},transform:function(F,D){if(F&&D){for(var E=0,B=this.components.length;E<B-1;E++){var C=this.components[E];C.transform(F,D)}this.bounds=null}return this},getCentroid:function(){if(this.components&&(this.components.length>2)){var G=0;var F=0;for(var D=0;D<this.components.length-1;D++){var C=this.components[D];var I=this.components[D+1];G+=(C.x+I.x)*(C.x*I.y-I.x*C.y);F+=(C.y+I.y)*(C.x*I.y-I.x*C.y)}var E=-1*this.getArea();var B=G/(6*E);var H=F/(6*E)}return new OpenLayers.Geometry.Point(B,H)},getArea:function(){var F=0;if(this.components&&(this.components.length>2)){var E=0;for(var D=0,C=this.components.length;D<C-1;D++){var B=this.components[D];var G=this.components[D+1];E+=(B.x+G.x)*(G.y-B.y)}F=-E/2}return F},getGeodesicArea:function(C){var E=this;if(C){var D=new OpenLayers.Projection("EPSG:4326");if(!D.equals(C)){E=this.clone().transform(C,D)}}var G=0;var B=E.components&&E.components.length;if(B>2){var I,H;for(var F=0;F<B-1;F++){I=E.components[F];H=E.components[F+1];G+=OpenLayers.Util.rad(H.x-I.x)*(2+Math.sin(OpenLayers.Util.rad(I.y))+Math.sin(OpenLayers.Util.rad(H.y)))}G=G*6378137*6378137/2}return G},containsPoint:function(M){var S=OpenLayers.Number.limitSigDigs;var L=14;var K=S(M.x,L);var J=S(M.y,L);function R(Y,U,W,T,V){return(((U-T)*Y)+((T*W)-(U*V)))/(W-V)}var B=this.components.length-1;var H,G,Q,E,O,C,F,D;var I=0;for(var N=0;N<B;++N){H=this.components[N];Q=S(H.x,L);E=S(H.y,L);G=this.components[N+1];O=S(G.x,L);C=S(G.y,L);if(E==C){if(J==E){if(Q<=O&&(K>=Q&&K<=O)||Q>=O&&(K<=Q&&K>=O)){I=-1;break}}continue}F=S(R(J,Q,E,O,C),L);if(F==K){if(E<C&&(J>=E&&J<=C)||E>C&&(J<=E&&J>=C)){I=-1;break}}if(F<=K){continue}if(Q!=O&&(F<Math.min(Q,O)||F>Math.max(Q,O))){continue}if(E<C&&(J>=E&&J<C)||E>C&&(J<E&&J>=C)){++I}}var P=(I==-1)?1:!!(I&1);return P},intersects:function(E){var C=false;if(E.CLASS_NAME=="OpenLayers.Geometry.Point"){C=this.containsPoint(E)}else{if(E.CLASS_NAME=="OpenLayers.Geometry.LineString"){C=E.intersects(this)}else{if(E.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){C=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[E])}else{for(var D=0,B=E.components.length;D<B;++D){C=E.components[D].intersects(this);if(C){break}}}}}return C},getVertices:function(B){return(B===true)?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"});OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],initialize:function(B){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},split:function(L,Q){var H=null;var P=Q&&Q.mutual;var M,B,O,K,C;var F=[];var N=[L];for(var G=0,I=this.components.length;G<I;++G){B=this.components[G];K=false;for(var E=0;E<N.length;++E){M=B.split(N[E],Q);if(M){if(P){O=M[0];for(var D=0,J=O.length;D<J;++D){if(D===0&&F.length){F[F.length-1].addComponent(O[D])}else{F.push(new OpenLayers.Geometry.MultiLineString([O[D]]))}}K=true;M=M[1]}if(M.length){M.unshift(E,1);Array.prototype.splice.apply(N,M);break}}}if(!K){if(F.length){F[F.length-1].addComponent(B.clone())}else{F=[new OpenLayers.Geometry.MultiLineString(B.clone())]}}}if(F&&F.length>1){K=true}else{F=[]}if(N&&N.length>1){C=true}else{N=[]}if(K||C){if(P){H=[F,N]}else{H=N}}return H},splitWith:function(L,Q){var H=null;var P=Q&&Q.mutual;var M,D,O,K,B,F,N;if(L instanceof OpenLayers.Geometry.LineString){N=[];F=[L];for(var G=0,I=this.components.length;G<I;++G){B=false;D=this.components[G];for(var E=0;E<F.length;++E){M=F[E].split(D,Q);if(M){if(P){O=M[0];if(O.length){O.unshift(E,1);Array.prototype.splice.apply(F,O);E+=O.length-2}M=M[1];if(M.length===0){M=[D.clone()]}}for(var C=0,J=M.length;C<J;++C){if(C===0&&N.length){N[N.length-1].addComponent(M[C])}else{N.push(new OpenLayers.Geometry.MultiLineString([M[C]]))}}B=true}}if(!B){if(N.length){N[N.length-1].addComponent(D.clone())}else{N=[new OpenLayers.Geometry.MultiLineString([D.clone()])]}}}}else{H=L.split(this)}if(F&&F.length>1){K=true}else{F=[]}if(N&&N.length>1){B=true}else{N=[]}if(K||B){if(P){H=[F,N]}else{H=N}}return H},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"});OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,freehand:false,freehandToggle:"shiftKey",initialize:function(D,C,B){OpenLayers.Handler.Point.prototype.initialize.apply(this,arguments)},createFeature:function(B){var C=this.control.map.getLonLatFromPixel(B);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(C.lon,C.lat));this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.line,this.point],{silent:true})},destroyFeature:function(){OpenLayers.Handler.Point.prototype.destroyFeature.apply(this);this.line=null},removePoint:function(){if(this.point){this.layer.removeFeatures([this.point])}},addPoint:function(B){this.layer.removeFeatures([this.point]);var C=this.control.map.getLonLatFromPixel(B);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(C.lon,C.lat));this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length);this.callback("point",[this.point.geometry,this.getGeometry()]);this.callback("modify",[this.point.geometry,this.getSketch()]);this.drawFeature()},freehandMode:function(B){return(this.freehandToggle&&B[this.freehandToggle])?!this.freehand:this.freehand},modifyFeature:function(B){var C=this.control.map.getLonLatFromPixel(B);this.point.geometry.x=C.lon;this.point.geometry.y=C.lat;this.callback("modify",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var B=this.line&&this.line.geometry;if(B&&this.multi){B=new OpenLayers.Geometry.MultiLineString([B])}return B},mousedown:function(B){if(this.lastDown&&this.lastDown.equals(B.xy)){return false}if(this.lastDown==null){if(this.persist){this.destroyFeature()}this.createFeature(B.xy)}else{if((this.lastUp==null)||!this.lastUp.equals(B.xy)){this.addPoint(B.xy)}}this.mouseDown=true;this.lastDown=B.xy;this.drawing=true;return false},mousemove:function(B){if(this.drawing){if(this.mouseDown&&this.freehandMode(B)){this.addPoint(B.xy)}else{this.modifyFeature(B.xy)}}return true},mouseup:function(B){this.mouseDown=false;if(this.drawing){if(this.freehandMode(B)){this.removePoint();this.finalize()}else{if(this.lastUp==null){this.addPoint(B.xy)}this.lastUp=B.xy}return false}return true},dblclick:function(B){if(!this.freehandMode(B)){var C=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[C]);this.removePoint();this.finalize()}return false},CLASS_NAME:"OpenLayers.Handler.Path"});OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{EVENT_TYPES:["beforesplit","split","aftersplit"],layer:null,source:null,sourceOptions:null,tolerance:null,edge:true,deferDelete:false,mutual:true,targetFilter:null,sourceFilter:null,handler:null,initialize:function(B){Array.prototype.push.apply(this.EVENT_TYPES,OpenLayers.Control.prototype.EVENT_TYPES);OpenLayers.Control.prototype.initialize.apply(this,[B]);this.options=B||{};if(this.options.source){this.setSource(this.options.source)}},setSource:function(B){if(this.active){this.deactivate();if(this.handler){this.handler.destroy();delete this.handler}this.source=B;this.activate()}else{this.source=B}},activate:function(){var B=OpenLayers.Control.prototype.activate.call(this);if(B){if(!this.source){if(!this.handler){this.handler=new OpenLayers.Handler.Path(this,{done:function(C){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(C)})}},{layerOptions:this.sourceOptions})}this.handler.activate()}else{if(this.source.events){this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}}}return B},deactivate:function(){var B=OpenLayers.Control.prototype.deactivate.call(this);if(B){if(this.source&&this.source.events){this.layer.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this})}}return B},onSketchComplete:function(B){this.feature=null;return !this.considerSplit(B.feature)},afterFeatureModified:function(C){if(C.modified){var B=C.feature;if(B.geometry instanceof OpenLayers.Geometry.LineString||B.geometry instanceof OpenLayers.Geometry.MultiLineString){this.feature=C.feature;this.considerSplit(C.feature)}}},removeByGeometry:function(D,E){for(var C=0,B=D.length;C<B;++C){if(D[C].geometry===E){D.splice(C,1);break}}},isEligible:function(B){return(B.state!==OpenLayers.State.DELETE)&&(B.geometry instanceof OpenLayers.Geometry.LineString||B.geometry instanceof OpenLayers.Geometry.MultiLineString)&&(this.feature!==B)&&(!this.targetFilter||this.targetFilter.evaluate(B.attributes))},considerSplit:function(D){sourceSplit=false;targetSplit=false;if(!this.sourceFilter||this.sourceFilter.evaluate(D.attributes)){var G=this.layer&&this.layer.features||[];var V,M,H,B;var J=[],U=[];var E=(this.layer===this.source)&&this.mutual;var C={edge:this.edge,tolerance:this.tolerance,mutual:E};var I=[D.geometry];var L,F;var O,N;for(var S=0,T=G.length;S<T;++S){L=G[S];if(this.isEligible(L)){F=[L.geometry];for(var R=0;R<I.length;++R){O=I[R];for(var P=0;P<F.length;++P){V=F[P];if(O.getBounds().intersectsBounds(V.getBounds())){M=O.split(V,C);if(M){B=this.events.triggerEvent("beforesplit",{source:D,target:L});if(B!==false){if(E){N=M[0];if(N.length>1){N.unshift(R,1);Array.prototype.splice.apply(I,N);R+=N.length-3}M=M[1]}if(M.length>1){M.unshift(P,1);Array.prototype.splice.apply(F,M);P+=M.length-3}}}}}}if(F&&F.length>1){this.geomsToFeatures(L,F);this.events.triggerEvent("split",{original:L,features:F});Array.prototype.push.apply(J,F);U.push(L);targetSplit=true}}}if(I&&I.length>1){this.geomsToFeatures(D,I);this.events.triggerEvent("split",{original:D,features:I});Array.prototype.push.apply(J,I);U.push(D);sourceSplit=true}if(sourceSplit||targetSplit){if(this.deferDelete){var K,Q=[];for(var S=0,T=U.length;S<T;++S){K=U[S];if(K.state===OpenLayers.State.INSERT){Q.push(K)}else{K.state=OpenLayers.State.DELETE;this.layer.drawFeature(K)}}this.layer.destroyFeatures(Q,{silent:true});for(var S=0,T=J.length;S<T;++S){J[S].state=OpenLayers.State.INSERT}}else{this.layer.destroyFeatures(U,{silent:true})}this.layer.addFeatures(J,{silent:true});this.events.triggerEvent("aftersplit",{source:D,features:J})}}return sourceSplit},geomsToFeatures:function(D,E){var G=D.clone();delete G.geometry;var F;for(var C=0,B=E.length;C<B;++C){F=G.clone();F.geometry=E[C];F.state=OpenLayers.State.INSERT;E[C]=F}},destroy:function(){if(this.active){this.deactivate()}OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"});OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],initialize:function(B){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},getArea:function(){var D=0;if(this.components&&(this.components.length>0)){D+=Math.abs(this.components[0].getArea());for(var C=1,B=this.components.length;C<B;C++){D-=Math.abs(this.components[C].getArea())}}return D},getGeodesicArea:function(C){var E=0;if(this.components&&(this.components.length>0)){E+=Math.abs(this.components[0].getGeodesicArea(C));for(var D=1,B=this.components.length;D<B;D++){E-=Math.abs(this.components[D].getGeodesicArea(C))}}return E},containsPoint:function(B){var F=this.components.length;var D=false;if(F>0){D=this.components[0].containsPoint(B);if(D!==1){if(D&&F>1){var E;for(var C=1;C<F;++C){E=this.components[C].containsPoint(B);if(E){if(E===1){D=1}else{D=false}break}}}}}return D},intersects:function(F){var C=false;var E,B;if(F.CLASS_NAME=="OpenLayers.Geometry.Point"){C=this.containsPoint(F)}else{if(F.CLASS_NAME=="OpenLayers.Geometry.LineString"||F.CLASS_NAME=="OpenLayers.Geometry.LinearRing"){for(E=0,B=this.components.length;E<B;++E){C=F.intersects(this.components[E]);if(C){break}}if(!C){for(E=0,B=F.components.length;E<B;++E){C=this.containsPoint(F.components[E]);if(C){break}}}}else{for(E=0,B=F.components.length;E<B;++E){C=this.intersects(F.components[E]);if(C){break}}}}if(!C&&F.CLASS_NAME=="OpenLayers.Geometry.Polygon"){var D=this.components[0];for(E=0,B=D.components.length;E<B;++E){C=F.containsPoint(D.components[E]);if(C){break}}}return C},distanceTo:function(E,C){var D=!(C&&C.edge===false);var B;if(!D&&this.intersects(E)){B=0}else{B=OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[E,C])}return B},CLASS_NAME:"OpenLayers.Geometry.Polygon"});OpenLayers.Geometry.Polygon.createRegularPolygon=function(J,G,C,L){var D=Math.PI*((1/C)-(1/2));if(L){D+=(L/180)*Math.PI}var B,I,H;var K=[];for(var F=0;F<C;++F){B=D+(F*2*Math.PI/C);I=J.x+(G*Math.cos(B));H=J.y+(G*Math.sin(B));K.push(new OpenLayers.Geometry.Point(I,H))}var E=new OpenLayers.Geometry.LinearRing(K);return new OpenLayers.Geometry.Polygon([E])};OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:false,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},createGeometryFromItem:function(N){var M=this.getElementsByTagNameNS(N,this.georssns,"point");var H=this.getElementsByTagNameNS(N,this.geons,"lat");var B=this.getElementsByTagNameNS(N,this.geons,"long");var P=this.getElementsByTagNameNS(N,this.georssns,"line");var K=this.getElementsByTagNameNS(N,this.georssns,"polygon");var D=this.getElementsByTagNameNS(N,this.georssns,"where");var E=this.getElementsByTagNameNS(N,this.georssns,"box");if(M.length>0||(H.length>0&&B.length>0)){var L;if(M.length>0){L=OpenLayers.String.trim(M[0].firstChild.nodeValue).split(/\s+/);if(L.length!=2){L=OpenLayers.String.trim(M[0].firstChild.nodeValue).split(/\s*,\s*/)}}else{L=[parseFloat(H[0].firstChild.nodeValue),parseFloat(B[0].firstChild.nodeValue)]}var I=new OpenLayers.Geometry.Point(parseFloat(L[1]),parseFloat(L[0]))}else{if(P.length>0){var J=OpenLayers.String.trim(this.concatChildValues(P[0])).split(/\s+/);var F=[];var M;for(var C=0,G=J.length;C<G;C+=2){M=new OpenLayers.Geometry.Point(parseFloat(J[C+1]),parseFloat(J[C]));F.push(M)}I=new OpenLayers.Geometry.LineString(F)}else{if(K.length>0){var J=OpenLayers.String.trim(this.concatChildValues(K[0])).split(/\s+/);var F=[];var M;for(var C=0,G=J.length;C<G;C+=2){M=new OpenLayers.Geometry.Point(parseFloat(J[C+1]),parseFloat(J[C]));F.push(M)}I=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(F)])}else{if(D.length>0){if(!this.gmlParser){this.gmlParser=new OpenLayers.Format.GML({xy:this.xy})}var O=this.gmlParser.parseFeature(D[0]);I=O.geometry}else{if(E.length>0){var J=OpenLayers.String.trim(E[0].firstChild.nodeValue).split(/\s+/);var F=[];var M;if(J.length>3){M=new OpenLayers.Geometry.Point(parseFloat(J[1]),parseFloat(J[0]));F.push(M);M=new OpenLayers.Geometry.Point(parseFloat(J[1]),parseFloat(J[2]));F.push(M);M=new OpenLayers.Geometry.Point(parseFloat(J[3]),parseFloat(J[2]));F.push(M);M=new OpenLayers.Geometry.Point(parseFloat(J[3]),parseFloat(J[0]));F.push(M);M=new OpenLayers.Geometry.Point(parseFloat(J[1]),parseFloat(J[0]));F.push(M)}I=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(F)])}}}}}if(I&&this.internalProjection&&this.externalProjection){I.transform(this.externalProjection,this.internalProjection)}return I},createFeatureFromItem:function(I){var E=this.createGeometryFromItem(I);var G=this.getChildValue(I,"*","title",this.featureTitle);var H=this.getChildValue(I,"*","description",this.getChildValue(I,"*","content",this.getChildValue(I,"*","summary",this.featureDescription)));var F=this.getChildValue(I,"*","link");if(!F){try{F=this.getElementsByTagNameNS(I,"*","link")[0].getAttribute("href")}catch(D){F=null}}var B=this.getChildValue(I,"*","id",null);var C={title:G,description:H,link:F};var J=new OpenLayers.Feature.Vector(E,C);J.fid=B;return J},getChildValue:function(E,C,D,G){var F;var B=this.getElementsByTagNameNS(E,C,D);if(B&&B[0]&&B[0].firstChild&&B[0].firstChild.nodeValue){F=B[0].firstChild.nodeValue}else{F=(G==undefined)?"":G}return F},read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var B=null;B=this.getElementsByTagNameNS(F,"*","item");if(B.length==0){B=this.getElementsByTagNameNS(F,"*","entry")}var D=B.length;var E=new Array(D);for(var C=0;C<D;C++){E[C]=this.createFeatureFromItem(B[C])}return E},write:function(D){var E;if(D instanceof Array){E=this.createElementNS(this.rssns,"rss");for(var C=0,B=D.length;C<B;C++){E.appendChild(this.createFeatureXML(D[C]))}}else{E=this.createFeatureXML(D)}return OpenLayers.Format.XML.prototype.write.apply(this,[E])},createFeatureXML:function(K){var G=this.buildGeometryNode(K.geometry);var B=this.createElementNS(this.rssns,"item");var E=this.createElementNS(this.rssns,"title");E.appendChild(this.createTextNode(K.attributes.title?K.attributes.title:""));var C=this.createElementNS(this.rssns,"description");C.appendChild(this.createTextNode(K.attributes.description?K.attributes.description:""));B.appendChild(E);B.appendChild(C);if(K.attributes.link){var I=this.createElementNS(this.rssns,"link");I.appendChild(this.createTextNode(K.attributes.link));B.appendChild(I)}for(var J in K.attributes){if(J=="link"||J=="title"||J=="description"){continue}var H=this.createTextNode(K.attributes[J]);var F=J;if(J.search(":")!=-1){F=J.split(":")[1]}var D=this.createElementNS(this.featureNS,"feature:"+F);D.appendChild(H);B.appendChild(D)}B.appendChild(G);return B},buildGeometryNode:function(C){if(this.internalProjection&&this.externalProjection){C=C.clone();C.transform(this.internalProjection,this.externalProjection)}var B;if(C.CLASS_NAME=="OpenLayers.Geometry.Polygon"){B=this.createElementNS(this.georssns,"georss:polygon");B.appendChild(this.buildCoordinatesNode(C.components[0]))}else{if(C.CLASS_NAME=="OpenLayers.Geometry.LineString"){B=this.createElementNS(this.georssns,"georss:line");B.appendChild(this.buildCoordinatesNode(C))}else{if(C.CLASS_NAME=="OpenLayers.Geometry.Point"){B=this.createElementNS(this.georssns,"georss:point");B.appendChild(this.buildCoordinatesNode(C))}else{throw"Couldn't parse "+C.CLASS_NAME}}}return B},buildCoordinatesNode:function(G){var D=null;if(G.components){D=G.components}var F;if(D){var C=D.length;var E=new Array(C);for(var B=0;B<C;B++){E[B]=D[B].y+" "+D[B].x}F=E.join(" ")}else{F=G.y+" "+G.x}return this.createTextNode(F)},CLASS_NAME:"OpenLayers.Format.GeoRSS"});OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date(),extractAttributes:true,extractStyles:false,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(B){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g),kmlColor:(/(\w{2})(\w{2})(\w{2})(\w{2})/),kmlIconPalette:(/root:\/\/icons\/palette-(\d+)(\.\w+)/),straightBracket:(/\$\[(.*?)\]/g)};OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(C){this.features=[];this.styles={};this.fetched={};var B={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(C,B)},parseData:function(H,D){if(typeof H=="string"){H=OpenLayers.Format.XML.prototype.read.apply(this,[H])}var F=["Link","NetworkLink","Style","StyleMap","Placemark"];for(var E=0,B=F.length;E<B;++E){var G=F[E];var C=this.getElementsByTagNameNS(H,"*",G);if(C.length==0){continue}switch(G.toLowerCase()){case"link":case"networklink":this.parseLinks(C,D);break;case"style":if(this.extractStyles){this.parseStyles(C,D)}break;case"stylemap":if(this.extractStyles){this.parseStyleMaps(C,D)}break;case"placemark":this.parseFeatures(C,D);break}}return this.features},parseLinks:function(D,E){if(E.depth>=this.maxDepth){return false}var H=OpenLayers.Util.extend({},E);H.depth++;for(var F=0,B=D.length;F<B;F++){var C=this.parseProperty(D[F],"*","href");if(C&&!this.fetched[C]){this.fetched[C]=true;var G=this.fetchLink(C);if(G){this.parseData(G,H)}}}},fetchLink:function(B){var C=OpenLayers.Request.GET({url:B,async:false});if(C){return C.responseText}},parseStyles:function(C,D){for(var E=0,B=C.length;E<B;E++){var F=this.parseStyle(C[E]);if(F){styleName=(D.styleBaseUrl||"")+"#"+F.id;this.styles[styleName]=F}}},parseStyle:function(R){var j={};var d=["LineStyle","PolyStyle","IconStyle","BalloonStyle"];var AB,H,I,O;for(var q=0,K=d.length;q<K;++q){AB=d[q];styleTypeNode=this.getElementsByTagNameNS(R,"*",AB)[0];if(!styleTypeNode){continue}switch(AB.toLowerCase()){case"linestyle":var N=this.parseProperty(styleTypeNode,"*","color");if(N){var C=(N.toString()).match(this.regExes.kmlColor);var l=C[1];j.strokeOpacity=parseInt(l,16)/255;var AA=C[2];var v=C[3];var f=C[4];j.strokeColor="#"+f+v+AA}var B=this.parseProperty(styleTypeNode,"*","width");if(B){j.strokeWidth=B}case"polystyle":var N=this.parseProperty(styleTypeNode,"*","color");if(N){var C=(N.toString()).match(this.regExes.kmlColor);var l=C[1];j.fillOpacity=parseInt(l,16)/255;var AA=C[2];var v=C[3];var f=C[4];j.fillColor="#"+f+v+AA}var J=this.parseProperty(styleTypeNode,"*","fill");if(J=="0"){j.fillColor="none"}break;case"iconstyle":var S=parseFloat(this.parseProperty(styleTypeNode,"*","scale")||1);var B=32*S;var D=32*S;var E=this.getElementsByTagNameNS(styleTypeNode,"*","Icon")[0];if(E){var M=this.parseProperty(E,"*","href");if(M){var a=this.parseProperty(E,"*","w");var u=this.parseProperty(E,"*","h");var G="http://maps.google.com/mapfiles/kml";if(OpenLayers.String.startsWith(M,G)&&!a&&!u){a=64;u=64;S=S/2}a=a||u;u=u||a;if(a){B=parseInt(a)*S}if(u){D=parseInt(u)*S}var C=M.match(this.regExes.kmlIconPalette);if(C){var m=C[1];var L=C[2];var Z=this.parseProperty(E,"*","x");var Y=this.parseProperty(E,"*","y");var U=Z?Z/32:0;var T=Y?(7-Y/32):7;var Q=T*8+U;M="http://maps.google.com/mapfiles/kml/pal"+m+"/icon"+Q+L}j.graphicOpacity=1;j.externalGraphic=M}}var W=this.getElementsByTagNameNS(styleTypeNode,"*","hotSpot")[0];if(W){var Z=parseFloat(W.getAttribute("x"));var Y=parseFloat(W.getAttribute("y"));var P=W.getAttribute("xunits");if(P=="pixels"){j.graphicXOffset=-Z*S}else{if(P=="insetPixels"){j.graphicXOffset=-B+(Z*S)}else{if(P=="fraction"){j.graphicXOffset=-B*Z}}}var F=W.getAttribute("yunits");if(F=="pixels"){j.graphicYOffset=-D+(Y*S)+1}else{if(F=="insetPixels"){j.graphicYOffset=-(Y*S)+1}else{if(F=="fraction"){j.graphicYOffset=-D*(1-Y)+1}}}}j.graphicWidth=B;j.graphicHeight=D;break;case"balloonstyle":var z=OpenLayers.Util.getXmlNodeValue(styleTypeNode);if(z){j.balloonStyle=z.replace(this.regExes.straightBracket,"${$1}")}break;default:}}if(!j.strokeColor&&j.fillColor){j.strokeColor=j.fillColor}var V=R.getAttribute("id");if(V&&j){j.id=V}return j},parseStyleMaps:function(B,M){for(var H=0,I=B.length;H<I;H++){var E=B[H];var D=this.getElementsByTagNameNS(E,"*","Pair");var C=E.getAttribute("id");for(var G=0,L=D.length;G<L;G++){var F=D[G];var K=this.parseProperty(F,"*","key");var J=this.parseProperty(F,"*","styleUrl");if(J&&K=="normal"){this.styles[(M.styleBaseUrl||"")+"#"+C]=this.styles[(M.styleBaseUrl||"")+J]}if(J&&K=="highlight"){}}}},parseFeatures:function(B,J){var E=new Array(B.length);for(var F=0,G=B.length;F<G;F++){var C=B[F];var I=this.parseFeature.apply(this,[C]);if(I){if(this.extractStyles&&I.attributes&&I.attributes.styleUrl){I.style=this.getStyle(I.attributes.styleUrl,J)}if(this.extractStyles){var H=this.getElementsByTagNameNS(C,"*","Style")[0];if(H){var D=this.parseStyle(H);if(D){I.style=OpenLayers.Util.extend(I.style,D)}}}E[F]=I}else{throw"Bad Placemark: "+F}}this.features=this.features.concat(E)},parseFeature:function(C){var D=["MultiGeometry","Polygon","LineString","Point"];var J,F,K,B;for(var H=0,I=D.length;H<I;++H){J=D[H];this.internalns=C.namespaceURI?C.namespaceURI:this.kmlns;F=this.getElementsByTagNameNS(C,this.internalns,J);if(F.length>0){var B=this.parseGeometry[J.toLowerCase()];if(B){K=B.apply(this,[F[0]]);if(this.internalProjection&&this.externalProjection){K.transform(this.externalProjection,this.internalProjection)}}else{OpenLayers.Console.error(OpenLayers.i18n("unsupportedGeometryType",{geomType:J}))}break}}var G;if(this.extractAttributes){G=this.parseAttributes(C)}var L=new OpenLayers.Feature.Vector(K,G);var E=C.getAttribute("id")||C.getAttribute("name");if(E!=null){L.fid=E}return L},getStyle:function(C,B){var D=OpenLayers.Util.removeTail(C);var G=OpenLayers.Util.extend({},B);G.depth++;G.styleBaseUrl=D;if(!this.styles[C]&&!OpenLayers.String.startsWith(C,"#")&&G.depth<=this.maxDepth&&!this.fetched[D]){var F=this.fetchLink(D);if(F){this.parseData(F,G)}}var E=OpenLayers.Util.extend({},this.styles[C]);return E},parseGeometry:{point:function(E){var D=this.getElementsByTagNameNS(E,this.internalns,"coordinates");var F=[];if(D.length>0){var C=D[0].firstChild.nodeValue;C=C.replace(this.regExes.removeSpace,"");F=C.split(",")}var B=null;if(F.length>1){if(F.length==2){F[2]=null}B=new OpenLayers.Geometry.Point(F[0],F[1],F[2])}else{throw"Bad coordinate string: "+C}return B},linestring:function(D,F){var E=this.getElementsByTagNameNS(D,this.internalns,"coordinates");var L=null;if(E.length>0){var C=this.getChildValue(E[0]);C=C.replace(this.regExes.trimSpace,"");C=C.replace(this.regExes.trimComma,",");var B=C.split(this.regExes.splitSpace);var I=B.length;var K=new Array(I);var J,H;for(var G=0;G<I;++G){J=B[G].split(",");H=J.length;if(H>1){if(J.length==2){J[2]=null}K[G]=new OpenLayers.Geometry.Point(J[0],J[1],J[2])}else{throw"Bad LineString point coordinates: "+B[G]}}if(I){if(F){L=new OpenLayers.Geometry.LinearRing(K)}else{L=new OpenLayers.Geometry.LineString(K)}}else{throw"Bad LineString coordinates: "+C}}return L},polygon:function(G){var D=this.getElementsByTagNameNS(G,this.internalns,"LinearRing");var H=D.length;var F=new Array(H);if(H>0){var C;for(var E=0,B=D.length;E<B;++E){C=this.parseGeometry.linestring.apply(this,[D[E],true]);if(C){F[E]=C}else{throw"Bad LinearRing geometry: "+E}}}return new OpenLayers.Geometry.Polygon(F)},multigeometry:function(F){var I,H;var G=[];var D=F.childNodes;for(var C=0,B=D.length;C<B;++C){I=D[C];if(I.nodeType==1){var E=(I.prefix)?I.nodeName.split(":")[1]:I.nodeName;var H=this.parseGeometry[E.toLowerCase()];if(H){G.push(H.apply(this,[I]))}}}return new OpenLayers.Geometry.Collection(G)}},parseAttributes:function(E){var F={};var G=E.getElementsByTagName("ExtendedData");if(G.length){F=this.parseExtendedData(G[0])}var C,L,K;var D=E.childNodes;for(var H=0,I=D.length;H<I;++H){C=D[H];if(C.nodeType==1){L=C.childNodes;if(L.length==1||L.length==3){var K;switch(L.length){case 1:K=L[0];break;case 3:default:K=L[1];break}if(K.nodeType==3||K.nodeType==4){var B=(C.prefix)?C.nodeName.split(":")[1]:C.nodeName;var J=OpenLayers.Util.getXmlNodeValue(K);if(J){J=J.replace(this.regExes.trimSpace,"");F[B]=J}}}}}return F},parseExtendedData:function(C){var E={};var D=C.getElementsByTagName("Data");for(var G=0,I=D.length;G<I;G++){var F=D[G];var J=F.getAttribute("name");var H={};var K=F.getElementsByTagName("value");if(K.length){H.value=this.getChildValue(K[0])}var B=F.getElementsByTagName("displayName");if(B.length){H.displayName=this.getChildValue(B[0])}E[J]=H}return E},parseProperty:function(D,E,C){var F;var B=this.getElementsByTagNameNS(D,E,C);try{F=OpenLayers.Util.getXmlNodeValue(B[0])}catch(G){F=null}return F},write:function(E){if(!(E instanceof Array)){E=[E]}var C=this.createElementNS(this.kmlns,"kml");var F=this.createFolderXML();for(var D=0,B=E.length;D<B;++D){F.appendChild(this.createPlacemarkXML(E[D]))}C.appendChild(F);return OpenLayers.Format.XML.prototype.write.apply(this,[C])},createFolderXML:function(){var F=this.createElementNS(this.kmlns,"name");var E=this.createTextNode(this.foldersName);F.appendChild(E);var B=this.createElementNS(this.kmlns,"description");var C=this.createTextNode(this.foldersDesc);B.appendChild(C);var D=this.createElementNS(this.kmlns,"Folder");D.appendChild(F);D.appendChild(B);return D},createPlacemarkXML:function(F){var H=this.createElementNS(this.kmlns,"name");var D=(F.attributes.name)?F.attributes.name:F.id;H.appendChild(this.createTextNode(D));var E=this.createElementNS(this.kmlns,"description");var G=(F.attributes.description)?F.attributes.description:this.placemarksDesc;E.appendChild(this.createTextNode(G));var C=this.createElementNS(this.kmlns,"Placemark");if(F.fid!=null){C.setAttribute("id",F.fid)}C.appendChild(H);C.appendChild(E);var B=this.buildGeometryNode(F.geometry);C.appendChild(B);return C},buildGeometryNode:function(F){if(this.internalProjection&&this.externalProjection){F=F.clone();F.transform(this.internalProjection,this.externalProjection)}var D=F.CLASS_NAME;var C=D.substring(D.lastIndexOf(".")+1);var B=this.buildGeometry[C.toLowerCase()];var E=null;if(B){E=B.apply(this,[F])}return E},buildGeometry:{point:function(C){var B=this.createElementNS(this.kmlns,"Point");B.appendChild(this.buildCoordinatesNode(C));return B},multipoint:function(B){return this.buildGeometry.collection.apply(this,[B])},linestring:function(C){var B=this.createElementNS(this.kmlns,"LineString");B.appendChild(this.buildCoordinatesNode(C));return B},multilinestring:function(B){return this.buildGeometry.collection.apply(this,[B])},linearring:function(C){var B=this.createElementNS(this.kmlns,"LinearRing");B.appendChild(this.buildCoordinatesNode(C));return B},polygon:function(I){var C=this.createElementNS(this.kmlns,"Polygon");var H=I.components;var F,G,E;for(var D=0,B=H.length;D<B;++D){E=(D==0)?"outerBoundaryIs":"innerBoundaryIs";F=this.createElementNS(this.kmlns,E);G=this.buildGeometry.linearring.apply(this,[H[D]]);F.appendChild(G);C.appendChild(F)}return C},multipolygon:function(B){return this.buildGeometry.collection.apply(this,[B])},collection:function(E){var C=this.createElementNS(this.kmlns,"MultiGeometry");var F;for(var D=0,B=E.components.length;D<B;++D){F=this.buildGeometryNode.apply(this,[E.components[D]]);if(F){C.appendChild(F)}}return C}},buildCoordinatesNode:function(F){var B=this.createElementNS(this.kmlns,"coordinates");var J;var I=F.components;if(I){var H;var G=I.length;var D=new Array(G);for(var E=0;E<G;++E){H=I[E];D[E]=H.x+","+H.y}J=D.join(" ")}else{J=F.x+","+F.y}var C=this.createTextNode(J);B.appendChild(C);return B},CLASS_NAME:"OpenLayers.Format.KML"});OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:false,interestingTagsExclude:null,areaTags:null,initialize:function(B){var E={interestingTagsExclude:["source","source_ref","source:ref","history","attribution","created_by"],areaTags:["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]};E=OpenLayers.Util.extend(E,B);var F={};for(var C=0;C<E.interestingTagsExclude.length;C++){F[E.interestingTagsExclude[C]]=true}E.interestingTagsExclude=F;var D={};for(var C=0;C<E.areaTags.length;C++){D[E.areaTags[C]]=true}E.areaTags=D;OpenLayers.Format.XML.prototype.initialize.apply(this,[E])},read:function(M){if(typeof M=="string"){M=OpenLayers.Format.XML.prototype.read.apply(this,[M])}var C=this.getNodes(M);var N=this.getWays(M);var H=new Array(N.length);for(var G=0;G<N.length;G++){var K=new Array(N[G].nodes.length);var B=this.isWayArea(N[G])?1:0;for(var F=0;F<N[G].nodes.length;F++){var D=C[N[G].nodes[F]];var L=new OpenLayers.Geometry.Point(D.lon,D.lat);L.osm_id=parseInt(N[G].nodes[F]);K[F]=L;D.used=true}var J=null;if(B){J=new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(K))}else{J=new OpenLayers.Geometry.LineString(K)}if(this.internalProjection&&this.externalProjection){J.transform(this.externalProjection,this.internalProjection)}var I=new OpenLayers.Feature.Vector(J,N[G].tags);I.osm_id=parseInt(N[G].id);I.fid="way."+I.osm_id;H[G]=I}for(var E in C){var D=C[E];if(!D.used||this.checkTags){var P=null;if(this.checkTags){var O=this.getTags(D.node,true);if(D.used&&!O[1]){continue}P=O[0]}else{P=this.getTags(D.node)}var I=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(D.lon,D.lat),P);if(this.internalProjection&&this.externalProjection){I.geometry.transform(this.externalProjection,this.internalProjection)}I.osm_id=parseInt(E);I.fid="node."+I.osm_id;H.push(I)}D.node=null}return H},getNodes:function(F){var E=F.getElementsByTagName("node");var B={};for(var C=0;C<E.length;C++){var D=E[C];var G=D.getAttribute("id");B[G]={lat:D.getAttribute("lat"),lon:D.getAttribute("lon"),node:D}}return B},getWays:function(H){var G=H.getElementsByTagName("way");var I=[];for(var E=0;E<G.length;E++){var C=G[E];var D={id:C.getAttribute("id")};D.tags=this.getTags(C);var F=C.getElementsByTagName("nd");D.nodes=new Array(F.length);for(var B=0;B<F.length;B++){D.nodes[B]=F[B].getAttribute("ref")}I.push(D)}return I},getTags:function(F,H){var B=F.getElementsByTagName("tag");var D={};var G=false;for(var C=0;C<B.length;C++){var E=B[C].getAttribute("k");D[E]=B[C].getAttribute("v");if(H){if(!this.interestingTagsExclude[E]){G=true}}}return H?[D,G]:D},isWayArea:function(C){var B=false;var E=false;if(C.nodes[0]==C.nodes[C.nodes.length-1]){B=true}if(this.checkTags){for(var D in C.tags){if(this.areaTags[D]){E=true;break}}}return B&&(this.checkTags?E:true)},write:function(E){if(!(E instanceof Array)){E=[E]}this.osm_id=1;this.created_nodes={};var F=this.createElementNS(null,"osm");F.setAttribute("version","0.5");F.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var D=E.length-1;D>=0;D--){var B=this.createFeatureNodes(E[D]);for(var C=0;C<B.length;C++){F.appendChild(B[C])}}return OpenLayers.Format.XML.prototype.write.apply(this,[F])},createFeatureNodes:function(D){var C=[];var F=D.geometry.CLASS_NAME;var E=F.substring(F.lastIndexOf(".")+1);E=E.toLowerCase();var B=this.createXML[E];if(B){C=B.apply(this,[D])}return C},createXML:{point:function(B){var F=null;var D=B.geometry?B.geometry:B;var E=false;if(B.osm_id){F=B.osm_id;if(this.created_nodes[F]){E=true}}else{F=-this.osm_id;this.osm_id++}if(E){C=this.created_nodes[F]}else{var C=this.createElementNS(null,"node")}this.created_nodes[F]=C;C.setAttribute("id",F);C.setAttribute("lon",D.x);C.setAttribute("lat",D.y);if(B.attributes){this.serializeTags(B,C)}this.setState(B,C);return E?[]:[C]},linestring:function(E){var B=[];var I=E.geometry;if(E.osm_id){id=E.osm_id}else{id=-this.osm_id;this.osm_id++}var C=this.createElementNS(null,"way");C.setAttribute("id",id);for(var D=0;D<I.components.length;D++){var G=this.createXML.point.apply(this,[I.components[D]]);if(G.length){G=G[0];var F=G.getAttribute("id");B.push(G)}else{F=I.components[D].osm_id;G=this.created_nodes[F]}this.setState(E,G);var H=this.createElementNS(null,"nd");H.setAttribute("ref",F);C.appendChild(H)}this.serializeTags(E,C);B.push(C);return B},polygon:function(C){var B=OpenLayers.Util.extend({area:"yes"},C.attributes);var D=new OpenLayers.Feature.Vector(C.geometry.components[0],B);D.osm_id=C.osm_id;return this.createXML.linestring.apply(this,[D])}},serializeTags:function(D,E){for(var C in D.attributes){var B=this.createElementNS(null,"tag");B.setAttribute("k",C);B.setAttribute("v",D.attributes[C]);E.appendChild(B)}},setState:function(B,C){if(B.state){var D=null;switch(B.state){case OpenLayers.State.UPDATE:D="modify";case OpenLayers.State.DELETE:D="delete"}if(D){C.setAttribute("action",D)}}},CLASS_NAME:"OpenLayers.Format.OSM"});OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],initialize:function(B){OpenLayers.Geometry.Collection.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"});OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{polygon:null,initialize:function(D,C,B){OpenLayers.Handler.Path.prototype.initialize.apply(this,arguments)},createFeature:function(B){var C=this.control.map.getLonLatFromPixel(B);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(C.lon,C.lat));this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry]));this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry]));this.callback("create",[this.point.geometry,this.getSketch()]);this.point.geometry.clearBounds();this.layer.addFeatures([this.polygon,this.point],{silent:true})},destroyFeature:function(){OpenLayers.Handler.Path.prototype.destroyFeature.apply(this);this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style);this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var B=this.polygon&&this.polygon.geometry;if(B&&this.multi){B=new OpenLayers.Geometry.MultiPolygon([B])}return B},dblclick:function(B){if(!this.freehandMode(B)){var C=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[C]);this.removePoint();this.finalize()}return false},CLASS_NAME:"OpenLayers.Handler.Polygon"});OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(D,C){OpenLayers.Control.Panel.prototype.initialize.apply(this,[C]);this.addControls([new OpenLayers.Control.Navigation()]);var B=[new OpenLayers.Control.DrawFeature(D,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint"}),new OpenLayers.Control.DrawFeature(D,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath"}),new OpenLayers.Control.DrawFeature(D,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon"})];this.addControls(B)},draw:function(){var B=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return B},CLASS_NAME:"OpenLayers.Control.EditingToolbar"});OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:["antialiasing","blockout","font","fontcolor","fontsize","fontstyle","glowing","interval","outline","printmode","shadow","transparency"],request:null,response:null,initialize:function(B){this.request=new OpenLayers.Format.ArcXML.Request();this.response=new OpenLayers.Format.ArcXML.Response();if(B){if(B.requesttype=="feature"){this.request.get_image=null;var D=this.request.get_feature.query;this.addCoordSys(D.featurecoordsys,B.featureCoordSys);this.addCoordSys(D.filtercoordsys,B.filterCoordSys);if(B.polygon){D.isspatial=true;D.spatialfilter.polygon=B.polygon}else{if(B.envelope){D.isspatial=true;D.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0};this.parseEnvelope(D.spatialfilter.envelope,B.envelope)}}}else{if(B.requesttype=="image"){this.request.get_feature=null;var C=this.request.get_image.properties;this.parseEnvelope(C.envelope,B.envelope);this.addLayers(C.layerlist,B.layers);this.addImageSize(C.imagesize,B.tileSize);this.addCoordSys(C.featurecoordsys,B.featureCoordSys);this.addCoordSys(C.filtercoordsys,B.filterCoordSys)}else{this.request=null}}}OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},parseEnvelope:function(C,B){if(B&&B.length==4){C.minx=B[0];C.miny=B[1];C.maxx=B[2];C.maxy=B[3]}},addLayers:function(E,D){for(var C=0,B=D.length;C<B;C++){E.push(D[C])}},addImageSize:function(C,B){if(B!==null){C.width=B.w;C.height=B.h;C.printwidth=B.w;C.printheight=B.h}},addCoordSys:function(B,C){if(typeof C=="string"){B.id=parseInt(C);B.string=C}else{if(typeof C=="object"&&C.proj!==null){B.id=C.proj.srsProjNumber;B.string=C.proj.srsCode}else{B=C}}},iserror:function(D){var B=null;if(!D){B=(this.response.error!=="")}else{D=OpenLayers.Format.XML.prototype.read.apply(this,[D]);var C=D.documentElement.getElementsByTagName("ERROR");B=(C!==null&&C.length>0)}return B},read:function(G){if(typeof G=="string"){G=OpenLayers.Format.XML.prototype.read.apply(this,[G])}var B=null;if(G&&G.documentElement){if(G.documentElement.nodeName=="ARCXML"){B=G.documentElement}else{B=G.documentElement.getElementsByTagName("ARCXML")[0]}}if(!B){var D,F;try{D=G.firstChild.nodeValue;F=G.firstChild.childNodes[1].firstChild.nodeValue}catch(E){}throw {message:"Error parsing the ArcXML request",error:D,source:F}}var C=this.parseResponse(B);return C},write:function(D){if(!D){D=this.request}var R=this.createElementNS("","ARCXML");R.setAttribute("version","1.1");var I=this.createElementNS("","REQUEST");if(D.get_image!=null){var L=this.createElementNS("","GET_IMAGE");I.appendChild(L);var K=this.createElementNS("","PROPERTIES");L.appendChild(K);var C=D.get_image.properties;if(C.featurecoordsys!=null){var P=this.createElementNS("","FEATURECOORDSYS");K.appendChild(P);if(C.featurecoordsys.id===0){P.setAttribute("string",C.featurecoordsys.string)}else{P.setAttribute("id",C.featurecoordsys.id)}}if(C.filtercoordsys!=null){var N=this.createElementNS("","FILTERCOORDSYS");K.appendChild(N);if(C.filtercoordsys.id===0){N.setAttribute("string",C.filtercoordsys.string)}else{N.setAttribute("id",C.filtercoordsys.id)}}if(C.envelope!=null){var V=this.createElementNS("","ENVELOPE");K.appendChild(V);V.setAttribute("minx",C.envelope.minx);V.setAttribute("miny",C.envelope.miny);V.setAttribute("maxx",C.envelope.maxx);V.setAttribute("maxy",C.envelope.maxy)}var T=this.createElementNS("","IMAGESIZE");K.appendChild(T);T.setAttribute("height",C.imagesize.height);T.setAttribute("width",C.imagesize.width);if(C.imagesize.height!=C.imagesize.printheight||C.imagesize.width!=C.imagesize.printwidth){T.setAttribute("printheight",C.imagesize.printheight);T.setArrtibute("printwidth",C.imagesize.printwidth)}if(C.background!=null){var B=this.createElementNS("","BACKGROUND");K.appendChild(B);B.setAttribute("color",C.background.color.r+","+C.background.color.g+","+C.background.color.b);if(C.background.transcolor!==null){B.setAttribute("transcolor",C.background.transcolor.r+","+C.background.transcolor.g+","+C.background.transcolor.b)}}if(C.layerlist!=null&&C.layerlist.length>0){var H=this.createElementNS("","LAYERLIST");K.appendChild(H);for(var Q=0;Q<C.layerlist.length;Q++){var O=this.createElementNS("","LAYERDEF");H.appendChild(O);O.setAttribute("id",C.layerlist[Q].id);O.setAttribute("visible",C.layerlist[Q].visible);if(typeof C.layerlist[Q].query=="object"){var G=C.layerlist[Q].query;if(G.where.length<0){continue}var Z=null;if(typeof G.spatialfilter=="boolean"&&G.spatialfilter){Z=this.createElementNS("","SPATIALQUERY")}else{Z=this.createElementNS("","QUERY")}Z.setAttribute("where",G.where);if(typeof G.accuracy=="number"&&G.accuracy>0){Z.setAttribute("accuracy",G.accuracy)}if(typeof G.featurelimit=="number"&&G.featurelimit<2000){Z.setAttribute("featurelimit",G.featurelimit)}if(typeof G.subfields=="string"&&G.subfields!="#ALL#"){Z.setAttribute("subfields",G.subfields)}if(typeof G.joinexpression=="string"&&G.joinexpression.length>0){Z.setAttribute("joinexpression",G.joinexpression)}if(typeof G.jointables=="string"&&G.jointables.length>0){Z.setAttribute("jointables",G.jointables)}O.appendChild(Z)}if(typeof C.layerlist[Q].renderer=="object"){this.addRenderer(O,C.layerlist[Q].renderer)}}}}else{if(D.get_feature!=null){var L=this.createElementNS("","GET_FEATURES");L.setAttribute("outputmode","newxml");L.setAttribute("checkesc","true");if(D.get_feature.geometry){L.setAttribute("geometry",D.get_feature.geometry)}else{L.setAttribute("geometry","false")}if(D.get_feature.compact){L.setAttribute("compact",D.get_feature.compact)}if(D.get_feature.featurelimit=="number"){L.setAttribute("featurelimit",D.get_feature.featurelimit)}L.setAttribute("globalenvelope","true");I.appendChild(L);if(D.get_feature.layer!=null&&D.get_feature.layer.length>0){var W=this.createElementNS("","LAYER");W.setAttribute("id",D.get_feature.layer);L.appendChild(W)}var S=D.get_feature.query;if(S!=null){var U=null;if(S.isspatial){U=this.createElementNS("","SPATIALQUERY")}else{U=this.createElementNS("","QUERY")}L.appendChild(U);if(typeof S.accuracy=="number"){U.setAttribute("accuracy",S.accuracy)}if(S.featurecoordsys!=null){var F=this.createElementNS("","FEATURECOORDSYS");if(S.featurecoordsys.id==0){F.setAttribute("string",S.featurecoordsys.string)}else{F.setAttribute("id",S.featurecoordsys.id)}U.appendChild(F)}if(S.filtercoordsys!=null){var E=this.createElementNS("","FILTERCOORDSYS");if(S.filtercoordsys.id===0){E.setAttribute("string",S.filtercoordsys.string)}else{E.setAttribute("id",S.filtercoordsys.id)}U.appendChild(E)}if(S.buffer>0){var M=this.createElementNS("","BUFFER");M.setAttribute("distance",S.buffer);U.appendChild(M)}if(S.isspatial){var J=this.createElementNS("","SPATIALFILTER");J.setAttribute("relation",S.spatialfilter.relation);U.appendChild(J);if(S.spatialfilter.envelope){var Y=this.createElementNS("","ENVELOPE");Y.setAttribute("minx",S.spatialfilter.envelope.minx);Y.setAttribute("miny",S.spatialfilter.envelope.miny);Y.setAttribute("maxx",S.spatialfilter.envelope.maxx);Y.setAttribute("maxy",S.spatialfilter.envelope.maxy);J.appendChild(Y)}else{if(typeof S.spatialfilter.polygon=="object"){J.appendChild(this.writePolygonGeometry(S.spatialfilter.polygon))}}}if(S.where!=null&&S.where.length>0){U.setAttribute("where",S.where)}}}}R.appendChild(I);return OpenLayers.Format.XML.prototype.write.apply(this,[R])},addGroupRenderer:function(C,B){var F=this.createElementNS("","GROUPRENDERER");C.appendChild(F);for(var D=0;D<B.length;D++){var E=B[D];this.addRenderer(F,E)}},addRenderer:function(D,C){if(C instanceof Array){this.addGroupRenderer(D,C)}else{var B=this.createElementNS("",C.type.toUpperCase()+"RENDERER");D.appendChild(B);if(B.tagName=="VALUEMAPRENDERER"){this.addValueMapRenderer(B,C)}else{if(B.tagName=="VALUEMAPLABELRENDERER"){this.addValueMapLabelRenderer(B,C)}else{if(B.tagName=="SIMPLELABELRENDERER"){this.addSimpleLabelRenderer(B,C)}else{if(B.tagName=="SCALEDEPENDENTRENDERER"){this.addScaleDependentRenderer(B,C)}}}}}},addScaleDependentRenderer:function(B,C){if(typeof C.lower=="string"||typeof C.lower=="number"){B.setAttribute("lower",C.lower)}if(typeof C.upper=="string"||typeof C.upper=="number"){B.setAttribute("upper",C.upper)}this.addRenderer(B,C.renderer)},addValueMapLabelRenderer:function(I,H){I.setAttribute("lookupfield",H.lookupfield);I.setAttribute("labelfield",H.labelfield);if(typeof H.exacts=="object"){for(var B=0,K=H.exacts.length;B<K;B++){var F=H.exacts[B];var E=this.createElementNS("","EXACT");if(typeof F.value=="string"){E.setAttribute("value",F.value)}if(typeof F.label=="string"){E.setAttribute("label",F.label)}if(typeof F.method=="string"){E.setAttribute("method",F.method)}I.appendChild(E);if(typeof F.symbol=="object"){var C=null;if(F.symbol.type=="text"){C=this.createElementNS("","TEXTSYMBOL")}if(C!=null){var L=this.fontStyleKeys;for(var D=0,G=L.length;D<G;D++){var J=L[D];if(F.symbol[J]){C.setAttribute(J,F.symbol[J])}}E.appendChild(C)}}}}},addValueMapRenderer:function(K,J){K.setAttribute("lookupfield",J.lookupfield);if(typeof J.ranges=="object"){for(var B=0,C=J.ranges.length;B<C;B++){var H=J.ranges[B];var F=this.createElementNS("","RANGE");F.setAttribute("lower",H.lower);F.setAttribute("upper",H.upper);K.appendChild(F);if(typeof H.symbol=="object"){var E=null;if(H.symbol.type=="simplepolygon"){E=this.createElementNS("","SIMPLEPOLYGONSYMBOL")}if(E!=null){if(typeof H.symbol.boundarycolor=="string"){E.setAttribute("boundarycolor",H.symbol.boundarycolor)}if(typeof H.symbol.fillcolor=="string"){E.setAttribute("fillcolor",H.symbol.fillcolor)}if(typeof H.symbol.filltransparency=="number"){E.setAttribute("filltransparency",H.symbol.filltransparency)}F.appendChild(E)}}}}else{if(typeof J.exacts=="object"){for(var D=0,L=J.exacts.length;D<L;D++){var I=J.exacts[D];var G=this.createElementNS("","EXACT");if(typeof I.value=="string"){G.setAttribute("value",I.value)}if(typeof I.label=="string"){G.setAttribute("label",I.label)}if(typeof I.method=="string"){G.setAttribute("method",I.method)}K.appendChild(G);if(typeof I.symbol=="object"){var E=null;if(I.symbol.type=="simplemarker"){E=this.createElementNS("","SIMPLEMARKERSYMBOL")}if(E!=null){if(typeof I.symbol.antialiasing=="string"){E.setAttribute("antialiasing",I.symbol.antialiasing)}if(typeof I.symbol.color=="string"){E.setAttribute("color",I.symbol.color)}if(typeof I.symbol.outline=="string"){E.setAttribute("outline",I.symbol.outline)}if(typeof I.symbol.overlap=="string"){E.setAttribute("overlap",I.symbol.overlap)}if(typeof I.symbol.shadow=="string"){E.setAttribute("shadow",I.symbol.shadow)}if(typeof I.symbol.transparency=="number"){E.setAttribute("transparency",I.symbol.transparency)}if(typeof I.symbol.usecentroid=="string"){E.setAttribute("usecentroid",I.symbol.usecentroid)}if(typeof I.symbol.width=="number"){E.setAttribute("width",I.symbol.width)}G.appendChild(E)}}}}}},addSimpleLabelRenderer:function(G,I){G.setAttribute("field",I.field);var F=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"];for(var E=0,B=F.length;E<B;E++){var D=F[E];if(I[D]){G.setAttribute(D,I[D])}}if(I.symbol.type=="text"){var H=I.symbol;var C=this.createElementNS("","TEXTSYMBOL");G.appendChild(C);var F=this.fontStyleKeys;for(var E=0,B=F.length;E<B;E++){var D=F[E];if(H[D]){C.setAttribute(D,I[D])}}}},writePolygonGeometry:function(H){if(!(H instanceof OpenLayers.Geometry.Polygon)){throw {message:"Cannot write polygon geometry to ArcXML with an "+H.CLASS_NAME+" object.",geometry:H}}var C=this.createElementNS("","POLYGON");for(var F=0,D=H.components.length;F<D;F++){var B=H.components[F];var J=this.createElementNS("","RING");for(var E=0,K=B.components.length;E<K;E++){var I=B.components[E];var G=this.createElementNS("","POINT");G.setAttribute("x",I.x);G.setAttribute("y",I.y);J.appendChild(G)}C.appendChild(J)}return C},parseResponse:function(b){if(typeof b=="string"){var O=new OpenLayers.Format.XML();b=O.read(b)}var B=new OpenLayers.Format.ArcXML.Response();var d=b.getElementsByTagName("ERROR");if(d!=null&&d.length>0){B.error=this.getChildValue(d,"Unknown error.")}else{var S=b.getElementsByTagName("RESPONSE");if(S==null||S.length==0){B.error="No RESPONSE tag found in ArcXML response.";return B}var R=S[0].firstChild.nodeName;if(R=="#text"){R=S[0].firstChild.nextSibling.nodeName}if(R=="IMAGE"){var D=b.getElementsByTagName("ENVELOPE");var Y=b.getElementsByTagName("OUTPUT");if(D==null||D.length==0){B.error="No ENVELOPE tag found in ArcXML response."}else{if(Y==null||Y.length==0){B.error="No OUTPUT tag found in ArcXML response."}else{var V=this.parseAttributes(D[0]);var W=this.parseAttributes(Y[0]);if(typeof W.type=="string"){B.image={envelope:V,output:{type:W.type,data:this.getChildValue(Y[0])}}}else{B.image={envelope:V,output:W}}}}}else{if(R=="FEATURES"){var J=S[0].getElementsByTagName("FEATURES");var Q=J[0].getElementsByTagName("FEATURECOUNT");B.features.featurecount=Q[0].getAttribute("count");if(B.features.featurecount>0){var E=J[0].getElementsByTagName("ENVELOPE");B.features.envelope=this.parseAttributes(E[0],typeof (0));var Z=J[0].getElementsByTagName("FEATURE");for(var N=0;N<Z.length;N++){var I=new OpenLayers.Feature.Vector();var T=Z[N].getElementsByTagName("FIELD");for(var G=0;G<T.length;G++){var H=T[G].getAttribute("name");var L=T[G].getAttribute("value");I.attributes[H]=L}var U=Z[N].getElementsByTagName("POLYGON");if(U.length>0){var K=U[0].getElementsByTagName("RING");var F=[];for(var P=0;P<K.length;P++){var a=[];a.push(this.parsePointGeometry(K[P]));var M=K[P].getElementsByTagName("HOLE");for(var C=0;C<M.length;C++){a.push(this.parsePointGeometry(M[C]))}M=null;F.push(new OpenLayers.Geometry.Polygon(a));a=null}K=null;if(F.length==1){I.geometry=F[0]}else{I.geometry=new OpenLayers.Geometry.MultiPolygon(F)}}B.features.feature.push(I)}}}else{B.error="Unidentified response type."}}}return B},parseAttributes:function(E,D){var C={};for(var B=0;B<E.attributes.length;B++){if(D=="number"){C[E.attributes[B].nodeName]=parseFloat(E.attributes[B].nodeValue)}else{C[E.attributes[B].nodeName]=E.attributes[B].nodeValue}}return C},parsePointGeometry:function(E){var C=[];var F=E.getElementsByTagName("COORDS");if(F.length>0){var G=this.getChildValue(F[0]);G=G.split(/;/);for(var I=0;I<G.length;I++){var H=G[I].split(/ /);C.push(new OpenLayers.Geometry.Point(parseFloat(H[0]),parseFloat(H[1])))}F=null}else{var B=E.getElementsByTagName("POINT");if(B.length>0){for(var D=0;D<B.length;D++){C.push(new OpenLayers.Geometry.Point(parseFloat(B[D].getAttribute("x")),parseFloat(B[D].getAttribute("y"))))}}B=null}return new OpenLayers.Geometry.LinearRing(C)},CLASS_NAME:"OpenLayers.Format.ArcXML"});OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(C){var B={get_image:{properties:{background:null,draw:true,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:false},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:false,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]};return OpenLayers.Util.extend(this,B)},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"});OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(C){var B={image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""};return OpenLayers.Util.extend(this,B)},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"});OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:true,xy:true,initialize:function(B){this.regExes={trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)};OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(E){if(typeof E=="string"){E=OpenLayers.Format.XML.prototype.read.apply(this,[E])}var F=this.getElementsByTagNameNS(E.documentElement,this.gmlns,this.featureName);var D=[];for(var C=0;C<F.length;C++){var B=this.parseFeature(F[C]);if(B){D.push(B)}}return D},parseFeature:function(D){var E=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope","Box"];var J,G,K,C;for(var I=0;I<E.length;++I){J=E[I];G=this.getElementsByTagNameNS(D,this.gmlns,J);if(G.length>0){var C=this.parseGeometry[J.toLowerCase()];if(C){K=C.apply(this,[G[0]]);if(this.internalProjection&&this.externalProjection){K.transform(this.externalProjection,this.internalProjection)}}else{OpenLayers.Console.error(OpenLayers.i18n("unsupportedGeometryType",{geomType:J}))}break}}var H;if(this.extractAttributes){H=this.parseAttributes(D)}var L=new OpenLayers.Feature.Vector(K,H);L.gml={featureType:D.firstChild.nodeName.split(":")[1],featureNS:D.firstChild.namespaceURI,featureNSPrefix:D.firstChild.prefix};var B=D.firstChild;var F;while(B){if(B.nodeType==1){F=B.getAttribute("fid")||B.getAttribute("id");if(F){break}}B=B.nextSibling}L.fid=F;return L},parseGeometry:{point:function(E){var C,B;var F=[];var C=this.getElementsByTagNameNS(E,this.gmlns,"pos");if(C.length>0){B=C[0].firstChild.nodeValue;B=B.replace(this.regExes.trimSpace,"");F=B.split(this.regExes.splitSpace)}if(F.length==0){C=this.getElementsByTagNameNS(E,this.gmlns,"coordinates");if(C.length>0){B=C[0].firstChild.nodeValue;B=B.replace(this.regExes.removeSpace,"");F=B.split(",")}}if(F.length==0){C=this.getElementsByTagNameNS(E,this.gmlns,"coord");if(C.length>0){var G=this.getElementsByTagNameNS(C[0],this.gmlns,"X");var D=this.getElementsByTagNameNS(C[0],this.gmlns,"Y");if(G.length>0&&D.length>0){F=[G[0].firstChild.nodeValue,D[0].firstChild.nodeValue]}}}if(F.length==2){F[2]=null}if(this.xy){return new OpenLayers.Geometry.Point(F[0],F[1],F[2])}else{return new OpenLayers.Geometry.Point(F[1],F[0],F[2])}},multipoint:function(F){var C=this.getElementsByTagNameNS(F,this.gmlns,"Point");var E=[];if(C.length>0){var B;for(var D=0;D<C.length;++D){B=this.parseGeometry.point.apply(this,[C[D]]);if(B){E.push(B)}}}return new OpenLayers.Geometry.MultiPoint(E)},linestring:function(D,F){var E,C;var M=[];var N=[];E=this.getElementsByTagNameNS(D,this.gmlns,"posList");if(E.length>0){C=this.getChildValue(E[0]);C=C.replace(this.regExes.trimSpace,"");M=C.split(this.regExes.splitSpace);var I=parseInt(E[0].getAttribute("dimension"));var G,L,K,J;for(var H=0;H<M.length/I;++H){G=H*I;L=M[G];K=M[G+1];J=(I==2)?null:M[G+2];if(this.xy){N.push(new OpenLayers.Geometry.Point(L,K,J))}else{N.push(new OpenLayers.Geometry.Point(K,L,J))}}}if(M.length==0){E=this.getElementsByTagNameNS(D,this.gmlns,"coordinates");if(E.length>0){C=this.getChildValue(E[0]);C=C.replace(this.regExes.trimSpace,"");C=C.replace(this.regExes.trimComma,",");var B=C.split(this.regExes.splitSpace);for(var H=0;H<B.length;++H){M=B[H].split(",");if(M.length==2){M[2]=null}if(this.xy){N.push(new OpenLayers.Geometry.Point(M[0],M[1],M[2]))}else{N.push(new OpenLayers.Geometry.Point(M[1],M[0],M[2]))}}}}var O=null;if(N.length!=0){if(F){O=new OpenLayers.Geometry.LinearRing(N)}else{O=new OpenLayers.Geometry.LineString(N)}}return O},multilinestring:function(F){var C=this.getElementsByTagNameNS(F,this.gmlns,"LineString");var E=[];if(C.length>0){var B;for(var D=0;D<C.length;++D){B=this.parseGeometry.linestring.apply(this,[C[D]]);if(B){E.push(B)}}}return new OpenLayers.Geometry.MultiLineString(E)},polygon:function(F){var C=this.getElementsByTagNameNS(F,this.gmlns,"LinearRing");var E=[];if(C.length>0){var B;for(var D=0;D<C.length;++D){B=this.parseGeometry.linestring.apply(this,[C[D],true]);if(B){E.push(B)}}}return new OpenLayers.Geometry.Polygon(E)},multipolygon:function(F){var B=this.getElementsByTagNameNS(F,this.gmlns,"Polygon");var E=[];if(B.length>0){var D;for(var C=0;C<B.length;++C){D=this.parseGeometry.polygon.apply(this,[B[C]]);if(D){E.push(D)}}}return new OpenLayers.Geometry.MultiPolygon(E)},envelope:function(C){var F=[];var B;var G;var K=this.getElementsByTagNameNS(C,this.gmlns,"lowerCorner");if(K.length>0){var I=[];if(K.length>0){B=K[0].firstChild.nodeValue;B=B.replace(this.regExes.trimSpace,"");I=B.split(this.regExes.splitSpace)}if(I.length==2){I[2]=null}if(this.xy){var E=new OpenLayers.Geometry.Point(I[0],I[1],I[2])}else{var E=new OpenLayers.Geometry.Point(I[1],I[0],I[2])}}var H=this.getElementsByTagNameNS(C,this.gmlns,"upperCorner");if(H.length>0){var I=[];if(H.length>0){B=H[0].firstChild.nodeValue;B=B.replace(this.regExes.trimSpace,"");I=B.split(this.regExes.splitSpace)}if(I.length==2){I[2]=null}if(this.xy){var J=new OpenLayers.Geometry.Point(I[0],I[1],I[2])}else{var J=new OpenLayers.Geometry.Point(I[1],I[0],I[2])}}if(E&&J){F.push(new OpenLayers.Geometry.Point(E.x,E.y));F.push(new OpenLayers.Geometry.Point(J.x,E.y));F.push(new OpenLayers.Geometry.Point(J.x,J.y));F.push(new OpenLayers.Geometry.Point(E.x,J.y));F.push(new OpenLayers.Geometry.Point(E.x,E.y));var D=new OpenLayers.Geometry.LinearRing(F);G=new OpenLayers.Geometry.Polygon([D])}return G}},parseAttributes:function(F){var G={};var B=F.firstChild;var E,H,D,K,J,C,I;while(B){if(B.nodeType==1){E=B.childNodes;for(H=0;H<E.length;++H){D=E[H];if(D.nodeType==1){K=D.childNodes;if(K.length==1){J=K[0];if(J.nodeType==3||J.nodeType==4){C=(D.prefix)?D.nodeName.split(":")[1]:D.nodeName;I=J.nodeValue.replace(this.regExes.trimSpace,"");G[C]=I}}else{G[D.nodeName.split(":").pop()]=null}}}break}B=B.nextSibling}return G},write:function(D){if(!(D instanceof Array)){D=[D]}var C=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName);for(var B=0;B<D.length;B++){C.appendChild(this.createFeatureXML(D[B]))}return OpenLayers.Format.XML.prototype.write.apply(this,[C])},createFeatureXML:function(K){var I=K.geometry;var F=this.buildGeometryNode(I);var J=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);J.appendChild(F);var B=this.createElementNS(this.gmlns,"gml:"+this.featureName);var L=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);var D=K.fid||K.id;L.setAttribute("fid",D);L.appendChild(J);for(var H in K.attributes){var G=this.createTextNode(K.attributes[H]);var E=H.substring(H.lastIndexOf(":")+1);var C=this.createElementNS(this.featureNS,this.featurePrefix+":"+E);C.appendChild(G);L.appendChild(C)}B.appendChild(L);return B},buildGeometryNode:function(E){if(this.externalProjection&&this.internalProjection){E=E.clone();E.transform(this.internalProjection,this.externalProjection)}var D=E.CLASS_NAME;var C=D.substring(D.lastIndexOf(".")+1);var B=this.buildGeometry[C.toLowerCase()];return B.apply(this,[E])},buildGeometry:{point:function(C){var B=this.createElementNS(this.gmlns,"gml:Point");B.appendChild(this.buildCoordinatesNode(C));return B},multipoint:function(G){var E=this.createElementNS(this.gmlns,"gml:MultiPoint");var D=G.components;var C,F;for(var B=0;B<D.length;B++){C=this.createElementNS(this.gmlns,"gml:pointMember");F=this.buildGeometry.point.apply(this,[D[B]]);C.appendChild(F);E.appendChild(C)}return E},linestring:function(C){var B=this.createElementNS(this.gmlns,"gml:LineString");B.appendChild(this.buildCoordinatesNode(C));return B},multilinestring:function(G){var E=this.createElementNS(this.gmlns,"gml:MultiLineString");var B=G.components;var D,F;for(var C=0;C<B.length;++C){D=this.createElementNS(this.gmlns,"gml:lineStringMember");F=this.buildGeometry.linestring.apply(this,[B[C]]);D.appendChild(F);E.appendChild(D)}return E},linearring:function(C){var B=this.createElementNS(this.gmlns,"gml:LinearRing");B.appendChild(this.buildCoordinatesNode(C));return B},polygon:function(H){var E=this.createElementNS(this.gmlns,"gml:Polygon");var G=H.components;var D,F,C;for(var B=0;B<G.length;++B){C=(B==0)?"outerBoundaryIs":"innerBoundaryIs";D=this.createElementNS(this.gmlns,"gml:"+C);F=this.buildGeometry.linearring.apply(this,[G[B]]);D.appendChild(F);E.appendChild(D)}return E},multipolygon:function(G){var E=this.createElementNS(this.gmlns,"gml:MultiPolygon");var B=G.components;var F,C;for(var D=0;D<B.length;++D){F=this.createElementNS(this.gmlns,"gml:polygonMember");C=this.buildGeometry.polygon.apply(this,[B[D]]);F.appendChild(C);E.appendChild(F)}return E},bounds:function(C){var B=this.createElementNS(this.gmlns,"gml:Box");B.appendChild(this.buildCoordinatesNode(C));return B}},buildCoordinatesNode:function(G){var B=this.createElementNS(this.gmlns,"gml:coordinates");B.setAttribute("decimal",".");B.setAttribute("cs",",");B.setAttribute("ts"," ");var F=[];if(G instanceof OpenLayers.Bounds){F.push(G.left+","+G.bottom);F.push(G.right+","+G.top)}else{var D=(G.components)?G.components:[G];for(var C=0;C<D.length;C++){F.push(D[C].x+","+D[C].y)}}var E=this.createTextNode(F.join(" "));B.appendChild(E);return B},CLASS_NAME:"OpenLayers.Format.GML"});OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{initialize:function(B){OpenLayers.Format.JSON.prototype.initialize.apply(this,[B])},read:function(J,H,B){H=(H)?H:"FeatureCollection";var E=null;var D=null;if(typeof J=="string"){D=OpenLayers.Format.JSON.prototype.read.apply(this,[J,B])}else{D=J}if(!D){OpenLayers.Console.error("Bad JSON: "+J)}else{if(typeof (D.type)!="string"){OpenLayers.Console.error("Bad GeoJSON - no type: "+J)}else{if(this.isValidType(D,H)){switch(H){case"Geometry":try{E=this.parseGeometry(D)}catch(C){OpenLayers.Console.error(C)}break;case"Feature":try{E=this.parseFeature(D);E.type="Feature"}catch(C){OpenLayers.Console.error(C)}break;case"FeatureCollection":E=[];switch(D.type){case"Feature":try{E.push(this.parseFeature(D))}catch(C){E=null;OpenLayers.Console.error(C)}break;case"FeatureCollection":for(var F=0,G=D.features.length;F<G;++F){try{E.push(this.parseFeature(D.features[F]))}catch(C){E=null;OpenLayers.Console.error(C)}}break;default:try{var I=this.parseGeometry(D);E.push(new OpenLayers.Feature.Vector(I))}catch(C){E=null;OpenLayers.Console.error(C)}}break}}}}return E},isValidType:function(D,B){var C=false;switch(B){case"Geometry":if(OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],D.type)==-1){OpenLayers.Console.error("Unsupported geometry type: "+D.type)}else{C=true}break;case"FeatureCollection":C=true;break;default:if(D.type==B){C=true}else{OpenLayers.Console.error("Cannot convert types from "+D.type+" to "+B)}}return C},parseFeature:function(E){var C,G,B,F;B=(E.properties)?E.properties:{};F=(E.geometry&&E.geometry.bbox)||E.bbox;try{G=this.parseGeometry(E.geometry)}catch(D){throw D}C=new OpenLayers.Feature.Vector(G,B);if(F){C.bounds=OpenLayers.Bounds.fromArray(F)}if(E.id){C.fid=E.id}return C},parseGeometry:function(F){if(F==null){return null}var H,G=false;if(F.type=="GeometryCollection"){if(!(F.geometries instanceof Array)){throw"GeometryCollection must have geometries array: "+F}var C=F.geometries.length;var E=new Array(C);for(var B=0;B<C;++B){E[B]=this.parseGeometry.apply(this,[F.geometries[B]])}H=new OpenLayers.Geometry.Collection(E);G=true}else{if(!(F.coordinates instanceof Array)){throw"Geometry must have coordinates array: "+F}if(!this.parseCoords[F.type.toLowerCase()]){throw"Unsupported geometry type: "+F.type}try{H=this.parseCoords[F.type.toLowerCase()].apply(this,[F.coordinates])}catch(D){throw D}}if(this.internalProjection&&this.externalProjection&&!G){H.transform(this.externalProjection,this.internalProjection)}return H},parseCoords:{point:function(B){if(B.length!=2){throw"Only 2D points are supported: "+B}return new OpenLayers.Geometry.Point(B[0],B[1])},multipoint:function(G){var D=[];var F=null;for(var C=0,B=G.length;C<B;++C){try{F=this.parseCoords.point.apply(this,[G[C]])}catch(E){throw E}D.push(F)}return new OpenLayers.Geometry.MultiPoint(D)},linestring:function(G){var D=[];var F=null;for(var C=0,B=G.length;C<B;++C){try{F=this.parseCoords.point.apply(this,[G[C]])}catch(E){throw E}D.push(F)}return new OpenLayers.Geometry.LineString(D)},multilinestring:function(G){var D=[];var C=null;for(var E=0,B=G.length;E<B;++E){try{C=this.parseCoords.linestring.apply(this,[G[E]])}catch(F){throw F}D.push(C)}return new OpenLayers.Geometry.MultiLineString(D)},polygon:function(H){var G=[];var F,C;for(var D=0,B=H.length;D<B;++D){try{C=this.parseCoords.linestring.apply(this,[H[D]])}catch(E){throw E}F=new OpenLayers.Geometry.LinearRing(C.components);G.push(F)}return new OpenLayers.Geometry.Polygon(G)},multipolygon:function(G){var C=[];var F=null;for(var D=0,B=G.length;D<B;++D){try{F=this.parseCoords.polygon.apply(this,[G[D]])}catch(E){throw E}C.push(F)}return new OpenLayers.Geometry.MultiPolygon(C)},box:function(B){if(B.length!=2){throw"GeoJSON box coordinates must have 2 elements"}return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(B[0][0],B[0][1]),new OpenLayers.Geometry.Point(B[1][0],B[0][1]),new OpenLayers.Geometry.Point(B[1][0],B[1][1]),new OpenLayers.Geometry.Point(B[0][0],B[1][1]),new OpenLayers.Geometry.Point(B[0][0],B[0][1])])])}},write:function(F,E){var B={type:null};if(F instanceof Array){B.type="FeatureCollection";var H=F.length;B.features=new Array(H);for(var D=0;D<H;++D){var C=F[D];if(!C instanceof OpenLayers.Feature.Vector){var G="FeatureCollection only supports collections of features: "+C;throw G}B.features[D]=this.extract.feature.apply(this,[C])}}else{if(F.CLASS_NAME.indexOf("OpenLayers.Geometry")==0){B=this.extract.geometry.apply(this,[F])}else{if(F instanceof OpenLayers.Feature.Vector){B=this.extract.feature.apply(this,[F]);if(F.layer&&F.layer.projection){B.crs=this.createCRSObject(F)}}}}return OpenLayers.Format.JSON.prototype.write.apply(this,[B,E])},createCRSObject:function(C){var D=C.layer.projection.toString();var B={};if(D.match(/epsg:/i)){var E=parseInt(D.substring(D.indexOf(":")+1));if(E==4326){B={type:"OGC",properties:{urn:"urn:ogc:def:crs:OGC:1.3:CRS84"}}}else{B={type:"EPSG",properties:{code:E}}}}return B},extract:{feature:function(C){var B=this.extract.geometry.apply(this,[C.geometry]);return{type:"Feature",id:C.fid==null?C.id:C.fid,properties:C.attributes,geometry:B}},geometry:function(E){if(E==null){return null}if(this.internalProjection&&this.externalProjection){E=E.clone();E.transform(this.internalProjection,this.externalProjection)}var B=E.CLASS_NAME.split(".")[2];var D=this.extract[B.toLowerCase()].apply(this,[E]);var C;if(B=="Collection"){C={type:"GeometryCollection",geometries:D}}else{C={type:B,coordinates:D}}return C},point:function(B){return[B.x,B.y]},multipoint:function(D){var E=[];for(var C=0,B=D.components.length;C<B;++C){E.push(this.extract.point.apply(this,[D.components[C]]))}return E},linestring:function(C){var E=[];for(var D=0,B=C.components.length;D<B;++D){E.push(this.extract.point.apply(this,[C.components[D]]))}return E},multilinestring:function(D){var E=[];for(var C=0,B=D.components.length;C<B;++C){E.push(this.extract.linestring.apply(this,[D.components[C]]))}return E},polygon:function(D){var E=[];for(var C=0,B=D.components.length;C<B;++C){E.push(this.extract.linestring.apply(this,[D.components[C]]))}return E},multipolygon:function(E){var D=[];for(var C=0,B=E.components.length;C<B;++C){D.push(this.extract.polygon.apply(this,[E.components[C]]))}return D},collection:function(D){var B=D.components.length;var E=new Array(B);for(var C=0;C<B;++C){E[C]=this.extract.geometry.apply(this,[D.components[C]])}return E}},CLASS_NAME:"OpenLayers.Format.GeoJSON"});OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(D){var C=new OpenLayers.Format.ArcXML();var B=C.read(D);return B.features.feature}});if(!OpenLayers.Format.GML){OpenLayers.Format.GML={}}OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:true,srsName:null,xy:true,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);this.setGeometryTypes();if(B&&B.featureNS){this.setNamespace("feature",B.featureNS)}this.singleFeatureType=!B||(typeof B.featureType==="string")},read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}if(F&&F.nodeType==9){F=F.documentElement}var D=[];this.readNode(F,{features:D});if(D.length==0){var E=this.getElementsByTagNameNS(F,this.namespaces.gml,"featureMember");if(E.length){for(var C=0,B=E.length;C<B;++C){this.readNode(E[C],{features:D})}}else{var E=this.getElementsByTagNameNS(F,this.namespaces.gml,"featureMembers");if(E.length){this.readNode(E[0],{features:D})}}}return D},readers:{gml:{featureMember:function(B,C){this.readChildNodes(B,C)},featureMembers:function(B,C){this.readChildNodes(B,C)},name:function(B,C){C.name=this.getChildValue(B)},boundedBy:function(C,D){var B={};this.readChildNodes(C,B);if(B.components&&B.components.length>0){D.bounds=B.components[0]}},Point:function(C,B){var D={points:[]};this.readChildNodes(C,D);if(!B.components){B.components=[]}B.components.push(D.points[0])},coordinates:function(F,H){var I=this.getChildValue(F).replace(this.regExes.trimSpace,"");I=I.replace(this.regExes.trimComma,",");var B=I.split(this.regExes.splitSpace);var G;var E=B.length;var D=new Array(E);for(var C=0;C<E;++C){G=B[C].split(",");if(this.xy){D[C]=new OpenLayers.Geometry.Point(G[0],G[1],G[2])}else{D[C]=new OpenLayers.Geometry.Point(G[1],G[0],G[2])}}H.points=D},coord:function(B,C){var D={};this.readChildNodes(B,D);if(!C.points){C.points=[]}C.points.push(new OpenLayers.Geometry.Point(D.x,D.y,D.z))},X:function(B,C){C.x=this.getChildValue(B)},Y:function(B,C){C.y=this.getChildValue(B)},Z:function(B,C){C.z=this.getChildValue(B)},MultiPoint:function(C,B){var D={components:[]};this.readChildNodes(C,D);B.components=[new OpenLayers.Geometry.MultiPoint(D.components)]},pointMember:function(B,C){this.readChildNodes(B,C)},LineString:function(C,B){var D={};this.readChildNodes(C,D);if(!B.components){B.components=[]}B.components.push(new OpenLayers.Geometry.LineString(D.points))},MultiLineString:function(C,B){var D={components:[]};this.readChildNodes(C,D);B.components=[new OpenLayers.Geometry.MultiLineString(D.components)]},lineStringMember:function(B,C){this.readChildNodes(B,C)},Polygon:function(C,B){var D={outer:null,inner:[]};this.readChildNodes(C,D);D.inner.unshift(D.outer);if(!B.components){B.components=[]}B.components.push(new OpenLayers.Geometry.Polygon(D.inner))},LinearRing:function(C,D){var B={};this.readChildNodes(C,B);D.components=[new OpenLayers.Geometry.LinearRing(B.points)]},MultiPolygon:function(C,B){var D={components:[]};this.readChildNodes(C,D);B.components=[new OpenLayers.Geometry.MultiPolygon(D.components)]},polygonMember:function(B,C){this.readChildNodes(B,C)},GeometryCollection:function(C,B){var D={components:[]};this.readChildNodes(C,D);B.components=[new OpenLayers.Geometry.Collection(D.components)]},geometryMember:function(B,C){this.readChildNodes(B,C)}},feature:{"*":function(D,E){var B;var C=D.localName||D.nodeName.split(":").pop();if(!this.singleFeatureType&&(OpenLayers.Util.indexOf(this.featureType,C)!=-1)){B="_typeName"}else{if(C==this.featureType){B="_typeName"}else{if(D.childNodes.length==0||(D.childNodes.length==1&&D.firstChild.nodeType==3)){if(this.extractAttributes){B="_attribute"}}else{B="_geometry"}}}if(B){this.readers.feature[B].apply(this,[D,E])}},_typeName:function(D,E){var B={components:[],attributes:{}};this.readChildNodes(D,B);if(B.name){B.attributes.name=B.name}var C=new OpenLayers.Feature.Vector(B.components[0],B.attributes);if(!this.singleFeatureType){C.type=D.nodeName.split(":").pop();C.namespace=D.namespaceURI}var F=D.getAttribute("fid")||this.getAttributeNS(D,this.namespaces.gml,"id");if(F){C.fid=F}if(this.internalProjection&&this.externalProjection&&C.geometry){C.geometry.transform(this.externalProjection,this.internalProjection)}if(B.bounds){C.geometry.bounds=B.bounds}E.features.push(C)},_geometry:function(B,C){this.readChildNodes(B,C)},_attribute:function(C,E){var B=C.localName||C.nodeName.split(":").pop();var D=this.getChildValue(C);E.attributes[B]=D}},wfs:{FeatureCollection:function(B,C){this.readChildNodes(B,C)}}},write:function(D){var C;if(D instanceof Array){C="featureMembers"}else{C="featureMember"}var B=this.writeNode("gml:"+C,D);this.setAttributeNS(B,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{gml:{featureMember:function(B){var C=this.createElementNSPlus("gml:featureMember");this.writeNode("feature:_typeName",B,C);return C},MultiPoint:function(D){var C=this.createElementNSPlus("gml:MultiPoint");for(var B=0;B<D.components.length;++B){this.writeNode("pointMember",D.components[B],C)}return C},pointMember:function(C){var B=this.createElementNSPlus("gml:pointMember");this.writeNode("Point",C,B);return B},MultiLineString:function(D){var C=this.createElementNSPlus("gml:MultiLineString");for(var B=0;B<D.components.length;++B){this.writeNode("lineStringMember",D.components[B],C)}return C},lineStringMember:function(C){var B=this.createElementNSPlus("gml:lineStringMember");this.writeNode("LineString",C,B);return B},MultiPolygon:function(D){var C=this.createElementNSPlus("gml:MultiPolygon");for(var B=0;B<D.components.length;++B){this.writeNode("polygonMember",D.components[B],C)}return C},polygonMember:function(C){var B=this.createElementNSPlus("gml:polygonMember");this.writeNode("Polygon",C,B);return B},GeometryCollection:function(E){var D=this.createElementNSPlus("gml:GeometryCollection");for(var C=0,B=E.components.length;C<B;++C){this.writeNode("geometryMember",E.components[C],D)}return D},geometryMember:function(C){var B=this.createElementNSPlus("gml:geometryMember");var D=this.writeNode("feature:_geometry",C);B.appendChild(D.firstChild);return B}},feature:{_typeName:function(C){var D=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:C.fid}});if(C.geometry){this.writeNode("feature:_geometry",C.geometry,D)}for(var B in C.attributes){var E=C.attributes[B];if(E!=null){this.writeNode("feature:_attribute",{name:B,value:E},D)}}return D},_geometry:function(D){if(this.externalProjection&&this.internalProjection){D=D.clone().transform(this.internalProjection,this.externalProjection)}var C=this.createElementNSPlus("feature:"+this.geometryName);var B=this.geometryTypes[D.CLASS_NAME];var E=this.writeNode("gml:"+B,D,C);if(this.srsName){E.setAttribute("srsName",this.srsName)}return C},_attribute:function(B){return this.createElementNSPlus("feature:"+B.name,{value:B.value})}},wfs:{FeatureCollection:function(D){var E=this.createElementNSPlus("wfs:FeatureCollection");for(var C=0,B=D.length;C<B;++C){this.writeNode("gml:featureMember",D[C],E)}return E}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"});OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(B,C){OpenLayers.Format.GML.prototype.initialize.apply(this,[B]);this.layer=C;if(this.layer.featureNS){this.featureNS=this.layer.featureNS}if(this.layer.options.geometry_column){this.geometryName=this.layer.options.geometry_column}if(this.layer.options.typename){this.featureName=this.layer.options.typename}},write:function(C){var D=this.createElementNS(this.wfsns,"wfs:Transaction");D.setAttribute("version","1.0.0");D.setAttribute("service","WFS");for(var B=0;B<C.length;B++){switch(C[B].state){case OpenLayers.State.INSERT:D.appendChild(this.insert(C[B]));break;case OpenLayers.State.UPDATE:D.appendChild(this.update(C[B]));break;case OpenLayers.State.DELETE:D.appendChild(this.remove(C[B]));break}}return OpenLayers.Format.XML.prototype.write.apply(this,[D])},createFeatureXML:function(G){var D=this.buildGeometryNode(G.geometry);var H=this.createElementNS(this.featureNS,"feature:"+this.geometryName);H.appendChild(D);var C=this.createElementNS(this.featureNS,"feature:"+this.featureName);C.appendChild(H);for(var B in G.attributes){var I=this.createTextNode(G.attributes[B]);var E=B;if(B.search(":")!=-1){E=B.split(":")[1]}var F=this.createElementNS(this.featureNS,"feature:"+E);F.appendChild(I);C.appendChild(F)}return C},insert:function(C){var B=this.createElementNS(this.wfsns,"wfs:Insert");B.appendChild(this.createFeatureXML(C));return B},update:function(K){if(!K.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"))}var G=this.createElementNS(this.wfsns,"wfs:Update");G.setAttribute("typeName",this.featurePrefix+":"+this.featureName);G.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var I=this.createElementNS(this.wfsns,"wfs:Property");var B=this.createElementNS(this.wfsns,"wfs:Name");var D=this.createTextNode(this.geometryName);B.appendChild(D);I.appendChild(B);var J=this.createElementNS(this.wfsns,"wfs:Value");var E=this.buildGeometryNode(K.geometry);if(K.layer){E.setAttribute("srsName",K.layer.projection.getCode())}J.appendChild(E);I.appendChild(J);G.appendChild(I);for(var F in K.attributes){I=this.createElementNS(this.wfsns,"wfs:Property");B=this.createElementNS(this.wfsns,"wfs:Name");B.appendChild(this.createTextNode(F));I.appendChild(B);J=this.createElementNS(this.wfsns,"wfs:Value");J.appendChild(this.createTextNode(K.attributes[F]));I.appendChild(J);G.appendChild(I)}var H=this.createElementNS(this.ogcns,"ogc:Filter");var C=this.createElementNS(this.ogcns,"ogc:FeatureId");C.setAttribute("fid",K.fid);H.appendChild(C);G.appendChild(H);return G},remove:function(C){if(!C.fid){OpenLayers.Console.userError(OpenLayers.i18n("noFID"));return false}var B=this.createElementNS(this.wfsns,"wfs:Delete");B.setAttribute("typeName",this.featurePrefix+":"+this.featureName);B.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var D=this.createElementNS(this.ogcns,"ogc:Filter");var E=this.createElementNS(this.ogcns,"ogc:FeatureId");E.setAttribute("fid",C.fid);D.appendChild(E);B.appendChild(D);return B},destroy:function(){this.layer=null},CLASS_NAME:"OpenLayers.Format.WFS"});OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},tileSize:null,featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:true,name:"ArcIMS",isBaseLayer:true,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:true,async:true,name:"ArcIMS"},initialize:function(D,C,B){this.tileSize=new OpenLayers.Size(512,512);this.params=OpenLayers.Util.applyDefaults({ServiceName:B.serviceName},this.DEFAULT_PARAMS);this.options=OpenLayers.Util.applyDefaults(B,this.DEFAULT_OPTIONS);OpenLayers.Layer.Grid.prototype.initialize.apply(this,[D,C,this.params,B]);if(this.transparent){if(!this.isBaseLayer){this.isBaseLayer=false}if(this.format=="image/jpeg"){this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}if(this.options.layers===null){this.options.layers=[]}},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},getURL:function(E){var B="";E=this.adjustBounds(E);var D=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:E.toArray(),tileSize:this.tileSize}));var C=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:D.write(),async:false});if(C!=null){var G=C.responseXML;if(!G||!G.documentElement){G=C.responseText}var F=new OpenLayers.Format.ArcXML();var H=F.read(G);B=this.getUrlOrImage(H.image.output)}return B},getURLasync:function(D,B,F,E){D=this.adjustBounds(D);var C=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:D.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:true,data:C.write(),callback:function(G){var I=G.responseXML;if(!I||!I.documentElement){I=G.responseText}var H=new OpenLayers.Format.ArcXML();var J=H.read(I);B[F]=this.getUrlOrImage(J.image.output);E.apply(B)},scope:this})},getUrlOrImage:function(B){var C="";if(B.url){C=B.url}else{if(B.data){C="data:image/"+B.type+";base64,"+B.data}}return C},setLayerQuery:function(D,B){for(var C=0;C<this.options.layers.length;C++){if(D==this.options.layers[C].id){this.options.layers[C].query=B;return }}this.options.layers.push({id:D,visible:true,query:B})},getFeatureInfo:function(I,G,L){var C=L.buffer||1;var J=L.callback||function(){};var K=L.scope||window;var B={};OpenLayers.Util.extend(B,this.options);B.requesttype="feature";if(I instanceof OpenLayers.LonLat){B.polygon=null;B.envelope=[I.lon-C,I.lat-C,I.lon+C,I.lat+C]}else{if(I instanceof OpenLayers.Geometry.Polygon){B.envelope=null;B.polygon=I}}var F=new OpenLayers.Format.ArcXML(B);OpenLayers.Util.extend(F.request.get_feature,L);F.request.get_feature.layer=G.id;if(typeof G.query.accuracy=="number"){F.request.get_feature.query.accuracy=G.query.accuracy}else{var H=this.map.getCenter();var E=this.map.getViewPortPxFromLonLat(H);E.x++;var D=this.map.getLonLatFromPixel(E);F.request.get_feature.query.accuracy=D.lon-H.lon}F.request.get_feature.query.where=G.query.where;F.request.get_feature.query.spatialfilter.relation="area_intersection";OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:F.write(),callback:function(N){var M=F.parseResponse(N.responseText);if(!F.iserror()){J.call(K,M.features)}else{J.call(K,null)}}})},addTile:function(C,B){return new OpenLayers.Tile.Image(this,B,C,null,this.tileSize)},CLASS_NAME:"OpenLayers.Layer.ArcIMS"});OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(B){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[B])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(C,B){var D={};this.readChildNodes(C,D);B.outer=D.components[0]},innerBoundaryIs:function(C,B){var D={};this.readChildNodes(C,D);B.inner.push(D.components[0])},Box:function(E,C){var F={};this.readChildNodes(E,F);if(!C.components){C.components=[]}var D=F.points[0];var B=F.points[1];C.components.push(new OpenLayers.Bounds(D.x,D.y,B.x,B.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(D){var C;if(D instanceof Array){C="wfs:FeatureCollection"}else{C="gml:featureMember"}var B=this.writeNode(C,D);this.setAttributeNS(B,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(C){var B=this.createElementNSPlus("gml:Point");this.writeNode("coordinates",[C],B);return B},coordinates:function(E){var D=E.length;var F=new Array(D);var B;for(var C=0;C<D;++C){B=E[C];if(this.xy){F[C]=B.x+","+B.y}else{F[C]=B.y+","+B.x}if(B.z!=undefined){F[C]+=","+B.z}}return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:(D==1)?F[0]:F.join(" ")})},LineString:function(C){var B=this.createElementNSPlus("gml:LineString");this.writeNode("coordinates",C.components,B);return B},Polygon:function(D){var C=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",D.components[0],C);for(var B=1;B<D.components.length;++B){this.writeNode("innerBoundaryIs",D.components[B],C)}return C},outerBoundaryIs:function(B){var C=this.createElementNSPlus("gml:outerBoundaryIs");this.writeNode("LinearRing",B,C);return C},innerBoundaryIs:function(B){var C=this.createElementNSPlus("gml:innerBoundaryIs");this.writeNode("LinearRing",B,C);return C},LinearRing:function(B){var C=this.createElementNSPlus("gml:LinearRing");this.writeNode("coordinates",B.components,C);return C},Box:function(C){var B=this.createElementNSPlus("gml:Box");this.writeNode("coordinates",[{x:C.left,y:C.bottom},{x:C.right,y:C.top}],B);if(this.srsName){B.setAttribute("srsName",this.srsName)}return B}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},CLASS_NAME:"OpenLayers.Format.GML.v2"});OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:false,multiCurve:true,surface:false,multiSurface:true,initialize:function(B){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[B])},readers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(B,C){this.readChildNodes(B,C)},Curve:function(C,B){var D={points:[]};this.readChildNodes(C,D);if(!B.components){B.components=[]}B.components.push(new OpenLayers.Geometry.LineString(D.points))},segments:function(B,C){this.readChildNodes(B,C)},LineStringSegment:function(C,B){var D={};this.readChildNodes(C,D);if(D.points){Array.prototype.push.apply(B.points,D.points)}},pos:function(C,E){var F=this.getChildValue(C).replace(this.regExes.trimSpace,"");var D=F.split(this.regExes.splitSpace);var B;if(this.xy){B=new OpenLayers.Geometry.Point(D[0],D[1],D[2])}else{B=new OpenLayers.Geometry.Point(D[1],D[0],D[2])}E.points=[B]},posList:function(B,E){var I=this.getChildValue(B).replace(this.regExes.trimSpace,"");var L=I.split(this.regExes.splitSpace);var F=parseInt(B.getAttribute("dimension"))||2;var C,M,K,H;var J=L.length/F;var N=new Array(J);for(var D=0,G=L.length;D<G;D+=F){M=L[D];K=L[D+1];H=(F==2)?undefined:L[D+2];if(this.xy){N[D/F]=new OpenLayers.Geometry.Point(M,K,H)}else{N[D/F]=new OpenLayers.Geometry.Point(K,M,H)}}E.points=N},Surface:function(B,C){this.readChildNodes(B,C)},patches:function(B,C){this.readChildNodes(B,C)},PolygonPatch:function(B,C){this.readers.gml.Polygon.apply(this,[B,C])},exterior:function(C,B){var D={};this.readChildNodes(C,D);B.outer=D.components[0]},interior:function(C,B){var D={};this.readChildNodes(C,D);B.inner.push(D.components[0])},MultiCurve:function(C,B){var D={components:[]};this.readChildNodes(C,D);if(D.components.length>0){B.components=[new OpenLayers.Geometry.MultiLineString(D.components)]}},curveMember:function(B,C){this.readChildNodes(B,C)},MultiSurface:function(C,B){var D={components:[]};this.readChildNodes(C,D);if(D.components.length>0){B.components=[new OpenLayers.Geometry.MultiPolygon(D.components)]}},surfaceMember:function(B,C){this.readChildNodes(B,C)},surfaceMembers:function(B,C){this.readChildNodes(B,C)},pointMembers:function(B,C){this.readChildNodes(B,C)},lineStringMembers:function(B,C){this.readChildNodes(B,C)},polygonMembers:function(B,C){this.readChildNodes(B,C)},geometryMembers:function(B,C){this.readChildNodes(B,C)},Envelope:function(E,C){var F={points:new Array(2)};this.readChildNodes(E,F);if(!C.components){C.components=[]}var D=F.points[0];var B=F.points[1];C.components.push(new OpenLayers.Bounds(D.x,D.y,B.x,B.y))},lowerCorner:function(C,B){var D={};this.readers.gml.pos.apply(this,[C,D]);B.points[0]=D.points[0]},upperCorner:function(C,B){var D={};this.readers.gml.pos.apply(this,[C,D]);B.points[1]=D.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(D){var C;if(D instanceof Array){C="featureMembers"}else{C="featureMember"}var B=this.writeNode("gml:"+C,D);this.setAttributeNS(B,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation);return OpenLayers.Format.XML.prototype.write.apply(this,[B])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(D){var E=this.createElementNSPlus("gml:featureMembers");for(var C=0,B=D.length;C<B;++C){this.writeNode("feature:_typeName",D[C],E)}return E},Point:function(C){var B=this.createElementNSPlus("gml:Point");this.writeNode("pos",C,B);return B},pos:function(B){var C=(this.xy)?(B.x+" "+B.y):(B.y+" "+B.x);return this.createElementNSPlus("gml:pos",{value:C})},LineString:function(C){var B=this.createElementNSPlus("gml:LineString");this.writeNode("posList",C.components,B);return B},Curve:function(C){var B=this.createElementNSPlus("gml:Curve");this.writeNode("segments",C,B);return B},segments:function(C){var B=this.createElementNSPlus("gml:segments");this.writeNode("LineStringSegment",C,B);return B},LineStringSegment:function(C){var B=this.createElementNSPlus("gml:LineStringSegment");this.writeNode("posList",C.components,B);return B},posList:function(E){var C=E.length;var F=new Array(C);var B;for(var D=0;D<C;++D){B=E[D];if(this.xy){F[D]=B.x+" "+B.y}else{F[D]=B.y+" "+B.x}}return this.createElementNSPlus("gml:posList",{value:F.join(" ")})},Surface:function(C){var B=this.createElementNSPlus("gml:Surface");this.writeNode("patches",C,B);return B},patches:function(C){var B=this.createElementNSPlus("gml:patches");this.writeNode("PolygonPatch",C,B);return B},PolygonPatch:function(E){var D=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",E.components[0],D);for(var C=1,B=E.components.length;C<B;++C){this.writeNode("interior",E.components[C],D)}return D},Polygon:function(E){var D=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",E.components[0],D);for(var C=1,B=E.components.length;C<B;++C){this.writeNode("interior",E.components[C],D)}return D},exterior:function(B){var C=this.createElementNSPlus("gml:exterior");this.writeNode("LinearRing",B,C);return C},interior:function(B){var C=this.createElementNSPlus("gml:interior");this.writeNode("LinearRing",B,C);return C},LinearRing:function(B){var C=this.createElementNSPlus("gml:LinearRing");this.writeNode("posList",B.components,C);return C},MultiCurve:function(E){var D=this.createElementNSPlus("gml:MultiCurve");for(var C=0,B=E.components.length;C<B;++C){this.writeNode("curveMember",E.components[C],D)}return D},curveMember:function(C){var B=this.createElementNSPlus("gml:curveMember");if(this.curve){this.writeNode("Curve",C,B)}else{this.writeNode("LineString",C,B)}return B},MultiSurface:function(E){var D=this.createElementNSPlus("gml:MultiSurface");for(var C=0,B=E.components.length;C<B;++C){this.writeNode("surfaceMember",E.components[C],D)}return D},surfaceMember:function(B){var C=this.createElementNSPlus("gml:surfaceMember");if(this.surface){this.writeNode("Surface",B,C)}else{this.writeNode("Polygon",B,C)}return C},Envelope:function(C){var B=this.createElementNSPlus("gml:Envelope");this.writeNode("lowerCorner",C,B);this.writeNode("upperCorner",C,B);if(this.srsName){B.setAttribute("srsName",this.srsName)}return B},lowerCorner:function(B){var C=(this.xy)?(B.left+" "+B.bottom):(B.bottom+" "+B.left);return this.createElementNSPlus("gml:lowerCorner",{value:C})},upperCorner:function(B){var C=(this.xy)?(B.right+" "+B.top):(B.top+" "+B.right);return this.createElementNSPlus("gml:upperCorner",{value:C})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":(this.curve===true)?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":(this.multiCurve===false)?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":(this.surface===true)?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":(this.multiSurface===false)?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"});OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(B){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[B])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(C,B);D.filters.push(B)},PropertyIsNotEqualTo:function(C,D){var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(C,B);D.filters.push(B)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(B){var C=this.createElementNSPlus("ogc:PropertyIsEqualTo");this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},PropertyIsNotEqualTo:function(B){var C=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},BBOX:function(B){var D=this.createElementNSPlus("ogc:BBOX");this.writeNode("PropertyName",B,D);var C=this.writeNode("gml:Box",B.value,D);if(B.projection){C.setAttribute("srsName",B.projection)}return D}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},writeSpatial:function(C,B){var D=this.createElementNSPlus("ogc:"+B);this.writeNode("PropertyName",C,D);var E;if(C.value instanceof OpenLayers.Geometry){E=this.writeNode("feature:_geometry",C.value).firstChild}else{E=this.writeNode("gml:Box",C.value)}if(C.projection){E.setAttribute("srsName",C.projection)}D.appendChild(E);return D},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"});OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(B){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[B])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(C,E){var D=C.getAttribute("matchCase");var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!(D==="false"||D==="0")});this.readChildNodes(C,B);E.filters.push(B)},PropertyIsNotEqualTo:function(C,E){var D=C.getAttribute("matchCase");var B=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!(D==="false"||D==="0")});this.readChildNodes(C,B);E.filters.push(B)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(B){var C=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:B.matchCase}});this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},PropertyIsNotEqualTo:function(B){var C=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",{attributes:{matchCase:B.matchCase}});this.writeNode("PropertyName",B,C);this.writeNode("Literal",B.value,C);return C},BBOX:function(B){var D=this.createElementNSPlus("ogc:BBOX");this.writeNode("PropertyName",B,D);var C=this.writeNode("gml:Envelope",B.value);if(B.projection){C.setAttribute("srsName",B.projection)}D.appendChild(C);return D}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(C,B){var D=this.createElementNSPlus("ogc:"+B);this.writeNode("PropertyName",C,D);var E;if(C.value instanceof OpenLayers.Geometry){E=this.writeNode("feature:_geometry",C.value).firstChild}else{E=this.writeNode("gml:Envelope",C.value)}if(C.projection){E.setAttribute("srsName",C.projection)}D.appendChild(E);return D},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"});OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,graphicName:"square"},initialize:function(B){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[B])},read:function(D,B){B=OpenLayers.Util.applyDefaults(B,this.options);var C={namedLayers:B.namedLayersAsArray===true?[]:{}};this.readChildNodes(D,C);return C},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(B,C){C.version=B.getAttribute("version");this.readChildNodes(B,C)},Name:function(B,C){C.name=this.getChildValue(B)},Title:function(B,C){C.title=this.getChildValue(B)},Abstract:function(B,C){C.description=this.getChildValue(B)},NamedLayer:function(E,F){var D={userStyles:[],namedStyles:[]};this.readChildNodes(E,D);for(var C=0,B=D.userStyles.length;C<B;++C){D.userStyles[C].layerName=D.name}if(F.namedLayers instanceof Array){F.namedLayers.push(D)}else{F.namedLayers[D.name]=D}},NamedStyle:function(C,B){B.namedStyles.push(this.getChildName(C.firstChild))},UserStyle:function(D,B){var E={defaultsPerSymbolizer:true,rules:[]};this.readChildNodes(D,E);var C=new OpenLayers.Style(this.defaultSymbolizer,E);B.userStyles.push(C)},IsDefault:function(C,B){if(this.getChildValue(C)=="1"){B.isDefault=true}},FeatureTypeStyle:function(C,B){var D={rules:[]};this.readChildNodes(C,D);B.rules=D.rules},Rule:function(B,D){var C=new OpenLayers.Rule();this.readChildNodes(B,C);D.rules.push(C)},ElseFilter:function(B,C){C.elseFilter=true},MinScaleDenominator:function(B,C){C.minScaleDenominator=parseFloat(this.getChildValue(B))},MaxScaleDenominator:function(B,C){C.maxScaleDenominator=parseFloat(this.getChildValue(B))},TextSymbolizer:function(C,D){var B=D.symbolizer.Text||{};this.readChildNodes(C,B);D.symbolizer.Text=B},Label:function(C,B){var E={};this.readChildNodes(C,E);if(E.property){B.label="${"+E.property+"}"}else{var D=this.readOgcExpression(C);if(D){B.label=D}}},Font:function(C,B){this.readChildNodes(C,B)},Halo:function(C,B){var D={};this.readChildNodes(C,D);B.haloRadius=D.haloRadius;B.haloColor=D.fillColor;B.haloOpacity=D.fillOpacity},Radius:function(D,C){var B=this.readOgcExpression(D);if(B!=null){C.haloRadius=B}},LineSymbolizer:function(C,D){var B=D.symbolizer.Line||{};this.readChildNodes(C,B);D.symbolizer.Line=B},PolygonSymbolizer:function(C,D){var B=D.symbolizer.Polygon||{};this.readChildNodes(C,B);D.symbolizer.Polygon=B},PointSymbolizer:function(C,D){var B=D.symbolizer.Point||{};this.readChildNodes(C,B);D.symbolizer.Point=B},Stroke:function(C,B){B.stroke=true;this.readChildNodes(C,B)},Fill:function(C,B){B.fill=true;this.readChildNodes(C,B)},CssParameter:function(D,C){var B=D.getAttribute("name");var F=this.cssMap[B];if(F){var E=this.readOgcExpression(D);if(E){C[F]=E}}},Graphic:function(F,E){E.graphic=true;var I={};this.readChildNodes(F,I);var D=["strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fillColor","fillOpacity","graphicName","rotation","graphicFormat"];var H,G;for(var C=0,B=D.length;C<B;++C){H=D[C];G=I[H];if(G!=undefined){E[H]=G}}if(I.opacity!=undefined){E.graphicOpacity=I.opacity}if(I.size!=undefined){E.pointRadius=I.size/2}if(I.href!=undefined){E.externalGraphic=I.href}if(I.rotation!=undefined){E.rotation=I.rotation}},ExternalGraphic:function(B,C){this.readChildNodes(B,C)},Mark:function(B,C){this.readChildNodes(B,C)},WellKnownName:function(B,C){C.graphicName=this.getChildValue(B)},Opacity:function(C,D){var B=this.readOgcExpression(C);if(B){D.opacity=B}},Size:function(C,D){var B=this.readOgcExpression(C);if(B){D.size=B}},Rotation:function(C,D){var B=this.readOgcExpression(C);if(B){D.rotation=B}},OnlineResource:function(B,C){C.href=this.getAttributeNS(B,this.namespaces.xlink,"href")},Format:function(B,C){C.graphicFormat=this.getChildValue(B)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(B){var C=null;for(var D in this.cssMap){if(this.cssMap[D]==B){C=D;break}}return C},getGraphicFormat:function(B){var E,D;for(var C in this.graphicFormats){if(this.graphicFormats[C].test(B)){E=C;break}}return E||this.defautlGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(B){return this.writers.sld.StyledLayerDescriptor.apply(this,[B])},writers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(F){var C=this.createElementNSPlus("StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});if(F.name){this.writeNode("Name",F.name,C)}if(F.title){this.writeNode("Title",F.title,C)}if(F.description){this.writeNode("Abstract",F.description,C)}if(F.namedLayers instanceof Array){for(var E=0,B=F.namedLayers.length;E<B;++E){this.writeNode("NamedLayer",F.namedLayers[E],C)}}else{for(var D in F.namedLayers){this.writeNode("NamedLayer",F.namedLayers[D],C)}}return C},Name:function(B){return this.createElementNSPlus("Name",{value:B})},Title:function(B){return this.createElementNSPlus("Title",{value:B})},Abstract:function(B){return this.createElementNSPlus("Abstract",{value:B})},NamedLayer:function(D){var E=this.createElementNSPlus("NamedLayer");this.writeNode("Name",D.name,E);if(D.namedStyles){for(var C=0,B=D.namedStyles.length;C<B;++C){this.writeNode("NamedStyle",D.namedStyles[C],E)}}if(D.userStyles){for(var C=0,B=D.userStyles.length;C<B;++C){this.writeNode("UserStyle",D.userStyles[C],E)}}return E},NamedStyle:function(B){var C=this.createElementNSPlus("NamedStyle");this.writeNode("Name",B,C);return C},UserStyle:function(B){var C=this.createElementNSPlus("UserStyle");if(B.name){this.writeNode("Name",B.name,C)}if(B.title){this.writeNode("Title",B.title,C)}if(B.description){this.writeNode("Abstract",B.description,C)}if(B.isDefault){this.writeNode("IsDefault",B.isDefault,C)}this.writeNode("FeatureTypeStyle",B,C);return C},IsDefault:function(B){return this.createElementNSPlus("IsDefault",{value:(B)?"1":"0"})},FeatureTypeStyle:function(D){var E=this.createElementNSPlus("FeatureTypeStyle");for(var C=0,B=D.rules.length;C<B;++C){this.writeNode("Rule",D.rules[C],E)}return E},Rule:function(H){var G=this.createElementNSPlus("Rule");if(H.name){this.writeNode("Name",H.name,G)}if(H.title){this.writeNode("Title",H.title,G)}if(H.description){this.writeNode("Abstract",H.description,G)}if(H.elseFilter){this.writeNode("ElseFilter",null,G)}else{if(H.filter){this.writeNode("ogc:Filter",H.filter,G)}}if(H.minScaleDenominator!=undefined){this.writeNode("MinScaleDenominator",H.minScaleDenominator,G)}if(H.maxScaleDenominator!=undefined){this.writeNode("MaxScaleDenominator",H.maxScaleDenominator,G)}var D=OpenLayers.Style.SYMBOLIZER_PREFIXES;var F,E;for(var C=0,B=D.length;C<B;++C){F=D[C];E=H.symbolizer[F];if(E){this.writeNode(F+"Symbolizer",E,G)}}return G},ElseFilter:function(){return this.createElementNSPlus("ElseFilter")},MinScaleDenominator:function(B){return this.createElementNSPlus("MinScaleDenominator",{value:B})},MaxScaleDenominator:function(B){return this.createElementNSPlus("MaxScaleDenominator",{value:B})},LineSymbolizer:function(B){var C=this.createElementNSPlus("LineSymbolizer");this.writeNode("Stroke",B,C);return C},Stroke:function(B){var C=this.createElementNSPlus("Stroke");if(B.strokeColor!=undefined){this.writeNode("CssParameter",{symbolizer:B,key:"strokeColor"},C)}if(B.strokeOpacity!=undefined){this.writeNode("CssParameter",{symbolizer:B,key:"strokeOpacity"},C)}if(B.strokeWidth!=undefined){this.writeNode("CssParameter",{symbolizer:B,key:"strokeWidth"},C)}return C},CssParameter:function(B){return this.createElementNSPlus("CssParameter",{attributes:{name:this.getCssProperty(B.key)},value:B.symbolizer[B.key]})},TextSymbolizer:function(B){var C=this.createElementNSPlus("TextSymbolizer");if(B.label!=null){this.writeNode("Label",B.label,C)}if(B.fontFamily!=null||B.fontSize!=null||B.fontWeight!=null||B.fontStyle!=null){this.writeNode("Font",B,C)}if(B.haloRadius!=null||B.haloColor!=null||B.haloOpacity!=null){this.writeNode("Halo",B,C)}if(B.fillColor!=null||B.fillOpacity!=null){this.writeNode("Fill",B,C)}return C},Font:function(B){var C=this.createElementNSPlus("Font");if(B.fontFamily){this.writeNode("CssParameter",{symbolizer:B,key:"fontFamily"},C)}if(B.fontSize){this.writeNode("CssParameter",{symbolizer:B,key:"fontSize"},C)}if(B.fontWeight){this.writeNode("CssParameter",{symbolizer:B,key:"fontWeight"},C)}if(B.fontStyle){this.writeNode("CssParameter",{symbolizer:B,key:"fontStyle"},C)}return C},Label:function(C){var G=this.createElementNSPlus("Label");var H=C.split("${");G.appendChild(this.createTextNode(H[0]));var F,E;for(var D=1,B=H.length;D<B;D++){F=H[D];E=F.indexOf("}");if(E>0){this.writeNode("ogc:PropertyName",{property:F.substring(0,E)},G);G.appendChild(this.createTextNode(F.substring(++E)))}else{G.appendChild(this.createTextNode("${"+F))}}return G},Halo:function(B){var C=this.createElementNSPlus("Halo");if(B.haloRadius){this.writeNode("Radius",B.haloRadius,C)}if(B.haloColor||B.haloOpacity){this.writeNode("Fill",{fillColor:B.haloColor,fillOpacity:B.haloOpacity},C)}return C},Radius:function(B){return node=this.createElementNSPlus("Radius",{value:B})},PolygonSymbolizer:function(B){var C=this.createElementNSPlus("PolygonSymbolizer");if(B.fillColor!=undefined||B.fillOpacity!=undefined){this.writeNode("Fill",B,C)}if(B.strokeWidth!=undefined||B.strokeColor!=undefined||B.strokeOpacity!=undefined||B.strokeDashstyle!=undefined){this.writeNode("Stroke",B,C)}return C},Fill:function(B){var C=this.createElementNSPlus("Fill");if(B.fillColor){this.writeNode("CssParameter",{symbolizer:B,key:"fillColor"},C)}if(B.fillOpacity!=null){this.writeNode("CssParameter",{symbolizer:B,key:"fillOpacity"},C)}return C},PointSymbolizer:function(B){var C=this.createElementNSPlus("PointSymbolizer");this.writeNode("Graphic",B,C);return C},Graphic:function(B){var C=this.createElementNSPlus("Graphic");if(B.externalGraphic!=undefined){this.writeNode("ExternalGraphic",B,C)}else{this.writeNode("Mark",B,C)}if(B.graphicOpacity!=undefined){this.writeNode("Opacity",B.graphicOpacity,C)}if(B.pointRadius!=undefined){this.writeNode("Size",B.pointRadius*2,C)}if(B.rotation!=undefined){this.writeNode("Rotation",B.rotation,C)}return C},ExternalGraphic:function(B){var C=this.createElementNSPlus("ExternalGraphic");this.writeNode("OnlineResource",B.externalGraphic,C);var D=B.graphicFormat||this.getGraphicFormat(B.externalGraphic);this.writeNode("Format",D,C);return C},Mark:function(B){var C=this.createElementNSPlus("Mark");if(B.graphicName){this.writeNode("WellKnownName",B.graphicName,C)}this.writeNode("Fill",B,C);this.writeNode("Stroke",B,C);return C},WellKnownName:function(B){return this.createElementNSPlus("WellKnownName",{value:B})},Opacity:function(B){return this.createElementNSPlus("Opacity",{value:B})},Size:function(B){return this.createElementNSPlus("Size",{value:B})},Rotation:function(B){return this.createElementNSPlus("Rotation",{value:B})},OnlineResource:function(B){return this.createElementNSPlus("OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":B}})},Format:function(B){return this.createElementNSPlus("Format",{value:B})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"});OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(B){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[B]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[B])},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(B,C){C.insertIds=[];C.success=false;this.readChildNodes(B,C)},InsertResult:function(C,B){var D={fids:[]};this.readChildNodes(C,D);B.insertIds.push(D.fids[0])},TransactionResult:function(B,C){this.readChildNodes(B,C)},Status:function(B,C){this.readChildNodes(B,C)},SUCCESS:function(B,C){C.success=true}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(C){C=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},C);var E=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(C.featureNS?C.featurePrefix+":":"")+C.featureType}});if(C.featureNS){E.setAttribute("xmlns:"+C.featurePrefix,C.featureNS)}if(C.propertyNames){for(var D=0,B=C.propertyNames.length;D<B;D++){this.writeNode("ogc:PropertyName",{property:C.propertyNames[D]},E)}}if(C.filter){this.setFilterProperty(C.filter);this.writeNode("ogc:Filter",C.filter,E)}return E}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"});OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(B){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[B]);OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[B])},readers:{wfs:OpenLayers.Util.applyDefaults({TransactionResponse:function(B,C){C.insertIds=[];C.success=false;this.readChildNodes(B,C)},TransactionSummary:function(B,C){C.success=true},InsertResults:function(B,C){this.readChildNodes(B,C)},Feature:function(C,B){var D={fids:[]};this.readChildNodes(C,D);B.insertIds.push(D.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(C){C=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},C);var E=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(C.featureNS?C.featurePrefix+":":"")+C.featureType,srsName:C.srsName}});if(C.featureNS){E.setAttribute("xmlns:"+C.featurePrefix,C.featureNS)}if(C.propertyNames){for(var D=0,B=C.propertyNames.length;D<B;D++){this.writeNode("wfs:PropertyName",{property:C.propertyNames[D]},E)}}if(C.filter){this.setFilterProperty(C.filter);this.writeNode("ogc:Filter",C.filter,E)}return E},PropertyName:function(B){return this.createElementNSPlus("wfs:PropertyName",{value:B.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"});OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",initialize:function(B){OpenLayers.Format.SLD.v1.prototype.initialize.apply(this,[B])},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"});OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"});OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"});Proj4js={defaultDatum:"WGS84",transform:function(E,C,B){if(!E.readyToUse||!C.readyToUse){this.reportError("Proj4js initialization for "+E.srsCode+" not yet complete");return B}if((E.srsProjNumber=="900913"&&C.datumCode!="WGS84")||(C.srsProjNumber=="900913"&&E.datumCode!="WGS84")){var D=Proj4js.WGS84;this.transform(E,D,B);E=D}if(E.projName=="longlat"){B.x*=Proj4js.common.D2R;B.y*=Proj4js.common.D2R}else{if(E.to_meter){B.x*=E.to_meter;B.y*=E.to_meter}E.inverse(B)}if(E.from_greenwich){B.x+=E.from_greenwich}B=this.datum_transform(E.datum,C.datum,B);if(C.from_greenwich){B.x-=C.from_greenwich}if(C.projName=="longlat"){B.x*=Proj4js.common.R2D;B.y*=Proj4js.common.R2D}else{C.forward(B);if(C.to_meter){B.x/=C.to_meter;B.y/=C.to_meter}}return B},datum_transform:function(D,C,B){if(D.compare_datums(C)){return B}if(D.datum_type==Proj4js.common.PJD_NODATUM||C.datum_type==Proj4js.common.PJD_NODATUM){return B}if(D.datum_type==Proj4js.common.PJD_GRIDSHIFT){alert("ERROR: Grid shift transformations are not implemented yet.")}if(C.datum_type==Proj4js.common.PJD_GRIDSHIFT){alert("ERROR: Grid shift transformations are not implemented yet.")}if(D.es!=C.es||D.a!=C.a||D.datum_type==Proj4js.common.PJD_3PARAM||D.datum_type==Proj4js.common.PJD_7PARAM||C.datum_type==Proj4js.common.PJD_3PARAM||C.datum_type==Proj4js.common.PJD_7PARAM){D.geodetic_to_geocentric(B);if(D.datum_type==Proj4js.common.PJD_3PARAM||D.datum_type==Proj4js.common.PJD_7PARAM){D.geocentric_to_wgs84(B)}if(C.datum_type==Proj4js.common.PJD_3PARAM||C.datum_type==Proj4js.common.PJD_7PARAM){C.geocentric_from_wgs84(B)}C.geocentric_to_geodetic(B)}if(C.datum_type==Proj4js.common.PJD_GRIDSHIFT){alert("ERROR: Grid shift transformations are not implemented yet.")}return B},reportError:function(B){},extend:function(B,E){B=B||{};if(E){for(var D in E){var C=E[D];if(C!==undefined){B[D]=C}}}return B},Class:function(){var C=function(){this.initialize.apply(this,arguments)};var B={};var E;for(var D=0;D<arguments.length;++D){if(typeof arguments[D]=="function"){E=arguments[D].prototype}else{E=arguments[D]}Proj4js.extend(B,E)}C.prototype=B;return C},bind:function(D,C){var B=Array.prototype.slice.apply(arguments,[2]);return function(){var E=B.concat(Array.prototype.slice.apply(arguments,[0]));return D.apply(C,E)}},scriptName:"proj4js.js",defsLookupService:"http://spatialreference.org/ref",libPath:null,getScriptLocation:function(){if(this.libPath){return this.libPath}var F=this.scriptName;var E=F.length;var B=document.getElementsByTagName("script");for(var D=0;D<B.length;D++){var G=B[D].getAttribute("src");if(G){var C=G.lastIndexOf(F);if((C>-1)&&(C+E==G.length)){this.libPath=G.slice(0,-E);break}}}return this.libPath||""},loadScript:function(E,F,D,B){var C=document.createElement("script");C.defer=false;C.type="text/javascript";C.id=E;C.src=E;C.onload=F;C.onerror=D;C.loadCheck=B;if(/MSIE/.test(navigator.userAgent)){C.onreadystatechange=this.checkReadyState}document.getElementsByTagName("head")[0].appendChild(C)},checkReadyState:function(){if(this.readyState=="loaded"){if(!this.loadCheck()){this.onerror()}else{this.onload()}}}};Proj4js.Proj=Proj4js.Class({readyToUse:false,title:null,projName:null,units:null,datum:null,x0:0,y0:0,initialize:function(D){this.srsCodeInput=D;if(D.indexOf("urn:")==0){var B=D.split(":");if((B[1]=="ogc"||B[1]=="x-ogc")&&(B[2]=="def")&&(B[3]=="crs")){D=B[4]+":"+B[B.length-1]}}else{if(D.indexOf("http://")==0){var C=D.split("#");if(C[0].match(/epsg.org/)){D="EPSG:"+C[1]}else{if(C[0].match(/RIG.xml/)){D="IGNF:"+C[1]}}}}this.srsCode=D.toUpperCase();if(this.srsCode.indexOf("EPSG")==0){this.srsCode=this.srsCode;this.srsAuth="epsg";this.srsProjNumber=this.srsCode.substring(5)}else{if(this.srsCode.indexOf("IGNF")==0){this.srsCode=this.srsCode;this.srsAuth="IGNF";this.srsProjNumber=this.srsCode.substring(5)}else{if(this.srsCode.indexOf("CRS")==0){this.srsCode=this.srsCode;this.srsAuth="CRS";this.srsProjNumber=this.srsCode.substring(4)}else{this.srsAuth="";this.srsProjNumber=this.srsCode}}}this.loadProjDefinition()},loadProjDefinition:function(){if(Proj4js.defs[this.srsCode]){this.defsLoaded();return }var B=Proj4js.getScriptLocation()+"defs/"+this.srsAuth.toUpperCase()+this.srsProjNumber+".js";Proj4js.loadScript(B,Proj4js.bind(this.defsLoaded,this),Proj4js.bind(this.loadFromService,this),Proj4js.bind(this.checkDefsLoaded,this))},loadFromService:function(){var B=Proj4js.defsLookupService+"/"+this.srsAuth+"/"+this.srsProjNumber+"/proj4js/";Proj4js.loadScript(B,Proj4js.bind(this.defsLoaded,this),Proj4js.bind(this.defsFailed,this),Proj4js.bind(this.checkDefsLoaded,this))},defsLoaded:function(){this.parseDefs();this.loadProjCode(this.projName)},checkDefsLoaded:function(){if(Proj4js.defs[this.srsCode]){return true}else{return false}},defsFailed:function(){Proj4js.reportError("failed to load projection definition for: "+this.srsCode);Proj4js.defs[this.srsCode]=Proj4js.defs.WGS84;this.defsLoaded()},loadProjCode:function(C){if(Proj4js.Proj[C]){this.initTransforms();return }var B=Proj4js.getScriptLocation()+"projCode/"+C+".js";Proj4js.loadScript(B,Proj4js.bind(this.loadProjCodeSuccess,this,C),Proj4js.bind(this.loadProjCodeFailure,this,C),Proj4js.bind(this.checkCodeLoaded,this,C))},loadProjCodeSuccess:function(B){if(Proj4js.Proj[B].dependsOn){this.loadProjCode(Proj4js.Proj[B].dependsOn)}else{this.initTransforms()}},loadProjCodeFailure:function(B){Proj4js.reportError("failed to find projection file for: "+B)},checkCodeLoaded:function(B){if(Proj4js.Proj[B]){return true}else{return false}},initTransforms:function(){Proj4js.extend(this,Proj4js.Proj[this.projName]);this.init();this.readyToUse=true},parseDefs:function(){this.defData=Proj4js.defs[this.srsCode];var E,C;if(!this.defData){return }var B=this.defData.split("+");for(var F=0;F<B.length;F++){var D=B[F].split("=");E=D[0].toLowerCase();C=D[1];switch(E.replace(/\s/gi,"")){case"":break;case"title":this.title=C;break;case"proj":this.projName=C.replace(/\s/gi,"");break;case"units":this.units=C.replace(/\s/gi,"");break;case"datum":this.datumCode=C.replace(/\s/gi,"");break;case"nadgrids":this.nagrids=C.replace(/\s/gi,"");break;case"ellps":this.ellps=C.replace(/\s/gi,"");break;case"a":this.a=parseFloat(C);break;case"b":this.b=parseFloat(C);break;case"rf":this.rf=parseFloat(C);break;case"lat_0":this.lat0=C*Proj4js.common.D2R;break;case"lat_1":this.lat1=C*Proj4js.common.D2R;break;case"lat_2":this.lat2=C*Proj4js.common.D2R;break;case"lat_ts":this.lat_ts=C*Proj4js.common.D2R;break;case"lon_0":this.long0=C*Proj4js.common.D2R;break;case"alpha":this.alpha=parseFloat(C)*Proj4js.common.D2R;break;case"lonc":this.longc=C*Proj4js.common.D2R;break;case"x_0":this.x0=parseFloat(C);break;case"y_0":this.y0=parseFloat(C);break;case"k_0":this.k0=parseFloat(C);break;case"k":this.k0=parseFloat(C);break;case"r_a":this.R_A=true;break;case"zone":this.zone=parseInt(C);break;case"south":this.utmSouth=true;break;case"towgs84":this.datum_params=C.split(",");break;case"to_meter":this.to_meter=parseFloat(C);break;case"from_greenwich":this.from_greenwich=C*Proj4js.common.D2R;break;case"pm":C=C.replace(/\s/gi,"");this.from_greenwich=Proj4js.PrimeMeridian[C]?Proj4js.PrimeMeridian[C]:parseFloat(C);this.from_greenwich*=Proj4js.common.D2R;break;case"no_defs":break;default:}}this.deriveConstants()},deriveConstants:function(){if(this.nagrids=="@null"){this.datumCode="none"}if(this.datumCode&&this.datumCode!="none"){var B=Proj4js.Datum[this.datumCode];if(B){this.datum_params=B.towgs84?B.towgs84.split(","):null;this.ellps=B.ellipse;this.datumName=B.datumName?B.datumName:this.datumCode}}if(!this.a){var C=Proj4js.Ellipsoid[this.ellps]?Proj4js.Ellipsoid[this.ellps]:Proj4js.Ellipsoid.WGS84;Proj4js.extend(this,C)}if(this.rf&&!this.b){this.b=(1-1/this.rf)*this.a}if(Math.abs(this.a-this.b)<Proj4js.common.EPSLN){this.sphere=true;this.b=this.a}this.a2=this.a*this.a;this.b2=this.b*this.b;this.es=(this.a2-this.b2)/this.a2;this.e=Math.sqrt(this.es);if(this.R_A){this.a*=1-this.es*(Proj4js.common.SIXTH+this.es*(Proj4js.common.RA4+this.es*Proj4js.common.RA6));this.a2=this.a*this.a;this.b2=this.b*this.b;this.es=0}this.ep2=(this.a2-this.b2)/this.b2;if(!this.k0){this.k0=1}this.datum=new Proj4js.datum(this)}});Proj4js.Proj.longlat={init:function(){},forward:function(B){return B},inverse:function(B){return B}};Proj4js.defs={WGS84:"+title=long/lat:WGS84 +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4326":"+title=long/lat:WGS84 +proj=longlat +a=6378137.0 +b=6356752.31424518 +ellps=WGS84 +datum=WGS84 +units=degrees","EPSG:4269":"+title=long/lat:NAD83 +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees","EPSG:3785":"+title= Google Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"};Proj4js.defs.GOOGLE=Proj4js.defs["EPSG:3785"];Proj4js.defs["EPSG:900913"]=Proj4js.defs["EPSG:3785"];Proj4js.defs["EPSG:102113"]=Proj4js.defs["EPSG:3785"];Proj4js.common={PI:3.141592653589793,HALF_PI:1.5707963267948966,TWO_PI:6.283185307179586,FORTPI:0.7853981633974483,R2D:57.29577951308232,D2R:0.017453292519943295,SEC_TO_RAD:0.00000484813681109536,EPSLN:1e-10,MAX_ITER:20,COS_67P5:0.3826834323650898,AD_C:1.0026,PJD_UNKNOWN:0,PJD_3PARAM:1,PJD_7PARAM:2,PJD_GRIDSHIFT:3,PJD_WGS84:4,PJD_NODATUM:5,SRS_WGS84_SEMIMAJOR:6378137,SIXTH:0.16666666666666666,RA4:0.04722222222222222,RA6:0.022156084656084655,RV4:0.06944444444444445,RV6:0.04243827160493827,msfnz:function(D,C,E){var B=D*C;return E/(Math.sqrt(1-B*B))},tsfnz:function(F,E,D){var B=F*D;var C=0.5*F;B=Math.pow(((1-B)/(1+B)),C);return(Math.tan(0.5*(this.HALF_PI-E))/B)},phi2z:function(G,F){var E=0.5*G;var B,C;var D=this.HALF_PI-2*Math.atan(F);for(i=0;i<=15;i++){B=G*Math.sin(D);C=this.HALF_PI-2*Math.atan(F*(Math.pow(((1-B)/(1+B)),E)))-D;D+=C;if(Math.abs(C)<=1e-10){return D}}alert("phi2z has NoConvergence");return(-9999)},qsfnz:function(D,C){var B;if(D>1e-7){B=D*C;return((1-D*D)*(C/(1-B*B)-(0.5/D)*Math.log((1-B)/(1+B))))}else{return(2*C)}},asinz:function(B){if(Math.abs(B)>1){B=(B>1)?1:-1}return Math.asin(B)},e0fn:function(B){return(1-0.25*B*(1+B/16*(3+1.25*B)))},e1fn:function(B){return(0.375*B*(1+0.25*B*(1+0.46875*B)))},e2fn:function(B){return(0.05859375*B*B*(1+0.75*B))},e3fn:function(B){return(B*B*B*(35/3072))},mlfn:function(F,E,D,C,B){return(F*B-E*Math.sin(2*B)+D*Math.sin(4*B)-C*Math.sin(6*B))},srat:function(B,C){return(Math.pow((1-B)/(1+B),C))},sign:function(B){if(B<0){return(-1)}else{return(1)}},adjust_lon:function(B){B=(Math.abs(B)<this.PI)?B:(B-(this.sign(B)*this.TWO_PI));return B},adjust_lat:function(B){B=(Math.abs(B)<this.HALF_PI)?B:(B-(this.sign(B)*this.PI));return B},latiso:function(E,D,C){if(Math.abs(D)>this.HALF_PI){return +Number.NaN}if(D==this.HALF_PI){return Number.POSITIVE_INFINITY}if(D==-1*this.HALF_PI){return -1*Number.POSITIVE_INFINITY}var B=E*C;return Math.log(Math.tan((this.HALF_PI+D)/2))+E*Math.log((1-B)/(1+B))/2},fL:function(C,B){return 2*Math.atan(C*Math.exp(B))-this.HALF_PI},invlatiso:function(F,D){var C=this.fL(1,D);var E=0;var B=0;do{E=C;B=F*Math.sin(E);C=this.fL(Math.exp(F*Math.log((1+B)/(1-B))/2),D)}while(Math.abs(C-E)>1e-12);return C},sinh:function(B){var C=Math.exp(B);C=(C-1/C)/2;return C},cosh:function(B){var C=Math.exp(B);C=(C+1/C)/2;return C},tanh:function(B){var C=Math.exp(B);C=(C-1/C)/(C+1/C);return C},asinh:function(B){var C=(B>=0?1:-1);return C*(Math.log(Math.abs(B)+Math.sqrt(B*B+1)))},acosh:function(B){return 2*Math.log(Math.sqrt((B+1)/2)+Math.sqrt((B-1)/2))},atanh:function(B){return Math.log((B-1)/(B+1))/2},gN:function(B,E,D){var C=E*D;return B/Math.sqrt(1-C*C)}};Proj4js.datum=Proj4js.Class({initialize:function(C){this.datum_type=Proj4js.common.PJD_WGS84;if(C.datumCode&&C.datumCode=="none"){this.datum_type=Proj4js.common.PJD_NODATUM}if(C&&C.datum_params){for(var B=0;B<C.datum_params.length;B++){C.datum_params[B]=parseFloat(C.datum_params[B])}if(C.datum_params[0]!=0||C.datum_params[1]!=0||C.datum_params[2]!=0){this.datum_type=Proj4js.common.PJD_3PARAM}if(C.datum_params.length>3){if(C.datum_params[3]!=0||C.datum_params[4]!=0||C.datum_params[5]!=0||C.datum_params[6]!=0){this.datum_type=Proj4js.common.PJD_7PARAM;C.datum_params[3]*=Proj4js.common.SEC_TO_RAD;C.datum_params[4]*=Proj4js.common.SEC_TO_RAD;C.datum_params[5]*=Proj4js.common.SEC_TO_RAD;C.datum_params[6]=(C.datum_params[6]/1000000)+1}}}if(C){this.a=C.a;this.b=C.b;this.es=C.es;this.ep2=C.ep2;this.datum_params=C.datum_params}},compare_datums:function(B){if(this.datum_type!=B.datum_type){return false}else{if(this.a!=B.a||Math.abs(this.es-B.es)>5e-11){return false}else{if(this.datum_type==Proj4js.common.PJD_3PARAM){return(this.datum_params[0]==B.datum_params[0]&&this.datum_params[1]==B.datum_params[1]&&this.datum_params[2]==B.datum_params[2])}else{if(this.datum_type==Proj4js.common.PJD_7PARAM){return(this.datum_params[0]==B.datum_params[0]&&this.datum_params[1]==B.datum_params[1]&&this.datum_params[2]==B.datum_params[2]&&this.datum_params[3]==B.datum_params[3]&&this.datum_params[4]==B.datum_params[4]&&this.datum_params[5]==B.datum_params[5]&&this.datum_params[6]==B.datum_params[6])}else{if(this.datum_type==Proj4js.common.PJD_GRIDSHIFT){return strcmp(pj_param(this.params,"snadgrids").s,pj_param(B.params,"snadgrids").s)==0}else{return true}}}}}},geodetic_to_geocentric:function(D){var M=D.x;var I=D.y;var E=D.z?D.z:0;var F;var C;var B;var K=0;var L;var J;var H;var G;if(I<-Proj4js.common.HALF_PI&&I>-1.001*Proj4js.common.HALF_PI){I=-Proj4js.common.HALF_PI}else{if(I>Proj4js.common.HALF_PI&&I<1.001*Proj4js.common.HALF_PI){I=Proj4js.common.HALF_PI}else{if((I<-Proj4js.common.HALF_PI)||(I>Proj4js.common.HALF_PI)){Proj4js.reportError("geocent:lat out of range:"+I);return null}}}if(M>Proj4js.common.PI){M-=(2*Proj4js.common.PI)}J=Math.sin(I);G=Math.cos(I);H=J*J;L=this.a/(Math.sqrt(1-this.es*H));F=(L+E)*G*Math.cos(M);C=(L+E)*G*Math.sin(M);B=((L*(1-this.es))+E)*J;D.x=F;D.y=C;D.z=B;return K},geocentric_to_geodetic:function(U){var d=1e-12;var V=(d*d);var G=30;var M;var I;var B;var O;var C;var N;var L;var b;var a;var K;var S;var R;var F;var W;var H=U.x;var E=U.y;var D=U.z?U.z:0;var J;var T;var Q;F=false;M=Math.sqrt(H*H+E*E);I=Math.sqrt(H*H+E*E+D*D);if(M/this.a<d){F=true;J=0;if(I/this.a<d){T=Proj4js.common.HALF_PI;Q=-this.b;return }}else{J=Math.atan2(E,H)}B=D/I;O=M/I;C=1/Math.sqrt(1-this.es*(2-this.es)*O*O);b=O*(1-this.es)*C;a=B*C;W=0;do{W++;L=this.a/Math.sqrt(1-this.es*a*a);Q=M*b+D*a-L*(1-this.es*a*a);N=this.es*L/(L+Q);C=1/Math.sqrt(1-N*(2-N)*O*O);K=O*(1-N)*C;S=B*C;R=S*b-K*a;b=K;a=S}while(R*R>V&&W<G);T=Math.atan(S/Math.abs(K));U.x=J;U.y=T;U.z=Q;return U},geocentric_to_geodetic_noniter:function(S){var E=S.x;var D=S.y;var B=S.z?S.z:0;var H;var R;var M;var F;var O;var Q;var N;var K;var I;var J;var V;var G;var U;var T;var P;var L;var C;E=parseFloat(E);D=parseFloat(D);B=parseFloat(B);C=false;if(E!=0){H=Math.atan2(D,E)}else{if(D>0){H=Proj4js.common.HALF_PI}else{if(D<0){H=-Proj4js.common.HALF_PI}else{C=true;H=0;if(B>0){R=Proj4js.common.HALF_PI}else{if(B<0){R=-Proj4js.common.HALF_PI}else{R=Proj4js.common.HALF_PI;M=-this.b;return }}}}}O=E*E+D*D;F=Math.sqrt(O);Q=B*Proj4js.common.AD_C;K=Math.sqrt(Q*Q+O);J=Q/K;G=F/K;V=J*J*J;N=B+this.b*this.ep2*V;L=F-this.a*this.es*G*G*G;I=Math.sqrt(N*N+L*L);U=N/I;T=L/I;P=this.a/Math.sqrt(1-this.es*U*U);if(T>=Proj4js.common.COS_67P5){M=F/T-P}else{if(T<=-Proj4js.common.COS_67P5){M=F/-T-P}else{M=B/U+P*(this.es-1)}}if(C==false){R=Math.atan(U/T)}S.x=H;S.y=R;S.z=M;return S},geocentric_to_wgs84:function(C){if(this.datum_type==Proj4js.common.PJD_3PARAM){C.x+=this.datum_params[0];C.y+=this.datum_params[1];C.z+=this.datum_params[2]}else{if(this.datum_type==Proj4js.common.PJD_7PARAM){var G=this.datum_params[0];var E=this.datum_params[1];var J=this.datum_params[2];var F=this.datum_params[3];var K=this.datum_params[4];var I=this.datum_params[5];var H=this.datum_params[6];var D=H*(C.x-I*C.y+K*C.z)+G;var B=H*(I*C.x+C.y-F*C.z)+E;var L=H*(-K*C.x+F*C.y+C.z)+J;C.x=D;C.y=B;C.z=L}}},geocentric_from_wgs84:function(D){if(this.datum_type==Proj4js.common.PJD_3PARAM){D.x-=this.datum_params[0];D.y-=this.datum_params[1];D.z-=this.datum_params[2]}else{if(this.datum_type==Proj4js.common.PJD_7PARAM){var H=this.datum_params[0];var E=this.datum_params[1];var K=this.datum_params[2];var G=this.datum_params[3];var L=this.datum_params[4];var J=this.datum_params[5];var I=this.datum_params[6];var F=(D.x-H)/I;var C=(D.y-E)/I;var B=(D.z-K)/I;D.x=F+J*C-L*B;D.y=-J*F+C+G*B;D.z=L*F-G*C+B}}}});Proj4js.Point=Proj4js.Class({initialize:function(B,E,D){if(typeof B=="object"){this.x=B[0];this.y=B[1];this.z=B[2]||0}else{if(typeof B=="string"){var C=B.split(",");this.x=parseFloat(C[0]);this.y=parseFloat(C[1]);this.z=parseFloat(C[2])||0}else{this.x=B;this.y=E;this.z=D||0}}},clone:function(){return new Proj4js.Point(this.x,this.y,this.z)},toString:function(){return("x="+this.x+",y="+this.y)},toShortString:function(){return(this.x+", "+this.y)}});Proj4js.PrimeMeridian={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};Proj4js.Ellipsoid={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},"APL4.":{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS72:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}};Proj4js.Datum={WGS84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},GGRS87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},NAD83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},NAD27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},OSGB36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"}};Proj4js.WGS84=new Proj4js.Proj("WGS84");Proj4js.Datum.OSB36=Proj4js.Datum.OSGB36;Proj4js.ProxyHost="";Proj4js.ProxyHostFQDN=null;Proj4js.getFQDNForUrl=function(B){if(B){var C=B.match(/^[a-z]+:\/\/([^\/]+)\/?/i);if(C){return C[1]}return window.location.host}return null};Proj4js.setProxyUrl=function(B){Proj4js.ProxyHost=B;Proj4js.ProxyHostFQDN=this.getFQDNForUrl(B)};Proj4js.Try=function(){var E=null;for(var D=0,B=arguments.length;D<B;D++){var C=arguments[D];try{E=C();break}catch(F){}}return E};Proj4js.loadScript=function(C,E,H,J){var F={loaded:false,onload:E,onfail:H,loadCheck:J,transport:Proj4js.Try(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||null};if(!F.transport){return }if(F.transport.overrideMimeType){F.transport.overrideMimeType("text/xml")}var G="_tick_="+new Date().getTime();C+=(C.indexOf("?")+1?"&":"?")+G;if(Proj4js.ProxyHost){if(C.indexOf(Proj4js.ProxyHost)!=0){if(C.search(/^[a-z]+:\/\//i)!=-1){var I=C.match(/^[a-z]+:\/\/([^\/]*)\/?/i);if(I){I=I[1]}if(Proj4js.ProxyHostFQDN!=I){C=Proj4js.ProxyHost+encodeURIComponent(C)}}}}F.transport.open("GET",C,false);F.transport.onreadystatechange=Proj4js.bind(this.onStateChange,this,F);var D={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",Proj4js:true};for(var B in D){F.transport.setRequestHeader(B,D[B])}F.transport.send(null);if(F.transport.overrideMimeType){this.onStateChange(F)}};Proj4js.onStateChange=function(request){if(request.transport.readyState>1&&!(request.transport.readyState==4&&request.loaded)){var state=0;try{state=request.transport.status||0}catch(e){state=0}var success=state==0||(state>=200&&state<300);if(request.transport.readyState==4){request.loaded=true;if(success){eval(request.transport.responseText);if(request.loadCheck&&!request.loadCheck()){if(request.onfail){request.onfail()}}else{if(request.onload){request.onload()}}}else{if(request.onfail){request.onfail()}}request.transport.onreadystatechange=function(){}}}};Proj4js.checkReadyState=function(){};Proj4js.defs["IGNF:RGR92GEO"]="+title=Reseau geodesique de la Reunion 1992 +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["IGNF:TAHAAUTM05S"]="+title=Tahaa 1951 +proj=tmerc +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:4151"]="+title=CHTRF95 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32745"]="+proj=utm +zone=45 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32655"]="+proj=utm +zone=55 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4640"]="+title=RRAF 1991 +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32609"]="+proj=utm +zone=9 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32618"]="+proj=utm +zone=18 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:CSG67UTM22"]="+title=Guyane CSG67 UTM fuseau 22 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:GEOPORTALKER"]="+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:LAMB3"]="+title=Lambert III +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs";Proj4js.defs["EPSG:27581"]="+title=NTF (Paris) / France I (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["IGNF:UTM43SW84"]="+title=World Geodetic System 1984 UTM fuseau 43 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32639"]="+proj=utm +zone=39 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:WGS72"]="+title=World Geodetic System 1972 +proj=geocent +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs";Proj4js.defs["EPSG:27573"]="+title=NTF (Paris) / Lambert zone III +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:32701"]="+proj=utm +zone=1 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:2154"]="+title=RGF93 / Lambert-93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32652"]="+proj=utm +zone=52 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.omerc={init:function(){if(!this.mode){this.mode=0}if(!this.lon1){this.lon1=0;this.mode=1}if(!this.lon2){this.lon2=0}if(!this.lat2){this.lat2=0}var B=this.b/this.a;var D=1-Math.pow(B,2);var C=Math.sqrt(D);this.sin_p20=Math.sin(this.lat0);this.cos_p20=Math.cos(this.lat0);this.con=1-this.es*this.sin_p20*this.sin_p20;this.com=Math.sqrt(1-D);this.bl=Math.sqrt(1+this.es*Math.pow(this.cos_p20,4)/(1-D));this.al=this.a*this.bl*this.k0*this.com/this.con;if(Math.abs(this.lat0)<Proj4js.common.EPSLN){this.ts=1;this.d=1;this.el=1}else{this.ts=Proj4js.common.tsfnz(this.e,this.lat0,this.sin_p20);this.con=Math.sqrt(this.con);this.d=this.bl*this.com/(this.cos_p20*this.con);if((this.d*this.d-1)>0){if(this.lat0>=0){this.f=this.d+Math.sqrt(this.d*this.d-1)}else{this.f=this.d-Math.sqrt(this.d*this.d-1)}}else{this.f=this.d}this.el=this.f*Math.pow(this.ts,this.bl)}if(this.mode!=0){this.g=0.5*(this.f-1/this.f);this.gama=Proj4js.common.asinz(Math.sin(this.alpha)/this.d);this.longc=this.longc-Proj4js.common.asinz(this.g*Math.tan(this.gama))/this.bl;this.con=Math.abs(this.lat0);if((this.con>Proj4js.common.EPSLN)&&(Math.abs(this.con-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN)){this.singam=Math.sin(this.gama);this.cosgam=Math.cos(this.gama);this.sinaz=Math.sin(this.alpha);this.cosaz=Math.cos(this.alpha);if(this.lat0>=0){this.u=(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz)}else{this.u=-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz)}}else{Proj4js.reportError("omerc:Init:DataError")}}else{this.sinphi=Math.sin(this.at1);this.ts1=Proj4js.common.tsfnz(this.e,this.lat1,this.sinphi);this.sinphi=Math.sin(this.lat2);this.ts2=Proj4js.common.tsfnz(this.e,this.lat2,this.sinphi);this.h=Math.pow(this.ts1,this.bl);this.l=Math.pow(this.ts2,this.bl);this.f=this.el/this.h;this.g=0.5*(this.f-1/this.f);this.j=(this.el*this.el-this.l*this.h)/(this.el*this.el+this.l*this.h);this.p=(this.l-this.h)/(this.l+this.h);this.dlon=this.lon1-this.lon2;if(this.dlon<-Proj4js.common.PI){this.lon2=this.lon2-2*Proj4js.common.PI}if(this.dlon>Proj4js.common.PI){this.lon2=this.lon2+2*Proj4js.common.PI}this.dlon=this.lon1-this.lon2;this.longc=0.5*(this.lon1+this.lon2)-Math.atan(this.j*Math.tan(0.5*this.bl*this.dlon)/this.p)/this.bl;this.dlon=Proj4js.common.adjust_lon(this.lon1-this.longc);this.gama=Math.atan(Math.sin(this.bl*this.dlon)/this.g);this.alpha=Proj4js.common.asinz(this.d*Math.sin(this.gama));if(Math.abs(this.lat1-this.lat2)<=Proj4js.common.EPSLN){Proj4js.reportError("omercInitDataError")}else{this.con=Math.abs(this.lat1)}if((this.con<=Proj4js.common.EPSLN)||(Math.abs(this.con-HALF_PI)<=Proj4js.common.EPSLN)){Proj4js.reportError("omercInitDataError")}else{if(Math.abs(Math.abs(this.lat0)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN){Proj4js.reportError("omercInitDataError")}}this.singam=Math.sin(this.gam);this.cosgam=Math.cos(this.gam);this.sinaz=Math.sin(this.alpha);this.cosaz=Math.cos(this.alpha);if(this.lat0>=0){this.u=(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz)}else{this.u=-(this.al/this.bl)*Math.atan(Math.sqrt(this.d*this.d-1)/this.cosaz)}}},forward:function(Q){var I;var D,Y;var W;var V,M,C;var F,R,T;var P,J,U;var N,S;var O;var B;var G;var E=Q.x;var H=Q.y;D=Math.sin(H);B=Proj4js.common.adjust_lon(E-this.longc);U=Math.sin(this.bl*B);if(Math.abs(Math.abs(H)-Proj4js.common.HALF_PI)>Proj4js.common.EPSLN){G=Proj4js.common.tsfnz(this.e,H,D);P=this.el/(Math.pow(G,this.bl));O=0.5*(P-1/P);M=0.5*(P+1/P);N=(O*this.singam-U*this.cosgam)/M;F=Math.cos(this.bl*B);if(Math.abs(F)<1e-7){J=this.al*this.bl*B}else{J=this.al*Math.atan((O*this.cosgam+U*this.singam)/F)/this.bl;if(F<0){J=J+Proj4js.common.PI*this.al/this.bl}}}else{if(H>=0){N=this.singam}else{N=-this.singam}J=this.al*H/this.bl}if(Math.abs(Math.abs(N)-1)<=Proj4js.common.EPSLN){Proj4js.reportError("omercFwdInfinity")}S=0.5*this.al*Math.log((1-N)/(1+N))/this.bl;J=J-this.u;var L=this.x0+S*this.cosaz+J*this.sinaz;var K=this.y0+J*this.cosaz-S*this.sinaz;Q.x=L;Q.y=K;return Q},inverse:function(N){var Y;var H;var E;var D,W;var V;var T,K,C;var F,O,R;var P,I,M,L,G;var S,J,U;var B;var Q;N.x-=this.x0;N.y-=this.y0;Q=0;P=N.x*this.cosaz-N.y*this.sinaz;I=N.y*this.cosaz+N.x*this.sinaz;I=I+this.u;M=Math.exp(-this.bl*P/this.al);L=0.5*(M-1/M);K=0.5*(M+1/M);S=Math.sin(this.bl*I/this.al);J=(S*this.cosgam+L*this.singam)/K;if(Math.abs(Math.abs(J)-1)<=Proj4js.common.EPSLN){lon=this.longc;if(J>=0){lat=Proj4js.common.HALF_PI}else{lat=-Proj4js.common.HALF_PI}}else{F=1/this.bl;G=Math.pow((this.el/Math.sqrt((1+J)/(1-J))),F);lat=Proj4js.common.phi2z(this.e,G);H=this.longc-Math.atan2((L*this.cosgam-S*this.singam),F)/this.bl;lon=Proj4js.common.adjust_lon(H)}N.x=lon;N.y=lat;return N}};Proj4js.defs["EPSG:2984"]="+title=RGNC 1991 / Lambert New Caledonia (deprecated) +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=intl +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:GEOPORTALASP"]="+title=Geoportail - Saint Paul et Amsterdam (Iles) +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:3171"]="+title=RGNC91-93 / UTM zone 59S +proj=utm +zone=59 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:GEOPORTALREU"]="+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32747"]="+proj=utm +zone=47 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32637"]="+proj=utm +zone=37 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32636"]="+proj=utm +zone=36 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGPFGEO"]="+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:27584"]="+title=NTF (Paris) / France IV (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:2980"]="+title=Combani 1950 / UTM zone 38S +proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:IGN72UTM58S"]="+title=IGN 1972 - UTM fuseau 58 Sud +proj=tmerc +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:GUADFM49U20"]="+title=Guadeloupe Fort Marigot  +proj=tmerc +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32605"]="+proj=utm +zone=5 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4750"]="+title=ST87 Ouvea +proj=longlat +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:LAMBE"]="+title=Lambert II etendu +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs";Proj4js.defs["IGNF:RGM04UTM38S"]="+title=UTM fuseau 38 Sud (Reseau Geodesique de Mayotte 2004) +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:4625"]="+title=Martinique 1938 +proj=longlat +ellps=intl +no_defs ";function phi4z(C,H,G,F,E,T,S,R,D){var I,Q,O,P,M,L,K,J,B,N;D=T;for(N=1;N<=15;N++){I=Math.sin(D);tanphi=Math.tan(D);R=tanphi*Math.sqrt(1-C*I*I);Q=Math.sin(2*D);P=H*D-G*Q+F*Math.sin(4*D)-E*Math.sin(6*D);M=H-2*G*Math.cos(2*D)+4*F*Math.cos(4*D)-6*E*Math.cos(6*D);L=2*P+R*(P*P+S)-2*T*(R*P+1);K=C*Q*(P*P+S-2*T*P)/(2*R);J=2*(T-P)*(R*M-2/Q)-2*M;B=L/(K+J);D+=B;if(Math.abs(B)<=1e-10){return(D)}}Proj4js.reportError("phi4z: No convergence");return null}function e4fn(B){var C,D;C=1+B;D=1-B;return(Math.sqrt((Math.pow(C,C))*(Math.pow(D,D))))}Proj4js.Proj.poly={init:function(){var B;if(this.lat0=0){this.lat0=90}this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.ml0=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(E){var B,G;var I;var K;var F,H;var D;var M,L;var C=E.x;var J=E.y;F=Proj4js.common.adjust_lon(C-this.long0);if(Math.abs(J)<=1e-7){M=this.x0+this.a*F;L=this.y0-this.a*this.ml0}else{B=Math.sin(J);G=Math.cos(J);H=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,J);D=Proj4js.common.msfnz(this.e,B,G);F=B;M=this.x0+this.a*D*Math.sin(F)/B;L=this.y0+this.a*(H-this.ml0+D*(1-Math.cos(F))/B)}E.x=M;E.y=L;return E},inverse:function(C){var K,G;var F;var L;var I;var D,E;var J;var B,H;C.x-=this.x0;C.y-=this.y0;F=this.ml0+C.y/this.a;J=0;if(Math.abs(F)<=1e-7){B=C.x/this.a+this.long0;H=0}else{L=F*F+(C.x/this.a)*(C.x/this.a);J=phi4z(this.es,this.e0,this.e1,this.e2,this.e3,this.al,L,I,H);if(J!=1){return(J)}B=Proj4js.common.adjust_lon((Proj4js.common.asinz(C.x*I/this.a)/Math.sin(H))+this.long0)}C.x=B;C.y=H;return C}};Proj4js.defs["EPSG:4638"]="+title=Saint Pierre et Miquelon 1950 +proj=longlat +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32658"]="+proj=utm +zone=58 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32723"]="+proj=utm +zone=23 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32703"]="+proj=utm +zone=3 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4692"]="+title=Maupiti 83 +proj=longlat +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32739"]="+proj=utm +zone=39 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27593"]="+title=NTF (Paris) / Sud France (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:2978"]="+title=IGN72 Nuku Hiva / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["EPSG:4698"]="+title=IGN 1962 Kerguelen +proj=longlat +ellps=intl +towgs84=145,-187,103,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:2969"]="+title=Fort Marigot / UTM zone 20N +proj=utm +zone=20 +ellps=intl +towgs84=137,248,-430,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:IGN72GEO"]="+title=IGN 1972 Grande-Terre / Ile des Pins +proj=longlat +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:TERA50"]="+title=Pointe Geologie - Perroud 1950 +proj=geocent +towgs84=324.8000,153.6000,172.1000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32728"]="+proj=utm +zone=28 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3296"]="+title=RGPF / UTM zone 5S +proj=utm +zone=5 +south +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["IGNF:RGF93CC43"]="+title=Lambert conique conforme Zone 2 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=43.000000000 +lon_0=3.000000000 +lat_1=42.200000000 +lat_2=43.800000000 +x_0=1700000.000 +y_0=2200000.000 +units=m +no_defs";Proj4js.defs["EPSG:3727"]="+title=Reunion 1947 / TM Reunion +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=160000 +y_0=50000 +ellps=intl +units=m +no_defs ";Proj4js.defs["EPSG:3336"]="+title=IGN 1962 Kerguelen / UTM zone 42S +proj=utm +zone=42 +south +ellps=intl +towgs84=145,-187,103,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32737"]="+proj=utm +zone=37 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGSPM06GEO"]="+title=Saint-Pierre-et-Miquelon (2006) +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["IGNF:STPM50GEO"]="+title=St Pierre et Miquelon 1950  +proj=longlat +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs";Proj4js.Proj.nzmg={iterations:1,init:function(){this.A=new Array();this.A[1]=+0.6399175073;this.A[2]=-0.1358797613;this.A[3]=+0.063294409;this.A[4]=-0.02526853;this.A[5]=+0.0117879;this.A[6]=-0.0055161;this.A[7]=+0.0026906;this.A[8]=-0.001333;this.A[9]=+0.00067;this.A[10]=-0.00034;this.B_re=new Array();this.B_im=new Array();this.B_re[1]=+0.7557853228;this.B_im[1]=0;this.B_re[2]=+0.249204646;this.B_im[2]=+0.003371507;this.B_re[3]=-0.001541739;this.B_im[3]=+0.04105856;this.B_re[4]=-0.10162907;this.B_im[4]=+0.01727609;this.B_re[5]=-0.26623489;this.B_im[5]=-0.36249218;this.B_re[6]=-0.6870983;this.B_im[6]=-1.1651967;this.C_re=new Array();this.C_im=new Array();this.C_re[1]=+1.3231270439;this.C_im[1]=0;this.C_re[2]=-0.577245789;this.C_im[2]=-0.007809598;this.C_re[3]=+0.508307513;this.C_im[3]=-0.112208952;this.C_re[4]=-0.15094762;this.C_im[4]=+0.18200602;this.C_re[5]=+1.01418179;this.C_im[5]=+1.64497696;this.C_re[6]=+1.9660549;this.C_im[6]=+2.5127645;this.D=new Array();this.D[1]=+1.5627014243;this.D[2]=+0.5185406398;this.D[3]=-0.03333098;this.D[4]=-0.1052906;this.D[5]=-0.0368594;this.D[6]=+0.007317;this.D[7]=+0.0122;this.D[8]=+0.00394;this.D[9]=-0.0013},forward:function(D){var C=D.x;var O=D.y;var R=O-this.lat0;var J=C-this.long0;var E=R/Proj4js.common.SEC_TO_RAD*0.00001;var B=J;var L=1;var I=0;for(n=1;n<=10;n++){L=L*E;I=I+this.A[n]*L}var K=I;var G=B;var M=1;var H=0;var Q;var F;var P=0;var N=0;for(n=1;n<=6;n++){Q=M*K-H*G;F=H*K+M*G;M=Q;H=F;P=P+this.B_re[n]*M-this.B_im[n]*H;N=N+this.B_im[n]*M+this.B_re[n]*H}x=(N*this.a)+this.x0;y=(P*this.a)+this.y0;D.x=x;D.y=y;return D},inverse:function(S){var P=S.x;var O=S.y;var W=P-this.x0;var V=O-this.y0;var N=V/this.a;var F=W/this.a;var J=1;var f=0;var G;var a;var K=0;var B=0;for(n=1;n<=6;n++){G=J*N-f*F;a=f*N+J*F;J=G;f=a;K=K+this.C_re[n]*J-this.C_im[n]*f;B=B+this.C_im[n]*J+this.C_re[n]*f}for(i=0;i<this.iterations;i++){var Q=K;var I=B;var U;var R;var D=N;var Z=F;for(n=2;n<=6;n++){U=Q*K-I*B;R=I*K+Q*B;Q=U;I=R;D=D+(n-1)*(this.B_re[n]*Q-this.B_im[n]*I);Z=Z+(n-1)*(this.B_im[n]*Q+this.B_re[n]*I)}Q=1;I=0;var C=this.B_re[1];var Y=this.B_im[1];for(n=2;n<=6;n++){U=Q*K-I*B;R=I*K+Q*B;Q=U;I=R;C=C+n*(this.B_re[n]*Q-this.B_im[n]*I);Y=Y+n*(this.B_im[n]*Q+this.B_re[n]*I)}var E=C*C+Y*Y;K=(D*C+Z*Y)/E;B=(Z*C-D*Y)/E}var T=K;var M=B;var b=1;var d=0;for(n=1;n<=9;n++){b=b*T;d=d+this.D[n]*b}var L=this.lat0+(d*Proj4js.common.SEC_TO_RAD*100000);var H=this.long0+M;S.x=H;S.y=L;return S}};Proj4js.defs["EPSG:32716"]="+proj=utm +zone=16 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4689"]="+title=IGN63 Hiva Oa +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:2987"]="+title=Saint Pierre et Miquelon 1950 / UTM zone 21N +proj=utm +zone=21 +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32601"]="+proj=utm +zone=1 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27561"]="+title=NTF (Paris) / Lambert Nord France +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["IGNF:MOOREA87"]="+title=Moorea 1987 +proj=geocent +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:3298"]="+title=RGPF / UTM zone 7S +proj=utm +zone=7 +south +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:32607"]="+proj=utm +zone=7 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32741"]="+proj=utm +zone=41 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32717"]="+proj=utm +zone=17 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27583"]="+title=NTF (Paris) / France III (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:32626"]="+proj=utm +zone=26 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGF93CC46"]="+title=Lambert conique conforme Zone 5 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.000000000 +lon_0=3.000000000 +lat_1=45.200000000 +lat_2=46.800000000 +x_0=1700000.000 +y_0=5200000.000 +units=m +no_defs";Proj4js.defs["EPSG:32707"]="+proj=utm +zone=7 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32614"]="+proj=utm +zone=14 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32721"]="+proj=utm +zone=21 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27574"]="+title=NTF (Paris) / Lambert zone IV +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:32735"]="+proj=utm +zone=35 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3042"]="+title=ETRS89 / ETRS-TM30 +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["IGNF:LAMB4"]="+title=Lambert IV +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=185861.369 +units=m +no_defs";Proj4js.Proj.sterea={dependsOn:"gauss",init:function(){Proj4js.Proj.gauss.init.apply(this);if(!this.rc){Proj4js.reportError("sterea:init:E_ERROR_0");return }this.sinc0=Math.sin(this.phic0);this.cosc0=Math.cos(this.phic0);this.R2=2*this.rc;if(!this.title){this.title="Oblique Stereographic Alternative"}},forward:function(B){B.x=Proj4js.common.adjust_lon(B.x-this.long0);Proj4js.Proj.gauss.forward.apply(this,[B]);sinc=Math.sin(B.y);cosc=Math.cos(B.y);cosl=Math.cos(B.x);k=this.k0*this.R2/(1+this.sinc0*sinc+this.cosc0*cosc*cosl);B.x=k*cosc*Math.sin(B.x);B.y=k*(this.cosc0*sinc-this.sinc0*cosc*cosl);B.x=this.a*B.x+this.x0;B.y=this.a*B.y+this.y0;return B},inverse:function(C){var D,B;C.x=(C.x-this.x0)/this.a;C.y=(C.y-this.y0)/this.a;C.x/=this.k0;C.y/=this.k0;if((rho=Math.sqrt(C.x*C.x+C.y*C.y))){c=2*Math.atan2(rho,this.R2);sinc=Math.sin(c);cosc=Math.cos(c);B=Math.asin(cosc*this.sinc0+C.y*sinc*this.cosc0/rho);D=Math.atan2(C.x*sinc,rho*this.cosc0*cosc-C.y*this.sinc0*sinc)}else{B=this.phic0;D=0}C.x=D;C.y=B;Proj4js.Proj.gauss.inverse.apply(this,[C]);C.x=Proj4js.common.adjust_lon(C.x+this.long0);return C}};Proj4js.defs["IGNF:CSG67UTM21"]="+title=Guyane CSG67 UTM fuseau 21 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:4624"]="+title=RGFG95 +proj=longlat +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:2975"]="+title=RGR92 / UTM zone 40S +proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.Proj.sinu={init:function(){this.R=6370997},forward:function(E){var B,G,C;var F=E.x;var D=E.y;C=Proj4js.common.adjust_lon(F-this.long0);B=this.R*C*Math.cos(D)+this.x0;G=this.R*D+this.y0;E.x=B;E.y=G;return E},inverse:function(D){var C,B,E;D.x-=this.x0;D.y-=this.y0;C=D.y/this.R;if(Math.abs(C)>Proj4js.common.HALF_PI){Proj4js.reportError("sinu:Inv:DataError")}B=Math.abs(C)-Proj4js.common.HALF_PI;if(Math.abs(B)>Proj4js.common.EPSLN){B=this.long0+D.x/(this.R*Math.cos(C));E=Proj4js.common.adjust_lon(B)}else{E=this.long0}D.x=E;D.y=C;return D}};Proj4js.defs["EPSG:32761"]="+proj=stere +lat_0=-90 +lat_ts=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27564"]="+title=NTF (Paris) / Lambert Corse +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:32744"]="+proj=utm +zone=44 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:2982"]="+title=IGN72 Grand Terre / UTM zone 58S (deprecated) +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:WGS84G"]="+title=World Geodetic System 1984 +proj=longlat +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:32702"]="+proj=utm +zone=2 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:REUN47GAUSSL"]="+title=Reunion Gauss Laborde +proj=gstmerc +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-21.116666667 +lon_0=55.533333333 +k_0=1.00000000 +x_0=160000.000 +y_0=50000.000 +units=m +no_defs";Proj4js.defs["EPSG:4150"]="+title=CH1903plus +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32746"]="+proj=utm +zone=46 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32651"]="+proj=utm +zone=51 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32644"]="+proj=utm +zone=44 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:LAMB1"]="+title=Lambert I +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs";Proj4js.defs["IGNF:WALL78"]="+title=Wallis-Uvea 1978 (MOP78) +proj=geocent +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:REUN47"]="+title=Reunion 1947 +proj=geocent +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:2970"]="+title=Guadeloupe 1948 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ";Proj4js.defs["EPSG:32753"]="+proj=utm +zone=53 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32638"]="+proj=utm +zone=38 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:MAYO50"]="+title=Mayotte Combani +proj=geocent +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:3170"]="+title=RGNC91-93 / UTM zone 58S +proj=utm +zone=58 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:UTM20W84MART"]="+title=World Geodetic System 1984 UTM fuseau 20 Nord-Martinique +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:3043"]="+title=ETRS89 / ETRS-TM31 +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:3165"]="+title=NEA74 Noumea / Noumea Lambert +proj=lcc +lat_1=-22.24469175 +lat_2=-22.29469175 +lat_0=-22.26969175 +lon_0=166.44242575 +x_0=0.66 +y_0=1.02 +ellps=intl +units=m +no_defs ";Proj4js.Proj.aea={init:function(){if(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN){Proj4js.reportError("aeaInitEqualLatitudes");return }this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e3=Math.sqrt(this.es);this.sin_po=Math.sin(this.lat1);this.cos_po=Math.cos(this.lat1);this.t1=this.sin_po;this.con=this.sin_po;this.ms1=Proj4js.common.msfnz(this.e3,this.sin_po,this.cos_po);this.qs1=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po);this.sin_po=Math.sin(this.lat2);this.cos_po=Math.cos(this.lat2);this.t2=this.sin_po;this.ms2=Proj4js.common.msfnz(this.e3,this.sin_po,this.cos_po);this.qs2=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po);this.sin_po=Math.sin(this.lat0);this.cos_po=Math.cos(this.lat0);this.t3=this.sin_po;this.qs0=Proj4js.common.qsfnz(this.e3,this.sin_po,this.cos_po);if(Math.abs(this.lat1-this.lat2)>Proj4js.common.EPSLN){this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1)}else{this.ns0=this.con}this.c=this.ms1*this.ms1+this.ns0*this.qs1;this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0},forward:function(F){var G=F.x;var E=F.y;this.sin_phi=Math.sin(E);this.cos_phi=Math.cos(E);var C=Proj4js.common.qsfnz(this.e3,this.sin_phi,this.cos_phi);var I=this.a*Math.sqrt(this.c-this.ns0*C)/this.ns0;var D=this.ns0*Proj4js.common.adjust_lon(G-this.long0);var B=I*Math.sin(D)+this.x0;var H=this.rh-I*Math.cos(D)+this.y0;F.x=B;F.y=H;return F},inverse:function(F){var H,B,C,D,G,E;F.x-=this.x0;F.y=this.rh-F.y+this.y0;if(this.ns0>=0){H=Math.sqrt(F.x*F.x+F.y*F.y);C=1}else{H=-Math.sqrt(F.x*F.x+F.y*F.y);C=-1}D=0;if(H!=0){D=Math.atan2(C*F.x,C*F.y)}C=H*this.ns0/this.a;B=(this.c-C*C)/this.ns0;if(this.e3>=1e-10){C=1-0.5*(1-this.es)*Math.log((1-this.e3)/(1+this.e3))/this.e3;if(Math.abs(Math.abs(C)-Math.abs(B))>1e-10){E=this.phi1z(this.e3,B)}else{if(B>=0){E=0.5*PI}else{E=-0.5*PI}}}else{E=this.phi1z(e3,B)}G=Proj4js.common.adjust_lon(D/this.ns0+this.long0);F.x=G;F.y=E;return F},phi1z:function(I,B){var C,D,E;var H=Proj4js.common.asinz(0.5*B);if(I<Proj4js.common.EPSLN){return H}var G=I*I;for(var F=1;F<=25;F++){sinphi=Math.sin(H);cosphi=Math.cos(H);C=I*sinphi;D=1-C*C;E=0.5*D*D/cosphi*(B/(1-G)-sinphi/D+0.5/I*Math.log((1-C)/(1+C)));H=H+E;if(Math.abs(E)<=1e-7){return H}}Proj4js.reportError("aea:phi1z:Convergence error");return null}};Proj4js.defs["EPSG:32661"]="+proj=stere +lat_0=90 +lat_ts=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:TAHI79"]="+title=IGN79 (Tahiti) Iles de la Societe +proj=geocent +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32743"]="+proj=utm +zone=43 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:STPM50"]="+title=St Pierre et Miquelon 1950 +proj=geocent +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs";Proj4js.defs["EPSG:32646"]="+proj=utm +zone=46 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.utm={dependsOn:"tmerc",init:function(){if(!this.zone){Proj4js.reportError("utm:init: zone must be specified for UTM");return }this.lat0=0;this.long0=((6*Math.abs(this.zone))-183)*Proj4js.common.D2R;this.x0=500000;this.y0=this.utmSouth?10000000:0;this.k0=0.9996;Proj4js.Proj.tmerc.init.apply(this);this.forward=Proj4js.Proj.tmerc.forward;this.inverse=Proj4js.Proj.tmerc.inverse}};Proj4js.Proj.equi={init:function(){if(!this.x0){this.x0=0}if(!this.y0){this.y0=0}if(!this.lat0){this.lat0=0}if(!this.long0){this.long0=0}},forward:function(E){var F=E.x;var D=E.y;var C=Proj4js.common.adjust_lon(F-this.long0);var B=this.x0+this.a*C*Math.cos(this.lat0);var G=this.y0+this.a*D;this.t1=B;this.t2=Math.cos(this.lat0);E.x=B;E.y=G;return E},inverse:function(C){C.x-=this.x0;C.y-=this.y0;var B=C.y/this.a;if(Math.abs(B)>Proj4js.common.HALF_PI){Proj4js.reportError("equi:Inv:DataError")}var D=Proj4js.common.adjust_lon(this.long0+C.x/(this.a*Math.cos(this.lat0)));C.x=D;C.y=B}};Proj4js.defs["EPSG:3044"]="+title=ETRS89 / ETRS-TM32 +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:25832"]="+title=ETRS89 / UTM zone 32N +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ";Proj4js.Proj.merc={init:function(){if(this.lat_ts){if(this.sphere){this.k0=Math.cos(this.lat_ts)}else{this.k0=Proj4js.common.msfnz(this.es,Math.sin(this.lat_ts),Math.cos(this.lat_ts))}}},forward:function(F){var G=F.x;var E=F.y;if(E*Proj4js.common.R2D>90&&E*Proj4js.common.R2D<-90&&G*Proj4js.common.R2D>180&&G*Proj4js.common.R2D<-180){Proj4js.reportError("merc:forward: llInputOutOfRange: "+G+" : "+E);return null}var B,H;if(Math.abs(Math.abs(E)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN){Proj4js.reportError("merc:forward: ll2mAtPoles");return null}else{if(this.sphere){B=this.x0+this.a*this.k0*Proj4js.common.adjust_lon(G-this.long0);H=this.y0+this.a*this.k0*Math.log(Math.tan(Proj4js.common.FORTPI+0.5*E))}else{var D=Math.sin(E);var C=Proj4js.common.tsfnz(this.e,E,D);B=this.x0+this.a*this.k0*Proj4js.common.adjust_lon(G-this.long0);H=this.y0-this.a*this.k0*Math.log(C)}F.x=B;F.y=H;return F}},inverse:function(E){var B=E.x-this.x0;var G=E.y-this.y0;var F,D;if(this.sphere){D=Proj4js.common.HALF_PI-2*Math.atan(Math.exp(-G/this.a*this.k0))}else{var C=Math.exp(-G/(this.a*this.k0));D=Proj4js.common.phi2z(this.e,C);if(D==-9999){Proj4js.reportError("merc:inverse: lat = -9999");return null}}F=Proj4js.common.adjust_lon(this.long0+B/(this.a*this.k0));E.x=F;E.y=D;return E}};Proj4js.defs["EPSG:32610"]="+proj=utm +zone=10 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32704"]="+proj=utm +zone=4 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32719"]="+proj=utm +zone=19 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32645"]="+proj=utm +zone=45 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32635"]="+proj=utm +zone=35 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.ortho={init:function(B){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0)},forward:function(D){var B,E;var L;var K;var F;var G;var C=D.x;var H=D.y;L=Proj4js.common.adjust_lon(C-this.long0);B=Math.sin(H);E=Math.cos(H);K=Math.cos(L);G=this.sin_p14*B+this.cos_p14*E*K;F=1;if((G>0)||(Math.abs(G)<=Proj4js.common.EPSLN)){var J=this.a*F*E*Math.sin(L);var I=this.y0+this.a*F*(this.cos_p14*B-this.sin_p14*E*K)}else{Proj4js.reportError("orthoFwdPointError")}D.x=J;D.y=I;return D},inverse:function(C){var H;var G;var E,J;var I;var D;var B,F;C.x-=this.x0;C.y-=this.y0;H=Math.sqrt(C.x*C.x+C.y*C.y);if(H>this.a+1e-7){Proj4js.reportError("orthoInvDataError")}G=Proj4js.common.asinz(H/this.a);E=Math.sin(G);J=Math.cos(G);B=this.long0;if(Math.abs(H)<=Proj4js.common.EPSLN){F=this.lat0}F=Proj4js.common.asinz(J*this.sin_p14+(C.y*E*this.cos_p14)/H);D=Math.abs(lat0)-Proj4js.common.HALF_PI;if(Math.abs(D)<=Proj4js.common.EPSLN){if(this.lat0>=0){B=Proj4js.common.adjust_lon(this.long0+Math.atan2(C.x,-C.y))}else{B=Proj4js.common.adjust_lon(this.long0-Math.atan2(-C.x,C.y))}}D=J-this.sin_p14*Math.sin(F);if((Math.abs(D)>=Proj4js.common.EPSLN)||(Math.abs(x)>=Proj4js.common.EPSLN)){B=Proj4js.common.adjust_lon(this.long0+Math.atan2((C.x*E*this.cos_p14),(D*H)))}C.x=B;C.y=F;return C}};Proj4js.defs["EPSG:32649"]="+proj=utm +zone=49 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3169"]="+title=RGNC91-93 / UTM zone 57S +proj=utm +zone=57 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:3035"]="+title=ETRS89 / ETRS-LAEA +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["IGNF:LAMB1C"]="+title=Lambert I Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=1200000.000 +units=m +no_defs";Proj4js.defs["EPSG:27563"]="+title=NTF (Paris) / Lambert Sud France +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:4637"]="+title=Perroud 1950 +proj=longlat +ellps=intl +towgs84=325,154,172,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:KERG62CAR"]="+title=Kerguelen - K0 +proj=geocent +towgs84=145.0000,-187.0000,103.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:GUADFM49GEO"]="+title=Guadeloupe Fort Marigot +proj=longlat +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:4645"]="+title=RGNC 1991 +proj=longlat +ellps=intl +towgs84=0,0,0,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:GUADFM49"]="+title=Guadeloupe Fort Marigot +proj=geocent +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:KERG62UTM42S"]="+title=Kerguelen 1962 +proj=tmerc +towgs84=145.0000,-187.0000,103.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32634"]="+proj=utm +zone=34 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4171"]="+title=RGF93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32642"]="+proj=utm +zone=42 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32619"]="+proj=utm +zone=19 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:MAYO50GEO"]="+title=Mayotte Combani +proj=longlat +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32612"]="+proj=utm +zone=12 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:MART38"]="+title=Martinique Fort-Desaix +proj=geocent +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32751"]="+proj=utm +zone=51 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:TERA50SPTA"]="+title=Terre Adelie Stereo polaire Terre Adelie +proj=sterea +towgs84=324.8000,153.6000,172.1000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-67.000000000 +lon_0=140.000000000 +k=1.00000000 +x_0=300000.000 +y_0=200000.000 +units=m +no_defs";Proj4js.defs["EPSG:3302"]="+title=IGN63 Hiva Oa / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["EPSG:27592"]="+title=NTF (Paris) / Centre France (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:32709"]="+proj=utm +zone=9 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.mill={init:function(){},forward:function(E){var F=E.x;var D=E.y;var C=Proj4js.common.adjust_lon(F-this.long0);var B=this.x0+this.a*C;var G=this.y0+this.a*Math.log(Math.tan((Proj4js.common.PI/4)+(D/2.5)))*1.25;E.x=B;E.y=G;return E},inverse:function(C){C.x-=this.x0;C.y-=this.y0;var D=Proj4js.common.adjust_lon(this.long0+C.x/this.a);var B=2.5*(Math.atan(Math.exp(0.8*C.y/this.a))-Proj4js.common.PI/4);C.x=D;C.y=B;return C}};Proj4js.defs["EPSG:32718"]="+proj=utm +zone=18 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32712"]="+proj=utm +zone=12 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3297"]="+title=RGPF / UTM zone 6S +proj=utm +zone=6 +south +ellps=GRS80 +units=m +no_defs ";Proj4js.Proj.vandg={init:function(){this.R=6370997},forward:function(D){var B=D.x;var M=D.y;var Q=Proj4js.common.adjust_lon(B-this.long0);var P,N;if(Math.abs(M)<=Proj4js.common.EPSLN){P=this.x0+this.R*Q;N=this.y0}var F=Proj4js.common.asinz(2*Math.abs(M/Proj4js.common.PI));if((Math.abs(Q)<=Proj4js.common.EPSLN)||(Math.abs(Math.abs(M)-Proj4js.common.HALF_PI)<=Proj4js.common.EPSLN)){P=this.x0;if(M>=0){N=this.y0+Proj4js.common.PI*this.R*Math.tan(0.5*F)}else{N=this.y0+Proj4js.common.PI*this.R*-Math.tan(0.5*F)}}var K=0.5*Math.abs((Proj4js.common.PI/Q)-(Q/Proj4js.common.PI));var E=K*K;var L=Math.sin(F);var J=Math.cos(F);var I=J/(L+J-1);var H=I*I;var G=I*(2/L-1);var O=G*G;var C=Proj4js.common.PI*this.R*(K*(I-O)+Math.sqrt(E*(I-O)*(I-O)-(O+E)*(H-O)))/(O+E);if(Q<0){C=-C}P=this.x0+C;C=Math.abs(C/(Proj4js.common.PI*this.R));if(M>=0){N=this.y0+Proj4js.common.PI*this.R*Math.sqrt(1-C*C-2*K*C)}else{N=this.y0-Proj4js.common.PI*this.R*Math.sqrt(1-C*C-2*K*C)}D.x=P;D.y=N;return D},inverse:function(E){var P;var B,L,O,I,H,G;var J,F;var D;var N;var C;var M;var K;E.x-=this.x0;E.y-=this.y0;C=Proj4js.common.PI*this.R;B=E.x/C;L=E.y/C;O=B*B+L*L;I=-Math.abs(L)*(1+O);H=I-2*L*L+B*B;G=-2*I+1+2*L*L+O*O;K=L*L/G+(2*H*H*H/G/G/G-9*I*H/G/G)/27;D=(I-H*H/3/G)/G;N=2*Math.sqrt(-D/3);C=((3*K)/D)/N;if(Math.abs(C)>1){if(C>=0){C=1}else{C=-1}}M=Math.acos(C)/3;if(E.y>=0){lat=(-N*Math.cos(M+Proj4js.common.PI/3)-H/3/G)*Proj4js.common.PI}else{lat=-(-N*Math.cos(M+PI/3)-H/3/G)*Proj4js.common.PI}if(Math.abs(B)<Proj4js.common.EPSLN){lon=this.long0}lon=Proj4js.common.adjust_lon(this.long0+Proj4js.common.PI*(O-1+Math.sqrt(1+2*(B*B-L*L)+O*O))/2/B);E.x=lon;E.y=lat;return E}};Proj4js.defs["EPSG:32730"]="+proj=utm +zone=30 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:IGN72"]="+title=IGN 1972 Grande-Terre / Ile des Pins +proj=geocent +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:3313"]="+title=RGFG95 / UTM zone 21N +proj=utm +zone=21 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ";Proj4js.defs["CRS:84"]="+title=WGS 84 longitude-latitude +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ";Proj4js.defs["IGNF:RGPF"]="+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:32647"]="+proj=utm +zone=47 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3163"]="+title=RGNC91-93 / Lambert New Caledonia +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:UTM39SW84"]="+title=World Geodetic System 1984 UTM fuseau 39 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:4641"]="+title=IGN53 Mare +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["IGNF:RRAF91"]="+title=RRAF 1991 (Reseau de Reference des Antilles Francaises) +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.Proj.stere={ssfn_:function(B,D,C){D*=C;return(Math.tan(0.5*(Proj4js.common.HALF_PI+B))*Math.pow((1-D)/(1+D),0.5*C))},TOL:1e-8,NITER:8,CONV:1e-10,S_POLE:0,N_POLE:1,OBLIQ:2,EQUIT:3,init:function(){this.phits=this.lat_ts?this.lat_ts:Proj4js.common.HALF_PI;var B=Math.abs(this.lat0);if((Math.abs(B)-Proj4js.common.HALF_PI)<Proj4js.common.EPSLN){this.mode=this.lat0<0?this.S_POLE:this.N_POLE}else{this.mode=B>Proj4js.common.EPSLN?this.OBLIQ:this.EQUIT}this.phits=Math.abs(this.phits);if(this.es){var C;switch(this.mode){case this.N_POLE:case this.S_POLE:if(Math.abs(this.phits-Proj4js.common.HALF_PI)<Proj4js.common.EPSLN){this.akm1=2*this.k0/Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e))}else{B=Math.sin(this.phits);this.akm1=Math.cos(this.phits)/Proj4js.common.tsfnz(this.e,this.phits,B);B*=this.e;this.akm1/=Math.sqrt(1-B*B)}break;case this.EQUIT:this.akm1=2*this.k0;break;case this.OBLIQ:B=Math.sin(this.lat0);C=2*Math.atan(this.ssfn_(this.lat0,B,this.e))-Proj4js.common.HALF_PI;B*=this.e;this.akm1=2*this.k0*Math.cos(this.lat0)/Math.sqrt(1-B*B);this.sinX1=Math.sin(C);this.cosX1=Math.cos(C);break}}else{switch(this.mode){case this.OBLIQ:this.sinph0=Math.sin(this.lat0);this.cosph0=Math.cos(this.lat0);case this.EQUIT:this.akm1=2*this.k0;break;case this.S_POLE:case this.N_POLE:this.akm1=Math.abs(this.phits-Proj4js.common.HALF_PI)>=Proj4js.common.EPSLN?Math.cos(this.phits)/Math.tan(Proj4js.common.FORTPI-0.5*this.phits):2*this.k0;break}}},forward:function(D){var C=D.x;C=Proj4js.common.adjust_lon(C-this.long0);var G=D.y;var J,H;if(this.sphere){var B,E,I,F;B=Math.sin(G);E=Math.cos(G);I=Math.cos(C);F=Math.sin(C);switch(this.mode){case this.EQUIT:H=1+E*I;if(H<=Proj4js.common.EPSLN){F_ERROR}H=this.akm1/H;J=H*E*F;H*=B;break;case this.OBLIQ:H=1+this.sinph0*B+this.cosph0*E*I;if(H<=Proj4js.common.EPSLN){F_ERROR}H=this.akm1/H;J=H*E*F;H*=this.cosph0*B-this.sinph0*E*I;break;case this.N_POLE:I=-I;G=-G;case this.S_POLE:if(Math.abs(G-Proj4js.common.HALF_PI)<this.TOL){F_ERROR}H=this.akm1*Math.tan(Proj4js.common.FORTPI+0.5*G);J=F*H;H*=I;break}}else{I=Math.cos(C);F=Math.sin(C);B=Math.sin(G);if(this.mode==this.OBLIQ||this.mode==this.EQUIT){X=2*Math.atan(this.ssfn_(G,B,this.e));sinX=Math.sin(X-Proj4js.common.HALF_PI);cosX=Math.cos(X)}switch(this.mode){case this.OBLIQ:A=this.akm1/(this.cosX1*(1+this.sinX1*sinX+this.cosX1*cosX*I));H=A*(this.cosX1*sinX-this.sinX1*cosX*I);J=A*cosX;break;case this.EQUIT:A=2*this.akm1/(1+cosX*I);H=A*sinX;J=A*cosX;break;case this.S_POLE:G=-G;I=-I;B=-B;case this.N_POLE:J=this.akm1*Proj4js.common.tsfnz(this.e,G,B);H=-J*I;break}J=J*F}D.x=J*this.a+this.x0;D.y=H*this.a+this.y0;return D},inverse:function(D){var P=(D.x-this.x0)/this.a;var M=(D.y-this.y0)/this.a;var C,L;var H,B,O=0,E=0,N,G=0,J=0;var I;if(this.sphere){var K,Q,F,R;Q=Math.sqrt(P*P+M*M);K=2*Math.atan(Q/this.akm1);F=Math.sin(K);R=Math.cos(K);C=0;switch(this.mode){case this.EQUIT:if(Math.abs(Q)<=Proj4js.common.EPSLN){L=0}else{L=Math.asin(M*F/Q)}if(R!=0||P!=0){C=Math.atan2(P*F,R*Q)}break;case this.OBLIQ:if(Math.abs(Q)<=Proj4js.common.EPSLN){L=this.phi0}else{L=Math.asin(R*sinph0+M*F*cosph0/Q)}K=R-sinph0*Math.sin(L);if(K!=0||P!=0){C=Math.atan2(P*F*cosph0,K*Q)}break;case this.N_POLE:M=-M;case this.S_POLE:if(Math.abs(Q)<=Proj4js.common.EPSLN){L=this.phi0}else{L=Math.asin(this.mode==this.S_POLE?-R:R)}C=(P==0&&M==0)?0:Math.atan2(P,M);break}}else{N=Math.sqrt(P*P+M*M);switch(this.mode){case this.OBLIQ:case this.EQUIT:O=2*Math.atan2(N*this.cosX1,this.akm1);H=Math.cos(O);B=Math.sin(O);if(N==0){E=Math.asin(H*this.sinX1)}else{E=Math.asin(H*this.sinX1+(M*B*this.cosX1/N))}O=Math.tan(0.5*(Proj4js.common.HALF_PI+E));P*=B;M=N*this.cosX1*H-M*this.sinX1*B;J=Proj4js.common.HALF_PI;G=0.5*this.e;break;case this.N_POLE:M=-M;case this.S_POLE:O=-N/this.akm1;E=Proj4js.common.HALF_PI-2*Math.atan(O);J=-Proj4js.common.HALF_PI;G=-0.5*this.e;break}for(I=this.NITER;I--;E=L){B=this.e*Math.sin(E);L=2*Math.atan(O*Math.pow((1+B)/(1-B),G))-J;if(Math.abs(E-L)<this.CONV){if(this.mode==this.S_POLE){L=-L}C=(P==0&&M==0)?0:Math.atan2(P,M);D.x=Proj4js.common.adjust_lon(C+this.long0);D.y=L;return D}}}}};Proj4js.defs["IGNF:GEOPORTALPYF"]="+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32760"]="+proj=utm +zone=60 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:25830"]="+title=ETRS89 / UTM zone 30N +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:32749"]="+proj=utm +zone=49 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32622"]="+proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32725"]="+proj=utm +zone=25 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:2213"]="+title=ETRS89 / TM 30 NE +proj=tmerc +lat_0=0 +lon_0=30 +k=0.9996 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:3172"]="+title=IGN53 Mare / UTM zone 59S +proj=utm +zone=59 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:RGR92"]="+title=Reseau geodesique Reunion 1992 +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:4149"]="+title=CH1903 +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:NTF"]="+title=Nouvelle Triangulation Francaise +proj=geocent +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs";Proj4js.defs["EPSG:4630"]="+title=IGN72 Nuku Hiva +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:4632"]="+title=Combani 1950 +proj=longlat +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:2971"]="+title=CSG67 / UTM zone 22N +proj=utm +zone=22 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:3166"]="+title=NEA74 Noumea / Noumea Lambert 2 +proj=lcc +lat_1=-22.24472222222222 +lat_2=-22.29472222222222 +lat_0=-22.26972222222222 +lon_0=166.4425 +x_0=8.313000000000001 +y_0=-2.354 +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:WGS84RRAFGEO"]="+title=Reseau de reference des Antilles francaises (1988-1991) +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:32734"]="+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32710"]="+proj=utm +zone=10 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGM04GEO"]="+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:2056"]="+title=CH1903+ / LV95 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32756"]="+proj=utm +zone=56 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:MOOREA87U6S"]="+title=Moorea 1987 - UTM fuseau 6 Sud +proj=tmerc +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32604"]="+proj=utm +zone=4 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32620"]="+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGNCGEO"]="+title=Reseau Geodesique de Nouvelle-Caledonie +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:4622"]="+title=Guadeloupe 1948 +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["IGNF:RGPFUTM7S"]="+title=RGPF - UTM fuseau 7 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:KERG62GEO"]="+title=Kerguelen - K0 +proj=longlat +towgs84=145.0000,-187.0000,103.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32625"]="+proj=utm +zone=25 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:TAHAA"]="+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=geocent +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32752"]="+proj=utm +zone=52 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32641"]="+proj=utm +zone=41 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32623"]="+proj=utm +zone=23 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32758"]="+proj=utm +zone=58 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:2973"]="+title=Martinique 1938 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ";Proj4js.defs["EPSG:32724"]="+proj=utm +zone=24 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32736"]="+proj=utm +zone=36 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32759"]="+proj=utm +zone=59 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:GEOPORTALSPA"]="+title=Geoportail - Saint-Paul et Amsterdam +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:LAMB4C"]="+title=Lambert IV Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=4185861.369 +units=m +no_defs";Proj4js.defs["IGNF:RGF93CC49"]="+title=Lambert conique conforme Zone 8 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=49.000000000 +lon_0=3.000000000 +lat_1=48.200000000 +lat_2=49.800000000 +x_0=1700000.000 +y_0=8200000.000 +units=m +no_defs";Proj4js.defs["EPSG:32662"]="+title=WGS 84 / Plate Carree +proj=eqc +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.gnom={init:function(B){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1000*this.a},forward:function(D){var B,E;var J;var I;var F;var G;var C=D.x;var H=D.y;J=Proj4js.common.adjust_lon(C-this.long0);B=Math.sin(H);E=Math.cos(H);I=Math.cos(J);G=this.sin_p14*B+this.cos_p14*E*I;F=1;if((G>0)||(Math.abs(G)<=Proj4js.common.EPSLN)){x=this.x0+this.a*F*E*Math.sin(J)/G;y=this.y0+this.a*F*(this.cos_p14*B-this.sin_p14*E*I)/G}else{Proj4js.reportError("orthoFwdPointError");x=this.x0+this.infinity_dist*E*Math.sin(J);y=this.y0+this.infinity_dist*(this.cos_p14*B-this.sin_p14*E*I)}D.x=x;D.y=y;return D},inverse:function(F){var B;var H;var C,D;var I;var G,E;F.x=(F.x-this.x0)/this.a;F.y=(F.y-this.y0)/this.a;F.x/=this.k0;F.y/=this.k0;if((B=Math.sqrt(F.x*F.x+F.y*F.y))){I=Math.atan2(B,this.rc);C=Math.sin(I);D=Math.cos(I);E=Proj4js.common.asinz(D*this.sin_p14+(F.y*C*this.cos_p14)/B);G=Math.atan2(F.x*C,B*this.cos_p14*D-F.y*this.sin_p14*C);G=Proj4js.common.adjust_lon(this.long0+G)}else{E=this.phic0;G=0}F.x=G;F.y=E;return F}};Proj4js.Proj.lcc={init:function(){if(!this.lat2){this.lat2=this.lat0}if(!this.k0){this.k0=1}if(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN){Proj4js.reportError("lcc:init: Equal Latitudes");return }var K=this.b/this.a;this.e=Math.sqrt(1-K*K);var H=Math.sin(this.lat1);var F=Math.cos(this.lat1);var J=Proj4js.common.msfnz(this.e,H,F);var C=Proj4js.common.tsfnz(this.e,this.lat1,H);var G=Math.sin(this.lat2);var E=Math.cos(this.lat2);var I=Proj4js.common.msfnz(this.e,G,E);var B=Proj4js.common.tsfnz(this.e,this.lat2,G);var D=Proj4js.common.tsfnz(this.e,this.lat0,Math.sin(this.lat0));if(Math.abs(this.lat1-this.lat2)>Proj4js.common.EPSLN){this.ns=Math.log(J/I)/Math.log(C/B)}else{this.ns=H}this.f0=J/(this.ns*Math.pow(C,this.ns));this.rh=this.a*this.f0*Math.pow(D,this.ns);if(!this.title){this.title="Lambert Conformal Conic"}},forward:function(F){var G=F.x;var E=F.y;if(E<=90&&E>=-90&&G<=180&&G>=-180){}else{Proj4js.reportError("lcc:forward: llInputOutOfRange: "+G+" : "+E);return null}var B=Math.abs(Math.abs(E)-Proj4js.common.HALF_PI);var D,H;if(B>Proj4js.common.EPSLN){D=Proj4js.common.tsfnz(this.e,E,Math.sin(E));H=this.a*this.f0*Math.pow(D,this.ns)}else{B=E*this.ns;if(B<=0){Proj4js.reportError("lcc:forward: No Projection");return null}H=0}var C=this.ns*Proj4js.common.adjust_lon(G-this.long0);F.x=this.k0*(H*Math.sin(C))+this.x0;F.y=this.k0*(this.rh-H*Math.cos(C))+this.y0;return F},inverse:function(F){var H,B,D;var E,G;x=(F.x-this.x0)/this.k0;y=(this.rh-(F.y-this.y0)/this.k0);if(this.ns>0){H=Math.sqrt(x*x+y*y);B=1}else{H=-Math.sqrt(x*x+y*y);B=-1}var C=0;if(H!=0){C=Math.atan2((B*x),(B*y))}if((H!=0)||(this.ns>0)){B=1/this.ns;D=Math.pow((H/(this.a*this.f0)),B);E=Proj4js.common.phi2z(this.e,D);if(E==-9999){return null}}else{E=-Proj4js.common.HALF_PI}G=Proj4js.common.adjust_lon(C/this.ns+this.long0);F.x=G;F.y=E;return F}};Proj4js.defs["EPSG:32624"]="+proj=utm +zone=24 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3395"]="+title=WGS 84 / World Mercator +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32606"]="+proj=utm +zone=6 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32706"]="+proj=utm +zone=6 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:UTM20W84GUAD"]="+title=World Geodetic System 1984 UTM fuseau 20 Nord-Guadeloupe +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:WGS84"]="+title=World Geodetic System 1984 +proj=geocent +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["IGNF:GEOPORTALSPM"]="+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:RGNC"]="+title=Reseau Geodesique de Nouvelle-Caledonie +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["IGNF:GEOPORTALWLF"]="+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:LAMB3C"]="+title=Lambert III Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=3200000.000 +units=m +no_defs";Proj4js.defs["EPSG:4626"]="+title=Reunion 1947 +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["IGNF:IGN63"]="+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=geocent +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:4749"]="+title=RGNC91-93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:UTM22RGFG95"]="+title=RGFG95 UTM fuseau 22 Nord-Guyane +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32617"]="+proj=utm +zone=17 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.eqc={init:function(){if(!this.x0){this.x0=0}if(!this.y0){this.y0=0}if(!this.lat0){this.lat0=0}if(!this.long0){this.long0=0}if(!this.lat_ts){this.lat_ts=0}if(!this.title){this.title="Equidistant Cylindrical (Plate Carre)"}this.rc=Math.cos(this.lat_ts)},forward:function(E){var F=E.x;var D=E.y;var C=Proj4js.common.adjust_lon(F-this.long0);var B=Proj4js.common.adjust_lat(D-this.lat0);E.x=this.x0+(this.a*C*this.rc);E.y=this.y0+(this.a*B);return E},inverse:function(C){var B=C.x;var D=C.y;C.x=Proj4js.common.adjust_lon(this.long0+((B-this.x0)/(this.a*this.rc)));C.y=Proj4js.common.adjust_lat(this.lat0+((D-this.y0)/(this.a)));return C}};Proj4js.defs["EPSG:32708"]="+proj=utm +zone=8 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGF93"]="+title=Reseau geodesique francais 1993 +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:32621"]="+proj=utm +zone=21 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGFG95GEO"]="+title=Reseau geodesique francais de Guyane 1995 +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.Proj.somerc={init:function(){var C=this.lat0;this.lambda0=this.long0;var B=Math.sin(C);var E=this.a;var D=this.rf;var F=1/D;var H=2*F-Math.pow(F,2);var G=this.e=Math.sqrt(H);this.R=E*Math.sqrt(1-H)/(1-H*Math.pow(B,2));this.alpha=Math.sqrt(1+H/(1-H)*Math.pow(Math.cos(C),4));this.b0=Math.asin(B/this.alpha);this.K=Math.log(Math.tan(Math.PI/4+this.b0/2))-this.alpha*Math.log(Math.tan(Math.PI/4+C/2))+this.alpha*G/2*Math.log((1+G*B)/(1-G*B))},forward:function(F){var J=Math.log(Math.tan(Math.PI/4-F.y/2));var G=this.e/2*Math.log((1+this.e*Math.sin(F.y))/(1-this.e*Math.sin(F.y)));var D=-this.alpha*(J+G)+this.K;var B=2*(Math.atan(Math.exp(D))-Math.PI/4);var C=this.alpha*(F.x-this.lambda0);var H=Math.atan(Math.sin(C)/(Math.sin(this.b0)*Math.tan(B)+Math.cos(this.b0)*Math.cos(C)));var E=Math.asin(Math.cos(this.b0)*Math.sin(B)-Math.sin(this.b0)*Math.cos(B)*Math.cos(C));F.y=this.R/2*Math.log((1+Math.sin(E))/(1-Math.sin(E)))+this.y0;F.x=this.R*H+this.x0;return F},inverse:function(D){var C=D.x-this.x0;var E=D.y-this.y0;var M=C/this.R;var F=2*(Math.atan(Math.exp(E/this.R))-Math.PI/4);var K=Math.asin(Math.cos(this.b0)*Math.sin(F)+Math.sin(this.b0)*Math.cos(F)*Math.cos(M));var L=Math.atan(Math.sin(M)/(Math.cos(this.b0)*Math.cos(M)-Math.sin(this.b0)*Math.tan(F)));var J=this.lambda0+L/this.alpha;var H=0;var N=K;var B=-1000;var G=0;while(Math.abs(N-B)>1e-7){if(++G>20){Proj4js.reportError("omercFwdInfinity");return }H=1/this.alpha*(Math.log(Math.tan(Math.PI/4+K/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(N))/2));B=N;N=2*Math.atan(Math.exp(H))-Math.PI/2}D.x=J;D.y=N;return D}};Proj4js.defs["EPSG:4634"]="+title=IGN72 Grand Terre +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["IGNF:NTFP"]="+title=Nouvelle Triangulation Francaise Paris grades +proj=longlat +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +units=m +no_defs";Proj4js.defs["EPSG:4275"]="+title=NTF +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +no_defs ";Proj4js.Proj.moll={init:function(){},forward:function(D){var B=D.x;var I=D.y;var G=Proj4js.common.adjust_lon(B-this.long0);var F=I;var E=Proj4js.common.PI*Math.sin(I);for(var H=0;true;H++){var C=-(F+Math.sin(F)-E)/(1+Math.cos(F));F+=C;if(Math.abs(C)<Proj4js.common.EPSLN){break}if(H>=50){Proj4js.reportError("moll:Fwd:IterationError")}}F/=2;if(Proj4js.common.PI/2-Math.abs(I)<Proj4js.common.EPSLN){G=0}var K=0.900316316158*this.a*G*Math.cos(F)+this.x0;var J=1.4142135623731*this.a*Math.sin(F)+this.y0;D.x=K;D.y=J;return D},inverse:function(E){var C;var B;E.x-=this.x0;var B=E.y/(1.4142135623731*this.a);if(Math.abs(B)>0.999999999999){B=0.999999999999}var C=Math.asin(B);var F=Proj4js.common.adjust_lon(this.long0+(E.x/(0.900316316158*this.a*Math.cos(C))));if(F<(-Proj4js.common.PI)){F=-Proj4js.common.PI}if(F>Proj4js.common.PI){F=Proj4js.common.PI}B=(2*C+Math.sin(2*C))/Proj4js.common.PI;if(Math.abs(B)>1){B=1}var D=Math.asin(B);E.x=F;E.y=D;return E}};Proj4js.defs["EPSG:32713"]="+proj=utm +zone=13 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32656"]="+proj=utm +zone=56 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:CROZ63GEO"]="+title=Crozet 1963 +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:2995"]="+title=IGN53 Mare / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ";Proj4js.Proj.aeqd={init:function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)},forward:function(D){var C=D.x;var I=D.y;var F;var B=Math.sin(D.y);var E=Math.cos(D.y);var K=Proj4js.common.adjust_lon(C-this.long0);var J=Math.cos(K);var G=this.sin_p12*B+this.cos_p12*E*J;if(Math.abs(Math.abs(G)-1)<Proj4js.common.EPSLN){F=1;if(G<0){Proj4js.reportError("aeqd:Fwd:PointError");return }}else{var H=Math.acos(G);F=H/Math.sin(H)}D.x=this.x0+this.a*F*E*Math.sin(K);D.y=this.y0+this.a*F*(this.cos_p12*B-this.sin_p12*E*J);return D},inverse:function(C){C.x-=this.x0;C.y-=this.y0;var H=Math.sqrt(C.x*C.x+C.y*C.y);if(H>(2*Proj4js.common.HALF_PI*this.a)){Proj4js.reportError("aeqdInvDataError");return }var F=H/this.a;var E=Math.sin(F);var J=Math.cos(F);var B=this.long0;var G;if(Math.abs(H)<=Proj4js.common.EPSLN){G=this.lat0}else{G=Proj4js.common.asinz(J*this.sin_p12+(C.y*E*this.cos_p12)/H);var D=Math.abs(this.lat0)-Proj4js.common.HALF_PI;if(Math.abs(D)<=Proj4js.common.EPSLN){if(lat0>=0){B=Proj4js.common.adjust_lon(this.long0+Math.atan2(C.x,-C.y))}else{B=Proj4js.common.adjust_lon(this.long0-Math.atan2(-C.x,C.y))}}else{D=J-this.sin_p12*Math.sin(G);if((Math.abs(D)<Proj4js.common.EPSLN)&&(Math.abs(C.x)<Proj4js.common.EPSLN)){}else{var I=Math.atan2((C.x*E*this.cos_p12),(D*H));B=Proj4js.common.adjust_lon(this.long0+Math.atan2((C.x*E*this.cos_p12),(D*H)))}}}C.x=B;C.y=G;return C}};Proj4js.defs["EPSG:32731"]="+proj=utm +zone=31 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:25831"]="+title=ETRS89 / UTM zone 31N +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["IGNF:MART38UTM20"]="+title=Martinique Fort-Desaix +proj=tmerc +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:CROZ63"]="+title=Crozet 1963 +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:4662"]="+title=IGN72 Grande Terre +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:32613"]="+proj=utm +zone=13 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32633"]="+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:WALL78UTM1S"]="+title=Wallis-Uvea 1978 (MOP78) UTM 1 SUD +proj=tmerc +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:NUKU72GEO"]="+title=IGN 1972 Nuku Hiva +proj=longlat +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:WALL78GEO"]="+title=Wallis - Uvea 1978 (MOP78) +proj=longlat +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.Proj.laea={S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4,init:function(){var B=Math.abs(this.lat0);if(Math.abs(B-Proj4js.common.HALF_PI)<Proj4js.common.EPSLN){this.mode=this.lat0<0?this.S_POLE:this.N_POLE}else{if(Math.abs(B)<Proj4js.common.EPSLN){this.mode=this.EQUIT}else{this.mode=this.OBLIQ}}if(this.es>0){var C;this.qp=Proj4js.common.qsfnz(this.e,1);this.mmf=0.5/(1-this.es);this.apa=this.authset(this.es);switch(this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(0.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=0.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(0.5*this.qp);C=Math.sin(this.lat0);this.sinb1=Proj4js.common.qsfnz(this.e,C)/this.qp;this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1);this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*C*C)*this.rq*this.cosb1);this.ymf=(this.xmf=this.rq)/this.dd;this.xmf*=this.dd;break}}else{if(this.mode==this.OBLIQ){this.sinph0=Math.sin(this.lat0);this.cosph0=Math.cos(this.lat0)}}},forward:function(E){var M,K;var N=E.x;var I=E.y;N=Proj4js.common.adjust_lon(N-this.long0);if(this.sphere){var L,G,C;C=Math.sin(I);G=Math.cos(I);L=Math.cos(N);switch(this.mode){case this.EQUIT:K=(this.mode==this.EQUIT)?1+G*L:1+this.sinph0*C+this.cosph0*G*L;if(K<=Proj4js.common.EPSLN){Proj4js.reportError("laea:fwd:y less than eps");return null}K=Math.sqrt(2/K);M=K*G*Math.sin(N);K*=(this.mode==this.EQUIT)?C:this.cosph0*C-this.sinph0*G*L;break;case this.N_POLE:L=-L;case this.S_POLE:if(Math.abs(I+this.phi0)<Proj4js.common.EPSLN){Proj4js.reportError("laea:fwd:phi < eps");return null}K=Proj4js.common.FORTPI-I*0.5;K=2*((this.mode==this.S_POLE)?Math.cos(K):Math.sin(K));M=K*Math.sin(N);K*=L;break}}else{var L,H,C,D,F=0,B=0,J=0;L=Math.cos(N);H=Math.sin(N);C=Math.sin(I);D=Proj4js.common.qsfnz(this.e,C);if(this.mode==this.OBLIQ||this.mode==this.EQUIT){F=D/this.qp;B=Math.sqrt(1-F*F)}switch(this.mode){case this.OBLIQ:J=1+this.sinb1*F+this.cosb1*B*L;break;case this.EQUIT:J=1+B*L;break;case this.N_POLE:J=Proj4js.common.HALF_PI+I;D=this.qp-D;break;case this.S_POLE:J=I-Proj4js.common.HALF_PI;D=this.qp+D;break}if(Math.abs(J)<Proj4js.common.EPSLN){Proj4js.reportError("laea:fwd:b < eps");return null}switch(this.mode){case this.OBLIQ:case this.EQUIT:J=Math.sqrt(2/J);if(this.mode==this.OBLIQ){K=this.ymf*J*(this.cosb1*F-this.sinb1*B*L)}else{K=(J=Math.sqrt(2/(1+B*L)))*F*this.ymf}M=this.xmf*J*B*H;break;case this.N_POLE:case this.S_POLE:if(D>=0){M=(J=Math.sqrt(D))*H;K=L*((this.mode==this.S_POLE)?J:-J)}else{M=K=0}break}}E.x=this.a*M+this.x0;E.y=this.a*K+this.y0;return E},inverse:function(C){C.x-=this.x0;C.y-=this.y0;var I=C.x/this.a;var G=C.y/this.a;if(this.sphere){var M=0,K,D=0;K=Math.sqrt(I*I+G*G);var F=K*0.5;if(F>1){Proj4js.reportError("laea:Inv:DataError");return null}F=2*Math.asin(F);if(this.mode==this.OBLIQ||this.mode==this.EQUIT){D=Math.sin(F);M=Math.cos(F)}switch(this.mode){case this.EQUIT:F=(Math.abs(K)<=Proj4js.common.EPSLN)?0:Math.asin(G*D/K);I*=D;G=M*K;break;case this.OBLIQ:F=(Math.abs(K)<=Proj4js.common.EPSLN)?this.phi0:Math.asin(M*sinph0+G*D*cosph0/K);I*=D*cosph0;G=(M-Math.sin(F)*sinph0)*K;break;case this.N_POLE:G=-G;F=Proj4js.common.HALF_PI-F;break;case this.S_POLE:F-=Proj4js.common.HALF_PI;break}lam=(G==0&&(this.mode==this.EQUIT||this.mode==this.OBLIQ))?0:Math.atan2(I,G)}else{var J,E,B,H,L=0;switch(this.mode){case this.EQUIT:case this.OBLIQ:I/=this.dd;G*=this.dd;H=Math.sqrt(I*I+G*G);if(H<Proj4js.common.EPSLN){C.x=0;C.y=this.phi0;return C}E=2*Math.asin(0.5*H/this.rq);J=Math.cos(E);I*=(E=Math.sin(E));if(this.mode==this.OBLIQ){L=J*this.sinb1+G*E*this.cosb1/H;B=this.qp*L;G=H*this.cosb1*J-G*this.sinb1*E}else{L=G*E/H;B=this.qp*L;G=H*J}break;case this.N_POLE:G=-G;case this.S_POLE:B=(I*I+G*G);if(!B){C.x=0;C.y=this.phi0;return C}L=1-B/this.qp;if(this.mode==this.S_POLE){L=-L}break}lam=Math.atan2(I,G);F=this.authlat(Math.asin(L),this.apa)}C.x=Proj4js.common.adjust_lon(this.long0+lam);C.y=F;return C},P00:0.3333333333333333,P01:0.17222222222222222,P02:0.10257936507936508,P10:0.06388888888888888,P11:0.0664021164021164,P20:0.016415012942191543,authset:function(C){var B;var D=new Array();D[0]=C*this.P00;B=C*C;D[0]+=B*this.P01;D[1]=B*this.P10;B*=C;D[0]+=B*this.P02;D[1]+=B*this.P11;D[2]=B*this.P20;return D},authlat:function(C,D){var B=C+C;return(C+D[0]*Math.sin(B)+D[1]*Math.sin(B+B)+D[2]*Math.sin(B+B+B))}};Proj4js.defs["EPSG:4322"]="+title=WGS 72 +proj=longlat +ellps=WGS72 +no_defs ";Proj4js.defs["EPSG:2990"]="+title=Reunion 1947 / TM Reunion (deprecated) +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=50000 +y_0=160000 +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:NTFG"]="+title=Nouvelle Triangulation Francaise Greenwich degres sexagesimaux +proj=longlat +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs";Proj4js.defs["IGNF:RGF93G"]="+title=Reseau geodesique francais 1993 +proj=longlat +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:4633"]="+title=IGN56 Lifou +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:32660"]="+proj=utm +zone=60 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:IGN63UTM7S"]="+title=IGN 1963 - Hiva Oa, Tahuata, Mohotani - UTM fuseau 7 Sud +proj=tmerc +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:REUN47GEO"]="+title=Reunion 1947 +proj=longlat +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32727"]="+proj=utm +zone=27 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:CROZ63UTM39S"]="+title=Crozet 1963 +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32757"]="+proj=utm +zone=57 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32711"]="+proj=utm +zone=11 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:2981"]="+title=IGN56 Lifou / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:TERA50GEO"]="+title=Pointe Geologie - Perroud 1950 +proj=longlat +towgs84=324.8000,153.6000,172.1000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:4235"]="+title=Guyane Francaise +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:32627"]="+proj=utm +zone=27 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.tmerc={init:function(){this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.ml0=this.a*Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(C){var B=C.x;var L=C.y;var F=Proj4js.common.adjust_lon(B-this.long0);var D;var Q,O;var P=Math.sin(L);var J=Math.cos(L);if(this.sphere){var N=J*Math.sin(F);if((Math.abs(Math.abs(N)-1))<1e-10){Proj4js.reportError("tmerc:forward: Point projects into infinity");return(93)}else{Q=0.5*this.a*this.k0*Math.log((1+N)/(1-N));D=Math.acos(J*Math.cos(F)/Math.sqrt(1-N*N));if(L<0){D=-D}O=this.a*this.k0*(D-this.lat0)}}else{var I=J*F;var H=Math.pow(I,2);var K=this.ep2*Math.pow(J,2);var M=Math.tan(L);var R=Math.pow(M,2);D=1-this.es*Math.pow(P,2);var E=this.a/Math.sqrt(D);var G=this.a*Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,L);Q=this.k0*E*I*(1+H/6*(1-R+K+H/20*(5-18*R+Math.pow(R,2)+72*K-58*this.ep2)))+this.x0;O=this.k0*(G-this.ml0+E*M*(H*(0.5+H/24*(5-R+9*K+4*Math.pow(K,2)+H/30*(61-58*R+Math.pow(R,2)+600*K-330*this.ep2)))))+this.y0}C.x=Q;C.y=O;return C},inverse:function(P){var F,D;var Z;var R;var I=6;var H,E;if(this.sphere){var U=Math.exp(P.x/(this.a*this.k0));var T=0.5*(U-1/U);var W=this.lat0+P.y/(this.a*this.k0);var S=Math.cos(W);F=Math.sqrt((1-S*S)/(1+T*T));H=Proj4js.common.asinz(F);if(W<0){H=-H}if((T==0)&&(S==0)){E=this.long0}else{E=Proj4js.common.adjust_lon(Math.atan2(T,S)+this.long0)}}else{var K=P.x-this.x0;var J=P.y-this.y0;F=(this.ml0+J/this.k0)/this.a;D=F;for(R=0;true;R++){Z=((F+this.e1*Math.sin(2*D)-this.e2*Math.sin(4*D)+this.e3*Math.sin(6*D))/this.e0)-D;D+=Z;if(Math.abs(Z)<=Proj4js.common.EPSLN){break}if(R>=I){Proj4js.reportError("tmerc:inverse: Latitude failed to converge");return(95)}}if(Math.abs(D)<Proj4js.common.HALF_PI){var C=Math.sin(D);var a=Math.cos(D);var L=Math.tan(D);var Y=this.ep2*Math.pow(a,2);var G=Math.pow(Y,2);var M=Math.pow(L,2);var B=Math.pow(M,2);F=1-this.es*Math.pow(C,2);var Q=this.a/Math.sqrt(F);var N=Q*(1-this.es)/F;var V=K/(Q*this.k0);var O=Math.pow(V,2);H=D-(Q*L*O/N)*(0.5-O/24*(5+3*M+10*Y-4*G-9*this.ep2-O/30*(61+90*M+298*Y+45*B-252*this.ep2-3*G)));E=Proj4js.common.adjust_lon(this.long0+(V*(1-O/6*(1+2*M+Y-O/20*(5-2*Y+28*M-3*G+8*this.ep2+24*B)))/a))}else{H=Proj4js.common.HALF_PI*Proj4js.common.sign(J);E=this.long0}}P.x=E;P.y=H;return P}};Proj4js.defs["EPSG:4258"]="+title=ETRS89 +proj=longlat +ellps=GRS80 +no_defs ";Proj4js.defs["EPSG:32611"]="+proj=utm +zone=11 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:TAHAAGEO"]="+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=longlat +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:RGF93CC50"]="+title=Lambert conique conforme Zone 9 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=50.000000000 +lon_0=3.000000000 +lat_1=49.200000000 +lat_2=50.800000000 +x_0=1700000.000 +y_0=9200000.000 +units=m +no_defs";Proj4js.defs["EPSG:32729"]="+proj=utm +zone=29 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:21781"]="+title=CH1903 / LV03 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32722"]="+proj=utm +zone=22 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3305"]="+title=Moorea 87 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +units=m +no_defs ";Proj4js.defs["EPSG:32659"]="+proj=utm +zone=59 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32648"]="+proj=utm +zone=48 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4627"]="+title=RGR92 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:MART38GEO"]="+title=Martinique Fort-Desaix +proj=longlat +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:27594"]="+title=NTF (Paris) / Corse (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["IGNF:RGF93CC42"]="+title=Lambert conique conforme Zone 1 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=42.000000000 +lon_0=3.000000000 +lat_1=41.200000000 +lat_2=42.800000000 +x_0=1700000.000 +y_0=1200000.000 +units=m +no_defs";Proj4js.defs["EPSG:32643"]="+proj=utm +zone=43 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:XGEO"]="+title=Systeme CIO-BIH +proj=longlat +towgs84=0.0000,0.0000,0.5000,0.0000,0.0000,0.0140,-0.100000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:4807"]="+title=NTF (Paris) +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +no_defs ";Proj4js.defs["EPSG:2972"]="+title=RGFG95 / UTM zone 22N +proj=utm +zone=22 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32654"]="+proj=utm +zone=54 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:GUAD48UTM20"]="+title=Guadeloupe Ste Anne +proj=tmerc +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:RGF93CC45"]="+title=Lambert conique conforme Zone 4 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=45.000000000 +lon_0=3.000000000 +lat_1=44.200000000 +lat_2=45.800000000 +x_0=1700000.000 +y_0=4200000.000 +units=m +no_defs";Proj4js.defs["EPSG:4623"]="+title=CSG67 +proj=longlat +ellps=intl +towgs84=-186,230,110,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:GEOPORTALMYT"]="+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32628"]="+proj=utm +zone=28 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:4629"]="+title=Tahaa 54 +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:4628"]="+title=Tahiti 52 +proj=longlat +ellps=intl +towgs84=162,117,154,0,0,0,0 +no_defs ";Proj4js.defs["EPSG:32740"]="+proj=utm +zone=40 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32732"]="+proj=utm +zone=32 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32726"]="+proj=utm +zone=26 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27582"]="+title=NTF (Paris) / France II (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["IGNF:NUKU72U7S"]="+title=IGN 1972 Nuku Hiva - UTM fuseau 7 Sud +proj=tmerc +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.Proj.gauss={init:function(){sphi=Math.sin(this.lat0);cphi=Math.cos(this.lat0);cphi*=cphi;this.rc=Math.sqrt(1-this.es)/(1-this.es*sphi*sphi);this.C=Math.sqrt(1+this.es*cphi*cphi/(1-this.es));this.phic0=Math.asin(sphi/this.C);this.ratexp=0.5*this.C*this.e;this.K=Math.tan(0.5*this.phic0+Proj4js.common.FORTPI)/(Math.pow(Math.tan(0.5*this.lat0+Proj4js.common.FORTPI),this.C)*Proj4js.common.srat(this.e*sphi,this.ratexp))},forward:function(C){var D=C.x;var B=C.y;C.y=2*Math.atan(this.K*Math.pow(Math.tan(0.5*B+Proj4js.common.FORTPI),this.C)*Proj4js.common.srat(this.e*Math.sin(B),this.ratexp))-Proj4js.common.HALF_PI;C.x=this.C*D;return C},inverse:function(E){var D=1e-14;var F=E.x/this.C;var C=E.y;num=Math.pow(Math.tan(0.5*C+Proj4js.common.FORTPI)/this.K,1/this.C);for(var B=Proj4js.common.MAX_ITER;B>0;--B){C=2*Math.atan(num*Proj4js.common.srat(this.e*Math.sin(E.y),-0.5*this.e))-Proj4js.common.HALF_PI;if(Math.abs(C-E.y)<D){break}E.y=C}if(!B){Proj4js.reportError("gauss:inverse:convergence failed");return null}E.x=F;E.y=C;return E}};Proj4js.defs["IGNF:GEOPORTALFXX"]="+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32720"]="+proj=utm +zone=20 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32630"]="+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGNCUTM59S"]="+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 59 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=171.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32705"]="+proj=utm +zone=5 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:GEOPORTALCRZ"]="+title=Geoportail - Crozet +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:NUKU72"]="+title=IGN 1972 Nuku Hiva +proj=geocent +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32602"]="+proj=utm +zone=2 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.eqdc={init:function(){if(!this.mode){this.mode=0}this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=Proj4js.common.e0fn(this.es);this.e1=Proj4js.common.e1fn(this.es);this.e2=Proj4js.common.e2fn(this.es);this.e3=Proj4js.common.e3fn(this.es);this.sinphi=Math.sin(this.lat1);this.cosphi=Math.cos(this.lat1);this.ms1=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi);this.ml1=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1);if(this.mode!=0){if(Math.abs(this.lat1+this.lat2)<Proj4js.common.EPSLN){Proj4js.reportError("eqdc:Init:EqualLatitudes")}this.sinphi=Math.sin(this.lat2);this.cosphi=Math.cos(this.lat2);this.ms2=Proj4js.common.msfnz(this.e,this.sinphi,this.cosphi);this.ml2=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2);if(Math.abs(this.lat1-this.lat2)>=Proj4js.common.EPSLN){this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)}else{this.ns=this.sinphi}}else{this.ns=this.sinphi}this.g=this.ml1+this.ms1/this.ns;this.ml0=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0);this.rh=this.a*(this.g-this.ml0)},forward:function(E){var F=E.x;var D=E.y;var I=Proj4js.common.mlfn(this.e0,this.e1,this.e2,this.e3,D);var H=this.a*(this.g-I);var C=this.ns*Proj4js.common.adjust_lon(F-this.long0);var B=this.x0+H*Math.sin(C);var G=this.y0+this.rh-H*Math.cos(C);E.x=B;E.y=G;return E},inverse:function(E){E.x-=this.x0;E.y=this.rh-E.y+this.y0;var B,H;if(this.ns>=0){var H=Math.sqrt(E.x*E.x+E.y*E.y);var B=1}else{H=-Math.sqrt(E.x*E.x+E.y*E.y);B=-1}var C=0;if(H!=0){C=Math.atan2(B*E.x,B*E.y)}var G=this.g-H/this.a;var D=this.phi3z(this.ml,this.e0,this.e1,this.e2,this.e3);var F=Proj4js.common.adjust_lon(this.long0+C/this.ns);E.x=F;E.y=D;return E},phi3z:function(I,H,G,F,E){var D;var B;D=I;for(var C=0;C<15;C++){B=(I+G*Math.sin(2*D)-F*Math.sin(4*D)+E*Math.sin(6*D))/H-D;D+=B;if(Math.abs(B)<=1e-10){return D}}Proj4js.reportError("PHI3Z-CONV:Latitude failed to converge after 15 iterations");return null}};Proj4js.defs["IGNF:GEOPORTALNCL"]="+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32616"]="+proj=utm +zone=16 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32750"]="+proj=utm +zone=50 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:27572"]="+title=NTF (Paris) / Lambert zone II +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["IGNF:LAMB2"]="+title=Lambert II +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs";Proj4js.defs["IGNF:RGF93CC48"]="+title=Lambert conique conforme Zone 7 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=48.000000000 +lon_0=3.000000000 +lat_1=47.200000000 +lat_2=48.800000000 +x_0=1700000.000 +y_0=7200000.000 +units=m +no_defs";Proj4js.defs["IGNF:TAHI79GEO"]="+title=IGN79 (Tahiti) Iles de la Societe +proj=longlat +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:RGNCUTM57S"]="+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 57 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=159.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:3303"]="+title=Fatu Iva 72 / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +towgs84=347.103,1078.12,2623.92,-33.8875,70.6773,-9.3943,186.074 +units=m +no_defs ";Proj4js.defs["EPSG:32653"]="+proj=utm +zone=53 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.Proj.cass={init:function(){if(!this.sphere){this.en=this.pj_enfn(this.es);this.m0=this.pj_mlfn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en)}},C1:0.16666666666666666,C2:0.008333333333333333,C3:0.041666666666666664,C4:0.3333333333333333,C5:0.06666666666666667,forward:function(E){var B,F;var C=E.x;var D=E.y;C=Proj4js.common.adjust_lon(C-this.long0);if(this.sphere){B=Math.asin(Math.cos(D)*Math.sin(C));F=Math.atan2(Math.tan(D),Math.cos(C))-this.phi0}else{this.n=Math.sin(D);this.c=Math.cos(D);F=this.pj_mlfn(D,this.n,this.c,this.en);this.n=1/Math.sqrt(1-this.es*this.n*this.n);this.tn=Math.tan(D);this.t=this.tn*this.tn;this.a1=C*this.c;this.c*=this.es*this.c/(1-this.es);this.a2=this.a1*this.a1;B=this.n*this.a1*(1-this.a2*this.t*(this.C1-(8-this.t+8*this.c)*this.a2*this.C2));F-=this.m0-this.n*this.tn*this.a2*(0.5+(5-this.t+6*this.c)*this.a2*this.C3)}E.x=this.a*B+this.x0;E.y=this.a*F+this.y0;return E},inverse:function(C){C.x-=this.x0;C.y-=this.y0;var B=C.x/this.a;var D=C.y/this.a;if(this.sphere){this.dd=D+this.lat0;phi=Math.asin(Math.sin(this.dd)*Math.cos(B));lam=Math.atan2(Math.tan(B),Math.cos(this.dd))}else{ph1=this.pj_inv_mlfn(this.m0+D,this.es,this.en);this.tn=Math.tan(ph1);this.t=this.tn*this.tn;this.n=Math.sin(ph1);this.r=1/(1-this.es*this.n*this.n);this.n=Math.sqrt(this.r);this.r*=(1-this.es)*this.n;this.dd=B/this.n;this.d2=this.dd*this.dd;phi=ph1-(this.n*this.tn/this.r)*this.d2*(0.5-(1+3*this.t)*this.d2*this.C3);lam=this.dd*(1+this.t*this.d2*(-this.C4+(1+3*this.t)*this.d2*this.C5))/Math.cos(ph1)}C.x=Proj4js.common.adjust_lon(this.long0+lam);C.y=phi;return C},pj_enfn:function(C){en=new Array();en[0]=this.C00-C*(this.C02+C*(this.C04+C*(this.C06+C*this.C08)));en[1]=C*(this.C22-C*(this.C04+C*(this.C06+C*this.C08)));var B=C*C;en[2]=B*(this.C44-C*(this.C46+C*this.C48));B*=C;en[3]=B*(this.C66-C*this.C68);en[4]=B*C*this.C88;return en},pj_mlfn:function(E,B,D,C){D*=B;B*=B;return(C[0]*E-D*(C[1]+B*(C[2]+B*(C[3]+B*C[4]))))},pj_inv_mlfn:function(B,D,C){k=1/(1-D);phi=B;for(i=Proj4js.common.MAX_ITER;i;--i){s=Math.sin(phi);t=1-D*s*s;t=(this.pj_mlfn(phi,s,Math.cos(phi),C)-B)*(t*Math.sqrt(t))*k;phi-=t;if(Math.abs(t)<Proj4js.common.EPSLN){return phi}}Proj4js.reportError("cass:pj_inv_mlfn: Convergence error");return phi},C00:1,C02:0.25,C04:0.046875,C06:0.01953125,C08:0.01068115234375,C22:0.75,C44:0.46875,C46:0.013020833333333334,C48:0.007120768229166667,C66:0.3645833333333333,C68:0.005696614583333333,C88:0.3076171875};Proj4js.defs["EPSG:32754"]="+proj=utm +zone=54 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:TERA50STEREO"]="+title=Terre Adelie 1950 +proj=sterea +towgs84=324.8000,153.6000,172.1000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs";Proj4js.defs["IGNF:ED50"]="+title=ED50 +proj=geocent +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:4690"]="+title=Tahiti 79 +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["IGNF:RGM04"]="+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:3312"]="+title=CSG67 / UTM zone 21N +proj=utm +zone=21 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ";Proj4js.Proj.cea={init:function(){},forward:function(D){var E=D.x;var C=D.y;dlon=Proj4js.common.adjust_lon(E-this.long0);var B=this.x0+this.a*dlon*Math.cos(this.lat_ts);var F=this.y0+this.a*Math.sin(C)/Math.cos(this.lat_ts);D.x=B;D.y=F;return D},inverse:function(C){C.x-=this.x0;C.y-=this.y0;var D=Proj4js.common.adjust_lon(this.long0+(C.x/this.a)/Math.cos(this.lat_ts));var B=Math.asin((C.y/this.a)*Math.cos(this.lat_ts));C.x=D;C.y=B;return C}};Proj4js.defs["EPSG:32632"]="+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGSPM06U21"]="+title=Saint-Pierre-et-Miquelon (2006) UTM Fuseau 21 Nord +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:RGR92UTM40S"]="+title=RGR92 UTM fuseau 40 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32657"]="+proj=utm +zone=57 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.ProxyHost="";Proj4js.ProxyHostFQDN=null;Proj4js.getFQDNForUrl=function(B){if(B){var C=B.match(/^[a-z]+:\/\/([^\/]+)\/?/i);if(C){return C[1]}return window.location.host}return null};Proj4js.setProxyUrl=function(B){Proj4js.ProxyHost=B;Proj4js.ProxyHostFQDN=this.getFQDNForUrl(B)};Proj4js.Try=function(){var E=null;for(var D=0,B=arguments.length;D<B;D++){var C=arguments[D];try{E=C();break}catch(F){}}return E};Proj4js.loadScript=function(C,E,H,J){var F={loaded:false,onload:E,onfail:H,loadCheck:J,transport:Proj4js.Try(function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")})||null};if(!F.transport){return }if(F.transport.overrideMimeType){F.transport.overrideMimeType("text/xml")}var G="_tick_="+new Date().getTime();C+=(C.indexOf("?")+1?"&":"?")+G;if(Proj4js.ProxyHost){if(C.indexOf(Proj4js.ProxyHost)!=0){if(C.search(/^[a-z]+:\/\//i)!=-1){var I=C.match(/^[a-z]+:\/\/([^\/]*)\/?/i);if(I){I=I[1]}if(Proj4js.ProxyHostFQDN!=I){C=Proj4js.ProxyHost+encodeURIComponent(C)}}}}F.transport.open("GET",C,false);F.transport.onreadystatechange=Proj4js.bind(this.onStateChange,this,F);var D={"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*",Proj4js:true};for(var B in D){F.transport.setRequestHeader(B,D[B])}F.transport.send(null);if(F.transport.overrideMimeType){this.onStateChange(F)}};Proj4js.onStateChange=function(request){if(request.transport.readyState>1&&!(request.transport.readyState==4&&request.loaded)){var state=0;try{state=request.transport.status||0}catch(e){state=0}var success=state==0||(state>=200&&state<300);if(request.transport.readyState==4){request.loaded=true;if(success){eval(request.transport.responseText);if(request.loadCheck&&!request.loadCheck()){if(request.onfail){request.onfail()}}else{if(request.onload){request.onload()}}}else{if(request.onfail){request.onfail()}}request.transport.onreadystatechange=function(){}}}};Proj4js.checkReadyState=function(){};Proj4js.defs["EPSG:4621"]="+title=Fort Marigot +proj=longlat +ellps=intl +towgs84=137,248,-430,0,0,0,0 +no_defs ";Proj4js.defs["IGNF:UTM42SW84"]="+title=World Geodetic System 1984 UTM fuseau 42 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:27591"]="+title=NTF (Paris) / Nord France (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:3306"]="+title=Maupiti 83 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32714"]="+proj=utm +zone=14 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32603"]="+proj=utm +zone=3 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32715"]="+proj=utm +zone=15 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGPFUTM6S"]="+title=RGPF - UTM fuseau 6 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32738"]="+proj=utm +zone=38 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGPFUTM5S"]="+title=RGPF - UTM fuseau 5 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["EPSG:32742"]="+proj=utm +zone=42 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGNCUTM58S"]="+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 58 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:GUAD48GEO"]="+title=Guadeloupe Ste Anne +proj=longlat +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:ED50G"]="+title=ED50 +proj=longlat +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:TAHI51UTM06S"]="+title=Tahiti-Terme Nord UTM fuseau 6 Sud +proj=tmerc +towgs84=162.0000,117.0000,154.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:MILLER"]="+title=Geoportail - Monde +proj=mill +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:32631"]="+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:GEOPORTALGUF"]="+title=Geoportail - Guyane +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["IGNF:GUAD48"]="+title=Guadeloupe Ste Anne +proj=geocent +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:CSG67"]="+title=Guyane CSG67 +proj=geocent +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:UTM01SW84"]="+title=World Geodetic System 1984 UTM fuseau 01 Sud +proj=tmerc +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:IGN63GEO"]="+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=longlat +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["EPSG:32608"]="+proj=utm +zone=8 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32650"]="+proj=utm +zone=50 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3304"]="+title=Tahiti 79 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:WGS72G"]="+title=WGS72 +proj=longlat +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs";Proj4js.defs["IGNF:LAMB93"]="+title=Lambert 93 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.500000000 +lon_0=3.000000000 +lat_1=44.000000000 +lat_2=49.000000000 +x_0=700000.000 +y_0=6600000.000 +units=m +no_defs";Proj4js.defs["EPSG:3060"]="+title=IGN72 Grande Terre / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["IGNF:RGF93CC47"]="+title=Lambert conique conforme Zone 6 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=47.000000000 +lon_0=3.000000000 +lat_1=46.200000000 +lat_2=47.800000000 +x_0=1700000.000 +y_0=6200000.000 +units=m +no_defs";Proj4js.defs["EPSG:4230"]="+title=ED50 +proj=longlat +ellps=intl +no_defs ";Proj4js.defs["EPSG:32748"]="+proj=utm +zone=48 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32755"]="+proj=utm +zone=55 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:3164"]="+title=ST87 Ouvea / UTM zone 58S +proj=utm +zone=58 +south +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:2977"]="+title=Tahaa 54 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +units=m +no_defs ";Proj4js.defs["EPSG:3034"]="+title=ETRS89 / ETRS-LCC +proj=lcc +lat_1=35 +lat_2=65 +lat_0=52 +lon_0=10 +x_0=4000000 +y_0=2800000 +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:4691"]="+title=Moorea 87 +proj=longlat +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +no_defs ";Proj4js.defs["EPSG:2976"]="+title=Tahiti 52 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=162,117,154,0,0,0,0 +units=m +no_defs ";Proj4js.defs["EPSG:32615"]="+proj=utm +zone=15 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:GEOPORTALANF"]="+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs";Proj4js.defs["EPSG:3299"]="+title=RGPF / UTM zone 8S +proj=utm +zone=8 +south +ellps=GRS80 +units=m +no_defs ";Proj4js.defs["EPSG:27571"]="+title=NTF (Paris) / Lambert zone I +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["IGNF:CSG67GEO"]="+title=Guyane CSG67 UTM fuseau 21 +proj=longlat +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:TAHI79UTM6S"]="+title=Tahiti 1979 +proj=tmerc +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:MAYO50UTM38S"]="+title=Mayotte Combani +proj=tmerc +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs";Proj4js.defs["IGNF:STPM50UTM21"]="+title=St Pierre et Miquelon 1950 +proj=tmerc +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs";Proj4js.Proj.gstmerc={init:function(){var B=this.b/this.a;this.e=Math.sqrt(1-B*B);this.lc=this.long0;this.rs=Math.sqrt(1+this.e*this.e*Math.pow(Math.cos(this.lat0),4)/(1-this.e*this.e));var D=Math.sin(this.lat0);var C=Math.asin(D/this.rs);var E=Math.sin(C);this.cp=Proj4js.common.latiso(0,C,E)-this.rs*Proj4js.common.latiso(this.e,this.lat0,D);this.n2=this.k0*this.a*Math.sqrt(1-this.e*this.e)/(1-this.e*this.e*D*D);this.xs=this.x0;this.ys=this.y0-this.n2*C;if(!this.title){this.title="Gauss Schreiber transverse mercator"}},forward:function(F){var H=F.x;var E=F.y;var B=this.rs*(H-this.lc);var C=this.cp+(this.rs*Proj4js.common.latiso(this.e,E,Math.sin(E)));var G=Math.asin(Math.sin(B)/Proj4js.common.cosh(C));var D=Proj4js.common.latiso(0,G,Math.sin(G));F.x=this.xs+(this.n2*D);F.y=this.ys+(this.n2*Math.atan(Proj4js.common.sinh(C)/Math.cos(B)));return F},inverse:function(E){var C=E.x;var G=E.y;var B=Math.atan(Proj4js.common.sinh((C-this.xs)/this.n2)/Math.cos((G-this.ys)/this.n2));var F=Math.asin(Math.sin((G-this.ys)/this.n2)/Proj4js.common.cosh((C-this.xs)/this.n2));var D=Proj4js.common.latiso(0,F,Math.sin(F));E.x=this.lc+B/this.rs;E.y=Proj4js.common.invlatiso(this.e,(D-this.cp)/this.rs);return E}};Proj4js.defs["IGNF:RGF93CC44"]="+title=Lambert conique conforme Zone 3 +proj=lcc +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=44.000000000 +lon_0=3.000000000 +lat_1=43.200000000 +lat_2=44.800000000 +x_0=1700000.000 +y_0=3200000.000 +units=m +no_defs";Proj4js.defs["EPSG:32629"]="+proj=utm +zone=29 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["EPSG:32640"]="+proj=utm +zone=40 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:RGSPM06"]="+title=Reseau Geodesique Saint-Pierre-et-Miquelon (2006) +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["EPSG:32733"]="+proj=utm +zone=33 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ";Proj4js.defs["IGNF:MOOREA87GEO"]="+title=Moorea 1987 +proj=longlat +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs";Proj4js.defs["IGNF:RGFG95"]="+title=Reseau geodesique francais de Guyane 1995 +proj=geocent +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs";Proj4js.defs["IGNF:STEREOSX"]="+title=Stereographique polaire Sud +proj=sterea +towgs84=0.0000,0.0000,0.5000,0.0000,0.0000,0.0140,-0.100000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=-90.000000000 +lon_0=140.000000000 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs";Proj4js.defs["EPSG:27562"]="+title=NTF (Paris) / Lambert Centre France +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ";Proj4js.defs["EPSG:2989"]="+title=RRAF 1991 / UTM zone 20N +proj=utm +zone=20 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ";Proj4js.defs["IGNF:LAMB2C"]="+title=Lambert II Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs";OpenLayers.Event.stopObservingElement=function(B){var C=OpenLayers.Util.getElement(B);if(C){var D=C._eventCacheID;if(D){this._removeElementObservers(OpenLayers.Event.observers[D])}}};OpenLayers.Lang.en.W="W";OpenLayers.Lang.en.E="E";OpenLayers.Lang.en.N="N";OpenLayers.Lang.en.S="S";OpenLayers.Lang.en["no.proj.implementation.found"]="No implementation for Projection handling found";if(typeof (OpenLayers.Lang.de)=="undefined"){OpenLayers.Lang.de=OpenLayers.Util.applyDefaults({},OpenLayers.Lang.en)}OpenLayers.Lang.de.W="W";OpenLayers.Lang.de.E="O";OpenLayers.Lang.de.N="N";OpenLayers.Lang.de.S="S";OpenLayers.Lang.de["no.proj.implementation.found"]="Keine umsetzung für projektions-handling gefunden";if(typeof (OpenLayers.Lang.es)=="undefined"){OpenLayers.Lang.es=OpenLayers.Util.applyDefaults({},OpenLayers.Lang.en)}OpenLayers.Lang.es.W="Oe";OpenLayers.Lang.es.E="Or";OpenLayers.Lang.es.N="N";OpenLayers.Lang.es.S="S";OpenLayers.Lang.es["no.proj.implementation.found"]="No aplicación para el manejo de proyección encontrado";if(typeof (OpenLayers.Lang.fr)=="undefined"){OpenLayers.Lang.fr=OpenLayers.Util.applyDefaults({},OpenLayers.Lang.en)}OpenLayers.Lang.fr.W="O";OpenLayers.Lang.fr.E="E";OpenLayers.Lang.fr.N="N";OpenLayers.Lang.fr.S="S";OpenLayers.Lang.fr["no.proj.implementation.found"]="Aucune implémentation d'un gestionnaire de projections n'a été chargé";if(typeof (OpenLayers.Lang.it)=="undefined"){OpenLayers.Lang.it=OpenLayers.Util.applyDefaults({},OpenLayers.Lang.en)}OpenLayers.Lang.it.W="O";OpenLayers.Lang.it.E="E";OpenLayers.Lang.it.N="N";OpenLayers.Lang.it.S="S";OpenLayers.Lang.it["no.proj.implementation.found"]="No di attuazione per la gestione di proiezione trovato";OpenLayers.INCHES_PER_UNIT.deg=OpenLayers.INCHES_PER_UNIT.degre=OpenLayers.INCHES_PER_UNIT.degree=OpenLayers.INCHES_PER_UNIT.dd;OpenLayers.INCHES_PER_UNIT.meters=OpenLayers.INCHES_PER_UNIT.meter=OpenLayers.INCHES_PER_UNIT.metres=OpenLayers.INCHES_PER_UNIT.metre=OpenLayers.INCHES_PER_UNIT.m;OpenLayers.Util.getResolutionFromScale=function(E,B){if(B==null||OpenLayers.INCHES_PER_UNIT[B]==undefined){B="degrees"}var D=OpenLayers.Util.normalizeScale(E);var C=1/(D*OpenLayers.INCHES_PER_UNIT[B]*OpenLayers.DOTS_PER_INCH);return C};OpenLayers.Util.getScaleFromResolution=function(C,B){if(B==null||OpenLayers.INCHES_PER_UNIT[B]==undefined){B="degrees"}var D=C*OpenLayers.INCHES_PER_UNIT[B]*OpenLayers.DOTS_PER_INCH;return D};OpenLayers.Util.getParameters=function(C){C=C||window.location.href;var B="";if(OpenLayers.String.contains(C,"?")){var D=C.indexOf("?")+1;var F=OpenLayers.String.contains(C,"#")?C.indexOf("#"):C.length;B=C.substring(D,F)}var N={};var E=B.split(/[&;]/);for(var I=0,J=E.length;I<J;++I){var H=E[I].split("=");if(H[0]){var L=decodeURIComponent(H[0]);var K=H[1]||"";K=K.split(",");for(var G=0,M=K.length;G<M;G++){K[G]=decodeURIComponent(unescape(K[G]))}if(K.length==1){K=K[0]}N[L]=K}}return N};OpenLayers.Util.getFormattedLonLat=function(I,C,F){if(!F){F="dms"}var E=Math.abs(I);var J=Math.floor(E);var B=(E-J)/(1/60);var D=B;B=Math.floor(B);var H=(D-B)/(1/60);H=Math.round(H*10);H/=10;if(J<10){J="0"+J}var G=J+" ";if(F.indexOf("dm")>=0){if(B<10){B="0"+B}G+=B+"'";if(F.indexOf("dms")>=0){if(H<10){H="0"+H}G+=H+'"'}}if(C=="lon"){G+=I<0?OpenLayers.i18n("W"):OpenLayers.i18n("E")}else{G+=I<0?OpenLayers.i18n("S"):OpenLayers.i18n("N")}return G};OpenLayers.Function.False=function(){return false};OpenLayers.Function.True=function(){return true};OpenLayers.Element.insertAfter=function(B,C){if(!C){return null}if(C.nextSibling){return C.parentNode.insertBefore(B,C.nextSibling)}return C.parentNode.appendChild(B)};OpenLayers.Projection.WKALIASES={WGS84G:["WGS84","EPSG:4326","CRS:84","IGNF:WGS84G","IGNF:WGS84RRAFGEO","IGNF:RGF93G","IGNF:RGFG95GEO","IGNF:RGM04GEO","IGNF:RGNCGEO","IGNF:RGPFGEO","IGNF:RGR92GEO","IGNF:RGSPM06GEO"],LAMB93:["IGNF:LAMB93","EPSG:2154"],LAMBE:["IGNF:LAMBE","EPSG:27572","EPSG:27582"],GOOGLE:["EPSG:3785","EPSG:3857","EPSG:900913","EPSG:102113"]};OpenLayers.Projection.prototype.domainOfValidity=null;OpenLayers.Projection.prototype.initialize=function(F,D){OpenLayers.Util.extend(this,D);this.projCode=F;this.options=OpenLayers.Util.extend({},D);this.aliases=OpenLayers.Util.extend({},this.options.aliases);if(window.Proj4js){this.proj=new Proj4js.Proj(F)}if(this.proj==null){throw OpenLayers.i18n("no.proj.implementation.found")}if(F=="EPSG:4326"||F=="CRS:84"||F=="IGNF:WGS84G"||F=="WGS84"){this.domainOfValidity=new OpenLayers.Bounds(-180,-90,180,90)}else{if(F=="EPSG:3785"||F=="EPSG:3857"||F=="EPSG:900913"||F=="EPSG:102113"||F=="GOOGLE"){this.domainOfValidity=new OpenLayers.Bounds(-180,-85.05113,180,85.05113)}else{if(this.isUTMZoneProjection()){var C=-180,B=-90,E=180,G=90;if(this.getProjName()=="utm"){E=this.getProperty("zone")*6-180;C=E-6;G=84;B=0;if(this.getProperty("utmSouth")===true){G=0;B=-80}}else{if(this.getProjName()=="stere"){if(this.getProperty("lat_ts")>0){B=84}else{G=-80}}}this.domainOfValidity=new OpenLayers.Bounds(C,B,E,G)}}}};OpenLayers.Projection.prototype.getCode=function(){if(this.proj instanceof Proj4js.Proj){this.proj.srsCode}return this.projCode};OpenLayers.Projection.prototype.getUnits=function(){if(this.proj instanceof Proj4js.Proj){this.proj.units}return null},OpenLayers.Projection.prototype.clone=function(){if(this.proj==null){return null}var B=new OpenLayers.Projection(this.projCode,this.options);B.aliases=OpenLayers.Util.extend({},this.aliases);return B};OpenLayers.Projection.prototype.getProjName=function(){if(this.proj instanceof Proj4js.Proj){return this.proj.projName}return null};OpenLayers.Projection.prototype.getTitle=function(){var B=OpenLayers.i18n(this.projCode);if(B==this.projCode){B=this.getProperty("title");if(B==null){B=this.projCode}}return B};OpenLayers.Projection.prototype.getDatum=function(){if(this.proj instanceof Proj4js.Proj){return this.proj.datum}return null};OpenLayers.Projection.prototype.getProperty=function(B){if(B==undefined){return null}if(this.proj instanceof Proj4js.Proj){return this.proj[B]}return null};OpenLayers.Projection.prototype.equals=function(C){var B=false;if(this.proj&&C){var D=C instanceof OpenLayers.Projection?C.getCode():C;if(this.getCode()==D){B=true}else{B=this.isAliasOf(C)}}return B};OpenLayers.Projection.prototype.isAliasOf=function(I){if(!this.proj||!I){return false}var C=this.getCode(),B=I instanceof OpenLayers.Projection?I.getCode():I;if(this.aliases[B]===true){return true}if(this.aliases[B]===false){return false}var H=false,G=false;for(var E in OpenLayers.Projection.WKALIASES){if(OpenLayers.Projection.WKALIASES.hasOwnProperty(E)){var J=OpenLayers.Projection.WKALIASES[E];for(var F=0,D=J.length;F<D&&!(H&&G);F++){if(C==J[F]){H=true;continue}if(B==J[F]){G=true;continue}}if(H||G){break}}}this.aliases[B]=(H&&G);return this.aliases[B]};OpenLayers.Projection.prototype.isCompatibleWith=function(C){if(!this.proj||!C){return false}var E;try{E=C instanceof OpenLayers.Projection?C:new OpenLayers.Projection(C)}catch(D){OpenLayers.Console.error(D.message);return false}var B=false;if(this.equals(E)){B=true}else{try{if(this.getProjName()==E.getProjName()){B=this.getDatum()&&E.getDatum()&&this.getDatum().compare_datums(E.getDatum())}else{if((this.getProjName()=="eqc"&&E.getProjName()=="longlat")||(this.getProjName()=="longlat"&&E.getProjName()=="eqc")){B=this.getDatum()&&E.getDatum()&&this.getDatum().compare_datums(E.getDatum())}}}catch(D){}}if(!(E==C)){E.destroy();E=null}return B};OpenLayers.Projection.prototype.isUTMZoneProjection=function(){if(this.proj==null){return false}if(this.getProjName()=="utm"&&this.getProperty("zone")!=null){return true}if(this.getProjName()=="stere"&&this.getProperty("long0")==0&&this.getProperty("lat0")===this.getProperty("lat_ts")&&Math.abs(this.getProperty("lat0"))==1.57079632679){return true}return false};OpenLayers.Projection.prototype.destroy=function(){if(this.proj){delete this.proj}if(this.projCode){delete this.projCode}if(this.domainOfValidity){delete this.domainOfValidity}delete this.options;delete this.aliases};OpenLayers.Projection.CRS84=new OpenLayers.Projection("WGS84");OpenLayers.Projection.getUTMZone=function(C){var B=""+(Math.floor(C/6)+31);return B};OpenLayers.Projection.getMGRSZone=function(B,F){var D=["C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W"];var C;if(F.lat<-80){if(F.lon<0){C="A"}else{C="B"}return C}if(F.lat>84){if(F.lon<0){C="Y"}else{C="Z"}return C}if(F.lat>72){if(F.lon<0||F.lon>42){C=B+"X"}else{if(F.lon<=9){C="31X"}else{if(F.lon<=21){C="33X"}else{if(F.lon<=33){C="35X"}else{C="37X"}}}}return C}var E=Math.abs(parseInt((F.lat+80)/8,10));C=B+D[E];if(C=="31V"&&F.lon>3){C="32V"}return C};OpenLayers.Projection.transform=function(E,F,C){if(F&&C){if(F.proj instanceof Proj4js.Proj&&C.proj instanceof Proj4js.Proj){if(!F.equals(C)){if(E instanceof Array){for(var D=0,B=E.length;D<B;D++){E[D]=Proj4js.transform(F.proj,C.proj,E[D]);if(E[D] instanceof OpenLayers.Geometry){E[D].bounds=null}}}else{E=Proj4js.transform(F.proj,C.proj,E);if(E instanceof OpenLayers.Geometry){E.bounds=null}}}}else{if(OpenLayers.Projection.transforms[F.getCode()]&&OpenLayers.Projection.transforms[F.getCode()][C.getCode()]){if(E instanceof Array){for(var D=0,B=E.length;D<B;D++){OpenLayers.Projection.transforms[F.getCode()][C.getCode()](E[D]);if(E[D] instanceof OpenLayers.Geometry){E[D].bounds=null}}}else{OpenLayers.Projection.transforms[F.getCode()][C.getCode()](E);if(E instanceof OpenLayers.Geometry){E.bounds=null}}}}}return E};OpenLayers.Bounds.prototype.transform=function(P,I,T){if(!T){var K=OpenLayers.Projection.transform({x:this.left,y:this.bottom},P,I);var H=OpenLayers.Projection.transform({x:this.right,y:this.top},P,I);this.left=K.x<H.x?K.x:H.x;this.bottom=K.y<H.y?K.y:H.y;this.right=H.x>K.x?H.x:K.x;this.top=H.y>K.y?H.y:K.y;return this}var U=I.getProjName()=="longlat"?0.000028:1;var C,E,V,M;var D=1;for(var R=0;R<7;R++){var L=(this.right-this.left)/(1*D);var J=(this.top-this.bottom)/(1*D);var N;var B,S,G,W;var Y=[],F=0;for(var Q=0;Q<D;Q++){Y[F++]={x:this.left+Q*L,y:this.bottom};Y[F++]={x:this.right,y:this.bottom+Q*J};Y[F++]={x:this.right-Q*L,y:this.top};Y[F++]={x:this.left,y:this.top-Q*J}}Y=OpenLayers.Projection.transform(Y,P,I);if(B==undefined){B=G=Y[0].x;S=W=Y[0].y}for(var O=0;O<F;O++){N=Y[O];if(N.x<B){B=N.x}if(N.y<S){S=N.y}if(N.x>G){G=N.x}if(N.y>W){W=N.y}}Y=null;if(C!=undefined&&Math.abs(B-C)<U&&Math.abs(S-E)<U&&Math.abs(G-V)<U&&Math.abs(W-M)<U){this.left=B;this.bottom=S;this.right=G;this.top=W;return this}C=B;E=S;V=G;M=W;D*=2}this.left=C;this.bottom=E;this.right=V;this.top=M;return this};OpenLayers.LonLat.prototype.equals=function(F,E){var D=false;if(!E){E=0.000001}if(F!=null){var C=(!isNaN(this.lon)&&!isNaN(F.lon))?Math.abs(this.lon-F.lon):1;var B=(!isNaN(this.lat)&&!isNaN(F.lat))?Math.abs(this.lat-F.lat):1;D=((C<=E&&B<=E)||(isNaN(this.lon)&&isNaN(this.lat)&&isNaN(F.lon)&&isNaN(F.lat)))}return D};OpenLayers.Map.prototype.isValidZoomLevel=function(C){var B=(C!=null);B=B&&(C>=0);B=B&&(C<this.getNumZoomLevels());if(this.minZoomLevel!=undefined){B=B&&(C>=this.minZoomLevel)}if(this.maxZoomLevel!=undefined){B=B&&(C<=this.maxZoomLevel)}return B};OpenLayers.Map.prototype.getProjectionObject=OpenLayers.Map.prototype.getProjection=function(){var B=null;if(this.baseLayer!=null){B=this.baseLayer.projection}return B?B:null};OpenLayers.Map.prototype.getDisplayProjection=function(){var B=null;if(this.displayProjection){B=this.displayProjection}else{B=this.getProjection()}return B};OpenLayers.Map.prototype.getMaxExtent=function(C){var B=null;if(C&&C.restricted&&this.restrictedExtent){B=this.restrictedExtent}else{if(this.baseLayer!=null){B=this.baseLayer.maxExtent}}if(!B){this.maxExtent=new OpenLayers.Bounds(-180,-90,180,90);this.maxExtent.transform(OpenLayers.Projection.CRS84,this.getProjection());B=this.maxExtent}return B};OpenLayers.Map.prototype.updateSize=function(){this.events.clearMouseCache();var D=this.getCurrentSize();var G=this.getSize();if(G==null){this.size=G=D}if(!D.equals(G)){this.size=D;for(var E=0,C=this.layers.length;E<C;E++){this.layers[E].onMapResize()}var B=this.getCenter();if(this.baseLayer!=null&&B!=null){var F=this.getZoom();this.zoom=null;this.setCenter(B,F)}}};OpenLayers.Layer.prototype.dataURL=null;OpenLayers.Layer.prototype.metadataURL=null;OpenLayers.Layer.prototype.savedStates={};OpenLayers.Layer.prototype.onLoadError=null;OpenLayers.Layer.WMS.Untiled.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.WMS.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Vector.RootContainer.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Vector.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.HTTPRequest.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Grid.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.GML.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.prototype.RESOLUTION_PROPERTIES=["projection","units","scales","resolutions","maxScale","minScale","maxResolution","minResolution","minExtent","maxExtent","numZoomLevels","maxZoomLevel"];OpenLayers.Layer.prototype.initialize=function(C,B){this.addOptions(B);this.name=C;if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_");this.div=OpenLayers.Util.createDiv(this.id);this.div.style.width="100%";this.div.style.height="100%";this.div.dir="ltr";this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}}if(this.wrapDateLine){this.displayOutsideMaxExtent=true}this.savedStates={};if(this.GeoRM){if(!this.events){this.events=new OpenLayers.Events(this,this.div,this.EVENT_TYPES)}this.events.register("loadstart",this,this.updateGeoRM);this.events.register("move",this,this.updateGeoRM);this.events.register("moveend",this,this.updateGeoRM)}};OpenLayers.Layer.prototype.destroy=function(B){if(B==null){B=true}if(this.map!=null){this.map.removeLayer(this,B)}this.projection=null;this.map=null;this.name=null;this.div=null;this.options=null;this.savedStates=null;if(this.GeoRM){this.events.unregister("loadstart",this,this.updateGeoRM)}if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy()}this.eventListeners=null;this.events=null};OpenLayers.Layer.prototype.clone=function(B){if(B==null){B=new OpenLayers.Layer(this.name,this.options)}OpenLayers.Util.applyDefaults(B,this);B.map=null;B.savedStates={};return B};OpenLayers.Layer.WMS.Untiled.prototype.addOptions=OpenLayers.Layer.WMS.prototype.addOptions=OpenLayers.Layer.Vector.RootContainer.prototype.addOptions=OpenLayers.Layer.Vector.prototype.addOptions=OpenLayers.Layer.HTTPRequest.prototype.addOptions=OpenLayers.Layer.Grid.prototype.addOptions=OpenLayers.Layer.GML.prototype.addOptions=OpenLayers.Layer.prototype.addOptions=function(E){if(this.options==null){this.options={}}OpenLayers.Util.extend(this.options,E);OpenLayers.Util.extend(this,E);var C=this.projection;if(typeof C=="string"){this.projection=new OpenLayers.Projection(C)}if(this.map){var B=false;for(var D in E){if(E.hasOwnProperty(D)&&OpenLayers.Util.indexOf(this.RESOLUTION_PROPERTIES,D)>0){B=true;break}}if(B){this.initResolutions()}}};OpenLayers.Layer.prototype.updateGeoRM=function(){return(this.GeoRM.getToken()!=null||this.isBaseLayer)};OpenLayers.Layer.WMS.Untiled.prototype.getNativeProjection=OpenLayers.Layer.WMS.prototype.getNativeProjection=OpenLayers.Layer.Vector.RootContainer.prototype.getNativeProjection=OpenLayers.Layer.Vector.prototype.getNativeProjection=OpenLayers.Layer.HTTPRequest.prototype.getNativeProjection=OpenLayers.Layer.Grid.prototype.getNativeProjection=OpenLayers.Layer.GML.prototype.getNativeProjection=OpenLayers.Layer.prototype.getNativeProjection=function(){if(this.isBaseLayer){this.projection=this.projection||this.nativeProjection}else{if(!this.projection&&this.map){this.projection=this.map.getProjection()}}if(this.projection&&typeof (this.projection)=="string"){this.projection=new OpenLayers.Projection(this.projection)}return this.projection};OpenLayers.Layer.prototype.changeBaseLayer=function(B){if(!B){return false}if(!(B.baseLayer)){return false}if(this.isBaseLayer){return true}var D=this.map.getProjection();var C=B.baseLayer.getNativeProjection();if(this.maxExtent){this.maxExtent.transform(C,D,true)}if(this.restrictedExtent){this.restrictedExtent.transform(C,D,true)}return true};OpenLayers.Layer.prototype.getCompatibleProjection=function(C){if(this.aggregate!=undefined){return undefined}var B=this.getNativeProjection();if(B==null){if(this.map==null){return undefined}return null}if(C==null){C=this.map.baseLayer;if(C==null){return undefined}}var D=C.getNativeProjection();return B.isCompatibleWith(D)?B:null};OpenLayers.Layer.Grid.prototype.mergeNewParams=OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams=function(B){this.params=OpenLayers.Util.extend(this.params,B);if(this.GeoRM){OpenLayers.Util.extend(this.params,this.GeoRM.token)}return this.redraw()};OpenLayers.Layer.Grid.prototype.getFullRequestString=OpenLayers.Layer.HTTPRequest.prototype.getFullRequestString=function(G,F){var C=F||this.url;var H=OpenLayers.Util.extend({},this.params);H=OpenLayers.Util.extend(H,G);if(this.GeoRM){OpenLayers.Util.extend(H,this.GeoRM.token)}var B=OpenLayers.Util.getParameterString(H);if(C instanceof Array){C=this.selectUrl(B,C)}var E=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(C));for(var I in H){if(I.toUpperCase() in E){delete H[I]}}B=OpenLayers.Util.getParameterString(H);var J=C;if(B!=""){var D=C.charAt(C.length-1);if((D=="&")||(D=="?")){J+=B}else{if(C.indexOf("?")==-1){J+="?"+B}else{J+="&"+B}}}return J};OpenLayers.Layer.WMS.prototype.getFullRequestString=function(F,D){var C=this.getNativeProjection();var B="SRS";if(this.params.VERSION.match(/^1\.3\..*/)){B="CRS";if(typeof (this.layerLimit)=="number"){var E=this.params.LAYERS.split(",");if(this.layerLimit<E.length){this.params.LAYERS=E.slice(0,this.layerLimit).join(",");OpenLayers.Console.warn("["+E.slice(this.layerLimit).join(",")+"]")}}}this.params[B]=(C==null)?null:C.getCode();return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)};OpenLayers.Layer.WMS.prototype.getURL=function(C){var E=C.clone();E=this.adjustBounds(E);E.transform(this.map.getProjection(),this.getNativeProjection());var D=this.getImageSize();var F={BBOX:this.encodeBBOX?E.toBBOX():E.toArray(),WIDTH:D.w,HEIGHT:D.h};var B=this.getFullRequestString(F);return B};OpenLayers.Layer.WMS.prototype.getDataExtent=function(){return this.maxExtent};OpenLayers.Control.KeyboardDefaults.prototype.defaultKeyPress=function(B){switch(B.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:var C=this.map.getSize();this.map.pan(0,-0.75*C.h);break;case 34:var C=this.map.getSize();this.map.pan(0,0.75*C.h);break;case 35:var C=this.map.getSize();this.map.pan(0.75*C.w,0);break;case 36:var C=this.map.getSize();this.map.pan(-0.75*C.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 54:case 109:case 189:case 95:this.map.zoomOut();break}};OpenLayers.Geometry.Point.prototype.transform=function(C,B){OpenLayers.Projection.transform(this,C,B);return this};OpenLayers.Geometry.LineString.prototype.transform=OpenLayers.Geometry.Curve.prototype.transform=OpenLayers.Geometry.MultiPoint.prototype.transform=function(C,B){OpenLayers.Projection.transform(this.components,C,B);if(C&&B){this.bounds=null}return this};OpenLayers.Renderer.VML.prototype.getResolution=OpenLayers.Renderer.SVG.prototype.getResolution=OpenLayers.Renderer.Elements.prototype.getResolution=OpenLayers.Renderer.Canvas.prototype.getResolution=OpenLayers.Renderer.prototype.getResolution=function(){this.resolution=this.resolution||(this.map?this.map.getResolution():null);return this.resolution};OpenLayers.Renderer.VML.prototype.drawFeature=OpenLayers.Renderer.SVG.prototype.drawFeature=OpenLayers.Renderer.Elements.prototype.drawFeature=OpenLayers.Renderer.prototype.drawFeature=function(D,E){if(E==null){E=D.style}if(D.geometry){var F=D.geometry.getBounds();if(F){if(!F.intersectsBounds(this.extent)){E={display:"none"}}var G=this.drawGeometry(D.geometry,E,D.id);if(E.display!="none"&&E.label&&G!==false){var B=D.geometry.getCentroid();if(E.labelXOffset||E.labelYOffset){xOffset=isNaN(E.labelXOffset)?0:E.labelXOffset;yOffset=isNaN(E.labelYOffset)?0:E.labelYOffset;var C=this.getResolution();B.move(xOffset*C,yOffset*C)}this.drawText(D.id,E,B)}else{this.removeText(D.id)}return G}}};OpenLayers.Renderer.VML.prototype.createNode=function(B,D){var C=document.createElement(B);if(D){C.id=D}C.unselectable="on";C.onselectstart=OpenLayers.Function.False;return C};OpenLayers.Renderer.VML.prototype.setExtent=function(J,B){OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments);var D=this.getResolution();if(D==null){return false}var C=J.left/D;var G=J.top/D-this.size.h;if(B){this.offset={x:C,y:G};C=0;G=0}else{C=C-this.offset.x;G=G-this.offset.y}var L=C+" "+G;this.root.coordorigin=L;var I=[this.root,this.vectorRoot,this.textRoot];var H;for(var E=0,F=I.length;E<F;++E){H=I[E];var K=this.size.w+" "+this.size.h;H.coordsize=K}this.root.style.flip="y";return true};OpenLayers.Format.XML.prototype.read=function(E){var C=E.indexOf("<");if(C>0){E=E.substring(C)}var D=OpenLayers.Util.Try(OpenLayers.Function.bind((function(){var F;if(window.ActiveXObject&&!this.xmldom){F=new ActiveXObject("Microsoft.XMLDOM")}else{F=this.xmldom}F.loadXML(E);return F}),this),function(){return new DOMParser().parseFromString(E,"text/xml")},function(){var F=new XMLHttpRequest();F.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(E),false);if(F.overrideMimeType){F.overrideMimeType("text/xml")}F.send(null);return F.responseXML});var B=OpenLayers.Request.XMLHttpRequest.getParseErrorText(D);if(B!=OpenLayers.Request.XMLHttpRequest.PARSED_OK&&B!=OpenLayers.Request.XMLHttpRequest.PARSED_EMPTY){alert(OpenLayers.i18n(B))}if(this.keepData){this.data=D}return D};OpenLayers.Format.XML.prototype.write=function(C){var D;if(C.xml!=undefined){D=C.xml}else{var B=new XMLSerializer();if(C.nodeType==1){var E=document.implementation.createDocument("","",null);if(E.importNode){C=E.importNode(C,true)}E.appendChild(C);D=B.serializeToString(E)}else{D=B.serializeToString(C)}}return D};OpenLayers.Format.KML.prototype.setAttributeNS=OpenLayers.Format.OSM.prototype.setAttributeNS=OpenLayers.Format.XML.prototype.setAttributeNS=function(E,D,B,F){if(F==null||F==undefined){F=""}if(E.setAttributeNS){E.setAttributeNS(D,B,F)}else{if(this.xmldom){if(D){var C=E.ownerDocument.createNode(2,B,D);C.nodeValue=F;E.setAttributeNode(C)}else{E.setAttribute(B,F)}}else{throw OpenLayers.i18n("xml.setattributens")}}};OpenLayers.Format.KML.prototype.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Format.KML.prototype.extractFolders=false;OpenLayers.Format.KML.prototype.read=function(C){this.features=[];this.styles={};this.fetched={};if(this.extractFolders){this.folders={}}var B={depth:0,styleBaseUrl:this.styleBaseUrl};this.parseData(C,B);return this.extractFolders?this.folders:this.features};OpenLayers.Format.KML.prototype.parseData=function(C,J){if(typeof C=="string"){C=OpenLayers.Format.XML.prototype.read.apply(this,[C])}var F=["Link","NetworkLink","Style","StyleMap","Placemark"];for(var D=0,G=F.length;D<G;++D){var H=F[D];var B=this.getElementsByTagNameNS(C,"*",H);if(B.length==0){continue}switch(H.toLowerCase()){case"link":case"networklink":this.parseLinks(B,J);break;case"style":if(this.extractStyles){this.parseStyles(B,J)}break;case"stylemap":if(this.extractStyles){this.parseStyleMaps(B,J)}break;case"placemark":this.parseFeatures(B,J);break}}if(this.extractFolders){var E=[];for(var I in this.folders){E.push(this.folders[I])}this.folders=E}return this.features};OpenLayers.Format.KML.prototype.parseStyles=function(C,D){for(var F=0,B=C.length;F<B;F++){var G=this.parseStyle(C[F]);if(G){var E=(D.styleBaseUrl||"")+"#"+G.id;this.styles[E]=G}}};OpenLayers.Format.KML.prototype.parseStyle=function(R){var j={};var d=["LineStyle","PolyStyle","IconStyle","BalloonStyle"];var AC,H,I,O,v;for(var q=0,K=d.length;q<K;++q){AC=d[q];v=this.getElementsByTagNameNS(R,"*",AC)[0];if(!v){continue}switch(AC.toLowerCase()){case"linestyle":var N=this.parseProperty(v,"*","color");if(N){var C=(N.toString()).match(this.regExes.kmlColor);var l=C[1];j.strokeOpacity=parseInt(l,16)/255;var AB=C[2];var z=C[3];var f=C[4];j.strokeColor="#"+f+z+AB}var B=this.parseProperty(v,"*","width");if(B){j.strokeWidth=B}case"polystyle":var N=this.parseProperty(v,"*","color");if(N){var C=(N.toString()).match(this.regExes.kmlColor);var l=C[1];j.fillOpacity=parseInt(l,16)/255;var AB=C[2];var z=C[3];var f=C[4];j.fillColor="#"+f+z+AB}var J=this.parseProperty(v,"*","fill");if(J=="0"){j.fillColor="none"}break;case"iconstyle":var S=parseFloat(this.parseProperty(v,"*","scale")||1);var B=32*S;var D=32*S;var E=this.getElementsByTagNameNS(v,"*","Icon")[0];if(E){var M=this.parseProperty(E,"*","href");if(M){var a=this.parseProperty(E,"*","w");var u=this.parseProperty(E,"*","h");var G="http://maps.google.com/mapfiles/kml";if(OpenLayers.String.startsWith(M,G)&&!a&&!u){a=64;u=64;S=S/2}a=a||u;u=u||a;if(a){B=parseInt(a)*S}if(u){D=parseInt(u)*S}var C=M.match(this.regExes.kmlIconPalette);if(C){var m=C[1];var L=C[2];var Z=this.parseProperty(E,"*","x");var Y=this.parseProperty(E,"*","y");var U=Z?Z/32:0;var T=Y?(7-Y/32):7;var Q=T*8+U;M="http://maps.google.com/mapfiles/kml/pal"+m+"/icon"+Q+L}j.graphicOpacity=1;j.externalGraphic=M}}var W=this.getElementsByTagNameNS(v,"*","hotSpot")[0];if(W){var Z=parseFloat(W.getAttribute("x"));var Y=parseFloat(W.getAttribute("y"));var P=W.getAttribute("xunits");if(P=="pixels"){j.graphicXOffset=-Z*S}else{if(P=="insetPixels"){j.graphicXOffset=-B+(Z*S)}else{if(P=="fraction"){j.graphicXOffset=-B*Z}}}var F=W.getAttribute("yunits");if(F=="pixels"){j.graphicYOffset=-D+(Y*S)+1}else{if(F=="insetPixels"){j.graphicYOffset=-(Y*S)+1}else{if(F=="fraction"){j.graphicYOffset=-D*(1-Y)+1}}}}j.graphicWidth=B;j.graphicHeight=D;break;case"balloonstyle":var AA=this.getElementsByTagNameNS(v,"*","text")[0];if(AA){AA=OpenLayers.Util.getXmlNodeValue(AA)}if(AA){j.balloonStyle=AA.replace(this.regExes.straightBracket,"${$1}")}break;default:}}if(!j.strokeColor&&j.fillColor){j.strokeColor=j.fillColor}var V=R.getAttribute("id");if(V&&j){j.id=V}return j};OpenLayers.Format.KML.prototype.parseFeatures=function(C,M){var G=new Array(C.length);for(var H=0,J=C.length;H<J;H++){var E=C[H];var I=E.parentNode;var L=this.parseFeature.apply(this,[E]);if(L){if(this.extractStyles&&L.attributes&&L.attributes.styleUrl){L.style=this.getStyle(L.attributes.styleUrl,M)}if(this.extractStyles){var K=this.getElementsByTagNameNS(E,"*","Style")[0];if(K){var F=this.parseStyle(K);if(F){L.style=OpenLayers.Util.extend(L.style,F)}}}if(I&&I.nodeName.toLowerCase()=="folder"&&this.extractFolders){var D=this.parseAttributes(I);var B=D.name;if(this.folders[B]==undefined){this.folders[B]=D;this.folders[B]["features"]=[]}this.folders[B].features.push(L)}G[H]=L}else{throw"Bad Placemark: "+H}}this.features=this.features.concat(G)};OpenLayers.Format.KML.prototype.parseAttributes=function(E){var F={};var G=E.getElementsByTagName("ExtendedData");if(G.length){F=this.parseExtendedData(G[0])}var C,L,K;var D=E.childNodes;for(var H=0,I=D.length;H<I;++H){C=D[H];if(C.nodeType==1){L=C.childNodes;if(1<=L.length&&L.length<=3){var K;switch(L.length){case 1:K=L[0];break;case 2:if(L[0].nodeType==4){K=L[0];break}K=L[1];break;case 3:default:K=L[1];break}if(K.nodeType==3||K.nodeType==4){var B=(C.prefix)?C.nodeName.split(":")[1]:C.nodeName;var J=OpenLayers.Util.getXmlNodeValue(K);if(J){J=J.replace(this.regExes.trimSpace,"");F[B]=J}}}}}return F};OpenLayers.Format.KML.prototype.parseExtendedData=function(C){var E={};var I=1;var D=null;var G,J=0;var F,M,H,N,L,B;do{switch(I){case 1:D=C.getElementsByTagName("Data");break;case 2:D=C.getElementsByTagName("SimpleData");break;case 3:var K=this.getAttributeNodeNS(C,"xlink","prefix");if(K==null){D=[]}else{D=this.getElementsByTagNameNS(C,K.nodeValue,"*")}default:D=[];break}J=D.length;if(J==0){I++;continue}for(G=0;G<J;G++){F=D[G];M=I!=3?F.getAttribute("name"):(F.localName||F.nodeName.split(":").pop());H={};N=I==1?F.getElementsByTagName("value"):[F];L="";if(N.length>0){N=N[0].childNodes;switch(N.length){case 0:N=null;break;case 1:N=N[0];break;case 2:if(N[0].nodeType==4){N=N[0];break}N=N[1];break;case 3:default:N=N[1];break}if(N&&(N.nodeType==3||N.nodeType==4)){L=OpenLayers.Util.getXmlNodeValue(N);if(L){L=L.replace(this.regExes.trimSpace,"")}}}H.value=L;B=F.getElementsByTagName("displayName");if(B.length){H.displayName=this.getChildValue(B[0])}E[M]=H}I++}while(I<=3);return E};OpenLayers.Format.OSM.prototype.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.String.sprintf=function(){function G(M,I,J,L){var K=(M.length>=I)?"":Array(1+I-M.length>>>0).join(J);return L?M+K:K+M}function D(L,K,N,I,J){var M=I-L.length;if(M>0){if(N||!J){L=G(L,I," ",N)}else{L=L.slice(0,K.length)+G("",M,"0",true)+L.slice(K.length)}}return L}function H(O,N,M,P,J,I,L){var K=O>>>0;M=M&&K&&{"2":"0b","8":"0","16":"0x"}[N]||"";O=M+G(K.toString(N),I||0,"0",false);return D(O,M,P,J,L)}function B(L,M,J,I,K){if(I!=null){L=L.slice(0,I)}return D(L,"",M,J,K)}var C=arguments,E=0,F=C[E++];return F.replace(OpenLayers.String.sprintf.regex,function(S,W,K,J,Z,P,V){if(S=="%%"){return"%"}var L=false,U="",R=false,T=false;for(var O=0;K&&O<K.length;O++){switch(K.charAt(O)){case" ":U=" ";break;case"+":U="+";break;case"-":L=true;break;case"0":R=true;break;case"#":T=true;break}}if(!J){J=0}else{if(J=="*"){J=+C[E++]}else{if(J.charAt(0)=="*"){J=+C[J.slice(1,-1)]}else{J=+J}}}if(J<0){J=-J;L=true}if(!isFinite(J)){throw new Error("sprintf: (minimum-)width must be finite")}if(!P){P="fFeE".indexOf(V)>-1?6:(V=="d")?0:void (0)}else{if(P=="*"){P=+C[E++]}else{if(P.charAt(0)=="*"){P=+C[P.slice(1,-1)]}else{P=+P}}}var Y=W?C[W.slice(0,-1)]:C[E++];switch(V){case"s":return B(String(Y),L,J,P,R);case"c":return B(String.fromCharCode(+Y),L,J,P,R);case"b":return H(Y,2,T,L,J,P,R);case"o":return H(Y,8,T,L,J,P,R);case"x":return H(Y,16,T,L,J,P,R);case"X":return H(Y,16,T,L,J,P,R).toUpperCase();case"u":return H(Y,10,T,L,J,P,R);case"i":case"d":var N=parseInt(+Y);var Q=N<0?"-":U;Y=Q+G(String(Math.abs(N)),P,"0",false);return D(Y,Q,L,J,R);case"e":case"E":case"f":case"F":case"g":case"G":var N=+Y;var Q=N<0?"-":U;var I=["toExponential","toFixed","toPrecision"]["efg".indexOf(V.toLowerCase())];var M=["toString","toUpperCase"]["eEfFgG".indexOf(V)%2];Y=Q+Math.abs(N)[I](P);return D(Y,Q,L,J,R)[M]();default:return S}})};OpenLayers.String.sprintf.regex=/%%|%(\d+\$)?([-+#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g;OpenLayers.Lang.en["olControlDragPan.title"]="Pan";OpenLayers.Lang.en["olControlZoomBox.title"]="Zoom in";OpenLayers.Lang.en["olControlZoomToMaxExtent.title"]="Zoom to max extent";OpenLayers.Lang.en["Document contains no parsing errors"]="Document contains no parsing errors";OpenLayers.Lang.en["Document is empty"]="Document is empty";OpenLayers.Lang.en["Not well-formed or other error"]="Not well-formed or other error";OpenLayers.Lang.en["xml.parse.error"]="XML Parsing Error: ${reason}\nLocation: ${url}\nLine Number ${line}, Column ${linepos}:\n ${srcText}\n";OpenLayers.Lang.en["wmc.version.not.supported"]="Can't find a WMC parser for version ${v}";OpenLayers.Lang.en["xml.setattributens"]="setAttributeNS not implemented";OpenLayers.Lang.en.Graticule="Graticule";if(typeof (OpenLayers.Lang.de)!="undefined"){OpenLayers.Lang.de["olControlDragPan.title"]=OpenLayers.Lang.en["olControlDragPan.title"];OpenLayers.Lang.de["olControlZoomBox.title"]=OpenLayers.Lang.en["olControlZoomBox.title"];OpenLayers.Lang.de["olControlZoomToMaxExtent.title"]=OpenLayers.Lang.en["olControlZoomToMaxExtent.title"];OpenLayers.Lang.de["Document contains no parsing errors"]=OpenLayers.Lang.en["Document contains no parsing errors"];OpenLayers.Lang.de["Document is empty"]=OpenLayers.Lang.en["Document is empty"];OpenLayers.Lang.de["Not well-formed or other error"]=OpenLayers.Lang.en["Not well-formed or other error"];OpenLayers.Lang.de["xml.parse.error"]=OpenLayers.Lang.en["xml.parse.error"];OpenLayers.Lang.de["wmc.version.not.supported"]=OpenLayers.Lang.en["wmc.version.not.supported"];OpenLayers.Lang.de["xml.setattributens"]=OpenLayers.Lang.en["xml.setattributens"];OpenLayers.Lang.de.Graticule="Geografische Koordinaten"}if(typeof (OpenLayers.Lang.es)!="undefined"){OpenLayers.Lang.es["olControlDragPan.title"]=OpenLayers.Lang.en["olControlDragPan.title"];OpenLayers.Lang.es["olControlZoomBox.title"]=OpenLayers.Lang.en["olControlZoomBox.title"];OpenLayers.Lang.es["olControlZoomToMaxExtent.title"]=OpenLayers.Lang.en["olControlZoomToMaxExtent.title"];OpenLayers.Lang.es["Document contains no parsing errors"]=OpenLayers.Lang.en["Document contains no parsing errors"];OpenLayers.Lang.es["Document is empty"]=OpenLayers.Lang.en["Document is empty"];OpenLayers.Lang.es["Not well-formed or other error"]=OpenLayers.Lang.en["Not well-formed or other error"];OpenLayers.Lang.es["xml.parse.error"]=OpenLayers.Lang.en["xml.parse.error"];OpenLayers.Lang.es["wmc.version.not.supported"]=OpenLayers.Lang.en["wmc.version.not.supported"];OpenLayers.Lang.es["xml.setattributens"]=OpenLayers.Lang.en["xml.setattributens"];OpenLayers.Lang.es.Graticule="Coordenadas geográficas"}if(typeof (OpenLayers.Lang.fr)!="undefined"){OpenLayers.Lang.fr["olControlDragPan.title"]="Déplacer le fond de carte";OpenLayers.Lang.fr["olControlZoomBox.title"]="Se rapprocher";OpenLayers.Lang.fr["olControlZoomToMaxExtent.title"]="Voir l'emprise totale";OpenLayers.Lang.fr["Document contains no parsing errors"]="Le document ne contient aucune erreur d'analyse";OpenLayers.Lang.fr["Document is empty"]="Le document est vide";OpenLayers.Lang.fr["Not well-formed or other error"]="Le document n'est pas bien formé ou une autre erreur s'est produite";OpenLayers.Lang.fr["xml.parse.error"]="Erreur d'analyse XML : ${reason}\nLocalisation : ${url}\nNuméro de ligne ${line}, colonne ${linepos} :\n ${srcText}\n";OpenLayers.Lang.fr["wmc.version.not.supported"]="Impossible de trouver un analyseur pour la version ${v} de WMC";OpenLayers.Lang.fr["xml.setattributens"]="setAttributeNS n'est pas implementé";OpenLayers.Lang.fr.Graticule="Repères géographiques"}if(typeof (OpenLayers.Lang.it)!="undefined"){OpenLayers.Lang.it["olControlDragPan.title"]=OpenLayers.Lang.en["olControlDragPan.title"];OpenLayers.Lang.it["olControlZoomBox.title"]=OpenLayers.Lang.en["olControlZoomBox.title"];OpenLayers.Lang.it["olControlZoomToMaxExtent.title"]=OpenLayers.Lang.en["olControlZoomToMaxExtent.title"];OpenLayers.Lang.it["Document contains no parsing errors"]=OpenLayers.Lang.en["Document contains no parsing errors"];OpenLayers.Lang.it["Document is empty"]=OpenLayers.Lang.en["Document is empty"];OpenLayers.Lang.it["Not well-formed or other error"]=OpenLayers.Lang.en["Not well-formed or other error"];OpenLayers.Lang.it["xml.parse.error"]=OpenLayers.Lang.en["xml.parse.error"];OpenLayers.Lang.it["wmc.version.not.supported"]=OpenLayers.Lang.en["wmc.version.not.supported"];OpenLayers.Lang.it["xml.setattributens"]=OpenLayers.Lang.en["xml.setattributens"];OpenLayers.Lang.it.Graticule="Coordinate geografiche"}OpenLayers.Util.DEFAULT_PRECISION=0;OpenLayers.Util.onImageLoadError=function(){if(this.src.match(/^http:\/\/[abc]\.[a-z]+\.openstreetmap\.org\//)){this.src="http://openstreetmap.org/openlayers/img/404.png"}else{if(this.src.match(/^http:\/\/[def]\.tah\.openstreetmap\.org\//)){}else{this._attempts=(this._attempts)?(this._attempts+1):1;if(this._attempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS){var E=this.urls;if(E&&E instanceof Array&&E.length>1){var F=this.src.toString();var D,B;for(B=0;D=E[B];B++){if(F.indexOf(D)!=-1){break}}var G=Math.floor(E.length*Math.random());var C=E[G];B=0;while(C==D&&B++<4){G=Math.floor(E.length*Math.random());C=E[G]}this.src=F.replace(D,C)}else{this.src=this.src}}else{if(this.layer.onLoadError){this.src=this.layer.onLoadError()}else{if(this.src.match(/TRANSPARENT=true/i)){this.src=OpenLayers.Util.getImagesLocation()+"blank.gif"}else{this.src=Geoportal.Util.getImagesLocation()+"stripe.gif"}}}this.style.display=""}}};OpenLayers.Request.getFQDNForUrl=function(B){if(B){var C=B.match(/^[a-z]+:\/\/([^\/]+)\/?/i);if(C){return C[1]}return window.location.host}return null};OpenLayers.Request.setProxyUrl=function(B){OpenLayers.ProxyHost=B;OpenLayers.ProxyHostFQDN=OpenLayers.Request.getFQDNForUrl(B);Proj4js.setProxyUrl(B)};OpenLayers.Request.proxyfyUrl=function(D,E,B){if(D){if(!OpenLayers.String.startsWith(B,D)){if(B.search(/^[a-z]+:\/\//i)!=-1){var C=B.match(/^[a-z]+:\/\/([^\/]*)\/?/i);if(C){C=C[1]}if(E!=C){B=D+encodeURIComponent(B)}}}}return B};OpenLayers.Request.issue=function(E){var H=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});E=OpenLayers.Util.applyDefaults(E,H);var G=new OpenLayers.Request.XMLHttpRequest();var B=E.url;if(E.params){var F=OpenLayers.Util.getParameterString(E.params);if(F.length>0){var J=(B.indexOf("?")>-1)?"&":"?";B+=J+F}}if(E.proxy){B=OpenLayers.Request.proxyfyUrl(E.proxy,OpenLayers.Request.getFQDNForUrl(E.proxy),B)}G.open(E.method,B,E.async,E.user,E.password);for(var I in E.headers){G.setRequestHeader(I,E.headers[I])}var C=(E.scope)?OpenLayers.Function.bind(E.callback,E.scope):E.callback;var K;if(E.success){K=(E.scope)?OpenLayers.Function.bind(E.success,E.scope):E.success}var D;if(E.failure){D=(E.scope)?OpenLayers.Function.bind(E.failure,E.scope):E.failure}var L=this.events;G.onreadystatechange=function(){if(G.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var M=L.triggerEvent("complete",{request:G,config:E,requestUrl:B});if(M!==false){C(G);if(!G.status||(G.status>=200&&G.status<300)){L.triggerEvent("success",{request:G,config:E,requestUrl:B});if(K){K(G)}}if(G.status&&(G.status<200||G.status>=300)){L.triggerEvent("failure",{request:G,config:E,requestUrl:B});if(D){D(G)}}}}};if(E.async===false){G.send(E.data)}else{window.setTimeout(function(){G.send(E.data)},0)}return G};if(!window.Node||!Node.ELEMENT_NODE){Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}}(function(){var F=window.XMLHttpRequest;var B=!!window.controllers,J=window.document.all&&!window.opera;function D(){this._object=F?new F:new window.ActiveXObject("Microsoft.XMLHTTP")}if(B&&F.wrapped){D.wrapped=F.wrapped}D.UNSENT=0;D.OPENED=1;D.HEADERS_RECEIVED=2;D.LOADING=3;D.DONE=4;D.PARSED_OK="Document contains no parsing errors";D.PARSED_EMPTY="Document is empty";D.PARSED_UNKNOWN_ERROR="Not well-formed or other error";D.prototype.readyState=D.UNSENT;D.prototype.responseText="";D.prototype.responseXML=null;D.prototype.status=0;D.prototype.statusText="";D.prototype.onreadystatechange=null;D.onreadystatechange=null;D.onopen=null;D.onsend=null;D.onabort=null;D.prototype.open=function(N,Q,M,R,L){this._async=M;var P=this,O=this.readyState;if(J){var K=function(){if(P._object.readyState!=D.DONE){E(P)}};if(M){window.attachEvent("onunload",K)}}this._object.onreadystatechange=function(){if(B&&!M){return }P.readyState=P._object.readyState;H(P);if(P._aborted){P.readyState=D.UNSENT;return }if(P.readyState==D.DONE){E(P);if(J&&M){window.detachEvent("onunload",K)}}if(O!=P.readyState){C(P)}O=P.readyState};if(D.onopen){D.onopen.apply(this,arguments)}this._object.open(N,Q,M,R,L);if(!M&&B){this.readyState=D.OPENED;C(this)}};D.prototype.send=function(K){if(D.onsend){D.onsend.apply(this,arguments)}if(K&&K.nodeType){K=window.XMLSerializer?new window.XMLSerializer().serializeToString(K):K.xml;if(!this._headers["Content-Type"]){this._object.setRequestHeader("Content-Type","application/xml")}}this._object.send(K);if(B&&!this._async){this.readyState=D.OPENED;H(this);while(this.readyState<D.DONE){this.readyState++;C(this);if(this._aborted){return }}}};D.prototype.abort=function(){if(D.onabort){D.onabort.apply(this,arguments)}if(this.readyState>D.UNSENT){this._aborted=true}this._object.abort();E(this)};D.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()};D.prototype.getResponseHeader=function(K){return this._object.getResponseHeader(K)};D.prototype.setRequestHeader=function(K,L){if(!this._headers){this._headers={}}this._headers[K]=L;return this._object.setRequestHeader(K,L)};D.prototype.toString=function(){return"[object XMLHttpRequest]"};D.toString=function(){return"[XMLHttpRequest]"};D.getParseErrorText=function(K){if(!K){return this.PARSED_EMPTY}var N=this.PARSED_OK;if(J){if(K.parseError&&K.parseError.errorCode&&K.parseError.errorCode!=0){N=OpenLayers.i18n("xml.parse.error",{reason:K.parseError.reason,url:K.parseError.url,line:K.parseError.line,linepos:K.parseError.linepos,srcText:K.parseError.srcText});for(var M=0;M<K.parseError.linepos;M++){N+="-"}N+="^\n"}else{if(!K.documentElement){return this.PARSED_EMPTY}}}else{if(K.documentElement&&K.documentElement.tagName=="parsererror"){N=K.documentElement.firstChild.data;N+="\n"+K.documentElement.firstChild.nextSibling.firstChild.data}else{if(K.getElementsByTagName("parsererror").length>0){var L=K.getElementsByTagName("parsererror")[0];N=G(L,true)+"\n"}else{if(K.parseError&&K.parseError.errorCode!=0){N=this.PARSED_UNKNOWN_ERROR}else{if(!K.documentElement){return this.PARSED_EMPTY}}}}}return N};function C(K){if(K.onreadystatechange){K.onreadystatechange.apply(K)}if(D.onreadystatechange){D.onreadystatechange.apply(K)}}function G(R,M){var P="";var N=R.childNodes;for(var O=0,K=N.length;O<K;O++){var Q=N[O];var L=Q.nodeType;if(L==Node.TEXT_NODE||L==Node.CDATA_SECTION_NODE){P+=Q.data}else{if(M===true&&(L==Node.ELEMENT_NODE||L==Node.DOCUMENT_NODE||L==Node.DOCUMENT_FRAGMENT_NODE)){P+=G(Q,true)}}}return P}function I(L){var K=L.responseXML;if(J&&K&&!K.documentElement){K=new ActiveXObject("Microsoft.XMLDOM");try{K.loadXML(L.responseText)}catch(M){}}if(K){if((J&&K.parseError&&K.parseError.errorCode!=0)||(K.documentElement&&K.documentElement.tagName=="parsererror")){return null}}return K}function H(K){try{K.responseText=K._object.responseText}catch(L){}try{K.responseXML=I(K._object)}catch(L){}try{K.status=K._object.status}catch(L){}try{K.statusText=K._object.statusText}catch(L){}}function E(K){K._object.onreadystatechange=new window.Function;delete K._headers}if(!window.Function.prototype.apply){window.Function.prototype.apply=function(K,L){if(!L){L=[]}K.__func=this;K.__func(L[0],L[1],L[2],L[3],L[4]);delete K.__func}}OpenLayers.Request.XMLHttpRequest=D})();OpenLayers.ProxyHostFQDN=null;OpenLayers.Ajax.Request.prototype.initialize=function(C,B){OpenLayers.Ajax.Base.prototype.initialize.apply(this,[B]);C=OpenLayers.Request.proxyfyUrl(C);this.transport=OpenLayers.Ajax.getTransport();this.request(C)};OpenLayers.Handler.Feature.prototype.moveLayerToTop=function(){if(this.map){var B=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(B)}};OpenLayers.Handler.Feature.prototype.moveLayerBack=function(){if(this.map){var B=this.layer.getZIndex()-1;if(B>=this.map.Z_INDEX_BASE.Feature){this.layer.setZIndex(B)}else{this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))}}};OpenLayers.Control.ZoomToMaxExtent.prototype.destroy=OpenLayers.Control.ZoomBox.prototype.destroy=OpenLayers.Control.WMSGetFeatureInfo.prototype.destroy=OpenLayers.Control.Measure.prototype.destroy=OpenLayers.Control.DrawFeature.prototype.destroy=OpenLayers.Control.DragPan.prototype.destroy=OpenLayers.Control.prototype.destroy=function(){if(this.events){if(this.eventListeners){this.events.un(this.eventListeners)}this.events.destroy();this.events=null}this.eventListeners=null;if(this.handler){this.handler.destroy();this.handler=null}if(this.handlers){for(var B in this.handlers){if(this.handlers.hasOwnProperty(B)&&typeof this.handlers[B].destroy=="function"){this.handlers[B].destroy()}}this.handlers=null}if(this.map){this.map.events.unregister("changelang",this,this.changeLang);this.map.removeControl(this);this.map=null}};OpenLayers.Control.ZoomToMaxExtent.prototype.setMap=OpenLayers.Control.ZoomBox.prototype.setMap=OpenLayers.Control.Panel.prototype.setMap=OpenLayers.Control.Navigation.prototype.setMap=OpenLayers.Control.Measure.prototype.setMap=OpenLayers.Control.KeyboardDefaults.prototype.setMap=OpenLayers.Control.DrawFeature.prototype.setMap=OpenLayers.Control.DragPan.prototype.setMap=OpenLayers.Control.prototype.setMap=function(B){this.map=B;this.map.events.register("changelang",this,this.changeLang);if(this.handler){this.handler.setMap(B)}};OpenLayers.Control.ZoomToMaxExtent.prototype.draw=OpenLayers.Control.WMSGetFeatureInfo.prototype.draw=OpenLayers.Control.SelectFeature.prototype.draw=OpenLayers.Control.ModifyFeature.prototype.draw=OpenLayers.Control.Measure.prototype.draw=OpenLayers.Control.DrawFeature.prototype.draw=OpenLayers.Control.DragFeature.prototype.draw=OpenLayers.Control.prototype.draw=function(B){if(this.div==null){this.div=OpenLayers.Util.createDiv(this.id);this.div.className=this.displayClass;if(!this.allowSelection){this.div.className+=" olControlNoSelect"}if(this.title!=""){if(this.div&&!this.panel_div){this.div.title=OpenLayers.i18n(this.title)}else{if(this.panel_div){this.panel_div.title=OpenLayers.i18n(this.title)}}}}if(B!=null){this.position=B.clone()}this.moveTo(this.position);return this.div};OpenLayers.Control.ZoomToMaxExtent.prototype.changeLang=OpenLayers.Control.ZoomBox.prototype.changeLang=OpenLayers.Control.WMSGetFeatureInfo.prototype.changeLang=OpenLayers.Control.SelectFeature.prototype.changeLang=OpenLayers.Control.Navigation.prototype.changeLang=OpenLayers.Control.ModifyFeature.prototype.changeLang=OpenLayers.Control.Measure.prototype.changeLang=OpenLayers.Control.KeyboardDefaults.prototype.changeLang=OpenLayers.Control.DrawFeature.prototype.changeLang=OpenLayers.Control.DragPan.prototype.changeLang=OpenLayers.Control.DragFeature.prototype.changeLang=OpenLayers.Control.prototype.changeLang=function(B){if(this.title!=""&&this.div){this.div.title=OpenLayers.i18n(this.title)}};OpenLayers.Map.prototype.EVENT_TYPES=["preaddlayer","addlayer","removelayer","changelayer","movestart","move","moveend","zoomend","popupopen","popupclose","addmarker","removemarker","clearmarkers","mouseover","mouseout","mousemove","dragstart","drag","dragend","changebaselayer","changelang","changedisplayprojection","controlactivated","beforemove"];OpenLayers.Map.prototype.moveTo=function(I,C,E){var N={zoom:C,lonlat:I,options:E};if(this.events.triggerEvent("beforemove",N)===false){return }C=N.zoom;I=N.lonlat;var S=I?I.clone():null;if(!E){E={}}var O=E.dragging;var J=E.forceZoomChange;var D=E.noEvent;if(this.panTween&&E.caller=="setCenter"){this.panTween.stop()}if(!this.center&&!this.isValidLonLat(S)){if(this.size){var F=new OpenLayers.Pixel(this.size.w/2,this.size.h/2);S=this.getLonLatFromViewPortPx(F)}else{S=this.getMaxExtent().getCenterLonLat()}}if(this.restrictedExtent!=null){if(S==null){S=this.getCenter()}if(C==null){C=this.getZoom()}var P=this.getResolutionForZoom(C);var M=this.calculateBounds(S,P);if(M!=null&&!this.restrictedExtent.containsBounds(M)){var U=this.restrictedExtent.getCenterLonLat();if(M.getWidth()>this.restrictedExtent.getWidth()){S=new OpenLayers.LonLat(U.lon,S.lat)}else{if(M.left<this.restrictedExtent.left){S=S.add(this.restrictedExtent.left-M.left,0)}else{if(M.right>this.restrictedExtent.right){S=S.add(this.restrictedExtent.right-M.right,0)}}}if(M.getHeight()>this.restrictedExtent.getHeight()){S=new OpenLayers.LonLat(S.lon,U.lat)}else{if(M.bottom<this.restrictedExtent.bottom){S=S.add(0,this.restrictedExtent.bottom-M.bottom)}else{if(M.top>this.restrictedExtent.top){S=S.add(0,this.restrictedExtent.top-M.top)}}}}}var K=J||((this.isValidZoomLevel(C))&&(C!=this.getZoom()));var L=(this.getProjection()?this.getProjection().getProjName()=="longlat"?0.000028:1:undefined);var H=!(S&&this.isValidLonLat(S)&&S.equals(this.center,L));if(K||H||!O){if(!this.dragging&&!D){this.events.triggerEvent("movestart")}if(H&&S!=null){if((!K)&&(this.center)){this.centerLayerContainer(S)}this.center=S.clone()}if((K)||(this.layerContainerOrigin==null)){this.layerContainerOrigin=this.center?this.center.clone():null;this.layerContainerDiv.style.left="0px";this.layerContainerDiv.style.top="0px"}if(K){this.zoom=C;this.resolution=this.getResolutionForZoom(C);this.viewRequestID++}var G=this.getExtent();if(G&&this.baseLayer.visibility){this.baseLayer.moveTo(G,K,O);if(O){this.baseLayer.events.triggerEvent("move")}else{this.baseLayer.events.triggerEvent("moveend",{zoomChanged:K})}}G=this.baseLayer.getExtent();for(var Q=0,R=this.layers.length;Q<R;Q++){var T=this.layers[Q];if(T!==this.baseLayer&&!T.isBaseLayer){var B=T.calculateInRange();if(T.inRange!=B){T.inRange=B;if(!B){T.display(false)}this.events.triggerEvent("changelayer",{layer:T,property:"visibility"})}if(B&&T.visibility){T.moveTo(G,K,O);if(O){T.events.triggerEvent("move")}else{T.events.triggerEvent("moveend",{zoomChanged:K})}}}}if(K){for(var Q=0,R=this.popups.length;Q<R;Q++){this.popups[Q].updatePosition()}}this.events.triggerEvent("move");if(K){this.events.triggerEvent("zoomend")}}if(!O&&!D){this.events.triggerEvent("moveend")}this.dragging=!!O};OpenLayers.Map.prototype.setBaseLayer=function(E,F,I){var H=null;var G=null;var J=null;if(this.baseLayer){H=this.baseLayer;G=this.getProjection();J=this.baseLayer.getExtent()}if(E!=this.baseLayer){if(OpenLayers.Util.indexOf(this.layers,E)!=-1){if(E.events.triggerEvent("loadstart")===false){return }if(this.baseLayer!=null&&!this.allOverlays){this.baseLayer.setVisibility(false)}this.baseLayer=E;this.viewRequestID++;if(!this.allOverlays){this.baseLayer.visibility=true}this.events.triggerEvent("changebaselayer",{layer:E,baseLayer:H});E.events.triggerEvent("loadend");var B=this.getCenter();if(B!=null||F!=null){var C=(F)?F.clone():(J)?J.getCenterLonLat():B;C.transform(G,this.getProjection());var D=(typeof (I)=="number")?I:(J)?this.getZoomForExtent(J,true):this.getZoomForResolution(this.resolution,true);this.setCenter(C,D,false,true)}}}};OpenLayers.Map.prototype.addControlToMap=function(C,B){C.outsideViewport=C.outsideViewport||(C.div!=null);if(this.displayProjection&&!C.displayProjection){C.displayProjection=this.displayProjection}C.setMap(this);var D=C.draw(B);if(D){if(!C.outsideViewport){D.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length;this.viewPortDiv.appendChild(D)}}};OpenLayers.Layer.WMS.Untiled.prototype.setMap=OpenLayers.Layer.WMS.prototype.setMap=OpenLayers.Layer.Grid.prototype.setMap=OpenLayers.Layer.HTTPRequest.prototype.setMap=OpenLayers.Layer.prototype.setMap=function(F){if(this.map==null){this.map=F;this.projection=this.getNativeProjection();if(this.maxExtent){if(this.isBaseLayer){}else{this.maxExtent.transform(this.projection,this.map.getProjection(),true)}}else{var G=null;for(var E=0,C=F.layers.length;E<C;E++){var D=F.layers[E];if(!D.isBaseLayer){continue}if(this.projection.equals(D.getNativeProjection())){G=D;break}if(this.projection.isCompatibleWith(D.getNativeProjection())){G=D;continue}}if(G&&G.maxExtent){this.maxExtent=G.maxExtent.clone().transform(G.getNativeProjection(),this.map.getProjection(),true)}else{this.maxExtent=(new OpenLayers.Bounds(-180,-90,180,90)).transform(OpenLayers.Projection.CRS84,this.map.getProjection(),true)}}if(this.restrictedExtent){this.restrictedExtent.transform(this.projection,this.map.getProjection(),true)}if(this.projection){this.units=this.projection.getUnits()||this.units||this.map.units}this.initResolutions();if(!this.isBaseLayer){this.inRange=this.calculateInRange();var B=((this.visibility)&&(this.inRange));this.div.style.display=B?"":"none"}this.setTileSize()}};OpenLayers.Layer.WMS.Untiled.prototype.calculateInRange=OpenLayers.Layer.WMS.prototype.calculateInRange=OpenLayers.Layer.Vector.RootContainer.prototype.calculateInRange=OpenLayers.Layer.Vector.prototype.calculateInRange=OpenLayers.Layer.HTTPRequest.prototype.calculateInRange=OpenLayers.Layer.GML.prototype.calculateInRange=OpenLayers.Layer.Grid.prototype.calculateInRange=OpenLayers.Layer.prototype.calculateInRange=function(){var E=false;if(this.alwaysInRange){E=true}else{if(this.map){var C=this.map.getResolution();E=((C>=this.minResolution)&&(C<=this.maxResolution));if(E&&!this.isBaseLayer&&this.maxExtent){var D=this.map.calculateBounds();if(D){var B=this.restrictedExtent||this.maxExtent;E=D.intersectsBounds(B)}}}}return E};OpenLayers.Layer.WMS.Untiled.prototype.initResolutions=OpenLayers.Layer.WMS.prototype.initResolutions=OpenLayers.Layer.Vector.RootContainer.prototype.initResolutions=OpenLayers.Layer.Vector.prototype.initResolutions=OpenLayers.Layer.HTTPRequest.prototype.initResolutions=OpenLayers.Layer.GML.prototype.initResolutions=OpenLayers.Layer.Grid.prototype.initResolutions=OpenLayers.Layer.prototype.initResolutions=function(){var C=["projection","units"];var F=false;var E={};for(var G=0,I=this.RESOLUTION_PROPERTIES.length;G<I;G++){var N=this.RESOLUTION_PROPERTIES[G];if(this.options[N]&&OpenLayers.Util.indexOf(C,N)==-1){F=true}E[N]=this.options[N]||this.map[N]}if(this.alwaysInRange==null){this.alwaysInRange=!F}if((this.options.minScale!=null||this.options.maxScale!=null)&&this.options.scales==null){E.scales=null}if((this.options.minResolution!=null||this.options.maxResolution!=null)&&this.options.resolutions==null){E.resolutions=null}if((!E.numZoomLevels)&&(E.maxZoomLevel)){E.numZoomLevels=E.maxZoomLevel+1}if((E.scales!=null)||(E.resolutions!=null)){if(E.scales!=null){E.resolutions=[];for(var G=0,I=E.scales.length;G<I;G++){var D=E.scales[G];E.resolutions[G]=OpenLayers.Util.getResolutionFromScale(D,E.units)}}E.numZoomLevels=E.resolutions.length}else{if(E.minScale){E.maxResolution=OpenLayers.Util.getResolutionFromScale(E.minScale,E.units)}else{if(E.maxResolution=="auto"){var M=this.map.getSize();var L=E.maxExtent.getWidth()/M.w;var H=E.maxExtent.getHeight()/M.h;E.maxResolution=Math.max(L,H)}}if(E.maxScale!=null){E.minResolution=OpenLayers.Util.getResolutionFromScale(E.maxScale,E.units)}else{if((E.minResolution=="auto")&&(E.minExtent!=null)){var M=this.map.getSize();var L=E.minExtent.getWidth()/M.w;var H=E.minExtent.getHeight()/M.h;E.minResolution=Math.max(L,H)}}if(E.minResolution!=null&&this.options.numZoomLevels==undefined){var K=E.maxResolution/E.minResolution;E.numZoomLevels=Math.floor(Math.log(K)/Math.log(2))+1}E.resolutions=new Array(E.numZoomLevels);var B=2;if(typeof E.minResolution=="number"&&E.numZoomLevels>1){B=Math.pow((E.maxResolution/E.minResolution),(1/(E.numZoomLevels-1)))}for(var G=0;G<E.numZoomLevels;G++){var J=E.maxResolution/Math.pow(B,G);E.resolutions[G]=J}}E.resolutions.sort(function(P,O){return(O-P)});this.minZoomLevel=typeof (this.options.minZoomLevel)=="number"?this.options.minZoomLevel:this.map.minZoomLevel||0;this.maxZoomLevel=this.options.maxZoomLevel||this.map.maxZoomLevel||E.resolutions.length-1;if(this.minZoomLevel<0){this.minZoomLevel=0}if(this.maxZoomLevel>E.resolutions.length){this.maxZoomLevel=E.resolutions.length-1}this.resolutions=E.resolutions;this.maxResolution=E.resolutions[this.minZoomLevel];this.minResolution=E.resolutions[this.maxZoomLevel];this.scales=[];for(var G=0,I=E.resolutions.length;G<I;G++){this.scales[G]=OpenLayers.Util.getScaleFromResolution(E.resolutions[G],E.units)}this.minScale=this.scales[this.minZoomLevel];this.maxScale=this.scales[this.maxZoomLevel];this.numZoomLevels=E.numZoomLevels};OpenLayers.Layer.WMS.Untiled.prototype.setOpacity=OpenLayers.Layer.WMS.prototype.setOpacity=OpenLayers.Layer.Vector.RootContainer.prototype.setOpacity=OpenLayers.Layer.Vector.prototype.setOpacity=OpenLayers.Layer.HTTPRequest.prototype.setOpacity=OpenLayers.Layer.Grid.prototype.setOpacity=OpenLayers.Layer.GML.prototype.setOpacity=OpenLayers.Layer.prototype.setOpacity=function(C){if(C!=this.opacity){this.opacity=C;for(var E=0,B=this.div.childNodes.length;E<B;++E){var D=this.div.childNodes[E].firstChild;OpenLayers.Util.modifyDOMElement(D,null,null,null,null,null,null,C)}if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}}};OpenLayers.Popup.prototype.destroy=function(){this.id=null;this.lonlat=null;this.contentSize=null;this.size=null;this.contentHTML=null;this.backgroundColor=null;this.opacity=null;this.border=null;this.events.destroy();this.events=null;if(this.contentDiv){this.groupDiv.removeChild(this.contentDiv);this.contentDiv=null}this.contentDivPadding=null;if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.groupDiv.removeChild(this.closeDiv)}this.closeDiv=null;this.div.removeChild(this.groupDiv);this.groupDiv=null;if(this.map!=null){if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){this.map.events.unregister("movestart",this,this.onMoveStartPopup);this.map.events.unregister("moveend",this,this.onMoveEndPopup)}this.map.removePopup(this)}this.map=null;this.div=null;this.autoSize=null;this.minSize=null;this.maxSize=null;this.padding=null;this.panMapIfOutOfView=null};OpenLayers.Popup.Anchored.prototype.draw=OpenLayers.Popup.prototype.draw=function(B){if(B==null){if((this.lonlat!=null)&&(this.map!=null)){B=this.map.getLayerPxFromLonLat(this.lonlat)}}if(this.closeOnMove){this.map.events.register("movestart",this,this.hide)}if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){this.map.events.register("movestart",this,this.onMoveStartPopup);this.map.events.register("moveend",this,this.onMoveEndPopup)}this.moveTo(B);if(!this.autoSize&&!this.size){this.setSize(this.contentSize)}this.setBackgroundColor();this.setOpacity();this.setBorder();this.setContentHTML();if(this.panMapIfOutOfView){this.panIntoView()}return this.div};OpenLayers.Popup.AnchoredBubble.prototype.onMoveStartPopup=OpenLayers.Popup.Anchored.prototype.onMoveStartPopup=OpenLayers.Popup.prototype.onMoveStartPopup=function(){if(!this.contentDiv){return }var B=document.defaultView.getComputedStyle(this.contentDiv,null);var C=B.getPropertyValue("overflow");if(C!="hidden"){this.contentDiv._oldOverflow=C;this.contentDiv.style.overflow="hidden"}};OpenLayers.Popup.AnchoredBubble.prototype.onMoveEndPopup=OpenLayers.Popup.Anchored.prototype.onMoveEndPopup=OpenLayers.Popup.prototype.onMoveEndPopup=function(){if(!this.contentDiv){return }var B=this.contentDiv._oldOverflow;if(B){this.contentDiv.style.overflow=B;this.contentDiv._oldOverflow=null}};OpenLayers.Popup.AnchoredBubble.prototype.addCloseBox=OpenLayers.Popup.Anchored.prototype.addCloseBox=OpenLayers.Popup.prototype.addCloseBox=function(D){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,new OpenLayers.Size(17,17));this.closeDiv.className="olPopupCloseBox";var C=this.getContentDivPadding();this.closeDiv.style.right=C.right+"px";this.closeDiv.style.top=C.top+"px";this.groupDiv.appendChild(this.closeDiv);var B=D||function(E){this.hide();OpenLayers.Event.stop(E);if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){if(this.map&&this.map.events){this.map.events.unregister("movestart",this,this.onMoveStartPopup);this.map.events.unregister("moveend",this,this.onMoveEndPopup)}}};OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(B,this))};OpenLayers.Tile.prototype.initialize=function(E,B,F,C,D){this.layer=E;this.position=B.clone();this.bounds=F.clone();this.url=C;this.size=D.clone();this.id=OpenLayers.Util.createUniqueID("Tile_");this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);if(E.GeoRM){this.events.register("reload",this,this.updateGeoRM);this.events.register("loadstart",this,this.updateGeoRM)}};OpenLayers.Tile.prototype.destroy=function(){if(this.layer.GeoRM){this.events.unregister("reload",this,this.updateGeoRM);this.events.unregister("loadstart",this,this.updateGeoRM)}this.layer=null;this.bounds=null;this.size=null;this.position=null;this.events.destroy();this.events=null};OpenLayers.Tile.prototype.updateGeoRM=function(){return(this.layer.GeoRM.getToken()!=null)};OpenLayers.Tile.Image.prototype.destroy=function(){if(this.imgDiv!=null){if(this.layerAlphaHack){OpenLayers.Event.stopObservingElement(this.imgDiv.childNodes[0])}OpenLayers.Event.stopObservingElement(this.imgDiv);if(this.imgDiv.parentNode==this.frame){this.frame.removeChild(this.imgDiv);this.imgDiv.map=null}this.imgDiv.urls=null;this.imgDiv.src=OpenLayers.Util.getImagesLocation()+"blank.gif"}this.imgDiv=null;if((this.frame!=null)&&(this.frame.parentNode==this.layer.div)){this.layer.div.removeChild(this.frame)}this.frame=null;if(this.backBufferTile){this.backBufferTile.destroy();this.backBufferTile=null}this.layer.events.unregister("loadend",this,this.resetBackBuffer);OpenLayers.Tile.prototype.destroy.apply(this,arguments)};OpenLayers.Tile.Image.prototype.draw=function(){if(this.layer!=this.layer.map.baseLayer&&this.layer.reproject){this.bounds=this.getBoundsFromBaseLayer(this.position)}var B=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(OpenLayers.Util.indexOf(this.layer.SUPPORTED_TRANSITIONS,this.layer.transitionEffect)!=-1){if(B){if(!this.backBufferTile){this.backBufferTile=this.clone();this.backBufferTile.hide();this.backBufferTile.isBackBuffer=true;this.events.register("loadend",this,this.resetBackBuffer);this.layer.events.register("loadend",this,this.resetBackBuffer)}this.startTransition()}else{if(this.backBufferTile){this.backBufferTile.clear()}}}else{if(B&&this.isFirstDraw){this.events.register("loadend",this,this.showTile);this.isFirstDraw=false}}if(!B){return false}if(this.isLoading){if(this.events.triggerEvent("reload")===false){return }}else{this.isLoading=true;if(this.events.triggerEvent("loadstart")===false){return }}return this.renderTile()};OpenLayers.Tile.Image.prototype.initImgDiv=function(){var E=this.layer.imageOffset;var C=this.layer.getImageSize();if(this.layerAlphaHack){this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,E,C,null,"relative",null,null,null,true)}else{this.imgDiv=OpenLayers.Util.createImage(null,E,C,null,"relative",null,null,true)}this.imgDiv.className="olTileImage";this.frame.style.zIndex=this.isBackBuffer?0:1;this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);if(this.layer.opacity!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity)}this.imgDiv.map=this.layer.map;this.imgDiv.layer=this.layer;var D=function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("loadend")}};if(this.layerAlphaHack){OpenLayers.Event.observe(this.imgDiv.childNodes[0],"load",OpenLayers.Function.bind(D,this))}else{OpenLayers.Event.observe(this.imgDiv,"load",OpenLayers.Function.bind(D,this))}var B=function(){if(this.imgDiv._attempts>OpenLayers.IMAGE_RELOAD_ATTEMPTS){D.call(this)}};OpenLayers.Event.observe(this.imgDiv,"error",OpenLayers.Function.bind(B,this))};OpenLayers.Layer.Grid.prototype.changeBaseLayer=OpenLayers.Layer.HTTPRequest.prototype.changeBaseLayer=function(B){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){this.addOptions({projection:mapProj.clone()});this.redraw()}return true};OpenLayers.Layer.Grid.prototype.getCompatibleProjection=OpenLayers.Layer.HTTPRequest.prototype.getCompatibleProjection=OpenLayers.Layer.prototype.getCompatibleProjection;OpenLayers.Layer.Grid.prototype.addTileMonitoringHooks=function(B){B.onLoadStart=function(){if(this.numLoadingTiles==0){if(this.events.triggerEvent("loadstart")===false){return }}this.numLoadingTiles++};B.events.register("loadstart",this,B.onLoadStart);B.onLoadEnd=function(){this.numLoadingTiles--;this.events.triggerEvent("tileloaded");if(this.numLoadingTiles==0){this.events.triggerEvent("loadend")}};B.events.register("loadend",this,B.onLoadEnd);B.events.register("unload",this,B.onLoadEnd)};OpenLayers.Layer.WMS.Untiled.prototype.changeBaseLayer=OpenLayers.Layer.WMS.prototype.changeBaseLayer=function(B){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){var C=this.getCompatibleProjection(B.layer);if(C!=null){this.addOptions({projection:C.clone()});return true}this.setVisibility(false)}return true};OpenLayers.Layer.WMS.Untiled.prototype.getCompatibleProjection=OpenLayers.Layer.WMS.prototype.getCompatibleProjection=function(F){var E=OpenLayers.Layer.prototype.getCompatibleProjection.apply(this,arguments);if(E!=null){return E}if(F==null){F=this.map.baseLayer;if(F==null){return undefined}}var G=F.getNativeProjection();if(this.srs!==undefined&&this.srs instanceof Array){for(var D=0,B=this.srs.length;D<B;D++){var C=this.srs[D];if(!(C instanceof OpenLayers.Projection)){E=new OpenLayers.Projection(C)}else{E=C}if(E.isCompatibleWith(G)){return E}E=null}}return null};OpenLayers.Control.Navigation.prototype.draw=function(){if(this.handleRightClicks){this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False}var B={dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick};var C={"double":true,stopDouble:true};this.handlers.click=new OpenLayers.Handler.Click(this,B,C);this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map},this.dragPanOptions));this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask});this.dragPan.draw();this.zoomBox.draw();this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown});this.activate()};OpenLayers.Control.Navigation.prototype.deactivate=function(){if(this.zoomBox){this.zoomBox.deactivate()}if(this.dragPan){this.dragPan.deactivate()}if(this.handlers){if(this.handlers.click){this.handlers.click.deactivate()}if(this.handlers.wheel){this.handlers.wheel.deactivate()}}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)};OpenLayers.Control.OverviewMap.prototype.showToggle=function(B){if(!this.outsideViewport){this.maximizeDiv.style.display=B?"":"none";this.minimizeDiv.style.display=B?"none":""}};OpenLayers.Control.Panel.prototype.addPanelDiv=function(C){var B=document.createElement("div");if(C.panel_div){C.panel_div.parentNode.removeChild(C.panel_div);C.panel_div=null}C.panel_div=B;if(C.title!=""){C.panel_div.title=OpenLayers.i18n(C.title)}OpenLayers.Event.observe(C.panel_div,"click",OpenLayers.Function.bind(this.onClick,this,C));OpenLayers.Event.observe(C.panel_div,"mousedown",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop))};OpenLayers.Control.Panel.prototype.activateControl=function(D){if(!this.active){return false}if(D.type==OpenLayers.Control.TYPE_BUTTON){D.trigger();this.redraw();return }if(D.type==OpenLayers.Control.TYPE_TOGGLE){if(D.active){D.deactivate()}else{if(this.map){this.map.events.triggerEvent("controlactivated",{control:D})}D.activate()}this.redraw();return }for(var C=0,B=this.controls.length;C<B;C++){if(this.controls[C]!=D){if(this.controls[C].type!=OpenLayers.Control.TYPE_TOGGLE){this.controls[C].deactivate()}}}if(this.map){this.map.events.triggerEvent("controlactivated",{control:D})}D.activate()};OpenLayers.Control.Panel.prototype.addControls=function(C){if(!(C instanceof Array)){C=[C]}this.controls=this.controls.concat(C);for(var D=0,B=C.length;D<B;D++){this.addPanelDiv(C[D])}if(this.map){for(var D=0,B=C.length;D<B;D++){this.map.addControl(C[D]);C[D].deactivate();C[D].events.on({activate:this.redraw,deactivate:this.redraw,scope:this})}this.redraw()}};OpenLayers.Control.Panel.prototype.changeLang=function(C){for(var D=0,B=this.controls.length;D<B;D++){if(this.controls[D].title!=""){if(this.controls[D].panel_div){this.controls[D].panel_div.title=OpenLayers.i18n(this.controls[D].title)}else{if(this.controls[D].div){this.controls[D].div.title=OpenLayers.i18n(this.controls[D].title)}else{if(this.div&&this.div.childNodes&&this.div.childNodes[D]){this.div.childNodes[D].title=OpenLayers.i18n(this.controls[D].title)}}}}}};OpenLayers.Layer.GML.prototype.labelOffset=OpenLayers.Layer.Vector.prototype.labelOffset=null;OpenLayers.Layer.GML.prototype.addFeatures=OpenLayers.Layer.Vector.prototype.addFeatures=function(C,J){if(!(C instanceof Array)){C=[C]}var H=!J||!J.silent;if(H){var B={features:C};var G=this.events.triggerEvent("beforefeaturesadded",B);if(G===false){return }C=B.features}for(var D=0,F=C.length;D<F;D++){if(D!=(C.length-1)){this.renderer.locked=true}else{this.renderer.locked=false}var I=C[D];if(this.geometryType&&!(I.geometry.CLASS_NAME==this.geometryType)){var E=OpenLayers.i18n("componentShouldBe",{geomType:this.geometryType});throw E}this.features.push(I);I.layer=this;if(!I.style&&this.style){I.style=OpenLayers.Util.extend({},this.style)}if(H){if(this.events.triggerEvent("beforefeatureadded",{feature:I})===false){continue}this.preFeatureInsert(I)}this.drawFeature(I);if(H){this.events.triggerEvent("featureadded",{feature:I});this.onFeatureInsert(I)}}if(H){this.events.triggerEvent("featuresadded",{features:C})}};OpenLayers.Layer.GML.prototype.changeBaseLayer=OpenLayers.Layer.Vector.RootContainer.prototype.changeBaseLayer=OpenLayers.Layer.Vector.prototype.changeBaseLayer=function(C){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){var D=this.getVisibility();if(D){this.setVisibility(false)}if(!this.options){this.options={}}if(!this.formatOptions){this.formatOptions={}}if(!this.options.formatOptions){this.options.formatOptions={}}var H=this.map.getProjection();var G=C.baseLayer?C.baseLayer.getNativeProjection():null;this.options.formatOptions.internalProjection=H.clone();this.formatOptions.internalProjection=H.clone();this.addOptions({projection:H.clone()});for(var F=0,B=this.features.length;F<B;F++){var E=this.features[F];E.geometry.transform(G,H);if(E.popup&&E.popup.lonlat){E.popup.hide();E.popup.lonlat.transform(G,H)}}if(D){this.setVisibility(true)}}return true};OpenLayers.Layer.GML.prototype.getCompatibleProjection=OpenLayers.Layer.Vector.RootContainer.prototype.getCompatibleProjection=OpenLayers.Layer.Vector.prototype.getCompatibleProjection=function(C){if(this.aggregate!=undefined){return undefined}var B=this.getNativeProjection();if(B==null){if(this.map==null){return undefined}return null}return B};OpenLayers.Layer.GML.prototype.loadGML=function(){if(!this.loaded){if(this.events.triggerEvent("loadstart")===false){return }OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this});this.loaded=true}};OpenLayers.Layer.GML.prototype.requestSuccess=function(F){var G=F.responseXML;if(!G||!G.documentElement){G=OpenLayers.parseXMLString(F.responseText)}var B=OpenLayers.Request.XMLHttpRequest.getParseErrorText(G);if(B!=OpenLayers.Request.XMLHttpRequest.PARSED_OK){alert(OpenLayers.i18n(B));this.events.triggerEvent("loadend");return }var C={};OpenLayers.Util.extend(C,this.formatOptions);if(this.map&&this.getNativeProjection()&&!this.getNativeProjection().equals(this.map.getProjection())){C.externalProjection=this.getNativeProjection();C.internalProjection=this.map.getProjection()}var D=this.format?new this.format(C):new OpenLayers.Format.GML(C);this.addFeatures(D.read(G));var E=this.getDataExtent();if(E&&!(E.getWidth()==0||E.getHeight()==0)){this.maxExtent=E}this.events.triggerEvent("loadend")};OpenLayers.Format.GML.prototype.setAttributeNS=OpenLayers.Format.XML.prototype.setAttributeNS;OpenLayers.Format.GML.prototype.read=function(G){if(typeof G=="string"){G=OpenLayers.Format.XML.prototype.read.apply(this,[G])}var C=G.nodeType==9?G.documentElement:G;var H=this.getElementsByTagNameNS(C,this.gmlns,this.featureName);var F=[];for(var E=0,B=H.length;E<B;E++){var D=this.parseFeature(H[E]);if(D){F.push(D)}}return F};OpenLayers.Format.GML.prototype.createFeatureXML=function(K){var I=K.geometry;var F=this.buildGeometryNode(I);if(this.externalProjection){F.setAttribute("srsName",this.externalProjection.toString())}var J=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);J.appendChild(F);var B=this.createElementNS(this.gmlns,"gml:"+this.featureName);var L=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName);var D=K.fid||K.id;L.setAttribute("fid",D);L.appendChild(J);for(var H in K.attributes){var G=this.createTextNode(K.attributes[H]);var E=H.substring(H.lastIndexOf(":")+1);var C=this.createElementNS(this.featureNS,this.featurePrefix+":"+E);C.appendChild(G);L.appendChild(C)}B.appendChild(L);return B};OpenLayers.Format.GML.prototype.buildCoordinatesNode=function(H){var C=this.createElementNS(this.gmlns,"gml:coordinates");C.setAttribute("decimal",".");C.setAttribute("cs",",");C.setAttribute("ts"," ");var G=[];if(H instanceof OpenLayers.Bounds){G.push(H.left+","+H.bottom);G.push(H.right+","+H.top)}else{var E=(H.components)?H.components:[H];if(this.xy){for(var D=0,B=E.length;D<B;D++){G.push(E[D].x+","+E[D].y)}}else{for(var D=0,B=E.length;D<B;D++){G.push(E[D].y+","+E[D].x)}}}var F=this.createTextNode(G.join(" "));C.appendChild(F);return C};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ServiceException=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ServiceException=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ServiceException=function(C,B){if(C.exceptions===undefined){C.exceptions=[]}C.exceptions.push(this.getChildNode(B))};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Fees=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Fees=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Fees=function(B,D){var C=this.getChildValue(D);if(C&&C.toLowerCase()!="none"){B.fees=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_AccessConstraints=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_AccessConstraints=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_AccessConstraints=function(B,C){var D=this.getChildValue(C);if(D&&D.toLowerCase()!="none"){B.accessConstraints=D}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactInformation=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactInformation=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactInformation=function(C,D){var B={};this.runChildNodes(B,D);C.contactInformation=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactPersonPrimary=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactPersonPrimary=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactPersonPrimary=function(C,D){var B={};this.runChildNodes(B,D);C.personPrimary=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactPerson=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactPerson=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactPerson=function(C,D){var B=this.getChildValue(D);if(B){C.person=B}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactOrganization=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactOrganization=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactOrganization=function(C,D){var B=this.getChildValue(D);if(B){C.organization=B}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactPosition=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactPosition=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactPosition=function(C,D){var B=this.getChildValue(D);if(B){C.position=B}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactAddress=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactAddress=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactAddress=function(B,C){var D={};this.runChildNodes(D,C);B.contactAddress=D};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_AddressType=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_AddressType=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_AddressType=function(D,C){var B=this.getChildValue(C);if(B){D.type=B}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Address=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Address=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Address=function(D,C){var B=this.getChildValue(C);if(B){D.address=B}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_City=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_City=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_City=function(D,B){var C=this.getChildValue(B);if(C){D.city=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_StateOrProvince=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_StateOrProvince=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_StateOrProvince=function(D,B){var C=this.getChildValue(B);if(C){D.stateOrProvince=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_PostCode=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_PostCode=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_PostCode=function(D,C){var B=this.getChildValue(C);if(B){D.postcode=B}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Country=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Country=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Country=function(D,B){var C=this.getChildValue(B);if(C){D.country=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactVoiceTelephone=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactVoiceTelephone=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactVoiceTelephone=function(B,D){var C=this.getChildValue(D);if(C){B.phone=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactFacsimileTelephone=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactFacsimileTelephone=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactFacsimileTelephone=function(B,D){var C=this.getChildValue(D);if(C){B.fax=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_ContactElectronicMailAddress=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_ContactElectronicMailAddress=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_ContactElectronicMailAddress=function(B,D){var C=this.getChildValue(D);if(C){B.email=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_GetCapabilities=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_GetCapabilities=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_GetCapabilities=function(C,B){var D={formats:[]};this.runChildNodes(D,B);C.getcapabilities=D};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_GetFeatureInfo=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_GetFeatureInfo=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_GetFeatureInfo=function(C,B){var D={formats:[]};this.runChildNodes(D,B);C.getfeatureinfo=D};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_DescribeLayer=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_DescribeLayer=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_DescribeLayer=function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.describelayer=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_GetLegendGraphic=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_GetLegendGraphic=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_GetLegendGraphic=function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.getlegendgraphic=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_GetStyles=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_GetStyles=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_GetStyles=function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.getstyles=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_PutStyles=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_PutStyles=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_PutStyles=function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.putstyles=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Format=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Format=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Format=function(C,B){if(C.formats){C.formats.push(this.getChildValue(B))}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Exception=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Exception=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Exception=function(B,D){var C={formats:[]};this.runChildNodes(C,D);B.exception=C};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_UserDefinedSymbolization=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_UserDefinedSymbolization=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_UserDefinedSymbolization=function(B,C){var D={supportSLD:parseInt(C.getAttribute("SupportSLD"))==1,userLayer:parseInt(C.getAttribute("UserLayer"))==1,userStyle:parseInt(C.getAttribute("UserStyle"))==1,remoteWFS:parseInt(C.getAttribute("RemoteWFS"))==1};B.userSymbols=D};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Layer=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Layer=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Layer=function(E,N,Q){var R={formats:E.request.getmap.formats||[],styles:[],srs:{},bbox:{},dimensions:{},metadataURLs:[],dataURLs:[],featureListURLs:[],authorityURLs:{},identifiers:{},keywords:[]};if(Q){R.styles=R.styles.concat(Q.styles);var H=["queryable","cascaded","fixedWidth","fixedHeight","opaque","noSubsets","llbbox","minScale","maxScale","attribution"];var K=["srs","bbox","dimensions","authorityURLs"];for(var P=0;P<H.length;P++){if(H[P] in Q){R[H[P]]=Q[H[P]]}}for(var P=0;P<K.length;P++){R[K[P]]=OpenLayers.Util.extend(R[K[P]],Q[K[P]])}}var O=["cascaded","fixedWidth","fixedHeight"];var J=["queryable","opaque","noSubsets"];for(var P=0;P<O.length;P++){var M=O[P];var I=N.getAttributeNode(M);if(I&&I.specified){R[M]=parseInt(I.value)}else{if(!(M in R)){R[M]=0}}}for(var P=0;P<J.length;P++){var M=J[P];var I=N.getAttributeNode(M);if(I&&I.specified){var L=I.value;R[M]=(L==="1"||L==="true")}else{if(!(M in R)){R[M]=false}}}var F=N.childNodes;var D,B,C;for(var P=0;P<F.length;++P){D=F[P];B=D.nodeName;C=this["read_cap_"+D.nodeName];if(C){if(B=="Layer"){C.apply(this,[E,D,R])}else{C.apply(this,[R,D])}}}var S=[];for(var T in R.srs){S.push(T)}R.srs=S;if(R.name){var G=R.name.indexOf(":");if(G>0){R.prefix=R.name.substring(0,G)}E.layers.push(R)}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Attribution=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Attribution=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Attribution=function(D,C){var B={};this.runChildNodes(B,C);D.attribution=B};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_LogoURL=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_LogoURL=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_LogoURL=function(C,B){C.logo={width:B.getAttribute("width"),height:B.getAttribute("height")};this.runChildNodes(C.logo,B)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_MetadataURL=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_MetadataURL=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_MetadataURL=function(B,C){var D={formats:[]};this.runChildNodes(D,C);D.type=C.getAttribute("type");B.metadataURLs.push(D)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_KeywordList=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_KeywordList=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_KeywordList=function(B,C){var D=B;this.runChildNodes(D,C)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Keyword=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Keyword=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Keyword=function(C,B){if(C.keywords){C.keywords.push(this.getChildValue(B))}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_DataURL=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_DataURL=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_DataURL=function(B,C){var D={};this.runChildNodes(D,C);B.dataURLs.push(D)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_FeatureListURL=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_FeatureListURL=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_FeatureListURL=function(C,D){var B={};this.runChildNodes(B,D);C.featureListURLs.push(B)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_AuthorityURL=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_AuthorityURL=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_AuthorityURL=function(C,D){var B=D.getAttribute("name");if(!(B in C.authorityURLs)){var E={};this.runChildNodes(E,D);C.authorityURLs[B]=E.href}else{return }};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Identifier=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Identifier=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Identifier=function(B,C){var D=C.getAttribute("authority");if(D in B.authorityURLs){B.identifiers[D]=this.getChildValue(C)}else{return }};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_BoundingBox=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_BoundingBox=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_BoundingBox=function(C,D){var E={};E.srs=D.getAttribute("SRS");if(!E.srs){E.srs=D.getAttribute("CRS")}E.bbox=[parseFloat(D.getAttribute("minx")),parseFloat(D.getAttribute("miny")),parseFloat(D.getAttribute("maxx")),parseFloat(D.getAttribute("maxy"))];var B={x:parseFloat(D.getAttribute("resx")),y:parseFloat(D.getAttribute("resy"))};if(!(isNaN(B.x)&&isNaN(B.y))){E.res=B}C.bbox[E.srs]=E};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Dimension=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Dimension=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Dimension=function(C,D){var B=D.getAttribute("name").toLowerCase();if(B in C.dimensions){return }var E={name:B,units:D.getAttribute("units"),unitsymbol:D.getAttribute("unitSymbol"),"default":D.getAttribute("default"),multipleValues:D.getAttribute("multipleValues")=="true"?true:false,nearestValue:D.getAttribute("nearestValue")=="true"?true:false,current:D.getAttribute("current")=="true"?true:false};C.dimensions[E.name]=E};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Extent=OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_Extent=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_Extent=function(D,F){var C=F.getAttribute("name").toLowerCase();if(C in D.dimensions){var E=D.dimensions[C];E.nearestVal=F.getAttribute("nearestValue")==="1";E.multipleVal=F.getAttribute("multipleValues")==="1";E.current=F.getAttribute("current")==="1";E["default"]=F.getAttribute("default")||"";var B=this.getChildValue(F);E.values=B.split(",")}else{return }};OpenLayers.Format.WMSCapabilities.v1_1_0.prototype.read_cap_SRS=OpenLayers.Format.WMSCapabilities.v1_1.prototype.read_cap_SRS=function(F,G){var E=this.getChildValue(G);var C=E.split(/ +/);for(var D=0,B=C.length;D<B;D++){F.srs[C[D]]=1}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_SRS=function(F,G){var E=this.getChildValue(G);if(E.indexOf(" ")){var C=E.split(/ +/);for(var D=0,B=C.length;D<B;D++){F.srs[C[D]]=1}}else{F.srs[E]=1}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_VendorSpecificCapabilities=function(B,C){B.vendorSpecificCaps={};this.runChildNodes(B.vendorSpecificCaps,C)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_TileSet=function(F,D){var E={srs:{},bbox:{},formats:[],layers:[],styles:[]};this.runChildNodes(E,D);var C=[];for(var B in E.srs){C.push(B)}E.srs=C;if(!F.tilesets){F.tilesets=[]}F.tilesets.push(E)};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Resolutions=function(G,F){var E=this.getChildValue(F);var C=E.split(/ +/);var B=C.length;if(B>0){for(var D=0;D<B;D++){C[D]=parseFloat(C[D])}C.sort(function(I,H){return H-I});G.resolutions=C}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Width=function(C,B){C.width=parseInt(this.getChildValue(B))};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Height=function(C,B){C.height=parseInt(this.getChildValue(B))};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Layers=function(C,B){if(C.layers){C.layers.push(this.getChildValue(B))}};OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.read_cap_Styles=function(C,B){if(C.styles){C.styles.push(this.getChildValue(B))}};OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{VERSION:"1.3.0",initialize:function(B){OpenLayers.Format.WMSCapabilities.prototype.initialize.apply(this,[B])},read_cap_LayerLimit:function(C,B){C.layerLimit=parseInt(this.getChildValue(B))},read_cap_MaxWidth:function(C,B){C.maxWidth=parseInt(this.getChildValue(B))},read_cap_MaxHeight:function(C,B){C.maxHeight=parseInt(this.getChildValue(B))},read_cap_UserDefinedSymbolization:function(B,C){},read_cap_DescribeLayer:function(C,B){},read_cap_GetLegendGraphic:function(C,B){},read_cap_GetStyles:function(C,B){},read_cap_PutStyles:function(C,B){},read_cap_CRS:function(C,B){this.read_cap_SRS(C,B)},read_cap_LatLonBoundingBox:function(B,C){},read_cap_EX_GeographicBoundingBox:function(F,G){var E=G.childNodes;var C=-180,B=-90,I=180,H=90;for(var D=0;D<E.length;++D){childNode=E[D];if(childNode.nodeType==1){if(childNode.nodeName=="westBoundLongitude"){C=this.getChildValue(childNode)}if(childNode.nodeName=="southBoundLatitude"){B=this.getChildValue(childNode)}if(childNode.nodeName=="eastBoundLongitude"){I=this.getChildValue(childNode)}if(childNode.nodeName=="northBoundLatitude"){H=this.getChildValue(childNode)}}}F.llbbox=[C,B,I,H]},read_cap_Extent:function(B,C){},read_cap_ScaleHint:function(B,C){},read_cap_MinScaleDenominator:function(B,C){B.maxScale=parseFloat(this.getChildValue(C))},read_cap_MaxScaleDenominator:function(B,C){B.minScale=parseFloat(this.getChildValue(C))},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"});OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{intervals:[45,30,20,10,5,2,1,0.5,0.2,0.1,0.05,0.01,0.005,0.002,0.001],displayInLayerSwitcher:true,visible:true,numPoints:50,targetSize:200,layerName:"Graticule",labelled:true,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:0.5},labelSymbolizer:{stroke:false,fill:false,label:"${label}",labelAlign:"${labelAlign}",labelXOffset:"${xOffset}",labelYOffset:"${yOffset}"},gratLayer:null,initialize:function(B){OpenLayers.Control.prototype.initialize.apply(this,[B])},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.gratLayer){var B=new OpenLayers.Style({},{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":B}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher});this.map.addLayer(this.gratLayer)}this.map.events.register("moveend",this,this.update);this.update();return this.div},update:function(){var N=this.map.getExtent();if(!N){return }var G=N.toGeometry();this.gratLayer.destroyFeatures();var O=OpenLayers.Projection.CRS84;var v=this.map.getProjection();var B=this.map.getResolution();switch(v.getProjName()){case"longlat":case"eqc":this.numPoints=1;break;default:break}var Z=this.map.getCenter();var T=new OpenLayers.Pixel(Z.lon,Z.lat);OpenLayers.Projection.transform(T,v,O);var W=this.targetSize*B;W*=W;var w;for(var h=0,d=this.intervals.length;h<d;++h){w=this.intervals[h];var V=w/2;var q=T.offset(new OpenLayers.Pixel(-V,-V));var m=T.offset(new OpenLayers.Pixel(V,V));OpenLayers.Projection.transform(q,O,v);OpenLayers.Projection.transform(m,O,v);var L=(q.x-m.x)*(q.x-m.x)+(q.y-m.y)*(q.y-m.y);if(L<=W){break}}T.x=Math.floor(T.x/w)*w;T.y=Math.floor(T.y/w)*w;var P=0;var H=[T.clone()];var U=T.clone();var K;do{U=U.offset(new OpenLayers.Pixel(0,w));K=OpenLayers.Projection.transform(U.clone(),O,v);H.unshift(U)}while(N.containsPixel(K)&&++P<1000);U=T.clone();do{U=U.offset(new OpenLayers.Pixel(0,-w));K=OpenLayers.Projection.transform(U.clone(),O,v);H.push(U)}while(N.containsPixel(K)&&++P<1000);P=0;var E=[T.clone()];U=T.clone();do{U=U.offset(new OpenLayers.Pixel(-w,0));K=OpenLayers.Projection.transform(U.clone(),O,v);E.unshift(U)}while(N.containsPixel(K)&&++P<1000);U=T.clone();do{U=U.offset(new OpenLayers.Pixel(w,0));K=OpenLayers.Projection.transform(U.clone(),O,v);E.push(U)}while(N.containsPixel(K)&&++P<1000);var S=[];for(var h=0;h<E.length;++h){var F=E[h].x;var r=[];var a=null;var f=Math.min(H[0].y,90);var b=Math.max(H[H.length-1].y,-90);var C=(f-b)/this.numPoints;var R=b;for(var g=0;g<=this.numPoints;++g){var D=new OpenLayers.Geometry.Point(F,R);D.transform(O,v);r.push(D);R+=C;if(D.y>=N.bottom&&!a){a=D}}if(this.labelled){var J=new OpenLayers.Geometry.Point(a.x,N.bottom);var M={value:F,label:this.labelled?OpenLayers.Util.getFormattedLonLat(F,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(J,M))}var I=new OpenLayers.Geometry.LineString(r);S.push(new OpenLayers.Feature.Vector(I))}for(var g=0;g<H.length;++g){R=H[g].y;if(R<-90||R>90){continue}var r=[];var Y=E[0].x;var Q=E[E.length-1].x;var u=(Q-Y)/this.numPoints;var F=Y;var a=null;for(var h=0;h<=this.numPoints;++h){var D=new OpenLayers.Geometry.Point(F,R);D.transform(O,v);r.push(D);F+=u;if(D.x<N.right){a=D}}if(this.labelled){var J=new OpenLayers.Geometry.Point(N.right,a.y);var M={value:R,label:this.labelled?OpenLayers.Util.getFormattedLonLat(R,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(J,M))}var I=new OpenLayers.Geometry.LineString(r);S.push(new OpenLayers.Feature.Vector(I))}this.gratLayer.addFeatures(S)},changeLang:function(B){this.update()},CLASS_NAME:"OpenLayers.Control.Graticule"});OpenLayers.Tile.WFS.prototype.draw=function(){if(OpenLayers.Tile.prototype.draw.apply(this,arguments)){if(this.isLoading){if(this.events.triggerEvent("reload")===false){return }}else{this.isLoading=true;if(this.events.triggerEvent("loadstart")===false){return }}this.loadFeaturesForRegion(this.requestSuccess)}};OpenLayers.Handler.Drag.prototype.mousedown=function(C){var B=true;this.dragging=false;if(this.checkModifiers(C)&&OpenLayers.Event.isLeftClick(C)){this.started=true;this.start=C.xy;this.last=C.xy;OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown");this.down(C);this.callback("down",[C.xy]);OpenLayers.Event.stop(C);if(!this.oldOnselectstart){this.oldOnselectstart=(document.onselectstart)?document.onselectstart:OpenLayers.Function.True;document.onselectstart=OpenLayers.Function.False}B=!this.stopDown}else{this.started=false;this.start=null;this.last=null}return B};OpenLayers.Handler.Drag.prototype.mousemove=function(B){if(this.started&&!this.timeoutId&&(B.xy.x!=this.last.x||B.xy.y!=this.last.y)){if(this.interval>0){this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)}this.dragging=true;this.move(B);this.callback("move",[B.xy]);if(!this.oldOnselectstart){this.oldOnselectstart=document.onselectstart;document.onselectstart=OpenLayers.Function.False}this.last=this.evt.xy}return true};OpenLayers.Handler.Path.prototype.activate=OpenLayers.Handler.Point.prototype.activate=function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments)){return false}var B=OpenLayers.Util.extend({displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,B);this.map.addLayer(this.layer);return true};OpenLayers.Handler.RegularPolygon.prototype.activate=function(){var B=false;if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var C={displayInLayerSwitcher:false,calculateInRange:OpenLayers.Function.True};this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,C);this.map.addLayer(this.layer);B=true}return B};OpenLayers.Control.ZoomPanel.prototype.destroy=OpenLayers.Control.ZoomOut.prototype.destroy=OpenLayers.Control.ZoomIn.prototype.destroy=OpenLayers.Control.Scale.prototype.destroy=OpenLayers.Control.ScaleLine.prototype.destroy=OpenLayers.Control.PanPanel.prototype.destroy=OpenLayers.Control.Pan.prototype.destroy=OpenLayers.Control.NavToolbar.prototype.destroy=OpenLayers.Control.GetFeature.prototype.destroy=OpenLayers.Control.EditingToolbar.prototype.destroy=OpenLayers.Control.Button.prototype.destroy=OpenLayers.Control.ArgParser.prototype.destroy=OpenLayers.Control.prototype.destroy;OpenLayers.Control.ZoomPanel.prototype.setMap=OpenLayers.Control.ZoomOut.prototype.setMap=OpenLayers.Control.ZoomIn.prototype.setMap=OpenLayers.Control.Split.prototype.setMap=OpenLayers.Control.Snapping.prototype.setMap=OpenLayers.Control.ScaleLine.prototype.setMap=OpenLayers.Control.Scale.prototype.setMap=OpenLayers.Control.PanZoom.prototype.setMap=OpenLayers.Control.PanPanel.prototype.setMap=OpenLayers.Control.Pan.prototype.setMap=OpenLayers.Control.OverviewMap.prototype.setMap=OpenLayers.Control.NavToolbar.prototype.setMap=OpenLayers.Control.MouseToolbar.prototype.setMap=OpenLayers.Control.MouseDefaults.prototype.setMap=OpenLayers.Control.EditingToolbar.prototype.setMap=OpenLayers.Control.DrawFeature.prototype.setMap=OpenLayers.Control.Button.prototype.setMap=OpenLayers.Control.Attribution.prototype.setMap=OpenLayers.Control.prototype.setMap;OpenLayers.Control.ZoomPanel.prototype.draw=OpenLayers.Control.ZoomOut.prototype.draw=OpenLayers.Control.ZoomIn.prototype.draw=OpenLayers.Control.Split.prototype.draw=OpenLayers.Control.Snapping.prototype.draw=OpenLayers.Control.PanPanel.prototype.draw=OpenLayers.Control.Pan.prototype.draw=OpenLayers.Control.GetFeature.prototype.draw=OpenLayers.Control.Button.prototype.draw=OpenLayers.Control.ArgParser.prototype.draw=OpenLayers.Control.prototype.draw;OpenLayers.Control.ZoomPanel.prototype.changeLang=OpenLayers.Control.ZoomOut.prototype.changeLang=OpenLayers.Control.ZoomIn.prototype.changeLang=OpenLayers.Control.Split.prototype.changeLang=OpenLayers.Control.Snapping.prototype.changeLang=OpenLayers.Control.ScaleLine.prototype.changeLang=OpenLayers.Control.Scale.prototype.changeLang=OpenLayers.Control.Permalink.prototype.changeLang=OpenLayers.Control.PanZoom.prototype.changeLang=OpenLayers.Control.PanZoomBar.prototype.changeLang=OpenLayers.Control.PanPanel.prototype.changeLang=OpenLayers.Control.Pan.prototype.changeLang=OpenLayers.Control.OverviewMap.prototype.changeLang=OpenLayers.Control.NavToolbar.prototype.changeLang=OpenLayers.Control.NavigationHistory.prototype.changeLang=OpenLayers.Control.MouseToolbar.prototype.changeLang=OpenLayers.Control.MousePosition.prototype.changeLang=OpenLayers.Control.MouseDefaults.prototype.changeLang=OpenLayers.Control.LayerSwitcher.prototype.changeLang=OpenLayers.Control.GetFeature.prototype.changeLang=OpenLayers.Control.EditingToolbar.prototype.changeLang=OpenLayers.Control.Button.prototype.changeLang=OpenLayers.Control.Attribution.prototype.changeLang=OpenLayers.Control.ArgParser.prototype.changeLang=OpenLayers.Control.prototype.changeLang;OpenLayers.Control.MouseDefaults.defaultMouseDown=function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.mouseDragStart=B.xy.clone();this.performedDrag=false;if(B.shiftKey){this.map.div.style.cursor="crosshair";this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red");this.zoomBox.style.backgroundColor="white";this.zoomBox.style.filter="alpha(opacity=50)";this.zoomBox.style.opacity="0.50";this.zoomBox.style.fontSize="1px";this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox)}document.onselectstart=OpenLayers.Function.False;OpenLayers.Event.stop(B)};OpenLayers.Control.MouseToolbar.prototype.defaultMouseDown=function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.mouseDragStart=B.xy.clone();this.performedDrag=false;this.startViaKeyboard=false;if(B.shiftKey&&this.mode!="zoombox"){this.switchModeTo("zoombox");this.startViaKeyboard=true}else{if(B.altKey&&this.mode!="measure"){this.switchModeTo("measure")}else{if(!this.mode){this.switchModeTo("pan")}}}switch(this.mode){case"zoombox":this.map.div.style.cursor="crosshair";this.zoomBox=OpenLayers.Util.createDiv("zoomBox",this.mouseDragStart,null,null,"absolute","2px solid red");this.zoomBox.style.backgroundColor="white";this.zoomBox.style.filter="alpha(opacity=50)";this.zoomBox.style.opacity="0.50";this.zoomBox.style.fontSize="1px";this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.viewPortDiv.appendChild(this.zoomBox);this.performedDrag=true;break;case"measure":var D="";if(this.measureStart){var C=this.map.getLonLatFromViewPortPx(this.mouseDragStart);D=OpenLayers.Util.distVincenty(this.measureStart,C);D=Math.round(D*100)/100;D=D+"km";this.measureStartBox=this.measureBox}this.measureStart=this.map.getLonLatFromViewPortPx(this.mouseDragStart);this.measureBox=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),-2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute");this.measureBox.style.width="4px";this.measureBox.style.height="4px";this.measureBox.style.fontSize="1px";this.measureBox.style.backgroundColor="red";this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBox);if(D){this.measureBoxDistance=OpenLayers.Util.createDiv(null,this.mouseDragStart.add(-2-parseInt(this.map.layerContainerDiv.style.left),2-parseInt(this.map.layerContainerDiv.style.top)),null,null,"absolute");this.measureBoxDistance.innerHTML=D;this.measureBoxDistance.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBoxDistance);this.measureDivs.push(this.measureBoxDistance)}this.measureBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1;this.map.layerContainerDiv.appendChild(this.measureBox);this.measureDivs.push(this.measureBox);break;default:this.map.div.style.cursor="move";break}document.onselectstart=OpenLayers.Function.False;OpenLayers.Event.stop(B)};OpenLayers.Control.PanZoom.prototype._removeButton=function(B){OpenLayers.Event.stopObservingElement(B);B.map=null;B.getSlideFactor=null;this.div.removeChild(B);OpenLayers.Util.removeItem(this.buttons,B)};OpenLayers.Popup.FramedCloud.prototype.draw=OpenLayers.Popup.Framed.prototype.draw=OpenLayers.Popup.prototype.draw;OpenLayers.Popup.FramedCloud.prototype.onMoveStartPopup=OpenLayers.Popup.Framed.prototype.onMoveStartPopup=OpenLayers.Popup.prototype.onMoveStartPopup;OpenLayers.Popup.FramedCloud.prototype.onMoveEndPopup=OpenLayers.Popup.Framed.prototype.onMoveEndPopup=OpenLayers.Popup.prototype.onMoveEndPopup;OpenLayers.Popup.FramedCloud.prototype.addCloseBox=OpenLayers.Popup.Framed.prototype.addCloseBox=OpenLayers.Popup.prototype.addCloseBox;OpenLayers.Layer.Yahoo.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.XYZ.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.WorldWind.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.WFS.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.VirtualEarth.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.TMS.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.TileCache.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Text.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.PointTrack.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.MultiMap.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Markers.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.MapServer.Untiled.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.MapServer.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.MapGuide.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.KaMap.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.KaMapCache.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Image.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Google.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.GeoRSS.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.EventPane.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.Boxes.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.ArcIMS.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.ArcGIS93Rest.prototype.RESOLUTION_PROPERTIES=OpenLayers.Layer.prototype.RESOLUTION_PROPERTIES;OpenLayers.Layer.Yahoo.prototype.addOptions=OpenLayers.Layer.XYZ.prototype.addOptions=OpenLayers.Layer.WorldWind.prototype.addOptions=OpenLayers.Layer.WFS.prototype.addOptions=OpenLayers.Layer.VirtualEarth.prototype.addOptions=OpenLayers.Layer.TMS.prototype.addOptions=OpenLayers.Layer.TileCache.prototype.addOptions=OpenLayers.Layer.Text.prototype.addOptions=OpenLayers.Layer.PointTrack.prototype.addOptions=OpenLayers.Layer.MultiMap.prototype.addOptions=OpenLayers.Layer.Markers.prototype.addOptions=OpenLayers.Layer.MapServer.Untiled.prototype.addOptions=OpenLayers.Layer.MapServer.prototype.addOptions=OpenLayers.Layer.MapGuide.prototype.addOptions=OpenLayers.Layer.KaMap.prototype.addOptions=OpenLayers.Layer.KaMapCache.prototype.addOptions=OpenLayers.Layer.Image.prototype.addOptions=OpenLayers.Layer.Google.prototype.addOptions=OpenLayers.Layer.GeoRSS.prototype.addOptions=OpenLayers.Layer.EventPane.prototype.addOptions=OpenLayers.Layer.Boxes.prototype.addOptions=OpenLayers.Layer.ArcIMS.prototype.addOptions=OpenLayers.Layer.ArcGIS93Rest.prototype.addOptions=OpenLayers.Layer.prototype.addOptions;OpenLayers.Layer.Yahoo.prototype.getNativeProjection=OpenLayers.Layer.XYZ.prototype.getNativeProjection=OpenLayers.Layer.WorldWind.prototype.getNativeProjection=OpenLayers.Layer.WFS.prototype.getNativeProjection=OpenLayers.Layer.VirtualEarth.prototype.getNativeProjection=OpenLayers.Layer.TMS.prototype.getNativeProjection=OpenLayers.Layer.TileCache.prototype.getNativeProjection=OpenLayers.Layer.Text.prototype.getNativeProjection=OpenLayers.Layer.PointTrack.prototype.getNativeProjection=OpenLayers.Layer.MultiMap.prototype.getNativeProjection=OpenLayers.Layer.Markers.prototype.getNativeProjection=OpenLayers.Layer.MapServer.Untiled.prototype.getNativeProjection=OpenLayers.Layer.MapServer.prototype.getNativeProjection=OpenLayers.Layer.MapGuide.prototype.getNativeProjection=OpenLayers.Layer.KaMap.prototype.getNativeProjection=OpenLayers.Layer.KaMapCache.prototype.getNativeProjection=OpenLayers.Layer.Image.prototype.getNativeProjection=OpenLayers.Layer.Google.prototype.getNativeProjection=OpenLayers.Layer.GeoRSS.prototype.getNativeProjection=OpenLayers.Layer.EventPane.prototype.getNativeProjection=OpenLayers.Layer.Boxes.prototype.getNativeProjection=OpenLayers.Layer.ArcIMS.prototype.getNativeProjection=OpenLayers.Layer.ArcGIS93Rest.prototype.getNativeProjection=OpenLayers.Layer.prototype.getNativeProjection;OpenLayers.Layer.WorldWind.prototype.setMap=OpenLayers.Layer.VirtualEarth.prototype.setMap=OpenLayers.Layer.TileCache.prototype.setMap=OpenLayers.Layer.Text.prototype.setMap=OpenLayers.Layer.MultiMap.prototype.setMap=OpenLayers.Layer.Markers.prototype.setMap=OpenLayers.Layer.MapServer.Untiled.prototype.setMap=OpenLayers.Layer.MapServer.prototype.setMap=OpenLayers.Layer.MapGuide.prototype.setMap=OpenLayers.Layer.KaMap.prototype.setMap=OpenLayers.Layer.KaMapCache.prototype.setMap=OpenLayers.Layer.GeoRSS.prototype.setMap=OpenLayers.Layer.Boxes.prototype.setMap=OpenLayers.Layer.ArcIMS.prototype.setMap=OpenLayers.Layer.ArcGIS93Rest.prototype.setMap=OpenLayers.Layer.prototype.setMap;OpenLayers.Layer.Yahoo.prototype.calculateInRange=OpenLayers.Layer.XYZ.prototype.calculateInRange=OpenLayers.Layer.WorldWind.prototype.calculateInRange=OpenLayers.Layer.WFS.prototype.calculateInRange=OpenLayers.Layer.VirtualEarth.prototype.calculateInRange=OpenLayers.Layer.TMS.prototype.calculateInRange=OpenLayers.Layer.TileCache.prototype.calculateInRange=OpenLayers.Layer.Text.prototype.calculateInRange=OpenLayers.Layer.PointTrack.prototype.calculateInRange=OpenLayers.Layer.MultiMap.prototype.calculateInRange=OpenLayers.Layer.Markers.prototype.calculateInRange=OpenLayers.Layer.MapServer.Untiled.prototype.calculateInRange=OpenLayers.Layer.MapServer.prototype.calculateInRange=OpenLayers.Layer.MapGuide.prototype.calculateInRange=OpenLayers.Layer.KaMap.prototype.calculateInRange=OpenLayers.Layer.KaMapCache.prototype.calculateInRange=OpenLayers.Layer.Image.prototype.calculateInRange=OpenLayers.Layer.Google.prototype.calculateInRange=OpenLayers.Layer.GeoRSS.prototype.calculateInRange=OpenLayers.Layer.EventPane.prototype.calculateInRange=OpenLayers.Layer.Boxes.prototype.calculateInRange=OpenLayers.Layer.ArcIMS.prototype.calculateInRange=OpenLayers.Layer.ArcGIS93Rest.prototype.calculateInRange=OpenLayers.Layer.prototype.calculateInRange;OpenLayers.Layer.Yahoo.prototype.initResolutions=OpenLayers.Layer.XYZ.prototype.initResolutions=OpenLayers.Layer.WorldWind.prototype.initResolutions=OpenLayers.Layer.WFS.prototype.initResolutions=OpenLayers.Layer.VirtualEarth.prototype.initResolutions=OpenLayers.Layer.TMS.prototype.initResolutions=OpenLayers.Layer.TileCache.prototype.initResolutions=OpenLayers.Layer.Text.prototype.initResolutions=OpenLayers.Layer.PointTrack.prototype.initResolutions=OpenLayers.Layer.MultiMap.prototype.initResolutions=OpenLayers.Layer.Markers.prototype.initResolutions=OpenLayers.Layer.MapServer.Untiled.prototype.initResolutions=OpenLayers.Layer.MapServer.prototype.initResolutions=OpenLayers.Layer.MapGuide.prototype.initResolutions=OpenLayers.Layer.KaMap.prototype.initResolutions=OpenLayers.Layer.KaMapCache.prototype.initResolutions=OpenLayers.Layer.Image.prototype.initResolutions=OpenLayers.Layer.Google.prototype.initResolutions=OpenLayers.Layer.GeoRSS.prototype.initResolutions=OpenLayers.Layer.EventPane.prototype.initResolutions=OpenLayers.Layer.Boxes.prototype.initResolutions=OpenLayers.Layer.ArcIMS.prototype.initResolutions=OpenLayers.Layer.ArcGIS93Rest.prototype.initResolutions=OpenLayers.Layer.prototype.initResolutions;OpenLayers.Layer.Yahoo.prototype.setOpacity=OpenLayers.Layer.XYZ.prototype.setOpacity=OpenLayers.Layer.WorldWind.prototype.setOpacity=OpenLayers.Layer.WFS.prototype.setOpacity=OpenLayers.Layer.VirtualEarth.prototype.setOpacity=OpenLayers.Layer.TMS.prototype.setOpacity=OpenLayers.Layer.TileCache.prototype.setOpacity=OpenLayers.Layer.Text.prototype.setOpacity=OpenLayers.Layer.PointTrack.prototype.setOpacity=OpenLayers.Layer.MultiMap.prototype.setOpacity=OpenLayers.Layer.MapServer.Untiled.prototype.setOpacity=OpenLayers.Layer.MapServer.prototype.setOpacity=OpenLayers.Layer.MapGuide.prototype.setOpacity=OpenLayers.Layer.KaMap.prototype.setOpacity=OpenLayers.Layer.KaMapCache.prototype.setOpacity=OpenLayers.Layer.Image.prototype.setOpacity=OpenLayers.Layer.Google.prototype.setOpacity=OpenLayers.Layer.GeoRSS.prototype.setOpacity=OpenLayers.Layer.EventPane.prototype.setOpacity=OpenLayers.Layer.Boxes.prototype.setOpacity=OpenLayers.Layer.ArcIMS.prototype.setOpacity=OpenLayers.Layer.ArcGIS93Rest.prototype.setOpacity=OpenLayers.Layer.prototype.setOpacity;OpenLayers.Layer.Yahoo.prototype.changeBaseLayer=OpenLayers.Layer.XYZ.prototype.changeBaseLayer=OpenLayers.Layer.WorldWind.prototype.changeBaseLayer=OpenLayers.Layer.VirtualEarth.prototype.changeBaseLayer=OpenLayers.Layer.TMS.prototype.changeBaseLayer=OpenLayers.Layer.TileCache.prototype.changeBaseLayer=OpenLayers.Layer.MultiMap.prototype.changeBaseLayer=OpenLayers.Layer.MapServer.Untiled.prototype.changeBaseLayer=OpenLayers.Layer.MapServer.prototype.changeBaseLayer=OpenLayers.Layer.MapGuide.prototype.changeBaseLayer=OpenLayers.Layer.KaMap.prototype.changeBaseLayer=OpenLayers.Layer.KaMapCache.prototype.changeBaseLayer=OpenLayers.Layer.Image.prototype.changeBaseLayer=OpenLayers.Layer.Google.prototype.changeBaseLayer=OpenLayers.Layer.EventPane.prototype.changeBaseLayer=OpenLayers.Layer.ArcIMS.prototype.changeBaseLayer=OpenLayers.Layer.ArcGIS93Rest.prototype.changeBaseLayer=function(B){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){this.addOptions({projection:p.clone()});this.redraw()}return true};OpenLayers.Layer.Yahoo.prototype.getCompatibleProjection=OpenLayers.Layer.XYZ.prototype.getCompatibleProjection=OpenLayers.Layer.WorldWind.prototype.getCompatibleProjection=OpenLayers.Layer.VirtualEarth.prototype.getCompatibleProjection=OpenLayers.Layer.TMS.prototype.getCompatibleProjection=OpenLayers.Layer.TileCache.prototype.getCompatibleProjection=OpenLayers.Layer.MultiMap.prototype.getCompatibleProjection=OpenLayers.Layer.MapServer.Untiled.prototype.getCompatibleProjection=OpenLayers.Layer.MapServer.prototype.getCompatibleProjection=OpenLayers.Layer.MapGuide.prototype.getCompatibleProjection=OpenLayers.Layer.KaMap.prototype.getCompatibleProjection=OpenLayers.Layer.KaMapCache.prototype.getCompatibleProjection=OpenLayers.Layer.Image.prototype.getCompatibleProjection=OpenLayers.Layer.Google.prototype.getCompatibleProjection=OpenLayers.Layer.EventPane.prototype.getCompatibleProjection=OpenLayers.Layer.ArcIMS.prototype.getCompatibleProjection=OpenLayers.Layer.ArcGIS93Rest.prototype.getCompatibleProjection=OpenLayers.Layer.prototype.getCompatibleProjection;OpenLayers.Layer.Image.prototype.addTileMonitoringHooks=function(B){B.onLoadStart=function(){if(this.events.triggerEvent("loadstart")===false){return }};B.events.register("loadstart",this,B.onLoadStart);B.onLoadEnd=function(){this.events.triggerEvent("loadend")};B.events.register("loadend",this,B.onLoadEnd);B.events.register("unload",this,B.onLoadEnd)};OpenLayers.Layer.VirtualEarth.prototype.loadMapObject=function(){var B=OpenLayers.Util.createDiv(this.name);var D=this.map.getSize();B.style.width=D.w+"px";B.style.height=D.h+"px";this.div.appendChild(B);try{this.mapObject=new VEMap(this.name)}catch(C){}if(this.mapObject!=null){try{this.mapObject.LoadMap(null,null,this.type,true);this.mapObject.AttachEvent("onmousedown",OpenLayers.Function.True)}catch(C){}this.mapObject.HideDashboard()}if(!this.mapObject||!this.mapObject.vemapcontrol||!this.mapObject.vemapcontrol.PanMap||(typeof this.mapObject.vemapcontrol.PanMap!="function")){this.dragPanMapObject=null}};OpenLayers.Layer.WorldWind.prototype.mergeNewParams=OpenLayers.Layer.TMS.prototype.mergeNewParams=OpenLayers.Layer.TileCache.prototype.mergeNewParams=OpenLayers.Layer.MapServer.prototype.mergeNewParams=OpenLayers.Layer.MapGuide.prototype.mergeNewParams=OpenLayers.Layer.KaMap.prototype.mergeNewParams=OpenLayers.Layer.HTTPRequest.prototype.mergeNewParams;OpenLayers.Layer.XYZ.prototype.getFullRequestString=OpenLayers.Layer.WorldWind.prototype.getFullRequestString=OpenLayers.Layer.TMS.prototype.getFullRequestString=OpenLayers.Layer.TileCache.prototype.getFullRequestString=OpenLayers.Layer.KaMapCache.prototype.getFullRequestString=OpenLayers.Layer.KaMap.prototype.getFullRequestString=OpenLayers.Layer.ArcIMS.prototype.getFullRequestString=OpenLayers.Layer.ArcGIS93Rest.prototype.getFullRequestString=OpenLayers.Layer.HTTPRequest.prototype.getFullRequestString;OpenLayers.Layer.MapServer.Untiled.prototype.getURL=OpenLayers.Layer.MapServer.prototype.getURL=function(D){D=this.adjustBounds(D);var C=[D.left,D.bottom,D.right,D.top];var F=D.clone();F.transform(this.map.getProjection(),this.getNativeProjection());C[0]=F.left;C[1]=F.bottom;C[2]=F.right;C[3]=F.top;var E=this.getImageSize();var B=this.getFullRequestString({mapext:C,imgext:C,map_size:[E.w,E.h],imgx:E.w/2,imgy:E.h/2,imgxy:[E.w,E.h]});return B};OpenLayers.Layer.Markers.prototype.setOpacity=function(C){if(C!=this.opacity){this.opacity=C;for(var D=0,B=this.markers.length;D<B;D++){this.markers[D].setOpacity(this.opacity)}if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}}};OpenLayers.Layer.Text.prototype.changeBaseLayer=OpenLayers.Layer.GeoRSS.prototype.changeBaseLayer=OpenLayers.Layer.Boxes.prototype.changeBaseLayer=OpenLayers.Layer.Markers.prototype.changeBaseLayer=function(D){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){var G=D.baseLayer?D.baseLayer.getNativeProjection():null;var H=this.map.getProjection();this.addOptions({projection:H.clone()});var E=this.getVisibility();if(E){this.setVisibility(false)}for(var F=0,C=this.markers.length;F<C;F++){var B=this.markers[F];B.lonlat.transform(G,H)}if(E){this.setVisibility(true)}}return true};OpenLayers.Layer.Text.prototype.loadText=function(){if(!this.loaded){if(this.location!=null){var B=function(C){this.events.triggerEvent("loadend")};if(this.events.triggerEvent("loadstart")===false){return }OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:B,scope:this});this.loaded=true}}};OpenLayers.Layer.GeoRSS.prototype.loadRSS=function(){if(!this.loaded){if(this.events.triggerEvent("loadstart")===false){return }OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this});this.loaded=true}};OpenLayers.Control.EditingToolbar.prototype.addPanelDiv=OpenLayers.Control.NavToolbar.prototype.addPanelDiv=OpenLayers.Control.PanPanel.prototype.addPanelDiv=OpenLayers.Control.ZoomPanel.prototype.addPanelDiv=OpenLayers.Control.Panel.prototype.addPanelDiv;OpenLayers.Control.NavToolbar.prototype.activateControl=OpenLayers.Control.Panel.prototype.activateControl;OpenLayers.Control.EditingToolbar.prototype.addControls=OpenLayers.Control.NavToolbar.prototype.addControls=OpenLayers.Control.PanPanel.prototype.addControls=OpenLayers.Control.ZoomPanel.prototype.addControls=OpenLayers.Control.Panel.prototype.addControls;OpenLayers.Control.PanPanel.prototype.changeLang=OpenLayers.Control.ZoomPanel.prototype.changeLang=OpenLayers.Control.NavToolbar.prototype.changeLang=OpenLayers.Control.Panel.prototype.changeLang;OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{forceRefresh:false,refreshTime:0,timer:null,initialize:function(B){OpenLayers.Strategy.prototype.initialize.apply(this,[B])},activate:function(){var B=OpenLayers.Strategy.prototype.activate.call(this);if(B){if(this.layer.visibility==true){this.start()}this.layer.events.on({visibilitychanged:this.reset,scope:this})}return B},deactivate:function(){var B=OpenLayers.Strategy.prototype.deactivate.call(this);if(B){this.stop()}return B},reset:function(){if(this.layer.visibility==true){this.start()}else{this.stop()}},start:function(){if(this.refreshTime&&typeof this.refreshTime==="number"&&this.refreshTime>0){this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.refreshTime)}},refresh:function(){if(this.layer&&this.layer.refresh){this.layer.refresh({force:this.forceRefresh})}},stop:function(){if(this.timer&&typeof this.timer!=null){window.clearInterval(this.timer);this.timer=null}},CLASS_NAME:"OpenLayers.Strategy.Refresh"});OpenLayers.Format.GeoRSS.prototype.setAttributeNS=OpenLayers.Format.SLD.v1_0_0.prototype.setAttributeNS=OpenLayers.Format.SLD.v1.prototype.setAttributeNS=OpenLayers.Format.SLD.prototype.setAttributeNS=OpenLayers.Format.GML.v3.prototype.setAttributeNS=OpenLayers.Format.GML.v2.prototype.setAttributeNS=OpenLayers.Format.GML.Base.prototype.setAttributeNS=OpenLayers.Format.GPX.prototype.setAttributeNS=OpenLayers.Format.OSM.prototype.setAttributeNS=OpenLayers.Format.Filter.v1_0_0.prototype.setAttributeNS=OpenLayers.Format.Filter.v1.prototype.setAttributeNS=OpenLayers.Format.Filter.prototype.setAttributeNS=OpenLayers.Format.WMC.v1_1_0.prototype.setAttributeNS=OpenLayers.Format.WMC.v1_0_0.prototype.setAttributeNS=OpenLayers.Format.WMC.v1.prototype.setAttributeNS=OpenLayers.Format.WMC.prototype.setAttributeNS=OpenLayers.Format.XML.prototype.setAttributeNS;OpenLayers.Format.GPX.prototype.externalProjection=new OpenLayers.Projection("EPSG:4326");OpenLayers.Strategy.Fixed.prototype.load=function(B){if(this.layer.events.triggerEvent("loadstart")===false){return }this.layer.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,scope:this},B));this.layer.events.un({visibilitychanged:this.load,scope:this})};OpenLayers.Strategy.BBOX.prototype.triggerRead=function(){this.layer.protocol.abort(this.response);if(this.layer.events.triggerEvent("loadstart")===false){return }this.response=this.layer.protocol.read({filter:this.createFilter(),callback:this.merge,scope:this})};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.namespaces=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.namespaces=OpenLayers.Format.WFSCapabilities.v1.prototype.namespaces={ows:"http://www.opengis.net/ows",wms:"http://www.opengis.net/wms",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.defaultPrefix=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.defaultPrefix=OpenLayers.Format.WFSCapabilities.v1.prototype.defaultPrefix="wfs";OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.getNamespacePrefix=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.getNamespacePrefix=OpenLayers.Format.WFSCapabilities.v1.prototype.getNamespacePrefix=function(C){if(C==null){return this.defaultPrefix}else{var B=false;var D=null;for(D in this.namespaces){if(this.namespaces[D]==C){B=true;break}}if(!B){D=null}return D}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.runChildNodes=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.runChildNodes=OpenLayers.Format.WFSCapabilities.v1.prototype.runChildNodes=function(F,E){var C=E.childNodes;var B,D,H,J;for(var G=0,I=C.length;G<I;++G){B=C[G];if(B.nodeType==1){H=this.getNamespacePrefix(B.namespaceURI);if(H==this.defaultPrefix){H=""}if(H.length>0){H+="_"}J=B.nodeName.split(":").pop();D=this["read_cap_"+H+J];if(D){D.apply(this,[F,B])}else{OpenLayers.Console.log("no read_cap_"+H+J);D=this["read_cap_"+J];if(D){D.apply(this,[F,B])}}}}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ServiceException=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_ServiceException=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_ServiceException=function(C,B){if(C.exceptions===undefined){C.exceptions=[]}C.exceptions.push(this.getChildNode(B))};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_FeatureTypeList=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_FeatureTypeList=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_FeatureTypeList=function(D,C){var B={operations:{},featureTypes:[]};this.runChildNodes(B,C);D.featureTypeList=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_FeatureType=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_FeatureType=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_FeatureType=function(B,D){var C={keywords:[],formats:[],bbox:[],metadataURLs:[],operations:{},supportedSRSs:[]};this.runChildNodes(C,D);for(var E in B.operations){if(!C.operations.hasOwnProperty()){C.operations[E]=1}}B.featureTypes.push(C)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Fees=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Fees=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_Fees=function(D,C){var B=this.getChildValue(C);if(B&&B.toLowerCase()!="none"){D.fees=B}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_AccessConstraints=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_AccessConstraints=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_AccessConstraints=function(C,B){var D=this.getChildValue(B);if(D&&D.toLowerCase()!="none"){C.accessConstraints.push(D)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_HTTP=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_HTTP=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_HTTP=function(C,B){this.runChildNodes(C,B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_Operations=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Operations=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_Operations=function(F,E){var D=E.childNodes;var C;for(var B=0;B<D.length;B++){C=D[B];if(C.nodeType==1){F.operations[C.nodeName]=1}}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_MetadataURL=OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_MetadataURL=OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_MetadataURL=function(D,B){var E={};E.type=B.getAttribute("type");var C=B.getAttribute("format");switch(C){case"XML":C="text/xml";break;case"SGML":C="text/sgml";break;case"TXT":C="text/plain";break;default:break}E.format=C;E.href=this.getChildValue(B);D.metadataURLs.push(E)};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Service=function(C,D){var B={accessConstraints:[],keywords:[]};this.runChildNodes(B,D);C.service=B};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_OnlineResource=function(D,C){var B=this.getChildValue(C);if(B&&B.toLowerCase()!="none"){D.onlineResource=B}};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Keywords=function(H,G){var C=this.getChildValue(G);var E=[];if(C&&C.toLowerCase()!="none"){var C=C.replace(/\n/g,",").split(",");for(var F=0,B=C.length;F<B;F++){var D=OpenLayers.String.trim(C[F]);if(D){E.push(D)}}}if(E.length>0){H.keywords.push({keyword:E})}};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Capability=function(B,D){var C={operations:{}};this.runChildNodes(C,D);B.capability=C};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Request=function(C,B){this.runChildNodes(C,B)};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_GetCapabilities=function(D,C){var B={};this.runChildNodes(B,C);D.operations.GetCapabilities=B};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_DescribeFeatureType=function(D,B){var C={};this.runChildNodes(C,B);D.operations.DescribeFeaturetype=C};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Transaction=function(D,C){var B={};this.runChildNodes(B,C);D.operations.Transaction=B};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_GetFeature=function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.operations.GetFeature=B};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_GetFeatureWithLock=function(D,C){var B={formats:[]};this.runChildNodes(B,C);D.operations.getFeatureWithLock=getFeatureWithLock};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_LockFeature=function(D,B){var C={};this.runChildNodes(C,B);D.operations.LockFeature=C};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_ResultFormat=function(F,E){var D=E.childNodes;var C;for(var B=0;B<D.length;B++){C=D[B];if(C.nodeType==1){F.formats.push(C.nodeName)}}};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_DCPType=function(C,B){this.runChildNodes(C,B)};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Get=function(D,C){var B={href:C.getAttribute("onlineResource")};D.get=B};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_Post=function(D,C){var B={href:C.getAttribute("onlineResource")};D.post=B};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_SRS=function(C,B){C.srs=this.getChildValue(B);C.supportedSRSs.push(C.srs)};OpenLayers.Format.WFSCapabilities.v1_0_0.prototype.read_cap_LatLongBoundingBox=function(C,B){var D=[parseFloat(B.getAttribute("minx")),parseFloat(B.getAttribute("miny")),parseFloat(B.getAttribute("maxx")),parseFloat(B.getAttribute("maxy"))];C.bbox.push(D)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ServiceIdentification=function(D,C){var B={accessConstraints:[],keywords:[]};this.runChildNodes(B,C);D.service=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Title=function(C,B){OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_Title.apply(this,arguments)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Abstract=function(C,B){OpenLayers.Format.WFSCapabilities.v1.prototype.read_cap_Abstract.apply(this,arguments)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Keywords=function(D,C){var B={keyword:[]};this.runChildNodes(B,C);D.keywords.push(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Keyword=function(D,C){var B=this.getChildValue(C);D.keyword.push(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ServiceType=function(D,B){var C={};C[this.getChildValue(B)]=B.getAttribute("codeSpace");D.serviceType=C};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ServiceTypeVersion=function(C,B){C.serviceTypeVersion=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ServiceProvider=function(C,B){var D={};this.runChildNodes(D,B);C.serviceProvider=D};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ProviderName=function(C,B){C.providerName=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ProviderSite=function(D,C){var B=C.getAttributeNS("xlink","href");if(B&&B.toLowerCase()!="none"){D.providerSite=B}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ServiceContact=function(D,C){var B={};this.runChildNodes(B,C);D.serviceContact=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_IndividualName=function(C,B){C.individualName=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_PositionName=function(C,B){C.positionName=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ContactInfo=function(D,C){var B={};this.runChildNodes(B,C);D.contactInfo=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Role=function(C,B){var D={};D[this.getChildValue(B)]=B.getAttribute("codeSpace");C.role=D};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Phone=function(D,C){var B={voices:[],facsimiles:[]};this.runChildNodes(B,C);D.phone=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Address=function(D,C){var B={deliveryPoints:[],electronicMailAddresses:[]};this.runChildNodes(B,C);D.address=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_OnlineResource=function(D,C){var B=this.getAttributeNS(C,"http://www.w3.org/1999/xlink","href");D.onlineResource=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_HoursOfService=function(C,B){C.hoursOfService=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ContactInstructions=function(C,B){C.contactInstructions=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Voice=function(D,B){var C=this.getChildValue(B);if(C){D.voices.push(C)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Facsimile=function(D,C){var B=this.getChildValue(C);if(B){D.facsimiles.push(B)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_DeliveryPoint=function(D,B){var C=this.getChildValue(B);if(C){D.deliveryPoints.push(C)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_City=function(C,B){C.city=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_AdministrativeArea=function(C,B){C.administrativeArea=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_PostalCode=function(C,B){C.postalCode=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Country=function(C,B){C.country=this.getChildValue(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_ElectronicMailAddress=function(D,C){var B=this.getChildValue(C);if(B){D.electronicMailAddresses.push(B)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_OperationsMetadata=function(D,C){var B={operations:{},parameters:[],constraints:[]};this.runChildNodes(B,C);D.capability=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Operation=function(E,D){var B={};var C=D.getAttribute("name");B[C]={parameters:[],constraints:[],metadata:[]};this.runChildNodes(B[C],D);E.operations[C]=B[C]};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Parameter=function(C,B){C.parameters.push(this.readDomainType(B))};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.readDomainType=function(C){var B={values:[],metadata:[],name:C.getAttribute("name")};this.runChildNodes(B,C);return B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_DCP=function(C,B){this.runChildNodes(C,B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Get=function(D,C){var B={href:this.readRequestMethod(C),constraints:[]};this.runChildNodes(D,C);D.get=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Post=function(D,C){var B={href:this.readRequestMethod(C),constraints:[]};this.runChildNodes(D,C);D.post=B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.readRequestMethod=function(C){var B=this.getAttributeNS(C,"http://www.w3.org/1999/xlink","href");if(B.indexOf("?")<0){B+="?"}else{if(B.lastIndexOf("?",B.length-1)!=B.length-1&&B.lastIndexOf("&",B.length-1)!=B.length-1){B+="&"}}return B};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Constraint=function(C,B){C.constraints.push(this.readDomainType(B))};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Value=function(D,B){var C=this.getChildValue(B);if(C){D.values.push(C)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_Metadata=function(D,C){var B=this.getAttributeNS(C,"http://www.w3.org/1999/xlink","href");D.metadata.push(B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ServesGMLObjectTypeList=function(C,B){C.serversGMLObjectTypeList=[];this.runChildNodes(C.serversGMLObjectTypeList,B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_SupportsGMLObjectTypeList=function(C,B){C.supportsGMLObjectTypeList=[];this.runChildNodes(C.supportsGMLObjectTypeList,B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_GMLObjectType=function(C,B){var D={formats:[]};this.runChildNodes(D,B);C.push(D)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_OutputFormats=function(C,B){this.runChildNodes(C,B)};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_Format=function(D,B){var C=this.getChildValue(B);if(C){D.formats.push(C)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_DefaultSRS=function(D,C){var B=this.getChildValue(C);if(B){D.srs=B;D.supportedSRSs.push(B)}};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_OtherSRS=function(C,B){C.supportedSRSs.push(this.getChildValue(B))};OpenLayers.Format.WFSCapabilities.v1_1_0.prototype.read_cap_ows_WGS84BoundingBox=function(D,E){var C=E.childNodes;var M,L,J,I;for(var H=0,G=C.length;H<G;H++){var B=C[H];var F=B.nodeName.split(":").pop();if(B.nodeType==1){if(F=="LowerCorner"){var K=this.getChildValue(B).split(" ");M=K[0];L=K[1]}else{if(F=="UpperCorner"){var K=this.getChildValue(B).split(" ");J=K[0];I=K[1]}}}}D.bbox.push([M,L,J,I])};OpenLayers.Format.GeoJSON.prototype.createCRSObject=function(C){var E;if(this.internalProjection&&this.externalProjection){E=this.externalProjection.toString()}else{E=C.layer.getNativeProjection().toString()}var F=E.substring(E.indexOf(":")+1);var D="";var B={};if(E.match(/^urn:/i)){F=E;D="OGC"}else{if(E.match(/epsg:/i)){F=parseInt(F);if(F==4326){F="urn:ogc:def:crs:OGC:1.3:CRS84";D="OGC"}else{D="EPSG"}}else{if(E.match(/crs:/i)){F="urn:ogc:def:crs:OGC:1.3:"+F;D="OGC"}else{if(E.match(/ignf:/i)){F="urn:ogc:def:crs:IGNF:1.1:"+F;D="OGC"}else{if(E.match(/http:\/\/www\.epsg\.org\/#/)){F=parseInt(E.substring(E.indexOf("#")+1));if(F==4326){F="urn:ogc:def:crs:OGC:1.3:CRS84";D="OGC"}else{D="EPSG"}}else{if(E.match(/\/RIG.xml#/)){F="urn:ogc:def:crs:IGNF:1.1:"+E.substring(E.indexOf("#")+1);D="OGC"}}}}}}switch(D){case"OGC":B={type:"OGC",properties:{urn:F}};break;case"EPSG":B={type:"EPSG",properties:{code:F}};break}return B};OpenLayers.Format.WMC.prototype.read=function(F,D){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}var C=F.documentElement;var B=this.version;if(!B){B=C.getAttribute("version");if(!B){B=this.defaultVersion}}if(!this.parser||this.parser.VERSION!=B){var H=OpenLayers.Format.WMC["v"+B.replace(/\./g,"_")];if(!H){throw OpenLayers.i18n("wmc.version.not.supported",{v:B})}this.parser=new H(this.options)}var E=this.parser.read(F,D);var G;if(D.map){this.context=E;if(D.map instanceof OpenLayers.Map){G=this.mergeContextToMap(E,D.map)}else{G=this.contextToMap(E,D.map)}}else{G=E}return G};OpenLayers.Format.WMC.prototype.write=function(F,C){if(F instanceof OpenLayers.Map){F=this.mapToContext(F)}var B=(C&&C.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=B){var E=OpenLayers.Format.WMC["v"+B.replace(/\./g,"_")];if(!E){throw OpenLayers.i18n("wmc.version.not.supported",{v:B})}this.parser=new E(this.options)}var D=this.parser.write(F,C);return D};OpenLayers.Format.WMC.v1_1_0.prototype.getLayerFromInfo=OpenLayers.Format.WMC.v1_0_0.prototype.getLayerFromInfo=OpenLayers.Format.WMC.v1.prototype.getLayerFromInfo=function(G){var C=G.options;if(this.layerOptions){OpenLayers.Util.applyDefaults(C,this.layerOptions)}C.legends=[];var E;for(var F=0,B=G.styles.length;F<B;F++){E=G.styles[F];C.legends.push(E)}var D=new G.classLayer(G.title,G.href,G.params,C);return D};OpenLayers.Format.WMC.v1_1_0.prototype.read_wmc_Server=OpenLayers.Format.WMC.v1_0_0.prototype.read_wmc_Server=OpenLayers.Format.WMC.v1.prototype.read_wmc_Server=function(C,B){var D=B.getAttribute("service");if(this.serviceMap&&this.servicesMap[D]){C.classLayer=this.servicesMap[D]}else{C.classLayer=OpenLayers.Layer.WMS}C.params.version=B.getAttribute("version");this.runChildNodes(C,B)};OpenLayers.Format.WMC.v1_1_0.prototype.read_wmc_dataURL=OpenLayers.Format.WMC.v1_0_0.prototype.read_wmc_dataURL=OpenLayers.Format.WMC.v1.prototype.read_wmc_dataURL=function(D,C){var E={};var B=C.getElementsByTagName("OnlineResource");if(B.length>0){this.read_wmc_OnlineResource(E,B[0])}D.options.dataURL=E.href};OpenLayers.Format.WMC.v1_1_0.prototype.read_ol_minZoomLevel=OpenLayers.Format.WMC.v1_0_0.prototype.read_ol_minZoomLevel=OpenLayers.Format.WMC.v1.prototype.read_ol_minZoomLevel=function(D,B){var C=this.getChildValue(B);C=parseInt(C);if(!isNaN(C)){D.minZoomLevel=C}};OpenLayers.Format.WMC.v1_1_0.prototype.read_ol_maxZoomLevel=OpenLayers.Format.WMC.v1_0_0.prototype.read_ol_maxZoomLevel=OpenLayers.Format.WMC.v1.prototype.read_ol_maxZoomLevel=function(D,B){var C=this.getChildValue(B);C=parseInt(C);if(!isNaN(C)){D.maxZoomLevel=C}};OpenLayers.Format.WMC.v1_1_0.prototype.read_ol_resolutions=OpenLayers.Format.WMC.v1_0_0.prototype.read_ol_resolutions=OpenLayers.Format.WMC.v1.prototype.read_ol_resolutions=function(F,E){var C=this.getChildValue(E).split(",");for(var D=0,B=C.length;D<B;D++){C[D]=parseFloat(C[D])}F.options.resolutions=C};OpenLayers.Format.WMC.v1_1_0.prototype.read_wmc_SRS=OpenLayers.Format.WMC.v1_0_0.prototype.read_wmc_SRS=OpenLayers.Format.WMC.v1.prototype.read_wmc_SRS=function(D,C){var B=this.getChildValue(C);if(B){D.options.projection=new OpenLayers.Projection(B)}};OpenLayers.Format.WMC.v1_1_0.prototype.read_ol_nativeResolutions=OpenLayers.Format.WMC.v1_0_0.prototype.read_ol_nativeResolutions=OpenLayers.Format.WMC.v1.prototype.read_ol_nativeResolutions=function(F,E){var C=this.getChildValue(E).split(",");for(var D=0,B=C.length;D<B;D++){C[D]=parseFloat(C[D])}F.options.nativeResolutions=C};OpenLayers.Format.WMC.v1_1_0.prototype.read_wmc_nativeProjection=OpenLayers.Format.WMC.v1_0_0.prototype.read_wmc_nativeProjection=OpenLayers.Format.WMC.v1.prototype.read_wmc_nativeProjection=function(D,C){var B=this.getChildValue(C);if(B){D.options.nativeProjection=new OpenLayers.Projection(B)}};OpenLayers.Format.WMC.v1_1_0.prototype.write_wmc_LayerList=OpenLayers.Format.WMC.v1_0_0.prototype.write_wmc_LayerList=OpenLayers.Format.WMC.v1.prototype.write_wmc_LayerList=function(E){var F=this.createElementDefaultNS("LayerList");var D;for(var C=0,B=E.layers.length;C<B;++C){D=E.layers[C];F.appendChild(this.write_wmc_Layer(D))}return F};OpenLayers.Format.WMC.v1_0_0.prototype.write_wmc_Layer=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer=function(B){var C=this.createElementDefaultNS("Layer",null,{queryable:B.queryable?"1":"0",hidden:B.visibility?"0":"1"});C.appendChild(this.write_wmc_Server(B));if(B.params&&B.params.LAYERS){C.appendChild(this.createElementDefaultNS("Name",B.params.LAYERS))}else{C.appendChild(this.createElementDefaultNS("Name",B.id))}C.appendChild(this.createElementDefaultNS("Title",B.name));if(B.projection){C.appendChild(this.write_wmc_SRS(B))}if(B.dataURL){C.appendChild(this.write_wmc_dataURL(B))}if(B.metadataURL){C.appendChild(this.write_wmc_MetadataURL(B))}if(B.params&&B.params.FORMAT){C.appendChild(this.write_wmc_FormatList(B))}if(B.params){C.appendChild(this.write_wmc_StyleList(B))}C.appendChild(this.write_wmc_LayerExtension(B));return C};OpenLayers.Format.WMC.v1_1_0.prototype.write_wmc_SRS=OpenLayers.Format.WMC.v1_0_0.prototype.write_wmc_SRS=OpenLayers.Format.WMC.v1.prototype.write_wmc_SRS=function(B){var C=this.createElementDefaultNS("SRS",""+B.projection);return C};OpenLayers.Format.WMC.v1_1_0.prototype.write_wmc_LayerExtension=OpenLayers.Format.WMC.v1_0_0.prototype.write_wmc_LayerExtension=OpenLayers.Format.WMC.v1.prototype.write_wmc_LayerExtension=function(H){var F=this.createElementDefaultNS("Extension");if(H.resolutions){var B=this.createElementNS(this.namespaces.ol,"ol:resolutions");B.appendChild(this.createTextNode(H.resolutions.join(",")));F.appendChild(B)}var C=H.maxExtent;var K=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(K,{minx:C.left.toPrecision(10),miny:C.bottom.toPrecision(10),maxx:C.right.toPrecision(10),maxy:C.top.toPrecision(10)});F.appendChild(K);if(H.nativeResolutions){var B=this.createElementNS(this.namespaces.ol,"ol:nativeResolutions");B.appendChild(this.createTextNode(H.nativeResolutions.join(",")));F.appendChild(B)}if(H.nativeProjection){var D=this.createElementNS(this.namespaces.ol,"ol:nativeProjection");D.appendChild(this.createTextNode(""+H.nativeProjection));F.appendChild(D)}if(H.params&&H.params.TRANSPARENT){var L=this.createElementNS(this.namespaces.ol,"ol:transparent");L.appendChild(this.createTextNode(H.params.TRANSPARENT));F.appendChild(L)}var J=["numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile","minZoomLevel","maxZoomLevel",];var E;for(var G=0,I=J.length;G<I;++G){E=this.createOLPropertyNode(H,J[G]);if(E){F.appendChild(E)}}return F};OpenLayers.Format.WMC.v1_1_0.prototype.write_wmc_Server=OpenLayers.Format.WMC.v1_0_0.prototype.write_wmc_Server=OpenLayers.Format.WMC.v1.prototype.write_wmc_Server=function(B){var C=this.createElementDefaultNS("Server");var E={service:"OGC:WMS",version:B.params&&B.params.VERSION?B.params.VERSION:"0.0.0"};if(this.servicesMap){for(var D in this.servicesMap){if(this.servicesMap.hasOwnProperty(D)){if(this.servicesMap[D].prototype.CLASS_NAME==B.CLASS_NAME){E.service=D;E.version=B.params&&B.params.VERSION?B.params.VERSION:"0.0.0";break}}}}this.setAttributes(C,E);C.appendChild(this.write_wmc_OnlineResource(B.url));return C};OpenLayers.Format.WMC.v1_1_0.prototype.write_wmc_dataURL=OpenLayers.Format.WMC.v1_0_0.prototype.write_wmc_dataURL=OpenLayers.Format.WMC.v1.prototype.write_wmc_dataURL=function(B){var C=this.createElementDefaultNS("dataURL");C.appendChild(this.write_wmc_OnlineResource(B.dataURL));return C};OpenLayers.Layer.PointTrack.prototype.changeBaseLayer=OpenLayers.Layer.Vector.prototype.changeBaseLayer;OpenLayers.Layer.PointTrack.prototype.getCompatibleProjection=OpenLayers.Layer.Vector.prototype.getCompatibleProjection;OpenLayers.Layer.PointTrack.prototype.labelOffset=OpenLayers.Layer.WFS.prototype.labelOffset=null;OpenLayers.Layer.WFS.prototype.moveTo=function(B,C,O){if(this.vectorMode){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments)}else{OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments)}if(O){return }if(C){if(this.vectorMode){this.renderer.clear()}}if(this.options.minZoomLevel){OpenLayers.Console.warn(OpenLayers.i18n("minZoomLevelError"));if(this.map.getZoom()<this.options.minZoomLevel){return }}if(B==null){B=this.map.getExtent()}var N=(this.tile==null);var H=(!N&&!this.tile.bounds.containsBounds(B));if(C||N||(!O&&H)){var D=B.getCenterLonLat();var M=B.getWidth()*this.ratio;var I=B.getHeight()*this.ratio;var K=new OpenLayers.Bounds(D.lon-(M/2),D.lat-(I/2),D.lon+(M/2),D.lat+(I/2));var P=this.map.getSize();P.w=P.w*this.ratio;P.h=P.h*this.ratio;var J=new OpenLayers.LonLat(K.left,K.top);var L=this.map.getLayerPxFromLonLat(J);var E=this.getFullRequestString();var G=null;var F=this.params.filter||this.params.FILTER;if(F){G={FILTER:F}}else{G={BBOX:this.encodeBBOX?K.toBBOX():K.toArray()}}var Q=K.clone();Q.transform(this.map.getProjection(),this.getNativeProjection());if(!F){G.BBOX=this.encodeBBOX?Q.toBBOX():Q.toArray()}E+="&"+OpenLayers.Util.getParameterString(G);if(!this.tile){this.tile=new OpenLayers.Tile.WFS(this,L,K,E,P);this.addTileMonitoringHooks(this.tile);this.tile.draw()}else{if(this.vectorMode){this.destroyFeatures();this.renderer.clear()}else{this.clearMarkers()}this.removeTileMonitoringHooks(this.tile);this.tile.destroy();this.tile=null;this.tile=new OpenLayers.Tile.WFS(this,L,K,E,P);this.addTileMonitoringHooks(this.tile);this.tile.draw()}}};OpenLayers.Layer.WFS.prototype.addTileMonitoringHooks=function(B){B.onLoadStart=function(){if(this==this.layer.tile){if(this.layer.events.triggerEvent("loadstart")===false){return }}};B.events.register("loadstart",B,B.onLoadStart);B.onLoadEnd=function(){if(this==this.layer.tile){this.layer.events.triggerEvent("tileloaded");this.layer.events.triggerEvent("loadend")}};B.events.register("loadend",B,B.onLoadEnd);B.events.register("unload",B,B.onLoadEnd)};OpenLayers.Layer.WFS.prototype.getFullRequestString=function(D,C){var B=this.getNativeProjection();this.params.SRS=(B==null)?null:B.getCode();return OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)};OpenLayers.Layer.WFS.prototype.commit=function(){if(!this.writer){var B={};if(this.map&&this.getNativeProjection()&&!this.getNativeProjection().equals(this.map.getProjection())){B.externalProjection=this.getNativeProjection();B.internalProjection=this.map.getProjection()}this.writer=new OpenLayers.Format.WFS(B,this)}var C=this.writer.write(this.features);OpenLayers.Request.POST({url:this.url,data:C,success:this.commitSuccess,failure:this.commitFailure,scope:this})};OpenLayers.Layer.PointTrack.prototype.addFeatures=OpenLayers.Layer.WFS.prototype.addFeatures=OpenLayers.Layer.Vector.prototype.addFeatures;OpenLayers.Layer.PointTrack.prototype.getDataExtent=OpenLayers.Layer.WFS.prototype.getDataExtent=OpenLayers.Layer.Vector.prototype.getDataExtent;OpenLayers.Layer.WFS.prototype.changeBaseLayer=function(I){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){var B=this.getCompatibleProjection(I.layer);if(B!=null){this.addOptions({projection:B.clone()})}var J=I.baseLayer?I.baseLayer.getNativeProjection():null;var G=this.map.getProjection();var H=this.getVisibility();if(H){this.setVisibility(false)}if(this.vectorMode){if(!this.formatOptions){this.formatOptions={}}if(!this.formatObject){this.formatObject={}}if(!this.options.formatOptions){this.options.formatOptions={}}this.options.formatOptions.internalProjection=G.clone();this.formatOptions.internalProjection=G.clone();this.formatObject.internalProjection=G.clone();for(var E=0,D=this.features.length;E<D;E++){var K=this.features[E];K.geometry.transform(J,G);if(K.popup&&K.popup.lonlat){K.popup.hide();K.popup.lonlat.transform(J,G)}}}else{for(var E=0,F=this.markers.length;E<F;E++){var C=this.markers[E];C.lonlat.transform(J,G)}}if(H){this.setVisibility(true)}}return true};OpenLayers.Layer.WFS.prototype.getCompatibleProjection=function(F){var E=OpenLayers.Layer.prototype.getCompatibleProjection.apply(this,arguments);if(E!=null){return E}if(F==null){F=this.map.baseLayer;if(F==null){return undefined}}var G=F.getNativeProjection();if(this.srs!==undefined&&this.srs instanceof Array){for(var D=0,B=this.srs.length;D<B;D++){var C=this.srs[D];if(!(C instanceof OpenLayers.Projection)){E=new OpenLayers.Projection(C)}else{E=C}if(E.isCompatibleWith(G)){return E}E=null}}return null};var Geoportal={singleFile:true};(function(){var H=(typeof (Geoportal)=="object"&&Geoportal.singleFile);window.Geoportal={_scriptName:(!H)?"lib/Geoportal.js":"GeoportalExtended.js",_scriptLocation:null,_getScriptLocation:function(){if(Geoportal._scriptLocation){return Geoportal._scriptLocation}var Q=Geoportal._scriptName;var P=Q.length;var L=document.documentElement.getElementsByTagName("script");for(var N=0;N<L.length;N++){var R=L[N].getAttribute("src");if(R){var M=R.lastIndexOf(Q);var O=R.lastIndexOf("?");if(O<0){O=R.length}if((M>-1)&&(M+P==O)){Geoportal._scriptLocation=R.slice(0,-P);break}}}return Geoportal._scriptLocation||""}};if(!H){var I=["../../openlayers/lib/OpenLayers/SingleFile.js","../../openlayers/lib/OpenLayers.js","../../openlayers/lib/OpenLayers/BaseTypes.js","../../openlayers/lib/OpenLayers/BaseTypes/Class.js","../../openlayers/lib/OpenLayers/Util.js","../../openlayers/lib/Rico/Corner.js","../../openlayers/lib/Gears/gears_init.js","../../openlayers/lib/OpenLayers/BaseTypes/Element.js","../../openlayers/lib/OpenLayers/BaseTypes/Size.js","../../openlayers/lib/OpenLayers/Console.js","../../openlayers/lib/OpenLayers/Icon.js","../../openlayers/lib/OpenLayers/Popup.js","../../openlayers/lib/OpenLayers/Protocol.js","../../openlayers/lib/OpenLayers/Renderer.js","../../openlayers/lib/OpenLayers/Strategy.js","../../openlayers/lib/Rico/Color.js","../../openlayers/lib/OpenLayers/BaseTypes/Bounds.js","../../openlayers/lib/OpenLayers/BaseTypes/LonLat.js","../../openlayers/lib/OpenLayers/BaseTypes/Pixel.js","../../openlayers/lib/OpenLayers/Control.js","../../openlayers/lib/OpenLayers/Lang.js","../../openlayers/lib/OpenLayers/Popup/Anchored.js","../../openlayers/lib/OpenLayers/Protocol/SQL.js","../../openlayers/lib/OpenLayers/Protocol/WFS.js","../../openlayers/lib/OpenLayers/Renderer/Canvas.js","../../openlayers/lib/OpenLayers/Renderer/Elements.js","../../openlayers/lib/OpenLayers/Strategy/Cluster.js","../../openlayers/lib/OpenLayers/Strategy/Fixed.js","../../openlayers/lib/OpenLayers/Strategy/Paging.js","../../openlayers/lib/OpenLayers/Strategy/Save.js","../../openlayers/lib/OpenLayers/Tween.js","../../openlayers/lib/OpenLayers/Control/ArgParser.js","../../openlayers/lib/OpenLayers/Control/Attribution.js","../../openlayers/lib/OpenLayers/Control/Button.js","../../openlayers/lib/OpenLayers/Control/LayerSwitcher.js","../../openlayers/lib/OpenLayers/Control/MouseDefaults.js","../../openlayers/lib/OpenLayers/Control/MousePosition.js","../../openlayers/lib/OpenLayers/Control/Pan.js","../../openlayers/lib/OpenLayers/Control/PanZoom.js","../../openlayers/lib/OpenLayers/Control/Panel.js","../../openlayers/lib/OpenLayers/Control/Scale.js","../../openlayers/lib/OpenLayers/Control/ScaleLine.js","../../openlayers/lib/OpenLayers/Control/ZoomIn.js","../../openlayers/lib/OpenLayers/Control/ZoomOut.js","../../openlayers/lib/OpenLayers/Control/ZoomToMaxExtent.js","../../openlayers/lib/OpenLayers/Events.js","../../openlayers/lib/OpenLayers/Format.js","../../openlayers/lib/OpenLayers/Lang/en.js","../../openlayers/lib/OpenLayers/Lang/es.js","../../openlayers/lib/OpenLayers/Lang/fr.js","../../openlayers/lib/OpenLayers/Lang/it.js","../../openlayers/lib/OpenLayers/Popup/AnchoredBubble.js","../../openlayers/lib/OpenLayers/Popup/Framed.js","../../openlayers/lib/OpenLayers/Projection.js","../../openlayers/lib/OpenLayers/Protocol/WFS/v1.js","../../openlayers/lib/OpenLayers/Renderer/SVG.js","../../openlayers/lib/OpenLayers/Renderer/VML.js","../../openlayers/lib/OpenLayers/Tile.js","../../openlayers/lib/OpenLayers/Control/MouseToolbar.js","../../openlayers/lib/OpenLayers/Control/NavigationHistory.js","../../openlayers/lib/OpenLayers/Control/PanPanel.js","../../openlayers/lib/OpenLayers/Control/PanZoomBar.js","../../openlayers/lib/OpenLayers/Control/Permalink.js","../../openlayers/lib/OpenLayers/Control/ZoomPanel.js","../../openlayers/lib/OpenLayers/Format/JSON.js","../../openlayers/lib/OpenLayers/Format/WFST.js","../../openlayers/lib/OpenLayers/Format/WMSCapabilities.js","../../openlayers/lib/OpenLayers/Format/XML.js","../../openlayers/lib/OpenLayers/Handler.js","../../openlayers/lib/OpenLayers/Lang/de.js","../../openlayers/lib/OpenLayers/Map.js","../../openlayers/lib/OpenLayers/Marker.js","../../openlayers/lib/OpenLayers/Popup/FramedCloud.js","../../openlayers/lib/OpenLayers/Request.js","../../openlayers/lib/OpenLayers/Tile/Image.js","../../openlayers/lib/OpenLayers/Control/OverviewMap.js","../../openlayers/lib/OpenLayers/Feature.js","../../openlayers/lib/OpenLayers/Format/WFSCapabilities.js","../../openlayers/lib/OpenLayers/Format/WFSDescribeFeatureType.js","../../openlayers/lib/OpenLayers/Format/WFST/v1.js","../../openlayers/lib/OpenLayers/Format/WMC.js","../../openlayers/lib/OpenLayers/Format/WMSCapabilities/v1_1.js","../../openlayers/lib/OpenLayers/Format/WMSDescribeLayer.js","../../openlayers/lib/OpenLayers/Format/WMSGetFeatureInfo.js","../../openlayers/lib/OpenLayers/Handler/Click.js","../../openlayers/lib/OpenLayers/Handler/Drag.js","../../openlayers/lib/OpenLayers/Handler/Feature.js","../../openlayers/lib/OpenLayers/Handler/Hover.js","../../openlayers/lib/OpenLayers/Handler/Keyboard.js","../../openlayers/lib/OpenLayers/Handler/MouseWheel.js","../../openlayers/lib/OpenLayers/Layer.js","../../openlayers/lib/OpenLayers/Marker/Box.js","../../openlayers/lib/OpenLayers/Request/XMLHttpRequest.js","../../openlayers/lib/OpenLayers/Ajax.js","../../openlayers/lib/OpenLayers/Control/DragFeature.js","../../openlayers/lib/OpenLayers/Control/DragPan.js","../../openlayers/lib/OpenLayers/Control/KeyboardDefaults.js","../../openlayers/lib/OpenLayers/Control/WMSGetFeatureInfo.js","../../openlayers/lib/OpenLayers/Feature/Vector.js","../../openlayers/lib/OpenLayers/Feature/WFS.js","../../openlayers/lib/OpenLayers/Format/WFSCapabilities/v1.js","../../openlayers/lib/OpenLayers/Format/WMC/v1.js","../../openlayers/lib/OpenLayers/Format/WMSCapabilities/v1_1_0.js","../../openlayers/lib/OpenLayers/Format/WMSCapabilities/v1_1_1.js","../../openlayers/lib/OpenLayers/Format/WMSDescribeLayer/v1_1.js","../../openlayers/lib/OpenLayers/Handler/Box.js","../../openlayers/lib/OpenLayers/Handler/RegularPolygon.js","../../openlayers/lib/OpenLayers/Layer/EventPane.js","../../openlayers/lib/OpenLayers/Layer/FixedZoomLevels.js","../../openlayers/lib/OpenLayers/Layer/HTTPRequest.js","../../openlayers/lib/OpenLayers/Layer/Image.js","../../openlayers/lib/OpenLayers/Layer/Markers.js","../../openlayers/lib/OpenLayers/Layer/SphericalMercator.js","../../openlayers/lib/OpenLayers/Tile/WFS.js","../../openlayers/lib/OpenLayers/Control/DrawFeature.js","../../openlayers/lib/OpenLayers/Control/Measure.js","../../openlayers/lib/OpenLayers/Control/ZoomBox.js","../../openlayers/lib/OpenLayers/Format/WFSCapabilities/v1_0_0.js","../../openlayers/lib/OpenLayers/Format/WFSCapabilities/v1_1_0.js","../../openlayers/lib/OpenLayers/Format/WKT.js","../../openlayers/lib/OpenLayers/Format/WMC/v1_0_0.js","../../openlayers/lib/OpenLayers/Format/WMC/v1_1_0.js","../../openlayers/lib/OpenLayers/Layer/Boxes.js","../../openlayers/lib/OpenLayers/Layer/GeoRSS.js","../../openlayers/lib/OpenLayers/Layer/Google.js","../../openlayers/lib/OpenLayers/Layer/Grid.js","../../openlayers/lib/OpenLayers/Layer/MultiMap.js","../../openlayers/lib/OpenLayers/Layer/Text.js","../../openlayers/lib/OpenLayers/Layer/VirtualEarth.js","../../openlayers/lib/OpenLayers/Layer/Yahoo.js","../../openlayers/lib/OpenLayers/Protocol/HTTP.js","../../openlayers/lib/OpenLayers/Style.js","../../openlayers/lib/OpenLayers/Control/Navigation.js","../../openlayers/lib/OpenLayers/Filter.js","../../openlayers/lib/OpenLayers/Geometry.js","../../openlayers/lib/OpenLayers/Layer/ArcGIS93Rest.js","../../openlayers/lib/OpenLayers/Layer/KaMap.js","../../openlayers/lib/OpenLayers/Layer/MapGuide.js","../../openlayers/lib/OpenLayers/Layer/MapServer.js","../../openlayers/lib/OpenLayers/Layer/TMS.js","../../openlayers/lib/OpenLayers/Layer/TileCache.js","../../openlayers/lib/OpenLayers/Layer/WMS.js","../../openlayers/lib/OpenLayers/Layer/WorldWind.js","../../openlayers/lib/OpenLayers/Layer/XYZ.js","../../openlayers/lib/OpenLayers/Protocol/SQL/Gears.js","../../openlayers/lib/OpenLayers/Rule.js","../../openlayers/lib/OpenLayers/StyleMap.js","../../openlayers/lib/OpenLayers/Control/NavToolbar.js","../../openlayers/lib/OpenLayers/Filter/Comparison.js","../../openlayers/lib/OpenLayers/Filter/FeatureId.js","../../openlayers/lib/OpenLayers/Filter/Logical.js","../../openlayers/lib/OpenLayers/Filter/Spatial.js","../../openlayers/lib/OpenLayers/Geometry/Collection.js","../../openlayers/lib/OpenLayers/Geometry/Point.js","../../openlayers/lib/OpenLayers/Geometry/Rectangle.js","../../openlayers/lib/OpenLayers/Geometry/Surface.js","../../openlayers/lib/OpenLayers/Layer/KaMapCache.js","../../openlayers/lib/OpenLayers/Layer/MapServer/Untiled.js","../../openlayers/lib/OpenLayers/Layer/Vector.js","../../openlayers/lib/OpenLayers/Layer/WMS/Untiled.js","../../openlayers/lib/OpenLayers/Control/GetFeature.js","../../openlayers/lib/OpenLayers/Control/Snapping.js","../../openlayers/lib/OpenLayers/Format/Filter.js","../../openlayers/lib/OpenLayers/Format/SLD.js","../../openlayers/lib/OpenLayers/Format/Text.js","../../openlayers/lib/OpenLayers/Geometry/MultiPoint.js","../../openlayers/lib/OpenLayers/Handler/Point.js","../../openlayers/lib/OpenLayers/Layer/GML.js","../../openlayers/lib/OpenLayers/Layer/PointTrack.js","../../openlayers/lib/OpenLayers/Layer/Vector/RootContainer.js","../../openlayers/lib/OpenLayers/Layer/WFS.js","../../openlayers/lib/OpenLayers/Strategy/BBOX.js","../../openlayers/lib/OpenLayers/Control/SelectFeature.js","../../openlayers/lib/OpenLayers/Format/Filter/v1.js","../../openlayers/lib/OpenLayers/Geometry/Curve.js","../../openlayers/lib/OpenLayers/Control/ModifyFeature.js","../../openlayers/lib/OpenLayers/Geometry/LineString.js","../../openlayers/lib/OpenLayers/Format/GPX.js","../../openlayers/lib/OpenLayers/Geometry/LinearRing.js","../../openlayers/lib/OpenLayers/Geometry/MultiLineString.js","../../openlayers/lib/OpenLayers/Handler/Path.js","../../openlayers/lib/OpenLayers/Control/Split.js","../../openlayers/lib/OpenLayers/Geometry/Polygon.js","../../openlayers/lib/OpenLayers/Format/GeoRSS.js","../../openlayers/lib/OpenLayers/Format/KML.js","../../openlayers/lib/OpenLayers/Format/OSM.js","../../openlayers/lib/OpenLayers/Geometry/MultiPolygon.js","../../openlayers/lib/OpenLayers/Handler/Polygon.js","../../openlayers/lib/OpenLayers/Control/EditingToolbar.js","../../openlayers/lib/OpenLayers/Format/ArcXML.js","../../openlayers/lib/OpenLayers/Format/GML.js","../../openlayers/lib/OpenLayers/Format/GeoJSON.js","../../openlayers/lib/OpenLayers/Format/ArcXML/Features.js","../../openlayers/lib/OpenLayers/Format/GML/Base.js","../../openlayers/lib/OpenLayers/Format/WFS.js","../../openlayers/lib/OpenLayers/Layer/ArcIMS.js","../../openlayers/lib/OpenLayers/Format/GML/v2.js","../../openlayers/lib/OpenLayers/Format/GML/v3.js","../../openlayers/lib/OpenLayers/Format/Filter/v1_0_0.js","../../openlayers/lib/OpenLayers/Format/Filter/v1_1_0.js","../../openlayers/lib/OpenLayers/Format/SLD/v1.js","../../openlayers/lib/OpenLayers/Format/WFST/v1_0_0.js","../../openlayers/lib/OpenLayers/Format/WFST/v1_1_0.js","../../openlayers/lib/OpenLayers/Format/SLD/v1_0_0.js","../../openlayers/lib/OpenLayers/Protocol/WFS/v1_0_0.js","../../openlayers/lib/OpenLayers/Protocol/WFS/v1_1_0.js","../../proj4js/lib/proj4js.js","../../proj4js/lib/OverloadedProj4js.js","OpenLayers/OverloadedOpenLayersMinimum.js","OpenLayers/OverloadedOpenLayersStandard.js","OpenLayers/OverloadedOpenLayersExtended.js","Geoportal/Lang.js","Geoportal/Lang/en.js","Geoportal/Lang/fr.js","Geoportal/Lang/de.js","Geoportal/Lang/es.js","Geoportal/Lang/it.js","Geoportal/Control.js","Geoportal/Format.js","Geoportal/Layer.js","Geoportal/Layer/Aggregate.js","Geoportal/OLS.js","Geoportal/Popup.js","Geoportal/Tile.js","Geoportal/Util.js","Geoportal/Control/Copyright.js","Geoportal/Control/DeleteFeature.js","Geoportal/Control/Floating.js","Geoportal/Control/GraphicScale.js","Geoportal/Control/Loading.js","Geoportal/Control/Logo.js","Geoportal/Control/Panel.js","Geoportal/Control/PermanentLogo.js","Geoportal/Control/Projections.js","Geoportal/Control/RemoveLayer.js","Geoportal/Control/SliderBase.js","Geoportal/Control/ToolBox.js","Geoportal/Control/ZoomToLayerMaxExtent.js","Geoportal/Format/GPX.js","Geoportal/Format/GPX/v1.js","Geoportal/Format/Geoconcept.js","Geoportal/Format/XLS.js","Geoportal/GeoRMHandler.js","Geoportal/Layer/Grid.js","Geoportal/Layer/WFS.js","Geoportal/Layer/WMS.js","Geoportal/Layer/WMSC.js","Geoportal/OLS/AbstractBody.js","Geoportal/OLS/AbstractHeader.js","Geoportal/OLS/AbstractLocation.js","Geoportal/OLS/AbstractRequestParameters.js","Geoportal/OLS/AbstractResponseParameters.js","Geoportal/OLS/AbstractStreetLocator.js","Geoportal/OLS/Error.js","Geoportal/OLS/GeocodeMatchCode.js","Geoportal/OLS/LUS.js","Geoportal/OLS/Place.js","Geoportal/OLS/PostalCode.js","Geoportal/OLS/Street.js","Geoportal/OLS/UOM.js","Geoportal/OLS/XLS.js","Geoportal/Popup/Anchored.js","Geoportal/Tile/Image.js","Geoportal/Control/EditingToolbar.js","Geoportal/Control/Form.js","Geoportal/Control/LayerOpacitySlider.js","Geoportal/Control/MeasureToolbar.js","Geoportal/Control/NavToolbar.js","Geoportal/Control/PanelToggle.js","Geoportal/Control/ZoomSlider.js","Geoportal/Format/GPX/v1_0.js","Geoportal/Layer/GXT.js","Geoportal/OLS/AbstractAddress.js","Geoportal/OLS/AbstractPosition.js","Geoportal/OLS/Building.js","Geoportal/OLS/ErrorList.js","Geoportal/OLS/LUS/ReverseGeocodePreference.js","Geoportal/OLS/StreetAddress.js","Geoportal/OLS/UOM/AbstractMeasure.js","Geoportal/OLS/UOM/TimeStamp.js","Geoportal/Control/AddImageLayer.js","Geoportal/Control/AddVectorLayer.js","Geoportal/Control/LayerOpacity.js","Geoportal/Control/MousePosition.js","Geoportal/Control/ZoomBar.js","Geoportal/OLS/Address.js","Geoportal/OLS/Request.js","Geoportal/OLS/RequestHeader.js","Geoportal/OLS/Response.js","Geoportal/OLS/ResponseHeader.js","Geoportal/OLS/UOM/Angle.js","Geoportal/OLS/UOM/Distance.js","Geoportal/OLS/UOM/Speed.js","Geoportal/OLS/UOM/Time.js","Geoportal/Control/BasicLayerToolbar.js","Geoportal/Control/Information.js","Geoportal/Control/LayerToolbar.js","Geoportal/Format/XLS/v1_1.js","Geoportal/OLS/HorizontalAcc.js","Geoportal/OLS/LUS/GeocodeRequest.js","Geoportal/OLS/LUS/GeocodedAddress.js","Geoportal/OLS/LUS/SearchCentreDistance.js","Geoportal/OLS/UOM/Distance/Altitude.js","Geoportal/OLS/VerticalAcc.js","Geoportal/Control/LayerSwitcher.js","Geoportal/Format/XLS/v1_0.js","Geoportal/OLS/LUS/GeocodeResponseList.js","Geoportal/OLS/LUS/ReverseGeocodedLocation.js","Geoportal/OLS/QualityOfPosition.js","Geoportal/OLS/LUS/GeocodeResponse.js","Geoportal/OLS/LUS/ReverseGeocodeResponse.js","Geoportal/OLS/Position.js","Geoportal/OLS/LUS/ReverseGeocodeRequest.js","Geoportal/Format/XLS/v1_1/LocationUtilityService.js","Geoportal/Format/XLS/v1_0/LocationUtilityService.js","Geoportal/Layer/OpenLS.js","Geoportal/Layer/OpenLS/Core.js","Geoportal/Layer/OpenLS/Core/LocationUtilityService.js","Geoportal/Control/LocationUtilityService.js","Geoportal/Control/LocationUtilityService/GeoNames.js","Geoportal/Control/LocationUtilityService/Geocode.js","Geoportal/Control/LocationUtilityService/ReverseGeocode.js","Geoportal/Control/SearchToolbar.js","Geoportal/Catalogue.js","Geoportal/Map.js","Geoportal/Viewer.js","Geoportal/Viewer/Default.js","Geoportal/Viewer/Standard.js"];var C=navigator.userAgent;var E=(C.match("MSIE")||C.match("Safari"));if(E){var B=new Array(I.length)}else{var F=document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body;if(!F){alert("no head and body to include the JavaScript API.");return }}var J=Geoportal._getScriptLocation()+"lib/";for(var D=0,G=I.length;D<G;D++){if(E){B[D]="<script type='text/javascript' src='"+J+I[D]+"' charset='UTF-8'><\/script>"}else{if(F){var K=document.createElement("script");K.src=J+I[D];K.charset="UTF-8";K.type="text/javascript";F.appendChild(K)}}}if(E){document.write(B.join(""))}}})();Geoportal.VERSION_NUMBER="1.0beta5";Geoportal.Lang={add:function(C){for(var B in C){if(C.hasOwnProperty(B)){for(var D in C[B]){if(C[B].hasOwnProperty(D)){var E=Geoportal.Lang[D];if(!E){E={}}E[B]=C[B][D]}}}}},translate:function(C,B){var E=Geoportal.Lang[OpenLayers.Lang.getCode()];var D=E[C];if(!D){D=OpenLayers.Lang.translate(C)}if(B){D=OpenLayers.String.format(D,B)}return D}};Geoportal.i18n=Geoportal.Lang.translate;OpenLayers.i18n=Geoportal.Lang.translate;Geoportal.Lang.en={"GEOGRAPHICALGRIDSYSTEMS.MAPS":"Maps","GEOGRAPHICALGRIDSYSTEMS.MAPS.description":"Maps are extracted from IGN's SCAN databases : World, Europe, SCAN 1 000®, SCAN 500®, SCAN Régional®, SCAN 200®, SCAN Départemental®, SCAN 100®, SCAN 50®, SCAN 25®.","ORTHOIMAGERY.ORTHOPHOTOS":"Aerial photos","ORTHOIMAGERY.ORTHOPHOTOS.description":"Aerial photographies combine the geometrical precision of maps with richness of photographies, between 15 and 50 cm resolution, and satelite images, between 10 and 20 m resolution.","ELEVATION.SLOPS":"Slops","ELEVATION.SLOPS.description":"Digital terrain models were derived from BD ALTI ® data that describes the  French territory with contour lines. The equidistance of the contour lines can range from 5 to 40m. Original data has been acquired from IGN maps at 1: 25 000, at 1: 50 000 and from aerial photographs at 1: 20 000, 1: 30 000 and 1: 60 000 by stereophotogrammetry.","CADASTRALPARCELS.PARCELS":"Cadastre","CADASTRALPARCELS.PARCELS.description":"The digital cadastral information is georeferenced and seamless throughout the French territory. It was carried out from the assembly of the digital cadastral scanned sheets.","HYDROGRAPHY.HYDROGRAPHY":"Hydrography network","HYDROGRAPHY.HYDROGRAPHY.description":"Hydrography network is derived from the assembly of datasets from BD TOPO®, BD CARTHAGE®, EuroRegionalMap and EuroGlobalMap databases.","TRANSPORTNETWORKS.ROADS":"Roads","TRANSPORTNETWORKS.ROADS.description":"The roads network is derived from the assembly of datasets from BD TOPO®, BD CARTO®, EuroRegionalMap and EuroGlobalMap databases.","TRANSPORTNETWORKS.RAILWAYS":"Railways","TRANSPORTNETWORKS.RAILWAYS.description":"The railways network is derived from the assembly of datasets from BD TOPO®, BD CARTO®, EuroRegionalMap and EuroGlobalMap databases.","TRANSPORTNETWORKS.RUNWAYS":"Runways","TRANSPORTNETWORKS.RUNWAYS.description":"Airport runways are derived from the assembly of datasets from BD TOPO® and BD CARTO®.","BUILDINGS.BUILDINGS":"Buildings","BUILDINGS.BUILDINGS.description":"Buildings and urban areas are derived from the assembly of datasets from BD TOPO®, BD CARTO®, EuroRegionalMap and EuroGlobalMap databases.","UTILITYANDGOVERNMENTALSERVICES.ALL":"Gov. services","UTILITYANDGOVERNMENTALSERVICES.ALL.description":"Energy networks are derived from the assembly of datasets from BD TOPO® and BD CARTO®.","ADMINISTRATIVEUNITS.BOUNDARIES":"Admin. boundaries","ADMINISTRATIVEUNITS.BOUNDARIES.description":"French administrative units are derived from the assembly of datasets from BD TOPO®, BD CARTO®, EuroRegionalMap and EuroBoundaryMap databases.","SEAREGIONS.LEVEL0":"Sea level 0","SEAREGIONS.LEVEL0.description":"The sea 0 level is part of LITTO3D®, a joint production from SHOM and IGN.","LANDCOVER.CORINELANDCOVER":"Land cover","LANDCOVER.CORINELANDCOVER.description":"CORINE 2006","div.not.found":"${id} not found in the document : check you have '${id}' set.","proxy.not.set":"Missing proxy setting : may cause problems when getting contract configuration.","cookies.not.enabled":"Cookies are disabled. Please, enable them.","geoRM.getConfig":"Impossible to get information for key '${key}' - check your connection","geoRM.getToken":"Impossible to get the token for key '${key}' - check your connection","geoRM.failed":"Failed to get a valid token for key '${key}'","GPX.version":"Unhandled GPX version ${gpxVersion}","XLS.version":"Unhandled XLS version ${xlsVersion} for OpenLS Core service ${coreService}","Not.conformal.XLS":"Location Service XML is missing : ${part}","olControlMeasurePath.title":"Distance measurement","olControlMeasurePolygon.title":"Surface measurement","waiting.measurement":"Waiting for digitizing ...","length.measurement":"Length","area.measurement":"Area","gpControlLayerSwitcher.label":"Layers","gpLayer.metadataURL":"More information about this layer ...","gpLayer.dataURL":"Access to download page","gpControlPanelToggle.closed":"Show toolbar","gpControlPanelToggle.opened":"Hide toolbar","gpControlRemoveLayer.title":"Remove layer","gpControlLayerOpacity.title":"Opacity slider","gpControlZoomToLayerMaxExtent.title":"Zoom to layer's extent","gpControlMousePosition.longitude":"Longitude","gpControlMousePosition.latitude":"Latitude","gpControlMousePosition.easting":"Easting","gpControlMousePosition.northing":"Northing","gpControlMousePosition.north":"N","gpControlMousePosition.south":"S","gpControlMousePosition.east":"E","gpControlMousePosition.west":"W","gpControlMousePosition.sexa":"sexagecimal degrees","gpControlMousePosition.deg":"decimal degrees","gpControlMousePosition.gon":"decimal grades","gpControlMousePosition.rad":"decimal radians","gpControlMousePosition.km":"kilometers","gpControlMousePosition.m":"meters","gpControlMousePosition.cm":"centimeters","gpControlMousePosition.utmZone":"Zone","gpControlToolBox.label":"Toolbox","gpControlZoomBar.world":"World","gpControlZoomBar.state":"State","gpControlZoomBar.country":"Country","gpControlZoomBar.town":"Town","gpControlZoomBar.street":"Street","gpControlZoomBar.house":"House","gpControlEditingToolbar.drawpoint":"Draw point","gpControlEditingToolbar.drawline":"Draw line","gpControlEditingToolbar.drawpolygon":"Draw polygon","gpControlEditingToolbar.dragfeature":"Drag feature","gpControlEditingToolbar.modifyfeature":"Modify feature","gpControlEditingToolbar.deletefeature":"Delete feature","gpControlEditingToolbar.selectfeature":"Select feature","gpControlEditingToolbar.navigation":"Navigate","gpControlAddImageLayer.title":"Add image layer ...","gpControlAddImageLayer.layerUrl":"URL : ","gpControlAddImageLayer.layerUrl.help":"base address of the service","gpControlAddImageLayer.layerType":"Type : ","gpControlAddImageLayer.layerType.help":"pick up a value in the select","gpControlAddImageLayer.layerType.WMS":"Web Map Service","gpControlAddImageLayer.layerType.WMSC":"OSGeO WMS-C","gpControlAddImageLayer.button.add":"Add Layer","gpControlAddImageLayer.button.cancel":"Cancel","wms.caps.no.compatible.srs":"No compatible layer found","gpControlAddVectorLayer.title":"Add vector layer ...","gpControlAddVectorLayer.layerName.help":"ex : my layer","gpControlAddVectorLayer.layerType":"Type : ","gpControlAddVectorLayer.layerType.help":"pick up a value in the select","gpControlAddVectorLayer.layerType.Point":"point","gpControlAddVectorLayer.layerType.LineString":"linestring","gpControlAddVectorLayer.layerType.Polygon":"polygon","gpControlAddVectorLayer.layerType.KML":"KML resource","gpControlAddVectorLayer.layerType.GPX":"GPX resource","gpControlAddVectorLayer.layerType.OSM":"OSM resource","gpControlAddVectorLayer.layerType.WFS":"WFS resource","gpControlAddVectorLayer.layerUrl":"URL : ","gpControlAddVectorLayer.layerUrl.help":"either local or remote","gpControlAddVectorLayer.layerFreeHand":"freehand ? ","gpControlAddVectorLayer.layerFreeHand.help":"allow free hand drawing","gpControlAddVectorLayer.button.add":"Add Layer","gpControlAddVectorLayer.button.cancel":"Cancel","gpControlAddVectorLayer.layerName":"Name : ","wfs.caps.no.feature.found":"No features found","wfs.caps.unsupported.version":"Unsupported WFS version ${version}","gpControlLocationUtilityService.geonames.title":"Search a location","gpControlLocationUtilityService.geocode.title":"Search an address","gpControlLocationUtilityService.reverse.geocode.title":"Search addresses around a location","gpControlLocationUtilityServiceGeoNames.title":"Search a location :","gpControlLocationUtilityServiceGeoNames.name":"Location : ","gpControlLocationUtilityServiceGeoNames.name.help":"ex : Saint-Mandé","gpControlLocationUtilityServiceGeoNames.button.cancel":"Cancel","gpControlLocationUtilityServiceGeoNames.button.search":"Search","gpControlLocationUtilityServiceGeocode.title":"Search a place :","gpControlLocationUtilityServiceGeocode.address":"Street : ","gpControlLocationUtilityServiceGeocode.address.help":"ex : 2, avenue Pasteur","gpControlLocationUtilityServiceGeocode.municipality":"Municipality : ","gpControlLocationUtilityServiceGeocode.municipality.help":"ex : Saint-Mandé","gpControlLocationUtilityServiceGeocode.postalcode":"Postal code : ","gpControlLocationUtilityServiceGeocode.postalcode.help":"ex : 94165","gpControlLocationUtilityServiceGeocode.name":"Place: ","gpControlLocationUtilityServiceGeocode.name.help":"e.g.: Saint-Mandé or 94165","gpControlLocationUtilityServiceGeocode.button.cancel":"Cancel","gpControlLocationUtilityServiceGeocode.button.search":"Search","gpControlLocationUtilityServiceReverseGeocode.title":"Search places around :","gpControlLocationUtilityServiceReverseGeocode.longitude":"Longitude : ","gpControlLocationUtilityServiceReverseGeocode.longitude.help":"ex : dd.mmss in geographic coordinates","gpControlLocationUtilityServiceReverseGeocode.latitude":"Latitude : ","gpControlLocationUtilityServiceReverseGeocode.latitude.help":"ex : dd.mmss in geographic coordinates","gpControlLocationUtilityServiceReverseGeocode.button.cancel":"Cancel","gpControlLocationUtilityServiceReverseGeocode.button.search":"Search","lus.not.match":"No match found","geocoded.address.popup.title":"Address","geocoded.address.popup.postalCode":"Postal code","geocoded.address.popup.places":"Places",CountrySubdivision:"Country subdivision",CountrySecondarySubdivision:"Country secondary subdivision",Municipality:"Municipality",MunicipalitySubdivision:"Municipality subdivision","utm.zone":"UTM","*":""};Geoportal.Lang.fr={"GEOGRAPHICALGRIDSYSTEMS.MAPS":"Cartes","GEOGRAPHICALGRIDSYSTEMS.MAPS.description":"Les cartes sont issues des bases de données SCAN de l'IGN : Monde, Europe Politique, SCAN 1 000®, SCAN 500®, SCAN Régional®, SCAN 200®, SCAN Départemental®, SCAN 100®, SCAN 50®, SCAN 25®.","ORTHOIMAGERY.ORTHOPHOTOS":"Photos","ORTHOIMAGERY.ORTHOPHOTOS.description":"Les photographies aériennes allient la précision géométrique de la carte à la richesse de la photographie, résolution entre 50 et 15 cm ou de l'images satellites, résolution entre 10 m et 20m.","ELEVATION.SLOPS":"MNT (teintes hypso.)","ELEVATION.SLOPS.description":"Les modèles numériques de terrain sont issus de données BD ALTI® que décrit le territoire français par des courbes de niveau. L’équidistance des courbes peut aller de 5 à 40m. Les données initiales ont été saisies sur des cartes IGN au 1 : 25 000, au 1 : 50 000 et à partir d’une restitution issue de prises de vue aériennes au 1 : 20 000, 1 : 30 000 et 1 : 60 000.","CADASTRALPARCELS.PARCELS":"Cadastre","CADASTRALPARCELS.PARCELS.description":"L'information cadastrale numérique est géoréférencée et continue sur l'ensemble du territoire français. Elle a été réalisée à partir de l'assemblage du plan cadastral dématérialisé.","HYDROGRAPHY.HYDROGRAPHY":"Hydrographie terrestre","HYDROGRAPHY.HYDROGRAPHY.description":"L'hydrographie terrestre est issue de l'assemblage de données BD TOPO®, BD CARTHAGE®, EuroRegionalMap et EuroGlobalMap.","TRANSPORTNETWORKS.ROADS":"Réseau routier","TRANSPORTNETWORKS.ROADS.description":"Le réseau routier est issu de l'assemblage de données BD TOPO®, BD CARTO®, EuroRegionalMap et EuroGlobalMap.","TRANSPORTNETWORKS.RAILWAYS":"Réseau ferré","TRANSPORTNETWORKS.RAILWAYS.description":"Le réseau ferroviaire est issu de l'assemblage de données BD TOPO®, BD CARTO®, EuroRegionalMap et EuroGlobalMap.","TRANSPORTNETWORKS.RUNWAYS":"Aéroports","TRANSPORTNETWORKS.RUNWAYS.description":"Les pistes des aéroports et aérodromes sont issus de l'assemblage de données BD TOPO® et BD CARTO®.","BUILDINGS.BUILDINGS":"Constructions","BUILDINGS.BUILDINGS.description":"Les bâtiments et zones construites sont issus de l'assemblage de données BD TOPO®, BD CARTO®, EuroRegionalMap et EuroGlobalMap.","UTILITYANDGOVERNMENTALSERVICES.ALL":"Services gouvernementaux","UTILITYANDGOVERNMENTALSERVICES.ALL.description":"Les divers réseaux de transports d'énergie sont issus de l'assemblage de données BD TOPO® et BD CARTO®.","ADMINISTRATIVEUNITS.BOUNDARIES":"Limites administratives","ADMINISTRATIVEUNITS.BOUNDARIES.description":"Les unités administratives de la France sont issus de l'assemblage de données BD TOPO®, BD CARTO®, EuroRegionalMap et EuroBoundaryMap.","SEAREGIONS.LEVEL0":"Trait de côte","SEAREGIONS.LEVEL0.description":"Le 0 des mers est issu de LITTO3D®, une production réalisée en commun entre le SHOM et l'IGN.","LANDCOVER.CORINELANDCOVER":"Occupation des sols","LANDCOVER.CORINELANDCOVER.description":"CORINE 2006","div.not.found":"${id} non trouvé dans le document : vérifier que '${id}' existe bien.","proxy.not.set":"Pas de configuration du proxy : l'obtention des informations sur le contrat pourrait échouer.","cookies.not.enabled":"Les cookies sont désactivés. Activer les s'il vous plaît.","geoRM.getConfig":"Impossible d'obtenir les informations relatives à la clef '${key}' - Vérifier votre connexion.","geoRM.getToken":"Impossible d'obtenir le jeton associé à la clef '${key}' - Vérifier votre connexion.","geoRM.failed":"Impossible d'obtenir un jeton valide pour la clef '${key}'","GPX.version":"Version ${gpxVersion} GPX non supportée","XLS.version":"Version ${xlsVersion} XLS non supportée pour le service ${coreService}","Not.conformal.XLS":"${part} est manquant dans l'XML","olControlMeasurePath.title":"Mesure de distance","olControlMeasurePolygon.title":"Mesure de surface","waiting.measurement":"En attente de saisie ...","length.measurement":"Longueur","area.measurement":"Surface","gpControlLayerSwitcher.label":"Couches","gpLayer.metadataURL":"Plus d'information sur cette couche ...","gpLayer.dataURL":"Accès au service de téléchargement","gpControlPanelToggle.closed":"Afficher la barre d'outils","gpControlPanelToggle.opened":"Masquer la barre d'outils","gpControlRemoveLayer.title":"Retirer la couche","gpControlLayerOpacity.title":"Règle de transparence","gpControlZoomToLayerMaxExtent.title":"Zoomer sur l'emprise de la couche","gpControlMousePosition.longitude":"Longitude","gpControlMousePosition.latitude":"Latitude","gpControlMousePosition.easting":"Abscisse","gpControlMousePosition.northing":"Ordonnée","gpControlMousePosition.north":"N","gpControlMousePosition.south":"S","gpControlMousePosition.east":"E","gpControlMousePosition.west":"O","gpControlMousePosition.sexa":"degrés sexagésimaux","gpControlMousePosition.deg":"degrés décimaux","gpControlMousePosition.gon":"grades","gpControlMousePosition.rad":"radians","gpControlMousePosition.km":"kilomètres","gpControlMousePosition.m":"mètres","gpControlMousePosition.cm":"centimètres","gpControlMousePosition.utmZone":"Zone","gpControlToolBox.label":"Outils","gpControlZoomBar.world":"Monde","gpControlZoomBar.state":"Pays","gpControlZoomBar.country":"Dépt.","gpControlZoomBar.town":"Ville","gpControlZoomBar.street":"Rue","gpControlZoomBar.house":"Maison","gpControlEditingToolbar.drawpoint":"Dessiner un point","gpControlEditingToolbar.drawline":"Dessiner une ligne","gpControlEditingToolbar.drawpolygon":"Dessiner un polygone","gpControlEditingToolbar.dragfeature":"Déplacer un objet","gpControlEditingToolbar.modifyfeature":"Modifier un objet","gpControlEditingToolbar.deletefeature":"Détruire un objet","gpControlEditingToolbar.selectfeature":"Sélectionner un objet","gpControlEditingToolbar.navigation":"Naviguer","gpControlAddImageLayer.title":"Ajouter une couche image ...","gpControlAddImageLayer.layerUrl":"URL : ","gpControlAddImageLayer.layerUrl.help":"adresse de base du service","gpControlAddImageLayer.layerType":"Type : ","gpControlAddImageLayer.layerType.help":"choisissez une valeur dans la liste","gpControlAddImageLayer.layerType.WMS":"Web Map Service","gpControlAddImageLayer.layerType.WMSC":"OSGeO WMS-C","gpControlAddImageLayer.button.add":"Ajouter","gpControlAddImageLayer.button.cancel":"Annuler","wms.caps.no.compatible.srs":"Pas de couche compatible trouvée","gpControlAddVectorLayer.title":"Ajouter une couche vectorielle ...","gpControlAddVectorLayer.layerName":"Nom : ","gpControlAddVectorLayer.layerName.help":"ex : ma couche","gpControlAddVectorLayer.layerType":"Type : ","gpControlAddVectorLayer.layerType.help":"choisissez une valeur dans la liste","gpControlAddVectorLayer.layerType.Point":"ponctuelle","gpControlAddVectorLayer.layerType.LineString":"linéaire","gpControlAddVectorLayer.layerType.Polygon":"surfacique","gpControlAddVectorLayer.layerType.KML":"resource KML","gpControlAddVectorLayer.layerType.GPX":"resource GPX","gpControlAddVectorLayer.layerType.OSM":"resource OSM","gpControlAddVectorLayer.layerType.WFS":"resource WFS","gpControlAddVectorLayer.layerUrl":"URL : ","gpControlAddVectorLayer.layerUrl.help":"local ou à distance","gpControlAddVectorLayer.layerFreeHand":"Dessin à main levée ? ","gpControlAddVectorLayer.layerFreeHand.help":"permet le dessin à main levée","gpControlAddVectorLayer.button.add":"Ajouter","gpControlAddVectorLayer.button.cancel":"Annuler","wfs.caps.no.feature.found":"Aucun objet trouvé","wfs.caps.unsupported.version":"Version ${version} de WFS non supportée","gpControlLocationUtilityService.geonames.title":"Rechercher un lieu","gpControlLocationUtilityService.geocode.title":"Rechercher une adresse","gpControlLocationUtilityService.reverse.geocode.title":"Rechercher les adresses autour d'un point","gpControlLocationUtilityServiceGeoNames.title":"Rechercher un lieu :","gpControlLocationUtilityServiceGeoNames.name":"Lieu : ","gpControlLocationUtilityServiceGeoNames.name.help":"ex : Saint-Mandé","gpControlLocationUtilityServiceGeoNames.button.cancel":"Annuler","gpControlLocationUtilityServiceGeoNames.button.search":"Rechercher","gpControlLocationUtilityServiceGeocode.title":"Chercher une adresse :","gpControlLocationUtilityServiceGeocode.address":"Rue : ","gpControlLocationUtilityServiceGeocode.address.help":"ex : 2, avenue Pasteur","gpControlLocationUtilityServiceGeocode.municipality":"Ville : ","gpControlLocationUtilityServiceGeocode.municipality.help":"ex : Saint-Mandé","gpControlLocationUtilityServiceGeocode.postalcode":"Code postal : ","gpControlLocationUtilityServiceGeocode.postalcode.help":"ex : 94165","gpControlLocationUtilityServiceGeocode.name":"Lieu : ","gpControlLocationUtilityServiceGeocode.name.help":"ex : Saint-Mandé ou 94165","gpControlLocationUtilityServiceGeocode.button.cancel":"Annuler","gpControlLocationUtilityServiceGeocode.button.search":"Rechercher","gpControlLocationUtilityServiceReverseGeocode.title":"Chercher des lieux à proximité :","gpControlLocationUtilityServiceReverseGeocode.longitude":"Longitude : ","gpControlLocationUtilityServiceReverseGeocode.longitude.help":"ex : dd.mmss en coordonnées géographiques","gpControlLocationUtilityServiceReverseGeocode.latitude":"Latitude : ","gpControlLocationUtilityServiceReverseGeocode.latitude.help":"ex : dd.mmss en coordonnées géographiques","gpControlLocationUtilityServiceReverseGeocode.button.cancel":"Annuler","gpControlLocationUtilityServiceReverseGeocode.button.search":"Rechercher","lus.not.match":"Pas de correspondance trouvée","geocoded.address.popup.title":"Adresse","geocoded.address.popup.postalCode":"Code postal","geocoded.address.popup.places":"Lieux",CountrySubdivision:"Département",CountrySecondarySubdivision:"Commune",Municipality:"Ville",MunicipalitySubdivision:"Quartier","utm.zone":"UTM","*":""};Geoportal.Lang.de={"GEOGRAPHICALGRIDSYSTEMS.MAPS":"Karten","GEOGRAPHICALGRIDSYSTEMS.MAPS.description":"Die karten stammen aus den SCAN-datenbanken des IGN: Welt, Politisches Europa, SCAN 1000®, SCAN 500®, SCAN Régional®, SCAN 200®, SCAN Départemental®, SCAN 100®, SCAN 50®, SCAN 25®.","ORTHOIMAGERY.ORTHOPHOTOS":"Luftaufnahme","ORTHOIMAGERY.ORTHOPHOTOS.description":"Die Luftaufnahmen verbinden die präzision der geometrie mit der detailreichhaltigkeit der photographie, auflösung zwischen 50 und 15 cm, oder der satellitenbilder, auflösung zwischen 10 m und 20 m.","ELEVATION.SLOPS":"Höhenlage (hypsometrische farben)","ELEVATION.SLOPS.description":"Die digitalen geländemodelle stammen aus den BD ALTI® daten, die das französische staatsgebiet mit seinen höhenlinien darstellt. Die abstandsgleichheit der linien reicht von 5 bis 40 m. Die ausgangsdaten wurden auf IGN-Karten im Maßstab von 1 : 25.000,  1 : 50.000 und, ausgehend von einer wiedergabe der luftaufnahmen, im Maßstab von 1 : 20.000, 1 : 30.000 und 1 : 60.000 erfaßt.","CADASTRALPARCELS.PARCELS":"Kataster","CADASTRALPARCELS.PARCELS.description":"Die digitale katasterinformation ist für das gesamte französische staatsgebiet durchgehend und georeferenziert. Sie wurde ausgehend von der zusammenstellung des entmaterialisierten katasterplans hergestellt.","HYDROGRAPHY.HYDROGRAPHY":"Hydrographie der erde","HYDROGRAPHY.HYDROGRAPHY.description":"Die hydrographie der erde wurde ausgehend von der zusammenstellung der daten des BD TOPO®, BD CARTHAGE®, EuroRegionalMal und EuroGlobalMap erstellt.","TRANSPORTNETWORKS.ROADS":"Straßennetz","TRANSPORTNETWORKS.ROADS.description":"Das straßennetz wurde ausgehend von der zusammenstellung der daten des BD TOPO®, BD CARTO®, EuroRegionalMap und EuroGlobalMap erstellt.","TRANSPORTNETWORKS.RAILWAYS":"Schienennetz","TRANSPORTNETWORKS.RAILWAYS.description":"Das schienennetz wurde ausgehend von der zusammenstellung der daten des BD TOPO®, BD CARTO®, EuroRegionalMap und EuroGlobalMap erstellt.","TRANSPORTNETWORKS.RUNWAYS":"Flughäfen","TRANSPORTNETWORKS.RUNWAYS.description":"Die flughäfen und flugplätze wurden ausgehend von der zusammenstellung der daten des BD TOPO® und BD CARTO® erfaßt.","BUILDINGS.BUILDINGS":"Gebäude","BUILDINGS.BUILDINGS.description":"Die gebäude und bebaute gebiete wurden ausgehend von der zusammenfügung der daten des BD TOPO®, BD CARTO®, EuroRegionalMap und EuroGlobalMap erfaßt.","UTILITYANDGOVERNMENTALSERVICES.ALL":"Regierungßtellen","UTILITYANDGOVERNMENTALSERVICES.ALL.description":"Die verschiedenen energietransportnetze wurden ausgehend von der zusammenstellung der daten des BD TOPO® und BD CARTO® erfaßt.","ADMINISTRATIVEUNITS.BOUNDARIES":"Verwaltungsgrenzen","ADMINISTRATIVEUNITS.BOUNDARIES.description":"Die verwaltungseinheiten frankreichs wurden ausgehend von der zusammenstellung der daten des BD TOPO®, BD CARTO®, EuroRegionalMap und EuroBoundaryMap erfaßt.","SEAREGIONS.LEVEL0":"Küstenlinie","SEAREGIONS.LEVEL0.description":"Die 0 des Meeres stammt aus LITTO3D®, eine gemeinsame produktion des SHOM und des IGN.","LANDCOVER.CORINELANDCOVER":"Bodenbedeckung","LANDCOVER.CORINELANDCOVER.description":"CORINE 2006","div.not.found":"${id} konnte nicht in dem dokument gefunden werden: Prüfen sie, ob ${id} auch wirklich existiert.","proxy.not.set":"Keine Proxy-konfiguration: Informationen zu dem vertrag könnten möglicherweise nicht abgerufen werden.","cookies.not.enabled":"Cookies sind deaktiviert. Bitte aktivieren.","geoRM.getConfig":"Die informationen zum schlüßel '${key}' können nicht abgerufen werden - überprüfen sie ihre verbindung.","geoRM.getToken":"Die datei zum schlüßel '${key}' kann nicht abgerufen werden - überprüfen sie ihre verbindung.","geoRM.failed":"Kein gültiges zeichen erhalten zum schlüßel '${key}'","GPX.version":"Version ${gpxVersion} GPX nicht gestützt.","XLS.version":"Version ${xlsVersion} XLS wird vom service ${coreService} nicht gestützt.","Not.conformal.XLS":"${part} fehlt im XML","olControlMeasurePath.title":"Entfernungsmeßung","olControlMeasurePolygon.title":"Flüchenmeßung","waiting.measurement":"In erwartung der eingabe ...","length.measurement":"Länge","area.measurement":"Fläche","gpControlLayerSwitcher.label":"Schichten","gpLayer.metadataURL":"Mehr informationen zu dieser schicht...","gpLayer.dataURL":"Zugang zum download-service","gpControlPanelToggle.closed":"Die tool-leiste anzeigen","gpControlPanelToggle.opened":"Die tool-leiste ausblenden","gpControlRemoveLayer.title":"Die schicht entfernen","gpControlLayerOpacity.title":"Die transparenz einstellen","gpControlZoomToLayerMaxExtent.title":"Auf die bodenfläche der schicht zoomen","gpControlMousePosition.longitude":"Längengrad","gpControlMousePosition.latitude":"Breitengrad","gpControlMousePosition.easting":"Absziße","gpControlMousePosition.northing":"Ordinate","gpControlMousePosition.north":"N","gpControlMousePosition.south":"S","gpControlMousePosition.east":"O","gpControlMousePosition.west":"W","gpControlMousePosition.sexa":"sexagecimal grades","gpControlMousePosition.deg":"dezimale grades","gpControlMousePosition.gon":"grad","gpControlMousePosition.rad":"radians","gpControlMousePosition.km":"kilometers","gpControlMousePosition.m":"meters","gpControlMousePosition.cm":"zentimeters","gpControlMousePosition.utmZone":"Zone","gpControlToolBox.label":"Tools","gpControlZoomBar.world":"Welt","gpControlZoomBar.state":"Staat","gpControlZoomBar.country":"Land","gpControlZoomBar.town":"Stadt","gpControlZoomBar.street":"Straße","gpControlZoomBar.house":"Haus","gpControlEditingToolbar.drawpoint":"Einen punkt platzieren","gpControlEditingToolbar.drawline":"Eine linie zeichnen","gpControlEditingToolbar.drawpolygon":"Ein polygon zeichnen","gpControlEditingToolbar.dragfeature":"Ein objekt verschieben","gpControlEditingToolbar.modifyfeature":"Ein objekt verändern","gpControlEditingToolbar.deletefeature":"Ein objekt vernichten","gpControlEditingToolbar.selectfeature":"Ein objekt auswählen","gpControlEditingToolbar.navigation":"Navigieren","gpControlAddImageLayer.title":"Eine bild-schicht hinzufügen","gpControlAddImageLayer.layerUrl":"URL : ","gpControlAddImageLayer.layerUrl.help":"basis-adresse des dienstes","gpControlAddImageLayer.layerType":"Typ : ","gpControlAddImageLayer.layerType.help":"Wählen sie einen wert der liste","gpControlAddImageLayer.layerType.WMS":"Web Map Service","gpControlAddImageLayer.layerType.WMSC":"OSGeO WMS-C","gpControlAddImageLayer.button.add":"Hinzufügen","gpControlAddImageLayer.button.cancel":"Abbrechen","wms.caps.no.compatible.srs":"Nicht kompatibel schicht gefunden","gpControlAddVectorLayer.title":"Eine vektorielle schicht hinzufügen","gpControlAddVectorLayer.layerName":"Name : ","gpControlAddVectorLayer.layerName.help":"z.B.: meine schicht","gpControlAddVectorLayer.layerType":"Typ : ","gpControlAddVectorLayer.layerType.help":"Wählen sie einen wert der liste","gpControlAddVectorLayer.layerType.Point":"punktuell","gpControlAddVectorLayer.layerType.LineString":"linear","gpControlAddVectorLayer.layerType.Polygon":"flächenbezogen","gpControlAddVectorLayer.layerType.KML":"KML resource","gpControlAddVectorLayer.layerType.GPX":"GPX resource","gpControlAddVectorLayer.layerType.OSM":"OSM resource","gpControlAddVectorLayer.layerType.WFS":"WFS resource","gpControlAddVectorLayer.layerUrl":"URL : ","gpControlAddVectorLayer.layerUrl.help":"vor ort oder aus entfernung","gpControlAddVectorLayer.layerFreeHand":"freihandzeichnen ? ","gpControlAddVectorLayer.layerFreeHand.help":"ermöglicht das freihandzeichnen","gpControlAddVectorLayer.button.add":"Hinzufügen","gpControlAddVectorLayer.button.cancel":"Abbrechen","wfs.caps.no.feature.found":"Keine objekte gefunden","wfs.caps.unsupported.version":"WFS version ${version} nicht unterstützt","gpControlLocationUtilityService.geonames.title":"Einen ort suchen","gpControlLocationUtilityService.geocode.title":"Eine adreße suchen","gpControlLocationUtilityService.reverse.geocode.title":"Die Adreßen um einen punkt herum suchen","gpControlLocationUtilityServiceGeoNames.title":"Einen ort suchen :","gpControlLocationUtilityServiceGeoNames.name":"Ort : ","gpControlLocationUtilityServiceGeoNames.name.help":"z.B. : Saint-Mandé","gpControlLocationUtilityServiceGeoNames.button.cancel":"Abbrechen","gpControlLocationUtilityServiceGeoNames.button.search":"Suchen","gpControlLocationUtilityServiceGeocode.title":"Eine Adreße suchen :","gpControlLocationUtilityServiceGeocode.address":"Straße : ","gpControlLocationUtilityServiceGeocode.address.help":"ex : 2, avenue Pasteur","gpControlLocationUtilityServiceGeocode.municipality":"Stadt : ","gpControlLocationUtilityServiceGeocode.municipality.help":"z.B. : Saint-Mandé","gpControlLocationUtilityServiceGeocode.postalcode":"Postleitzahl:","gpControlLocationUtilityServiceGeocode.postalcode.help":"z.B. : 94165","gpControlLocationUtilityServiceGeocode.name":"Ort:","gpControlLocationUtilityServiceGeocode.name.help":"z.B.: Saint-Mandé oder 94165","gpControlLocationUtilityServiceGeocode.button.cancel":"Abbrechen","gpControlLocationUtilityServiceGeocode.button.search":"Suchen","gpControlLocationUtilityServiceReverseGeocode.title":"Orte in der nähe suchen:","gpControlLocationUtilityServiceReverseGeocode.longitude":"Längengrad : ","gpControlLocationUtilityServiceReverseGeocode.longitude.help":"z.B. : dd.mmss in in geographischen koordinaten","gpControlLocationUtilityServiceReverseGeocode.latitude":"Breitengrad : ","gpControlLocationUtilityServiceReverseGeocode.latitude.help":"z.B. : dd.mmss in geographischen koordinaten","gpControlLocationUtilityServiceReverseGeocode.button.cancel":"Abbrechen","gpControlLocationUtilityServiceReverseGeocode.button.search":"Suchen","lus.not.match":"Es konnte keine übereinstimmung gefunden werden","geocoded.address.popup.title":"Adreße","geocoded.address.popup.postalCode":"Postleitzahl","geocoded.address.popup.places":"Orte",CountrySubdivision:"Departement",CountrySecondarySubdivision:"Gemeinde",Municipality:"Stadt",MunicipalitySubdivision:"Stadtteil","utm.zone":"UTM","*":""};Geoportal.Lang.es={"GEOGRAPHICALGRIDSYSTEMS.MAPS":"Mapas","GEOGRAPHICALGRIDSYSTEMS.MAPS.description":"Los mapas se derivan de las bases de datos SCAN del IGN: Mundo, Europa politica databases : World, Europe, SCAN 1 000®, SCAN 500®, SCAN Régional®, SCAN 200®, SCAN Départemental®, SCAN 100®, SCAN 50®, SCAN 25®.","ORTHOIMAGERY.ORTHOPHOTOS":"Fotografias aéreas","ORTHOIMAGERY.ORTHOPHOTOS.description":"Las fotografias aéreas combinan la precisión geométrica del mapa y la riqueza de la fotografia, una resolución entre 50 cm y 15 cm o, con imágenes de satélite, una resolución entre 10 m y 20 m.","ELEVATION.SLOPS":"Altitud (tintas hipsométricas)","ELEVATION.SLOPS.description":"Los modelos digitales del terreno se elaboran con información de la base de datos BD ALTI®, que describe el territorio francés mediante curvas de nivel. La equidistancia de las curvas varia de 5 m a 40 m. Los datos iniciales se han tomado de mapas del IGN a escalas 1:25 000, 1:50 000 y a partir de una restitución elaborada mediante tomas de vistas aéreas a escalas 1:20 000, 1:30 000 y 1:60 000.","CADASTRALPARCELS.PARCELS":"Catastro","CADASTRALPARCELS.PARCELS.description":"La información catastral digital está georreferenciada y es continua sobre el conjunto del territorio francés. Se ha elaborado a partir del montaje del plan catastral desmaterializado.","HYDROGRAPHY.HYDROGRAPHY":"Hidrografia terrestre","HYDROGRAPHY.HYDROGRAPHY.description":"La hidrografia terrestre se obtiene de la combinación de datos de las bases de datos BD TOPO® y BD CARTHAGE® y del EuroRegionalMap y el EuroGlobalMap.","TRANSPORTNETWORKS.ROADS":"Red de carreteras","TRANSPORTNETWORKS.ROADS.description":"La red de carreteras se obtiene de la combinación de datos de las bases de datos BD TOPO® y BD CARTO® y del EuroRegionalMap y el EuroGlobalMap.","TRANSPORTNETWORKS.RAILWAYS":"Red ferroviaria","TRANSPORTNETWORKS.RAILWAYS.description":"La red ferroviaria se obtiene de la combinación de datos de las bases de datos BD TOPO® y CARTO® y del EuroRegionalMap y el EuroGlobalMap.","TRANSPORTNETWORKS.RUNWAYS":"Aeropuertos","TRANSPORTNETWORKS.RUNWAYS.description":"Las pistas de los aeropuertos y aeródromos se obtienen de la combinación de datos de las bases de datos BD TOPO® y BD CARTO®.","BUILDINGS.BUILDINGS":"Construcciones","BUILDINGS.BUILDINGS.description":"Los edificios y las zonas construidas se obtienen de la combinación de datos de las bases de datos BD TOPO® y BD CARTO® y del EuroRegionalMap y el EuroGlobalMap.","UTILITYANDGOVERNMENTALSERVICES.ALL":"Servicios gubernamentales","UTILITYANDGOVERNMENTALSERVICES.ALL.description":"Las diversas redes de transporte de energia se obtienen de la combinación de datos de las bases de datos BD TOPO® y BD CARTO®.","ADMINISTRATIVEUNITS.BOUNDARIES":"Limites administrativos","ADMINISTRATIVEUNITS.BOUNDARIES.description":"Las unidades administrativas de Francia se obtienen de la combinación de datos de las bases de datos BD TOPO® y BD CARTO® y del EuroRegionalMap y el EuroBoundaryMap.","SEAREGIONS.LEVEL0":"Linea de costa","SEAREGIONS.LEVEL0.description":"La cota 0 (cero) de los mares se obtiene de LITTO3D®, una producción realizada en común entre el SHOM y el IGN.","LANDCOVER.CORINELANDCOVER":"La cobertura del suelo","LANDCOVER.CORINELANDCOVER.description":"CORINE 2006","div.not.found":"${id} no se encontró en el documento: verifique si '${id}' existe.","proxy.not.set":"No se ha configurado un proxy: la obtención de información sobre el contrato podria fallar.","cookies.not.enabled":"Las cookies son discapacitados. Por favor, les permiten.","geoRM.getConfig":"No es posible obtener información relativa a la clave '${key}' - Verifique su conexión.","geoRM.getToken":"No es posible obtener la ficha asociada a la clave '${key}' - Verifique su conexión.","geoRM.failed":"No pudo obtener una muestra válida relativa a la clave '${key}'","GPX.version":"La versión ${gpxVersion} de GPX no es compatible","XLS.version":"La versión ${xlsVersion} de XLS no es compatible con el servicio ${coreService}","Not.conformal.XLS":"${part} falta en el XML","olControlMeasurePath.title":"Medida de distancia","olControlMeasurePolygon.title":"Medida de superficie","waiting.measurement":"A la espera de la selección...","length.measurement":"Longitud","area.measurement":"Superficie","gpControlLayerSwitcher.label":"Capas","gpLayer.metadataURL":"Más información sobre esta capa...","gpLayer.dataURL":"Acceso al servicio de descargas","gpControlPanelToggle.closed":"Mostrar la barra de herramientas","gpControlPanelToggle.opened":"Ocultar la barra de herramientas","gpControlRemoveLayer.title":"Quitar la capa","gpControlLayerOpacity.title":"Regla de transparencia","gpControlZoomToLayerMaxExtent.title":"Ampliar el área de la capa","gpControlMousePosition.longitude":"Longitud","gpControlMousePosition.latitude":"Latitud","gpControlMousePosition.easting":"Abscisa","gpControlMousePosition.northing":"Ordenada","gpControlMousePosition.north":"N","gpControlMousePosition.south":"S","gpControlMousePosition.east":"Or","gpControlMousePosition.west":"Oe","gpControlMousePosition.sexa":"grados sexagesimales","gpControlMousePosition.deg":"grados decimales","gpControlMousePosition.gon":"grados","gpControlMousePosition.rad":"radianes","gpControlMousePosition.km":"kilómetros","gpControlMousePosition.m":"metros","gpControlMousePosition.cm":"centimetros","gpControlMousePosition.utmZone":"Zona","gpControlToolBox.label":"Herra.","gpControlZoomBar.world":"Mundo","gpControlZoomBar.state":"Pais","gpControlZoomBar.country":"Provin.","gpControlZoomBar.town":"Ciudad","gpControlZoomBar.street":"Calle","gpControlZoomBar.house":"Casa","gpControlEditingToolbar.drawpoint":"Situar un punto","gpControlEditingToolbar.drawline":"Dibujar una linea","gpControlEditingToolbar.drawpolygon":"Dibujar un poligono","gpControlEditingToolbar.dragfeature":"Desplazar un objeto","gpControlEditingToolbar.modifyfeature":"Modificar un objeto","gpControlEditingToolbar.deletefeature":"Destruir un objeto","gpControlEditingToolbar.selectfeature":"Seleccionar un objeto","gpControlEditingToolbar.navigation":"Navegar","gpControlAddImageLayer.title":"Añadir una capa de imagen...","gpControlAddImageLayer.layerUrl":"URL : ","gpControlAddImageLayer.layerUrl.help":"Dirección base del servicio","gpControlAddImageLayer.layerType":"Tipo : ","gpControlAddImageLayer.layerType.help":"elija un valor de la lista","gpControlAddImageLayer.layerType.WMS":"Web Map Service","gpControlAddImageLayer.layerType.WMSC":"OSGeO WMS-C","gpControlAddImageLayer.button.add":"Añadir","gpControlAddImageLayer.button.cancel":"Cancelar","wms.caps.no.compatible.srs":"No compatible encontrado capa","gpControlAddVectorLayer.title":"Añadir una capa vectorial...","gpControlAddVectorLayer.layerName":"Nombre : ","gpControlAddVectorLayer.layerName.help":"ejemplo : mi capa","gpControlAddVectorLayer.layerType":"Tipo : ","gpControlAddVectorLayer.layerType.help":"elija un valor de la lista","gpControlAddVectorLayer.layerType.Point":"puntual","gpControlAddVectorLayer.layerType.LineString":"lineal","gpControlAddVectorLayer.layerType.Polygon":"superficial","gpControlAddVectorLayer.layerType.KML":"recurso KML","gpControlAddVectorLayer.layerType.GPX":"recurso GPX","gpControlAddVectorLayer.layerType.OSM":"recurso OSM","gpControlAddVectorLayer.layerType.WFS":"recurso WFS","gpControlAddVectorLayer.layerUrl":"URL : ","gpControlAddVectorLayer.layerUrl.help":"local o a distancia","gpControlAddVectorLayer.layerFreeHand":"Dibujo a mano alzada ? ","gpControlAddVectorLayer.layerFreeHand.help":"permite el dibujo a mano alzada","gpControlAddVectorLayer.button.add":"Añadir","gpControlAddVectorLayer.button.cancel":"Cancelar","wfs.caps.no.feature.found":"No objetos encontrados","wfs.caps.unsupported.version":"WFS versión ${version} no es compatible","gpControlLocationUtilityService.geonames.title":"Buscar un lugar","gpControlLocationUtilityService.geocode.title":"Buscar una dirección","gpControlLocationUtilityService.reverse.geocode.title":"Buscar las direcciones en torno a un punto","gpControlLocationUtilityServiceGeoNames.title":"Buscar un lugar:","gpControlLocationUtilityServiceGeoNames.name":"Lugar: ","gpControlLocationUtilityServiceGeoNames.name.help":"ejemplo: Saint-Mandé","gpControlLocationUtilityServiceGeoNames.button.cancel":"Cancelar","gpControlLocationUtilityServiceGeoNames.button.search":"Buscar","gpControlLocationUtilityServiceGeocode.title":"Buscar una dirección:","gpControlLocationUtilityServiceGeocode.address":"Calle: ","gpControlLocationUtilityServiceGeocode.address.help":"ejemplo: 2, avenue Pasteur","gpControlLocationUtilityServiceGeocode.municipality":"Localidad:","gpControlLocationUtilityServiceGeocode.municipality.help":"ejemplo: Saint-Mandé","gpControlLocationUtilityServiceGeocode.postalcode":"Código postal: ","gpControlLocationUtilityServiceGeocode.postalcode.help":"ejemplo: 94165","gpControlLocationUtilityServiceGeocode.name":"Lugar:","gpControlLocationUtilityServiceGeocode.name.help":"ejemplo: Saint-Mandé o 94165","gpControlLocationUtilityServiceGeocode.button.cancel":"Cancelar","gpControlLocationUtilityServiceGeocode.button.search":"Buscar","gpControlLocationUtilityServiceReverseGeocode.longitude":"Longitud: ","gpControlLocationUtilityServiceReverseGeocode.longitude.help":"ejemplo: dd.mmss en coordenadas geográficas","gpControlLocationUtilityServiceReverseGeocode.latitude":"Latitud: ","gpControlLocationUtilityServiceReverseGeocode.latitude.help":"ejemplo: dd.mmss en coordenadas geográficas","gpControlLocationUtilityServiceReverseGeocode.title":"Buscar lugares próximos:","gpControlLocationUtilityServiceReverseGeocode.button.cancel":"Cancelar","gpControlLocationUtilityServiceReverseGeocode.button.search":"Buscar","lus.not.match":"No se ha encontrado ninguna correspondencia","geocoded.address.popup.title":"Dirección","geocoded.address.popup.postalCode":"Código postal","geocoded.address.popup.places":"Lugares",CountrySubdivision:"Departamento",CountrySecondarySubdivision:"Municipio",Municipality:"Localidad",MunicipalitySubdivision:"Barrio","utm.zone":"UTM","*":""};Geoportal.Lang.it={"GEOGRAPHICALGRIDSYSTEMS.MAPS":"Mappe","GEOGRAPHICALGRIDSYSTEMS.MAPS.description":"Le carte sono ricavate dalla banca dati SCAN dell'IGN : Mondo, Europa Politica, SCAN 1 000®, SCAN 500®, SCAN Régional®, SCAN 200®, SCAN Départemental®, SCAN 100®, SCAN 50®, SCAN 25®.","ORTHOIMAGERY.ORTHOPHOTOS":"Fotografie aeree","ORTHOIMAGERY.ORTHOPHOTOS.description":"Le fotografie aeree sposano la precisione geometrica della carta alla richezza di una foto con una risoluzione compresa tra 50 e 15 cm o di immagini satellitarie con una risoluzione compresa tra 10 e 20 m.","ELEVATION.SLOPS":"Altitudine (colori ipsometrici)","ELEVATION.SLOPS.description":"I modelli numerici del terreno sono ricavati da dati della banca dati BD ALTI® che descrive il territorio francese con delle curve di livello. L'equidistanza delle curve pueden andare da 5 a 40 m. I dati iniziali sono stati impostati su delle carte IGN alla scala di 1:25 000 o 1:50 000, a partire da una restituzione ricavata da riprese aeree alla scala di 1:20 000, 1:30 000 o 1:60 000.","CADASTRALPARCELS.PARCELS":"Catasto","CADASTRALPARCELS.PARCELS.description":"Le informazioni catastali numeriche comportano i riferimenti geografici, continuano sull'insieme del territorio francese e sono state ricavate a partire da un assemblaggio dei piani catastali smaterializzati.","HYDROGRAPHY.HYDROGRAPHY":"Idrografiaz terrestre","HYDROGRAPHY.HYDROGRAPHY.description":"L'idrografia terrestre è ricavata a partire da un assemblaggio dei dati dei database BD TOPO®, BD CARTHAGE®, EuroRegionalMap e EuroGlobalMap.","TRANSPORTNETWORKS.ROADS":"Rete stradale","TRANSPORTNETWORKS.ROADS.description":"La rete stradale è ricavata a partire da un assemblaggio dei dati dei database BD TOPO®, BD CARTO®, EuroRegionalMap e EuroGlobalMap.","TRANSPORTNETWORKS.RAILWAYS":"Rete ferroviaria","TRANSPORTNETWORKS.RAILWAYS.description":"La rete ferroviaria è ricavata a partire da un assemblaggio dei dati dei database BD TOPO®, BD CARTO®, EuroRegionalMap e EuroGlobalMap.","TRANSPORTNETWORKS.RUNWAYS":"Aeroporto","TRANSPORTNETWORKS.RUNWAYS.description":"Le piste degli aeroporti e aerodromi sono ricavate a partire da un assemblaggio dei dati dei database BD TOPO® e BD CARTO®","BUILDINGS.BUILDINGS":"Costruzioni","BUILDINGS.BUILDINGS.description":"Gli edifici e le zone costruite sono ricavati a partire da un assemblaggio dei dati dei database BD TOPO®, BD CARTO®, EuroRegionalMap e EuroGlobalMap.","UTILITYANDGOVERNMENTALSERVICES.ALL":"Servizi governativi","UTILITYANDGOVERNMENTALSERVICES.ALL.description":"Le diverse reti di trasporto dell'energia sono ricavate a partire da un assemblaggio dei dati dei database BD TOPO® e BD CARTO®.","ADMINISTRATIVEUNITS.BOUNDARIES":"Limiti amministrativi","ADMINISTRATIVEUNITS.BOUNDARIES.description":"Le unitè amministrative della Francia sono ricavate a partire da un assemblaggio dei dati dei database BD TOPO®, BD CARTO®, EuroRegionalMap e EuroBoundaryMap.","SEAREGIONS.LEVEL0":"Tratto costiero","SEAREGIONS.LEVEL0.description":"Lo 0 dei mari è ricavato dal datbase LITTO3D®, prodotto realizzato in comune dallo SHOM e dall'IGN.","LANDCOVER.CORINELANDCOVER":"Copertura del suolo","LANDCOVER.CORINELANDCOVER.description":"CORINE 2006","div.not.found":"${id} non trovato nel documento : verificare l'esistenza reale di '${id}'.","proxy.not.set":"Nessuna configurazione per il proxy : è possibile che l'ottenimento delle informazioni richieste sul contratto fallisca.","cookies.not.enabled":"Cookie sono disabilitati. Per favore, consentire loro.","geoRM.getConfig":"Impossibile di ottenere le informazioni relative alla chiave '${key}' - Verificare la propria connessione.","geoRM.getToken":"Impossibile di ottenere il gettone associato alla chiave '${key}' - Verificare la propria connessione.","geoRM.failed":"Impossibile di ottenere uno token valido relative alla chiave '${key}'","GPX.version":"Versione ${gpxVersion} GPX non supportata","XLS.version":"Versione ${xlsVersion} XLS non supportata per il servizio ${coreService}","Not.conformal.XLS":"${part} non è presente nello XML","olControlMeasurePath.title":"Misura di distanza","olControlMeasurePolygon.title":"Misura di superficie","waiting.measurement":"In attesa di input...","length.measurement":"Lunghezza","area.measurement":"Surfacie","gpControlLayerSwitcher.label":"Strati","gpLayer.metadataURL":"Maggiori informazioni su questo strato...","gpLayer.dataURL":"Accesso al servizio di download","gpControlPanelToggle.closed":"Visualizzare la barra degli attrezzi","gpControlPanelToggle.opened":"Mascherare la barra degli attrezzi","gpControlRemoveLayer.title":"Ritirare lo strato","gpControlLayerOpacity.title":"Regola di trasparenza","gpControlZoomToLayerMaxExtent.title":"Zoom sul campo di applicazione dello strato","gpControlMousePosition.longitude":"Longitudine","gpControlMousePosition.latitude":"Latitudine","gpControlMousePosition.easting":"Ascissa","gpControlMousePosition.northing":"Ordinata","gpControlMousePosition.north":"N","gpControlMousePosition.south":"S","gpControlMousePosition.east":"E","gpControlMousePosition.west":"O","gpControlMousePosition.sexa":"gradi sessagesimali","gpControlMousePosition.deg":"gradi decimali","gpControlMousePosition.gon":"gradi","gpControlMousePosition.rad":"radianti","gpControlMousePosition.km":"chilometri","gpControlMousePosition.m":"metri","gpControlMousePosition.cm":"centimetri","gpControlMousePosition.utmZone":"Zona","gpControlToolBox.label":"Attrezzi","gpControlZoomBar.world":"Mondo","gpControlZoomBar.state":"Stato","gpControlZoomBar.country":"Paese","gpControlZoomBar.town":"Città","gpControlZoomBar.street":"Via","gpControlZoomBar.house":"Casa","gpControlEditingToolbar.drawpoint":"Inserire un punto","gpControlEditingToolbar.drawline":"Disegnare una linea","gpControlEditingToolbar.drawpolygon":"Disegnare un poligono","gpControlEditingToolbar.dragfeature":"Spostare un oggetto","gpControlEditingToolbar.modifyfeature":"Modificare un oggetto","gpControlEditingToolbar.deletefeature":"Distruggere un oggetto","gpControlEditingToolbar.selectfeature":"Selezionare un oggetto","gpControlEditingToolbar.navigation":"Navigare","gpControlAddImageLayer.title":"Aggiungere uno strato immagine...","gpControlAddImageLayer.layerUrl":"URL : ","gpControlAddImageLayer.layerUrl.help":"indirizzo di base del servizio","gpControlAddImageLayer.layerType":"Tipo :","gpControlAddImageLayer.layerType.help":"Scegliere un valore nella lista","gpControlAddImageLayer.layerType.WMS":"Web Map Service","gpControlAddImageLayer.layerType.WMSC":"OSGeO WMS-C","gpControlAddImageLayer.button.add":"Aggiungere","gpControlAddImageLayer.button.cancel":"Cancel","wms.caps.no.compatible.srs":"Non compatibile strato trovato","gpControlAddVectorLayer.title":"Annullare","gpControlAddVectorLayer.layerName":"Nome :","gpControlAddVectorLayer.layerName.help":"Ad esempio : il mio strato","gpControlAddVectorLayer.layerType":"Tipo :","gpControlAddVectorLayer.layerType.help":"Scegliere un valore nella lista","gpControlAddVectorLayer.layerType.Point":"puntuale","gpControlAddVectorLayer.layerType.LineString":"lineare","gpControlAddVectorLayer.layerType.Polygon":"superficiale","gpControlAddVectorLayer.layerType.KML":"risorsa KML","gpControlAddVectorLayer.layerType.GPX":"risorsa GPX","gpControlAddVectorLayer.layerType.OSM":"risorsa OSM","gpControlAddVectorLayer.layerType.WFS":"risorsa WFS","gpControlAddVectorLayer.layerUrl":"URL : ","gpControlAddVectorLayer.layerUrl.help":"locale o a distanza","gpControlAddVectorLayer.layerFreeHand":"a mano libera ? ","gpControlAddVectorLayer.layerFreeHand.help":"permette il disegno a mano libera","gpControlAddVectorLayer.button.add":"Aggiungere","gpControlAddVectorLayer.button.cancel":"Annullare","wfs.caps.no.feature.found":"Nessun oggetto trovato","wfs.caps.unsupported.version":"WFS versione ${version} non supportata","gpControlLocationUtilityService.geonames.title":"Ricercare una località","gpControlLocationUtilityService.geocode.title":"Ricercare un indirizzo","gpControlLocationUtilityService.reverse.geocode.title":"Ricercare gli indirizzi intorno a un punto","gpControlLocationUtilityServiceGeoNames.title":"Ricercare una località :","gpControlLocationUtilityServiceGeoNames.name":"Località :","gpControlLocationUtilityServiceGeoNames.name.help":"Ad esempio : Saint-Mandé","gpControlLocationUtilityServiceGeoNames.button.cancel":"Annullare","gpControlLocationUtilityServiceGeoNames.button.search":"Ricercare","gpControlLocationUtilityServiceGeocode.title":"Ricercare un indirizzo","gpControlLocationUtilityServiceGeocode.address":"Via :","gpControlLocationUtilityServiceGeocode.address.help":"Ad esempio : 2, avenue Pasteur","gpControlLocationUtilityServiceGeocode.municipality":"Città :","gpControlLocationUtilityServiceGeocode.municipality.help":"Ad esempio : Saint-Mandé","gpControlLocationUtilityServiceGeocode.postalcode":"Codice di avviamento postale : ","gpControlLocationUtilityServiceGeocode.postalcode.help":"Ad esempio : 94165","gpControlLocationUtilityServiceGeocode.name":"Località :","gpControlLocationUtilityServiceGeocode.name.help":"Ad esempio : Saint-Mandé ou 94165","gpControlLocationUtilityServiceGeocode.button.cancel":"Annullare","gpControlLocationUtilityServiceGeocode.button.search":"Ricercare","gpControlLocationUtilityServiceReverse.title":"Ricercare dei luoghi nelle vicinanze","gpControlLocationUtilityServiceReverse.longitude":"Longitudine :","gpControlLocationUtilityServiceReverse.longitude.help":"Ad esempio : dd.mmss in coordinate geografiche","gpControlLocationUtilityServiceReverse.latitude":"Latitudine","gpControlLocationUtilityServiceReverse.latitude.help":"Ad esempio : dd.mmss in coordinate geografiche","gpControlLocationUtilityServiceReverse.button.cancel":"Annullare","gpControlLocationUtilityServiceReverse.button.search":"Ricercare","lus.not.match":"Non trovata nessuna corrispondenza","geocoded.address.popup.title":"Indirizzo","geocoded.address.popup.postalCode":"Codice di avviamento postale :","geocoded.address.popup.places":"Località",CountrySubdivision:"Provincia",CountrySecondarySubdivision:"Comune",Municipality:"Città",MunicipalitySubdivision:"Quartiere","utm.zone":"UTM","*":""};Geoportal.Control=OpenLayers.Class(OpenLayers.Control,{initialize:function(B){this.displayClass=this.CLASS_NAME.replace("Geoportal.","gp").replace(/\./g,"");OpenLayers.Util.extend(this,B);this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}},changeLang:function(B){},setSelectable:function(B){if(!this.allowSelection){this.div.className=this.displayClass;if(B===false){this.div.className+=" olControlNoSelect";this.div.setAttribute("unselectable","on",0);this.div.onselectstart=function(){return(false)}}else{this.div.setAttribute("unselectable","off",0);this.div.onselectstart=null}}},CLASS_NAME:"Geoportal.Control"});Geoportal.Control.selectFeature=function(B){if(B){if(!B.popup){B.createPopup()}if(B.layer&&B.layer.map&&B.popup){B.layer.map.addPopup(B.popup)}}};Geoportal.Control.hoverFeature=function(D){if(D){if(!D.popup){var E='<table border="1" cellspacing="0" cellpadding="0">';var C="";for(var B in D.attributes){if(D.attributes.hasOwnProperty(B)){if(B.toLowerCase()=="name"){C=D.attributes[B]||""}E+='<tr><td class="gpAttName">'+B+'</td><td class="gpAttValue">'+(D.attributes[B]||"")+"</td></tr>"}}E+="</table>";D.popup=new OpenLayers.Popup.FramedCloud("chicken",D.geometry.getBounds().getCenterLonLat(),null,'<div class="gpPopupHead">'+C+'</div><div class="gpPopupBody">'+E+"</div>",null,false);Geoportal.Popup.completePopup(D.popup,{maxSize:new OpenLayers.Size(300,300),overflow:"auto"})}if(D.layer&&D.layer.map&&D.popup){D.layer.map.addPopup(D.popup,true)}}};Geoportal.Control.unselectFeature=function(B){if(B){if(B.popup){B.popup.destroy();B.popup=null}}};Geoportal.Format=OpenLayers.Class(OpenLayers.Format,{CLASS_NAME:"Geoportal.Format"});Geoportal.Layer=OpenLayers.Class(OpenLayers.Layer,{CLASS_NAME:"Geoportal.Layer"});Geoportal.Layer.onPreAddLayer=function(B){if(B==null){return }if(B.layer==null){return }if(B.layer.isBaseLayer){return }if(B.layer.getCompatibleProjection(this)!==null){if(!B.layer.savedStates[this.id]){B.layer.savedStates[this.id]={}}B.layer.savedStates[this.id].visibility=!!B.layer.visibility;if(B.layer.opacity!=undefined){B.layer.savedStates[this.id].opacity=B.layer.opacity}}};Geoportal.Layer.Aggregate=OpenLayers.Class(Geoportal.Layer,{layers:null,initialize:function(C,D,B){Geoportal.Layer.prototype.initialize.apply(this,[C,B]);this.layers=[];this.addLayers(D)},destroy:function(D){if(this.map){this.map.events.unregister("removelayer",this,this.remove)}if(this.layers){for(var C=0,B=this.layers.length;C<B;C++){this.layers[C].aggregate=null}this.layers=null}Geoportal.Layer.prototype.destroy.apply(this,arguments)},remove:function(C){if(C.layer!=this){return }if(this.layers){var E;for(var D=0,B=this.layers.length;D<B;D++){E=this.layers[D];E.map.removeLayer(this.layers[D],false)}}},clone:function(){var B=Geoportal.Layer.prototype.clone.apply(this,arguments);B.addLayers(this.layers)},setMap:function(F){if(this.map!=null){return }if(!this.layers){return }var D;for(var C=0,B=this.layers.length;C<B;C++){D=this.layers[C];if(D.map==null){F.addLayer(D)}}var E=this.maxExtent==null;Geoportal.Layer.prototype.setMap.apply(this,arguments);if(E){this.maxExtent=null;for(var C=0,B=this.layers.length;C<B;C++){D=this.layers[C];if(C==0){this.maxExtent=D.maxExtent.clone()}else{this.maxExtent.extend(D)}}}this.setZIndex(this.getZIndex());this.map.events.register("removelayer",this,this.remove)},removeMap:function(E){if(this.map==null){return }if(this.layers){var D;for(var C=0,B=this.layers.length;C<B;C++){D=this.layers[C];if(D.map!=null){D.map.removeLayer(D)}}}},setVisibility:function(C){if(C!=this.visibility){this.visibility=C;Geoportal.Layer.prototype.display.apply(this,arguments);if(this.layers&&this.map!=null){var F,E;for(var D=0,B=this.layers.length;D<B;D++){F=this.layers[D];if(F.isBaseLayer){continue}if(F.territory!==undefined&&this.map.baseLayer.territory!==undefined){if(F.territory==this.map.baseLayer.territory){if(C){F.setVisibility(F.calculateInRange())}else{F.setVisibility(false)}}continue}E=F.getNativeProjection();if(!E){continue}if(!(E.equals(this.map.baseLayer.nativeProjection)||(E.getProjName()=="longlat"&&E.isCompatibleWith(this.map.baseLayer.nativeProjection)))){continue}if(!(F.restrictedExtent||F.maxExtent)||this.map.baseLayer.maxExtent.containsBounds(F.restrictedExtent||F.maxExtent,true,true)){if(C){F.setVisibility(F.calculateInRange())}else{F.setVisibility(false)}}}}if(this.map!=null){this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"})}this.events.triggerEvent("visibilitychanged")}},display:function(E){var F=this.calculateInRange();if(E!=(this.div.style.display!="none")){this.div.style.display=(E&&F)?"block":"none";if(this.layers){var D;for(var C=0,B=this.layers.length;C<B;C++){D=this.layers[C];D.display(E)}}}},initResolutions:function(){if(this.layers){var F;var D=typeof (this.options.minZoomLevel)=="number";var C=typeof (this.options.maxZoomLevel)=="number";for(var E=0,B=this.layers.length;E<B;E++){F=this.layers[E];if(E==0){if(!D&&typeof (F.minZoomLevel)=="number"){this.options.minZoomLevel=F.minZoomLevel}if(!C&&typeof (F.maxZoomLevel)=="number"){this.options.maxZoomLevel=F.maxZoomLevel}}else{if(!D&&typeof (F.minZoomLevel)=="number"){this.options.minZoomLevel=Math.min(this.options.minZoomLevel,F.minZoomLevel)}if(!C&&typeof (F.maxZoomLevel)=="number"){this.options.maxZoomLevel=Math.max(this.options.maxZoomLevel,F.maxZoomLevel)}}}}Geoportal.Layer.prototype.initResolutions.apply(this,arguments)},getDataExtent:function(){var E=null;if(this.layers){var D;for(var C=0,B=this.layers.length;C<B;C++){D=this.layers[C];if(C==0){E=D.getDataExtent()}else{E.extend(D.getDataExtent())}}}return E},setOpacity:function(C){if(C!=this.opacity){Geoportal.Layer.prototype.setOpacity.apply(this,arguments);if(this.layers){var E;for(var D=0,B=this.layers.length;D<B;D++){E=this.layers[D];E.setOpacity(C)}}}},setZIndex:function(E){this.div.style.zIndex=E;if(this.layers){var D;for(var C=0,B=this.layers.length;C<B;C++){D=this.layers[C];if(D.div){D.setZIndex(E-C-1)}}}},addLayer:function(E){var C;for(var D=0,B=this.layers.length;D<B;D++){C=this.layers[D];if(C==E){var F=OpenLayers.i18n("layerAlreadyAdded",{layerName:E.name});OpenLayers.Console.warn(F);return }}E.displayInLayerSwitcher=false;E.visibility=this.visibility;E.aggregate=this;this.layers.push(E);if(this.map){if(E.map==null){this.map.addLayer(E)}this.initResolutions();this.setZIndex(this.getZIndex())}},addLayers:function(D){if(!D){return }if(!(D instanceof Array)){this.addLayer(D);return }for(var C=0,B=D.length;C<B;C++){this.addLayer(D[C])}},CLASS_NAME:"Geoportal.Layer.Aggregate"});Geoportal.OLS=OpenLayers.Class({id:null,initialize:function(B){OpenLayers.Util.extend(this,B);if(this.id==null){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}},destroy:function(){this.id=null},CLASS_NAME:"Geoportal.OLS"});Geoportal.Popup=OpenLayers.Class(OpenLayers.Popup,{feature:null,initialize:function(C,F,I,E,B,G,J){if(C==null){C=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")}this.id=C;this.lonlat=F;this.contentSize=(I!=null?I:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT));if(E!=null){this.contentHTML=E}this.backgroundColor=OpenLayers.Popup.COLOR;this.opacity=OpenLayers.Popup.OPACITY;this.border=OpenLayers.Popup.BORDER;this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden");this.div.className="gpPopup";var D=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(D,null,null,null,"relative",null,"hidden");var H=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(H,null,this.contentSize.clone(),null,"relative",null,"hidden");this.contentDiv.className="gpPopupContent";this.groupDiv.appendChild(this.contentDiv);this.div.appendChild(this.groupDiv);this.autoSize=true;this.feature=J;if(B){this.addCloseBox(G)}this.registerEvents();if(this.feature){this.feature.layer.events.register("visibilitychanged",this,this.onVisibilityChanged)}},destroy:function(){this.feature=null;OpenLayers.Popup.prototype.destroy.apply(this,arguments)},onVisibilityChanged:function(){if(this.feature){if(!this.feature.layer.getVisibility()){this.hide();OpenLayers.Util.removeItem(this.feature.layer.selectedFeatures,this.feature);this.feature.layer.events.triggerEvent("featureunselected",{feature:this.feature})}}},addCloseBox:function(D){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,new OpenLayers.Size(17,17));this.closeDiv.className="gpPopupCloseBox";var C=this.getContentDivPadding();this.closeDiv.style.right=C.right+"px";this.closeDiv.style.top=C.top+"px";this.groupDiv.appendChild(this.closeDiv);var B=D||function(E){OpenLayers.Event.stop(E);this.hide();if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){if(this.map&&this.map.events){this.map.events.unregister("movestart",this,this.onMoveStartPopup);this.map.events.unregister("moveend",this,this.onMoveEndPopup)}}if(this.feature){OpenLayers.Util.removeItem(this.feature.layer.selectedFeatures,this.feature);this.feature.layer.events.triggerEvent("featureunselected",{feature:this.feature})}};OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(B,this))},CLASS_NAME:"Geoportal.Popup"});Geoportal.Popup.setPointerCursorForFeature=function(B){if(B){if(B.style){B.style.cursor="pointer"}else{if(B.layer){if(B.layer.style){B.layer.style.cursor="pointer"}else{if(!B.layer.styleMap){B.layer.styleMap=new OpenLayers.StyleMap()}for(var C in B.layer.styleMap.styles){B.layer.styleMap.styles[C].defaultStyle.cursor="pointer"}}}else{B.style=OpenLayers.Util.applyDefaults({cursor:"pointer"},OpenLayers.Feature.Vector.style["default"])}}}};Geoportal.Popup.completePopup=function(B,C){if(!C){return B}if(C.backgroundColor){B.setBackgroundColor(C.backgroundColor)}if(C.opacity){B.setOpacity(C.opacity)}if(C.border){B.setBorder(C.border)}if(C.className&&B.div){B.div.className=C.className}B.autoSize=C.autoSize!=undefined?C.autoSize:true;if(C.maxSize){B.maxSize=C.maxSize}if(C.minSize){B.minSize=C.minSize}if(C.overflow){B.contentDiv.style.overflow=C.overflow}return B};Geoportal.Popup.onPopupClose=function(B){OpenLayers.Event.stop(B);this.hide();if(!this.disableFirefoxOverflowHack&&OpenLayers.Util.getBrowserName()=="firefox"){if(this.map&&this.map.events){this.map.events.unregister("movestart",this,this.onMoveStartPopup);this.map.events.unregister("moveend",this,this.onMoveEndPopup)}}if(this.feature){this.feature.layer.drawFeature(this.feature,"default");OpenLayers.Util.removeItem(this.feature.layer.selectedFeatures,this.feature);this.feature.layer.events.triggerEvent("featureunselected",{feature:this.feature});Geoportal.Control.unselectFeature(this.feature)}};Geoportal.Tile=OpenLayers.Class(OpenLayers.Tile,{CLASS_NAME:"Geoportal.Tile"});Geoportal.Util={getImagesLocation:function(){return Geoportal._getScriptLocation()+"theme/geoportal/img/"},convertToPixels:function(E,B,F){if(!E){return undefined}if(B==undefined){B=false}if(/px$/.test(E)){return parseInt(E)}var D=document.createElement("div");D.style.display="";D.style.visibility="hidden";D.style.position="absolute";D.style.lineHeight="0";if(!F){F=document.body}if(/%$/.test(E)){F=F.parentNode||F;D.style[B?"width":"height"]=E}else{D.style.borderStyle="solid";if(B){D.style.borderBottomHeight="0";D.style.borderTopHeight=E}else{D.style.borderBottomWidth="0";D.style.borderTopWidth=E}}F.appendChild(D);var C=B?D.offsetWidth:D.offsetHeight;F.removeChild(D);return C},getComputedStyle:function(G,H,C){var B;if(G.currentStyle){B=G.currentStyle[OpenLayers.String.camelize(H)]}else{if(document.defaultView.getComputedStyle){var F=document.defaultView.getComputedStyle(G,null);B=F.getPropertyValue(H)}else{B=null}}var E=/(em|ex|pt|%)$/;var D=/(width)/i;B=C?B?E.test(B)?this.convertToPixels(B,D.test(B),G.parentNode):parseInt(B)||0:0:B;return B},loadJS:function(B,D,I){D=D||B;var E=OpenLayers.Util.getElement(D);if(E!=null){return[E,false]}var C=document.getElementsByTagName("script"),F,J;var H,G;for(H=0,G=C.length;H<G;++H){if(OpenLayers.Util.isEquivalentUrl(C.item(H).src,B)){C.item(H).setAttribute("id",D);return[C.item(H),false]}}C=document.getElementsByTagName("head");var K=C.length>0?C[0]:document.body;var L=OpenLayers.Util.getElement(I||"");E=document.createElement("script");E.setAttribute("type","text/javascript");E.setAttribute("src",B);E.setAttribute("charset","UTF-8");E.setAttribute("id",D);if(L!=null){var L=OpenLayers.Util.getElement(I);OpenLayers.Element.insertAfter(E,L)}else{C=K.childNodes;J=null;for(H=0,G=C.length;H<G;H++){F=C[H];if(F.nodeType!=1){continue}switch(F.tagName.toLowerCase()){case"script":if(F.getAttribute("type").toLowerCase()=="text/javascript"){J=F}break;default:break}if(J!=null){break}}if(J==null){K.appendChild(E)}else{OpenLayers.Element.insertAfter(E,J)}}return[E,true]},loadCSS:function(B,D,H){D=D||B;var I=OpenLayers.Util.getElement(D);if(I!=null){return[I,false]}var C=document.getElementsByTagName("link"),E,J;var G,F;for(G=0,F=C.length;G<F;++G){if(OpenLayers.Util.isEquivalentUrl(C.item(G).href,B)){C.item(G).setAttribute("id",D);return[C.item(G),false]}}C=document.getElementsByTagName("head");var K=C.length>0?C[0]:document.body;I=document.createElement("link");I.setAttribute("rel","stylesheet");I.setAttribute("type","text/css");I.setAttribute("href",B);I.setAttribute("id",D);if(H==""){K.appendChild(I);return[I,true]}var L=H!=null?OpenLayers.Util.getElement(H):null;if(L!=null){OpenLayers.Element.insertAfter(I,L);return[I,true]}C=K.childNodes;J=null;for(G=0,F=C.length;G<F;G++){E=C[G];if(E.nodeType!=1){continue}switch(E.tagName.toLowerCase()){case"link":if(E.getAttribute("rel").toLowerCase()=="stylesheet"||E.getAttribute("type").toLowerCase()=="text/css"){J=E}break;case"style":J=E;break;default:break}if(J!=null){break}}if(J==null){K.appendChild(I)}else{J.parentNode.insertBefore(I,J)}return[I,true]},cleanContent:function(C){var B=C.replace(/[\r\n]?/gi,"");B=B.replace(/<[\/]?html[^>]*>/gi,"");B=B.replace(/<head[^>]*>.*<\/head>/gi,"");B=B.replace(/<[\/]?body[^>]*>/gi,"");B=B.replace(/<script[^>]*>.*<\/script>/gi,"");return B},dmsToDeg:function(I){if(!I){return Number.NaN}var H=I.match(/(^\s?-)|(\s?[SW]\s?$)/)!=null?-1:1;I=I.replace(/(^\s?-)|(\s?[NSEW]\s?)$/,"");I=I.replace(/\s/g,"");var E=I.match(/(\d{1,3})[.,°d]?(\d{0,2})[']?(\d{0,2})[.,]?(\d{0,})(?:["]|[']{2})?/);if(E==null){return Number.NaN}var F=(E[1]?E[1]:"0.0")*1;var B=(E[2]?E[2]:"0.0")*1;var C=(E[3]?E[3]:"0.0")*1;var D=(E[4]?("0."+E[4]):"0.0")*1;var G=(F+(B/60)+(C/3600)+(D/3600))*H;return G},degToDMS:function(E,C,B){var J=Math.abs(E);var F=Math.round(J+0.5)-1;var I=60*(J-F);var H=Math.round(I+0.5)-1;I=60*(I-H);var L=Math.round(I+0.5)-1;if(B===undefined||B<0){B=1}var G=Math.pow(10,B);var K=G*(I-L);K=Math.round(K+0.5)-1;if(K>=G){L=L+1;K=0}if(L==60){H=H+1;L=0}if(H==60){F=F+1;H=0}var D="";if(C&&(C instanceof Array)&&C.length==2){D=" "+(E>0?C[0]:C[1])}else{if(E<0){F=-1*F}}var M=OpenLayers.String.sprintf("%4d° %02d' %02d",F,H,L)+(B>0?OpenLayers.String.sprintf('.%0*d"',B,K):'"')+D;return M}};Geoportal.Cookies={_get:function(D,C){var E=new RegExp("(^|;)[\\s]*"+D+"=([^;]*)");var B=E.exec(document.cookie);if(!B){return C}var F={name:"",value:decodeURIComponent(B[2]),path:"",domain:"",ttl:0,secure:false};return(!F.value?C||null:F)},get:function(C,B){var D=Geoportal.Cookies._get(C);return(D?D.value:B)},expireDateToHours:function(E){var C=new Date(E);if(isNaN(C)){return -1}var D=new Date();var B=(C.getTime()-D.getTime())/(60*60*1000);return B},set:function(D,E,B,H,F,G){if(D==null){return }var C=Geoportal.Cookies._get(typeof (D)=="object"?D.name:D)||{name:"",value:"",ttl:0,path:"",domain:"",secure:false};var I;if(typeof (D)=="string"){I={name:D,value:E||C.value||undefined,ttl:B||C.ttl||undefined,path:C.path||H||undefined,domain:C.domain||F||undefined,secure:C.secure||G||false}}else{I={name:D.name,value:D.value||C.value||undefined,ttl:D.ttl||C.ttl||undefined,path:C.path||D.path||undefined,domain:C.domain||D.domain||undefined,secure:C.secure||D.secure||false}}document.cookie=Geoportal.Cookies.toString(I)},remove:function(B){Geoportal.Cookies.set(B,"",-1)},toString:function(E,C){var B=[];B.push(E.name+"="+encodeURIComponent(""+E.value));if(E.path){B.push("path="+E.path)}if(C){B.push("domain="+(!E.domain?location.hostname:E.domain))}if(E.ttl&&!isNaN(E.ttl)){B.push("max-age="+E.ttl*60*60)}if(E.secure){B.push("secure")}var D=B.join(";");return D},cookiesEnabled:function(){var B={name:"cookieEnabled",value:"1"};Geoportal.Cookies.set(B.name,B.value);var D=Geoportal.Cookies.get(B.name);var C=!(D===undefined||D!=B.value);Geoportal.Cookies.remove(B.name);return C}};Geoportal.Control.Copyright=OpenLayers.Class(Geoportal.Control,{copyright:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,arguments);if(!this.copyright){this.copyright="&copy; IGN"}},redraw:function(){if(this.div){this.div.innerHTML=OpenLayers.i18n(this.copyright)}},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.redraw();return this.div},changeLang:function(B){this.redraw()},CLASS_NAME:"Geoportal.Control.Copyright"});Geoportal.Control.DeleteFeature=OpenLayers.Class(Geoportal.Control,{EVENT_TYPES:["beforefeaturesdeleted","featuresdeleted","beforefeaturedeleted","featuredeleted"],deleteCodes:null,onDelete:function(){},onUndelete:function(){},geometryTypes:null,layer:null,callbacks:null,handlers:null,deletedFeatures:null,initialize:function(C,B){this.EVENT_TYPES=Geoportal.Control.DeleteFeature.prototype.EVENT_TYPES.concat(Geoportal.Control.prototype.EVENT_TYPES);Geoportal.Control.prototype.initialize.apply(this,[B]);this.layer=C;this.deleteCodes=[46,68];var D={click:this.clickFeature};this.callbacks=OpenLayers.Util.extend(D,this.callbacks);var E={keydown:this.handleKeypress};this.handlers={feature:new OpenLayers.Handler.Feature(this,C,this.callbacks,{geometryTypes:this.geometryTypes}),keyboard:new OpenLayers.Handler.Keyboard(this,E)};this.deletedFeatures=[]},destroy:function(){this.deletedFeatures=null;Geoportal.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(!this.active){this.handlers.feature.activate()}return Geoportal.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active){this.handlers.feature.deactivate()}return Geoportal.Control.prototype.deactivate.apply(this,arguments)},clickFeature:function(B){this.deleteFeature(B)},handleKeypress:function(C){if(!C){return }if(this.layer.selectedFeatures.length>0&&OpenLayers.Util.indexOf(this.deleteCodes,C.keyCode)!=-1){if(this.events.triggerEvent("beforefeaturesdeleted",{features:this.layer.selectedFeatures})===false){return }for(var E=0,B=this.layer.selectedFeatures.length;E<B;E++){var D=this.layer.selectedFeatures.unshift();this.deleteFeature(D)}if(this.events.triggerEvent("featuresdeleted",{features:features})==false){return }features=null}},deleteFeature:function(B){if(this.events.triggerEvent("beforefeaturedeleted",{feature:B})===false){return }this.deletedFeatures.push(B);this.layer.destroyFeatures([B]);if(this.events.triggerEvent("featuredeleted",{feature:B})===false){return }this.onDelete(B)},setMap:function(B){this.handlers.feature.setMap(B);this.handlers.keyboard.setMap(B);Geoportal.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"Geoportal.Control.DeleteFeature"});Geoportal.Control.Floating=OpenLayers.Class(Geoportal.Control,{contentControler:null,headDiv:null,headTitle:null,headDivEvents:null,minimizeDiv:null,maximizeDiv:null,closeDiv:null,bodyDiv:null,bodyDivEvents:null,size:null,onMaximize:function(B){},onMinimize:function(B){},onClose:function(B){},initialize:function(C,B){Geoportal.Control.prototype.initialize.apply(this,[B]);this.contentControler=C},destroy:function(){this._clearAll();Geoportal.Control.prototype.destroy.apply(this,arguments)},_clearAll:function(){if(this.minimizeDiv){OpenLayers.Event.stopObservingElement(this.minimizeDiv);this.minimizeDiv=null}if(this.maximizeDiv){OpenLayers.Event.stopObservingElement(this.maximizeDiv);this.maximizeDiv=null}if(this.closeDiv){OpenLayers.Event.stopObservingElement(this.closeDiv);this.closeDiv=null}if(this.headDivEvents){this.headDivEvents.un({click:OpenLayers.Event.stop,dblclick:OpenLayers.Event.stop,mousedown:this.dragStart,mousemove:this.drag,mouseup:this.dragStop});this.headDivEvents=null}if(this.headDiv){this.headDiv.innerHTML="";this.headDiv=null}if(this.bodyDivEvents){this.bodyDivEvents.un({click:this.passthroughEvent,dblclick:this.passthroughEvent,mousedown:this.passthroughEvent,mousemove:this.passthroughEvent,mouseup:this.passthroughEvent});this.bodyDivEvents=null}if(this.bodyDiv){this.bodyDiv.innerHTML="";this.bodyDiv=null}if(this.size){this.size=null}if(this.div){OpenLayers.Event.stopObservingElement(this.div);this.div.parentNode.removeChild(this.div);this.div.innerHTML="";this.div=null}this.contentControler=null},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this._loadContents();if(this.maximizeDiv){this.maximizeControl()}return this.div},dblClick:function(B){if(B!=null){OpenLayers.Event.stop(B)}},maximizeControl:function(B){if(B!=null){OpenLayers.Event.stop(B)}this.showControls(false);this.onMaximize(B)},minimizeControl:function(B){if(B!=null){OpenLayers.Event.stop(B)}this.showControls(true);this.onMinimize(B)},showControls:function(B){this.maximizeDiv.style.display=B?"":"none";this.minimizeDiv.style.display=B?"none":"";this.bodyDiv.style.display=B?"none":""},closeControl:function(B){if(B!=null){OpenLayers.Event.stop(B)}if(this.contentControler){this.onClose.apply(this.contentControler,[B])}},dragStart:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.mouseDragStart=B.xy.clone();this.headDiv.style.cursor="move";this.zIndex=this.div.style.zIndex;this.div.style.zIndex=9998;OpenLayers.Event.stop(B)},drag:function(E){if(this.mouseDragStart!=null){var D=this.mouseDragStart.x-E.xy.x;var B=this.mouseDragStart.y-E.xy.y;var G=this.div.offsetLeft-D;var F=this.div.offsetTop-B;if((G>0)&&(F>0)&&(G+this.div.clientWidth<this.div.parentNode.clientWidth)&&(F+this.div.clientHeight<this.div.parentNode.clientHeight)){var C=this.div.style;if(this.position){this.position.x=G;this.position.y=F}C.left=G+"px";C.top=F+"px";this.mouseDragStart=E.xy.clone()}OpenLayers.Event.stop(E)}},dragStop:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }if(this.mouseDragStart){this.mouseDragStart=null;this.headDiv.style.cursor="pointer";this.div.style.zIndex=this.zIndex;this.zIndex=-1;OpenLayers.Event.stop(B)}},ignoreEvent:function(B){OpenLayers.Event.stop(B,false)},passthroughEvent:function(B){OpenLayers.Event.stop(B,true)},_loadContents:function(){this.div.className=this.displayClass;this.headDiv=document.createElement("div");this.headDiv.className=this.displayClass+"Head";var E=document.createElement("span");E.id="spanTitle"+this.id;E.className=this.displayClass+"Head";E.appendChild(document.createTextNode(OpenLayers.i18n(this.headTitle?this.headTitle:"???")));this.headDiv.appendChild(E);var H=Geoportal.Util.getImagesLocation();var G=new OpenLayers.Size(11,11);var D=document.createElement("div");D.className=this.displayClass+"HeadBtns";if(this.contentControler){this.closeDiv=OpenLayers.Util.createAlphaImageDiv(this.id+"_CloseDiv",null,G,H+"ico_floatwin_close.gif","absolute");this.closeDiv.className=this.displayClass+"HeadBtnsClose";OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(this.closeControl,this));OpenLayers.Event.observe(this.closeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));D.appendChild(this.closeDiv)}if(!this.size){this.headDiv.appendChild(D);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv(this.id+"_MinimizeDiv",null,G,H+"ico_win_moins.gif","absolute");this.minimizeDiv.className=this.displayClass+"HeadBtnsMin";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));OpenLayers.Event.observe(this.minimizeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));D.appendChild(this.minimizeDiv);this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.id+"_MaximizeDiv",null,G,H+"ico_win_plus.gif","absolute");this.maximizeDiv.className=this.displayClass+"HeadBtnsMax";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));OpenLayers.Event.observe(this.maximizeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));D.appendChild(this.maximizeDiv)}this.headDiv.appendChild(D);var B=this.size?new OpenLayers.Size(this.size.w,0):null;var F=OpenLayers.Util.getRenderedDimensions(this.headDiv.innerHTML,B,{displayClass:this.headDiv.className});if(this.size){B=null;this.headDiv.style.height=F.h+"px";F.w=this.size.w}this.headDiv.style.width=F.w+"px";if(!this.position){var C=this.map.div.clientWidth||this.map.div.offsetWidth||800;this.div.style.left=(((C-F.w)*100)/(2*C))+"%"}F=null;if(this.size){this.div.style.width=this.size.w+"px";this.div.style.height=this.size.h+"px"}this.headDivEvents=new OpenLayers.Events(this,this.headDiv,null,true,{includeXY:true});this.headDivEvents.on({click:OpenLayers.Event.stop,dblclick:OpenLayers.Event.stop,mousedown:this.dragStart,mousemove:this.drag,mouseup:this.dragStop});this.bodyDiv=document.createElement("div");this.bodyDiv.id=this.id+"_Child";this.bodyDiv.className=this.displayClass+"Body";if(this.size){this.bodyDiv.style.width=this.size.w+"px";this.bodyDiv.style.height=(this.size.h-parseInt(this.headDiv.style.height))+"px";this.bodyDiv.style.overflow="auto";this.bodyDiv.style.margin="0px"}this.bodyDivEvents=new OpenLayers.Events(this,this.bodyDiv,null,true);this.bodyDivEvents.on({click:this.passthroughEvent,dblclick:this.passthroughEvent,mousedown:this.passthroughEvent,mousemove:this.passthroughEvent,mouseup:this.passthroughEvent});this.div.appendChild(this.headDiv);this.div.appendChild(this.bodyDiv);OpenLayers.Event.observe(this.div,"dblclick",OpenLayers.Function.bindAsEventListener(this.ignoreEvent,this));OpenLayers.Event.observe(this.div,"mousedown",OpenLayers.Function.bindAsEventListener(this.ignoreEvent,this));OpenLayers.Event.observe(this.div,"mouseup",OpenLayers.Function.bindAsEventListener(this.ignoreEvent,this))},addContent:function(D){if(this.bodyDiv&&D){this.bodyDiv.appendChild(D);if(!this.size){var C=OpenLayers.Util.getRenderedDimensions(this.bodyDiv.innerHTML,null,{displayClass:this.bodyDiv.className});if(C.w>this.div.parentNode.clientWidth){C.w=0.75*this.div.parentNode.clientWidth}var B=parseInt(this.headDiv.style.width);if(isNaN(B)||C.w>B){this.headDiv.style.width=(C.w+4)+"px";this.bodyDiv.style.width=C.w+"px"}else{this.bodyDiv.style.width=(parseInt(this.headDiv.style.width)-4)+"px"}if(!this.position){this.div.style.left=(((this.div.parentNode.clientWidth-parseInt(this.headDiv.style.width))*100)/(2*this.div.parentNode.clientWidth))+"%";this.div.style.top=(((this.div.parentNode.clientHeight-C.h)*100)/(8*this.div.parentNode.clientHeight))+"%"}C=null}}},changeLang:function(B){if(this.title){this.div.title=OpenLayers.i18n(this.title)}if(this.headTitle){var C=OpenLayers.Util.getElement("spanTitle"+this.id);if(C){C.innerHTML=OpenLayers.i18n(this.headTitle)}}},CLASS_NAME:"Geoportal.Control.Floating"});Geoportal.Control.GraphicScale=OpenLayers.Class(Geoportal.Control,{METRICSUIMETER:[1000,1,0.01,0.001],METRICSUISYMBOL:["km","m","cm","mm"],barAreaWidth:150,currentUnitInfo:null,currentIiSymbol:null,currentWidth:null,currentDistance:null,currentDivisionCount:null,listBlocks:null,initialize:function(){Geoportal.Control.prototype.initialize.apply(this,arguments);this.listBlocks=[]},destroy:function(){if(this.map){this.map.events.unregister("zoomend",this,this.redraw);this.map.events.unregister("changebaselayer",this,this.redraw)}if(this.listBlocks){for(var C=0,B=this.listBlocks.length;C<B;C++){if(this.listBlocks[C]){if(this.listBlocks[C].parentNode){this.listBlocks[C].parentNode.removeChild(this.listBlocks[C])}this.listBlocks[C]=null}}this.listBlocks=null}if(this.divLegend&&this.divLegend.parendNode){this.divLegend.parendNode.removeChild(this.divLegend);this.divLegend=null}if(this.divText1){if(this.divText1.parentNode){this.divText1.parentNode.removeChild(this.divText1)}this.divText1=null}if(this.divText2){if(this.divText2.parentNode){this.divText2.parentNode.removeChild(this.divText2)}this.divText2=null}Geoportal.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.prototype.setMap.apply(this,arguments);this.map.events.register("zoomend",this,this.redraw);this.map.events.register("changebaselayer",this,this.redraw)},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.divText2=document.createElement("div");this.divText2.className=this.displayClass+"Text2";this.div.appendChild(this.divText2);this.divText1=document.createElement("div");this.divText1.className=this.displayClass+"Text1";this.divText1.innerHTML="0";this.div.appendChild(this.divText1);this.divLegend=document.createElement("div");this.divLegend.className=this.displayClass+"Legend";this.div.appendChild(this.divLegend);return this.div},redraw:function(){this.computeBarMetrics();this.drawBar()},computeBarMetrics:function(){var H=false;var S=this.map.getResolution();if(this.map.getProjection()&&this.map.getProjection().getProjName()=="longlat"){var O=this.map.getCenter();if(!O){O=this.map.getMaxExtent().getCenterLonLat()}var Q=this.map.getProjection().getProperty("a");var N=this.map.getProjection().getProperty("b");if(!(Q&&N)){S*=111319.49079327357*Math.cos(O.lat*0.017453292519943295)}else{var K=Math.cos(O.lat*0.017453292519943295);var G=K*K;var E=Math.sin(O.lat*0.017453292519943295);var I=E*E;var R=Q*Q;var M=Q*Q*Q*Q;var C=N*N;var B=N*N*N*N;S*=0.017453292519943295*K*Math.sqrt((M*G+B*I)/(R*G+C*I))}}for(var J=0;J<this.METRICSUIMETER.length&&!H;J++){var L=100000;var D=this.METRICSUIMETER[J];while((Math.round(L)>0)&&!H){var F=Math.round((L*D)/S);if(F<this.barAreaWidth){H=true;this.currentUnitInfo=this.METRICSUIMETER[J];this.currentUiSymbol=this.METRICSUISYMBOL[J];this.currentWidth=F;this.currentDistance=L}else{L/=10}}}var P=1;while(P<5){if((this.currentWidth*(P+1))<this.barAreaWidth){P++}else{break}}this.currentDivisionCount=P;this.currentWidth*=P;this.currentDistance*=P;this.divText2.innerHTML=this.currentDistance+" "+this.currentUiSymbol;this.divText2.style.left=this.currentWidth+"px"},drawBar:function(){var B;this.divLegend.style.width=this.currentWidth+"px";this.div.style.width=(this.currentWidth)+"px";if(this.currentDivisionCount==1){this.currentDivisionCount=5}for(B=0;B<this.currentDivisionCount;B++){if(!this.listBlocks[B]){var C=document.createElement("div");if((B%2)===0){C.className=this.displayClass+"FullBlock"}else{C.className=this.displayClass+"EmptyBlock"}this.divLegend.appendChild(C);this.listBlocks[B]=C}else{this.listBlocks[B].style.display="block"}this.listBlocks[B].style.width=this.currentWidth/this.currentDivisionCount+"px"}for(B=this.currentDivisionCount;B<5;B++){if(this.listBlocks[B]){this.listBlocks[B].style.display="none"}}},CLASS_NAME:"Geoportal.Control.GraphicScale"});Geoportal.Control.Loading=OpenLayers.Class(Geoportal.Control,{counter:0,maximized:false,visible:true,layers:null,initialize:function(C,B){Geoportal.Control.prototype.initialize.apply(this,[B]);if(C&&typeof (C)=="object"){C=[C]}this.layers=C},destroy:function(){var D,B,C,E;if(this.layers){E=this.layers;this.layers=null}else{if(this.map){this.map.events.unregister("preaddlayer",this,this.addLayer);if(this.map.layers){E=this.map.layers}}}if(E){for(D=0,B=E.length;D<B;D++){C=E[D];C.events.unregister("loadstart",this,this.increaseCounter);C.events.unregister("loadend",this,this.decreaseCounter)}}Geoportal.Control.prototype.destroy.apply(this,arguments)},setVisible:function(B){this.visible=B;if(B){OpenLayers.Element.show(this.div)}else{OpenLayers.Element.hide(this.div)}},getVisible:function(){return this.visible},hide:function(){this.setVisible(false)},show:function(){this.setVisible(true)},toggle:function(){this.setVisible(!this.getVisible())},addLayer:function(B){if(B.layer){B.layer.events.register("loadstart",this,this.increaseCounter);B.layer.events.register("loadend",this,this.decreaseCounter)}},setMap:function(F){Geoportal.Control.prototype.setMap.apply(this,arguments);if(!this.layers){this.map.events.register("preaddlayer",this,this.addLayer)}var E=this.layers||this.map.layers;for(var D=0,B=E.length;D<B;D++){var C=E[D];C.events.register("loadstart",this,this.increaseCounter);C.events.register("loadend",this,this.decreaseCounter)}},increaseCounter:function(){this.counter++;if(this.counter>0){if(!this.maximized&&this.visible){this.maximizeControl()}}},decreaseCounter:function(){if(this.counter>0){this.counter--}if(this.counter==0){if(this.maximized&&this.visible){this.minimizeControl()}}},draw:function(){Geoportal.Control.prototype.draw.apply(this,arguments);return this.div},minimizeControl:function(B){if(B!=null){OpenLayers.Event.stop(B)}this.div.style.display="none";this.maximized=false},maximizeControl:function(B){if(B!=null){OpenLayers.Event.stop(B)}this.div.style.display="block";if(!this.layers){var E=this.map.getSize();var C=E.w;var D=E.h;this.div.style.left=C/2-this.div.offsetWidth/2+"px";this.div.style.top=D/2-this.div.offsetHeight/2+"px"}this.maximized=true},CLASS_NAME:"Geoportal.Control.Loading"});OpenLayers.Control.LoadingPanel=OpenLayers.Class(Geoportal.Control.Loading,{initialize:function(B){Geoportal.Control.Loading.prototype.initialize.apply(this,[null,B]);this.displayClass="olControlLoadingPanel"},CLASS_NAME:"OpenLayers.Control.LoadingPanel"});Geoportal.Control.Logo=OpenLayers.Class(Geoportal.Control,{logoPrefix:"http://www.geoportail.fr/legendes/logo_",logoSuffix:".gif",logoSize:null,_listeLogos:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,arguments);if(!this.logoSize){this.logoSize=new OpenLayers.Size(Geoportal.Control.Logo.WHSizes.normal,Geoportal.Control.Logo.WHSizes.normal)}if(typeof (this.logoSize)=="number"){this.logoSize=new OpenLayers.Size(this.logoSize,this.logoSize)}this._listeLogos=[]},destroy:function(){var C=this.div.childNodes;for(var B=0;B<C.length;B++){this.div.removeChild(C[B])}this._listeLogos=null;this.map.events.unregister("addlayer",this,this.redraw);this.map.events.unregister("changelayer",this,this.redraw);this.map.events.unregister("removelayer",this,this.redraw);this.map.events.unregister("zoomend",this,this.redraw);Geoportal.Control.prototype.destroy.apply(this,arguments)},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);return this.div},redraw:function(){var D;var F=this.div.childNodes;for(D=0;D<F.length;D++){F[D].style.display="none"}var H=this.map.layers;var E=this.map.getZoom();var G;for(D=0;D<H.length;D++){if(!H[D].getVisibility()||!H[D].inRange){continue}if(H[D].originators!=null){var B;for(var C=0;C<H[D].originators.length;C++){B=true;var G=H[D].originators[C];if(((G.minZoomLevel)&&(G.minZoomLevel>E))||((this.map.minZoomLevel)&&this.map.minZoomLevel>E)){B=false}if(((G.maxZoomLevel)&&(G.maxZoomLevel<E))||((this.map.maxZoomLevel)&&this.map.maxZoomLevel<E)){B=false}if(B){this._ajoutLogo(G.logo,G.url,G.pictureUrl)}}}}},_ajoutLogo:function(F,C,E){if(this._listeLogos[F]==null){var B=document.createElement("div");this.div.appendChild(B);this._listeLogos[F]=B;var G=OpenLayers.Util.createImage(null,null,new OpenLayers.Size(this.logoSize.w,this.logoSize.h),E?E:this.logoPrefix+F+this.logoSuffix,null,null,null,false);if(C!=null){var D=document.createElement("a");if(C.match(/^javascript:/)){D.setAttribute("href","#");D.setAttribute("onclick",C)}else{D.setAttribute("href",C);D.setAttribute("target","_blank")}D.appendChild(G);B.appendChild(D)}else{B.appendChild(G)}}else{this._listeLogos[F].style.display=""}},setMap:function(){Geoportal.Control.prototype.setMap.apply(this,arguments);this.map.events.register("addlayer",this,this.redraw);this.map.events.register("changelayer",this,this.redraw);this.map.events.register("removelayer",this,this.redraw);this.map.events.register("zoomend",this,this.redraw)},changeLogoSize:function(K){var I=null;if(typeof (K)=="number"){I=new OpenLayers.Size(K,K)}else{I=K.clone()}this.logoSize=I;var E=this.map.layers;for(var F=0,J=E.length;F<J;F++){var H=E[F];if(H.originators!=null){for(var C=0,G=H.originators.length;C<G;C++){var B=H.originators[C];if(this._listeLogos[B.logo]!=null){var D=this._listeLogos[B.logo].firstChild;if(D){if(D.firstChild){D=D.firstChild}if(D){D.style.width=this.logoSize.w+"px";D.style.height=this.logoSize.h+"px"}}}}}}I=null},CLASS_NAME:"Geoportal.Control.Logo"});Geoportal.Control.Logo.WHSizes={normal:50,mini:30};Geoportal.Control.Panel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,[B]);this.controls=[]},destroy:function(){for(var B=this.controls.length-1;B>=0;B--){if(this.controls[B].events){this.controls[B].events.un({activate:this.redraw,deactivate:this.redraw,scope:this})}if(!this.controls[B].panel_div&&this.div&&this.div.childNodes.length>0){this.controls[B].panel_div=this.div.removeChild(this.div.childNodes[0])}if(this.controls[B].panel_div){OpenLayers.Event.stopObservingElement(this.controls[B].panel_div)}this.controls[B].panel_div=null;this.controls[B]=null}this.controls=[];Geoportal.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){if(this.map){this.map.events.on({controlactivated:this.onActivateControl,scope:this})}if(this.defaultControl!=undefined){for(var C=0,B=this.controls.length;C<B;C++){if(this.controls[C]==this.defaultControl){this.controls[C].activate()}}}this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var C=0,B=this.controls.length;C<B;C++){this.controls[C].deactivate()}if(this.map){this.events.un({controlactivated:this.onActivateControl,scope:this})}return true}else{return false}},redraw:function(){if(this.active){for(var D=0,B=this.controls.length;D<B;D++){var E=this.controls[D];if(!E.panel_div){if(this.div.childNodes.length>0){E.panel_div=this.div.removeChild(this.div.childNodes[0])}else{E.panel_div=null}}var C=E.panel_div;if(C!=null){if(E.active){C.className=E.displayClass+"ItemActive"}else{C.className=E.displayClass+"ItemInactive"}if(C.parentNode){C=C.parentNode.removeChild(C)}this.div.appendChild(C)}E.panel_div=null}this.div.style.display="block"}},onActivateControl:function(C){for(var D=0,B=this.controls.length;D<B;D++){var E=this.controls[D];if(E==C.control){continue}if(E.type==OpenLayers.Control.TYPE_BUTTON){continue}if(E.type==OpenLayers.Control.TYPE_TOGGLE&&(E instanceof Geoportal.Control.PanelToggle)){continue}E.deactivate()}return true},CLASS_NAME:"Geoportal.Control.Panel"});Geoportal.Control.PermanentLogo=OpenLayers.Class(Geoportal.Control,{permaLogo:null,permaURL:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,arguments);if(!this.permaLogo){this.permaLogo=Geoportal.Util.getImagesLocation()+"logo_gp.gif"}if(!this.permaURL){this.permaURL="http://www.geoportail.fr/"}},destroy:function(){this.map.events.unregister("changebaselayer",this,this.changeBaseLayer);this.map.events.unregister("preaddlayer",this,this.isGeoportalLayer);Geoportal.Control.prototype.destroy.apply(this,arguments)},draw:function(C){Geoportal.Control.prototype.draw.apply(this,arguments);var D=OpenLayers.Util.createImage(null,null,null,this.permaLogo,null,null,null,false);if(this.permaURL!=null){var B=document.createElement("a");B.setAttribute("href",this.permaURL);B.setAttribute("target","_blank");B.appendChild(D);this.div.appendChild(B)}else{this.div.appendChild(D)}if(this.hasGeoportalLayers()){this.div.style.display="block"}else{this.div.style.display="none"}return this.div},isGeoportalLayer:function(B){if(!(this.div.style.display=="none")){return }if(!B){return }if(!B.layer){return }var C=B.layer;if(C.isBaseLayer){return }if(!C.visibility){return }if(C.GeoRM&&(C.GeoRM instanceof Geoportal.GeoRMHandler.Updater)){this.div.style.display="block"}},hasGeoportalLayers:function(){if(!this.map){return false}for(var D=0,B=this.map.layers.length;D<B;D++){var C=this.map.layers[D];if(!C.visibility){continue}if(C.GeoRM&&(C.GeoRM instanceof Geoportal.GeoRMHandler.Updater)){return true}}return(this.map.layers.length==0)},setMap:function(){Geoportal.Control.prototype.setMap.apply(this,arguments);this.map.events.register("preaddlayer",this,this.isGeoportalLayer);this.map.events.register("changebaselayer",this,this.changeBaseLayer)},changeBaseLayer:function(B){if(this.hasGeoportalLayers()){this.div.style.display="block"}else{this.div.style.display="none"}},CLASS_NAME:"Geoportal.Control.PermanentLogo"});Geoportal.Control.Projections=OpenLayers.Class(Geoportal.Control,{displayProjections:null,selectProjs:null,destroy:function(){if(this.map){this.map.events.unregister("changebaselayer",this,this.changeDisplayProjections);if(this.displayProjection.isUTMZoneProjection()){this.map.events.unregister("mousemove",this,this.updateDisplayProjections);this.map.events.unregister("moveend",this,this.updateDisplayProjections)}}if(this.selectProjs){OpenLayers.Event.stopObservingElement(this.selectProjs);this.selectProjs=null}this.displayProjections=null;Geoportal.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.prototype.setMap.apply(this,arguments);this.map.events.register("changebaselayer",this,this.changeDisplayProjections)},changeDisplayProjections:function(C){if(!C){return }if(this.map&&this.map.baseLayer){if(this.map.baseLayer.allowedDisplayProjections){this.displayProjections=this.map.baseLayer.allowedDisplayProjections.slice(0)}else{if(this.map.baseLayer.displayProjection){this.displayProjections=[this.map.baseLayer.displayProjection]}else{this.displayProjections=[this.map.getProjection()]}}for(var D=0,B=this.displayProjections.length;D<B;D++){var E=this.displayProjections[D];if(typeof (E)=="string"){this.displayProjections[D]=new OpenLayers.Projection(E)}}this.redraw()}},updateDisplayProjections:function(B){if(this.displayProjection.isUTMZoneProjection()){this.updateMGRS(B);return }return },updateMGRS:function(B){var C=null;if(B==null||B.xy==undefined){C=this.map.getCenter();if(!C){C=new OpenLayers.LonLat(0,0)}}else{C=this.map.getLonLatFromPixel(B.xy)}if(!C){return }C.transform(this.map.getProjection(),OpenLayers.Projection.CRS84);if(!this.displayProjection.domainOfValidity.containsLonLat(C)){var D=this.lookupUTMZone(C);if(D!=null){this.displayProjection=D;this.map.displayProjection=D;this.map.events.triggerEvent("changedisplayprojection",{displayProjection:D})}}},redraw:function(){if(this.div!=null){this.div.innerHTML=""}this.draw()},draw:function(C){Geoportal.Control.prototype.draw.apply(this,arguments);var D=document.createElement("form");D.id="__fslpj__"+this.id;D.name=D.id;D.action="javascript:void(null)";this.selectProjs=document.createElement("select");this.selectProjs.id="__slpj__"+this.id;this.selectProjs.name=this.selectProjs.id;this.selectProjs.className="gpSelectProjections";D.appendChild(this.selectProjs);var E=false;for(var B=0,H=this.displayProjections.length;B<H;B++){var G=this.displayProjections[B];if(G.isUTMZoneProjection()){E=true;continue}var F=document.createElement("option");F.value=B;F.appendChild(document.createTextNode(G.getTitle()));this.selectProjs.appendChild(F)}if(E){var F=document.createElement("option");F.value=Geoportal.Control.Projections.MGRS_UTM;F.appendChild(document.createTextNode(OpenLayers.i18n("utm.zone")));this.selectProjs.appendChild(F)}this.selectProjs.hasFocus=false;this.selectProjs.kbControl=this.map.getControlsByClass(OpenLayers.Control.KeyboardDefaults.prototype.CLASS_NAME)[0];if(this.selectProjs.kbControl){OpenLayers.Event.observe(this.selectProjs,"click",OpenLayers.Function.bind(this.onProjectionClick,this,this.selectProjs))}OpenLayers.Event.observe(this.selectProjs,"change",OpenLayers.Function.bind(this.onProjectionChange,this,this.selectProjs));this.div.appendChild(D);return this.div},onProjectionClick:function(C,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(C.kbControl){if(C.kbControl.active){C.kbControl.deactivate()}}C.hasFocus=true;C.focus()},onProjectionChange:function(D,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(D.options[D.selectedIndex].value!=Geoportal.Control.Projections.MGRS_UTM){if(this.displayProjection.isUTMZoneProjection()){this.map.events.unregister("mousemove",this,this.updateDisplayProjections);this.map.events.unregister("moveend",this,this.updateDisplayProjections)}this.displayProjection=this.displayProjections[D.options[D.selectedIndex].value]}else{var C=this.lookupUTMZone(this.map.getCenter().transform(this.map.getProjection(),OpenLayers.Projection.CRS84));if(C!=null){if(!this.displayProjection.isUTMZoneProjection()){this.map.events.register("mousemove",this,this.updateDisplayProjections);this.map.events.register("moveend",this,this.updateDisplayProjections)}this.displayProjection=C}}this.map.displayProjection=this.displayProjection;this.map.events.triggerEvent("changedisplayprojection",{displayProjection:this.displayProjection});if(D.kbControl){if(!D.kbControl.active){D.kbControl.activate()}}D.hasFocus=false;D.blur()},setDisplayProjection:function(E){if(!this.selectProjs){return }if(typeof (E)=="string"){E=new OpenLayers.Projection(E);if(E==null){return }}var G=null,F=-1,I=null,D=E.getCode(),C=E.isUTMZoneProjection();for(var B=0,H=this.displayProjections.length;B<H;B++){I=this.displayProjections[B];if(D==I.getCode()){F=B;break}}if(F==-1){return }if(C){F=Geoportal.Control.Projections.MGRS_UTM}else{F=""+F}for(var B=0,H=this.selectProjs.options.length;B<H;B++){G=this.selectProjs.options[B];if(G.value==F){if(this.selectProjs.selectedIndex==B){return }this.selectProjs.selectedIndex=B;this.onProjectionChange(this.selectProjs);return }}},lookupUTMZone:function(B){for(var C=0,E=this.displayProjections.length;C<E;C++){var D=this.displayProjections[C];if(!D.isUTMZoneProjection()){continue}if(D.domainOfValidity.containsLonLat(B)){return D}}return null},changeLang:function(C){if(this.selectProjs){for(var D=0,B=this.selectProjs.options.length;D<B;D++){var E=this.selectProjs.options[D];if(E.value!=Geoportal.Control.Projections.MGRS_UTM){E.innerHTML=this.displayProjections[E.value].getTitle()}}}},updateSize:function(){if(this.div.parentNode){var D=Geoportal.Util.getComputedStyle(this.div.parentNode,"width",true);if(!D){return }var B=Geoportal.Util.getComputedStyle(this.selectProjs,"width",true);if(!B){return }var C=B/D;if(C>1){C/=C}this.div.style.left=(100*(C<0.35?0.35:C)).toFixed(0)+"%";this.redraw()}},CLASS_NAME:"Geoportal.Control.Projections"});Geoportal.Control.Projections.MGRS_UTM="__MGRS_UTM__";Geoportal.Control.RemoveLayer=OpenLayers.Class(Geoportal.Control,{type:OpenLayers.Control.TYPE_BUTTON,layer:null,removable:false,initialize:function(C,B){Geoportal.Control.prototype.initialize.apply(this,[B]);this.layer=C;this.removable=this.layer.view&&this.layer.view.drop;if(!this.removable){this.displayClass="gpControlRemoveLayerNone";if(this.div){this.div.title="";if(this.panel_div){this.panel_div.title=this.div.title}}}},trigger:function(){if(this.removable&&this.layer&&this.layer.map){this.layer.map.removeLayer(this.layer)}},changeLang:function(B){if(this.removable){this.div.title=OpenLayers.i18n(this.displayClass+".title");if(this.panel_div){this.panel_div.title=this.div.title}}},CLASS_NAME:"Geoportal.Control.RemoveLayer"});Geoportal.Control.SliderBase=OpenLayers.Class(Geoportal.Control,{axis:"vertical",isVertical:true,levelBarImgWidth:0,levelBarImgHeight:0,levelBarImg:null,levelBarIntervalLength:0,levelBarDiv:null,levelBarDivEvents:null,sliderImgWidth:0,sliderImgHeight:0,sliderImg:null,slider:null,sliderEvents:null,sliderTopLeft:"top",initialLevel:Number.NaN,getLevel:function(){return -1},getMaxAbsoluteLevels:function(){return -1},getMinSelectableLevel:function(){return 0},getMaxSelectableLevel:function(){return this.getMaxAbsoluteLevels()-1},onDraw:function(B){},onSliderMove:function(B){},downEventStart:null,initialize:function(){Geoportal.Control.prototype.initialize.apply(this,arguments);if(this.axis=="horizontal"){this.sliderTopLeft="left"}this.isVertical=this.axis=="vertical"},destroy:function(){if(this.div){if(this.slider){if(this.slider.parentNode){this.slider.parentNode.removeChild(this.slider)}this.slider=null}if(this.levelBarDiv){if(this.levelBarDiv.parentNode){this.levelBarDiv.parentNode.removeChild(this.levelBarDiv)}this.levelBarDiv=null}this.div=null}if(this.sliderEvents){this.sliderEvents.destroy();this.sliderEvents=null}if(this.levelBarDivEvents){this.levelBarDivEvents.destroy();this.levelBarDivEvents=null}Geoportal.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.prototype.setMap.apply(this,arguments);if(!this.isVertical){if(this.getMaxAbsoluteLevels()>1){this.levelBarIntervalLength=this.levelBarImgWidth/(this.getMaxAbsoluteLevels()-1)}else{this.levelBarIntervalLength=this.levelBarImgWidth}}else{if(this.getMaxAbsoluteLevels()>1){this.levelBarIntervalLength=this.levelBarImgHeight/(this.getMaxAbsoluteLevels()-1)}else{this.levelBarIntervalLength=this.levelBarImgHeight}}},redraw:function(){if(this.div!=null){this.div.innerHTML=""}this.draw(this.position)},draw:function(D){Geoportal.Control.prototype.draw.apply(this,arguments);var C=null;if(!D){C=new OpenLayers.Pixel(0,0)}else{C=D.clone()}var F=new OpenLayers.Size();if(this.isVertical){F.w=this.levelBarImgWidth;F.h=this.levelBarIntervalLength*(this.getMaxAbsoluteLevels()-1)}else{F.w=this.levelBarIntervalLength*(this.getMaxAbsoluteLevels()-1);F.h=this.levelBarImgHeight}var E=OpenLayers.Util.createUniqueID("SliderBase");this.levelBarDiv=OpenLayers.Util.createDiv(E,C,F,this.levelBarImg,"relative",null,null,null);this.levelBarDiv.style.backgroundRepeat="no-repeat";this.levelBarDiv.appendChild(document.createTextNode(" "));this.levelBarDivEvents=new OpenLayers.Events(this,this.levelBarDiv,null,true,{includeXY:true});this.levelBarDivEvents.on({mousedown:this.singleClick,mousemove:this.passEventToSlider,dblclick:this.doubleClick,click:this.doubleClick});this.div.appendChild(this.levelBarDiv);F.w=this.sliderImgWidth;F.h=this.sliderImgHeight;var G;if(isNaN(this.initialLevel)){G=this.getLevel()}else{G=this.initialLevel;this.initialLevel=Number.NaN}if(this.isVertical){C=C.add(-Math.round(C.x/2),this.levelToPos(G))}else{C=C.add(this.levelToPos(G),-Math.round(C.y/2))}var B=OpenLayers.Util.createUniqueID("SliderBaseHandle");this.slider=OpenLayers.Util.createAlphaImageDiv(B,C,F,this.sliderImg,"absolute");if(this.isVertical){this.slider.style.position="relative"}this.sliderEvents=new OpenLayers.Events(this,this.slider,null,true,{includeXY:true});this.sliderEvents.on({mousedown:this.sliderDown,mousemove:this.sliderDrag,mouseup:this.sliderUp,dblclick:this.doubleClick,click:this.doubleClick});this.div.appendChild(this.slider);this.onDraw(G);return this.div},passEventToSlider:function(B){this.sliderEvents.handleBrowserEvent(B)},doubleClick:function(B){OpenLayers.Event.stop(B);return false},singleClick:function(B){},sliderDown:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }this.map.events.on({mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this});this.mouseDragStart=B.xy.clone();this.downEventStart=B.xy.clone();this.div.style.cursor="move";OpenLayers.Event.stop(B)},sliderDrag:function(B){},sliderUp:function(B){},moveSlider:function(){var C=this.getLevel();var B=this.levelToPos(C);this.updateSlider(B);this.onSliderMove(C)},levelToPos:function(C){var B=0;if(this.isVertical){B=(C-this.getMaxAbsoluteLevels()+1)*this.levelBarIntervalLength;B-=this.sliderImgHeight/2}else{B=(C)*this.levelBarIntervalLength;B-=this.sliderImgWidth/2}return B},posToLevel:function(B){var C=0;if(this.isVertical){C=B+this.sliderImgHeight/2;C=Math.floor((C/this.levelBarIntervalLength)+this.getMaxAbsoluteLevels()-1)}else{C=B+this.sliderImgWidth/2;C=Math.floor((C/this.levelBarIntervalLength))}C=this.adjustLevel(C);return C},adjustLevel:function(C){var B=Math.min(Math.max(C,this.getMinSelectableLevel()),this.getMaxSelectableLevel());return B},updateSlider:function(B){this.slider.style[this.sliderTopLeft]=B+"px"},CLASS_NAME:"Geoportal.Control.SliderBase"});Geoportal.Control.ToolBox=OpenLayers.Class(Geoportal.Control,{containDiv:null,labelDivID:null,tbxContent:null,usersContent:null,ovmContent:null,minimizeDiv:null,maximizeDiv:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,[B])},destroy:function(){OpenLayers.Event.stopObservingElement(this.div);if(!this.outsideViewport){OpenLayers.Event.stopObservingElement(this.minimizeDiv);OpenLayers.Event.stopObservingElement(this.maximizeDiv)}Geoportal.Control.prototype.destroy.apply(this,arguments)},loadContents:function(){OpenLayers.Event.observe(this.div,"dblclick",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop));OpenLayers.Event.observe(this.div,"click",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop));OpenLayers.Event.observe(this.div,"mousedown",OpenLayers.Function.bindAsEventListener(this.mouseDown,this));OpenLayers.Event.observe(this.div,"mousemove",OpenLayers.Function.bindAsEventListener(OpenLayers.Event.stop));OpenLayers.Event.observe(this.div,"mouseup",OpenLayers.Function.bindAsEventListener(this.mouseUp,this));var H=this.createInnerDiv(OpenLayers.Util.createUniqueID("toolbox"),"gpToolBoxClass",this.div);var G;if(!this.outsideViewport){this.labelDivID=OpenLayers.Util.createUniqueID("nameOfBox");G=this.createInnerDiv(this.labelDivID,"gpControlLabelClass",H,"<center>"+OpenLayers.i18n(this.displayClass+".label")+"</center>")}G=this.createInnerDiv(OpenLayers.Util.createUniqueID("contenuTools"),"gpToolBoxContentContainer",H);this.tbxContent=this.createInnerDiv(null,"gpToolBoxContent",G);var E=this.createInnerDiv(this.id+"_navbar","gpControlNavToolbar",this.tbxContent);E=this.createInnerDiv(this.id+"_measure","gpControlMeasureToolbar",this.tbxContent);E.style.display="none";E=this.createInnerDiv(this.id+"_search","gpControlSearchToolbar",this.tbxContent);E.style.display="none";E=this.createInnerDiv(this.id+"_addlyr","gpControlLayerToolbar",this.tbxContent);E.style.display="none";E=this.createInnerDiv(this.id+"_zoombar","gpZoomBarClass",this.tbxContent);E=this.createInnerDiv(this.id+"_meares","gpControlMeasureToolbarResult",this.tbxContent);E.style.display="none";this.usersContent=this.createInnerDiv(this.id+"_userctrls","gpToolBoxUsersControlsContainer",this.tbxContent);this.ovmContent=this.createInnerDiv(this.id+"_ovmap","olControlOverviewMap",G);if(!this.outsideViewport){var I=Geoportal.Util.getImagesLocation();var B=new OpenLayers.Size(11,11);this.containDiv=this.div.firstChild.childNodes[1];var C=I+"ico_win_plus.gif";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("Geoportal_ToolBox_MaximizeDiv",null,B,C,"absolute");this.maximizeDiv.style.top="3px";this.maximizeDiv.style.right="80%";this.maximizeDiv.style.left="";this.maximizeDiv.style.display="none";this.maximizeDiv.style.cursor="pointer";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));OpenLayers.Event.observe(this.maximizeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));this.div.appendChild(this.maximizeDiv);var F=I+"ico_win_moins.gif";var D=new OpenLayers.Size(11,11);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("Geoportal_ToolBox_MinimizeDiv",null,D,F,"absolute");this.minimizeDiv.style.top="3px";this.minimizeDiv.style.right="80%";this.minimizeDiv.style.left="";this.minimizeDiv.style.display="none";this.minimizeDiv.style.cursor="pointer";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));OpenLayers.Event.observe(this.minimizeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));this.div.appendChild(this.minimizeDiv)}},createControlAnchor:function(D,C){var B=null;if(this.usersContent){B=this.createInnerDiv(D,C,this.tbxContent);this.usersContent.appendChild(B)}return B},createInnerDiv:function(F,E,C,B){var D=document.createElement("div");if(F){D.id=F}if(E==null){E=""}D.className=E+" olControlNoSelect";D.setAttribute("unselectable","on",0);D.onselectstart=function(){return(false)};if(B){D.innerHTML=B}C.appendChild(D);return D},redraw:function(){return this.div},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.loadContents();if(!this.outsideViewport){this.minimizeControl()}return this.div},maximizeControl:function(B){this.showControls(false);if(B!=null){OpenLayers.Event.stop(B)}},dblClick:function(B){if(B!=null){OpenLayers.Event.stop(B)}},minimizeControl:function(B){this.showControls(true);if(B!=null){OpenLayers.Event.stop(B)}},showControls:function(B){this.maximizeDiv.style.display=B?"block":"none";this.minimizeDiv.style.display=B?"none":"block";this.containDiv.style.display=B?"none":"block"},mouseDown:function(B){this.isMouseDown=true;OpenLayers.Event.stop(B)},mouseUp:function(B){if(this.isMouseDown){this.isMouseDown=false;OpenLayers.Event.stop(B)}},changeLang:function(B){var C=OpenLayers.Util.getElement(this.labelDivID);if(C){C.innerHTML="<center>"+OpenLayers.i18n(this.displayClass+".label")+"</center>"}},CLASS_NAME:"Geoportal.Control.ToolBox"});Geoportal.Control.ZoomToLayerMaxExtent=OpenLayers.Class(Geoportal.Control,{type:OpenLayers.Control.TYPE_BUTTON,visible:true,layer:null,zoomable:false,initialize:function(C,B){Geoportal.Control.prototype.initialize.apply(this,[B]);this.layer=C;this.zoomable=this.layer.view&&this.layer.view.zoomToExtent;if(!this.zoomable){this.displayClass="gpControlZoomToLayerMaxExtentNone";if(this.div){this.div.title="";if(this.panel_div){this.panel_div.title=this.div.title}}}},trigger:function(){if(this.zoomable&&this.layer&&this.layer.inRange&&this.layer.map){var B=this.layer.getDataExtent();if(B){if(B.getWidth()==0||B.getHeight()==0){this.layer.map.zoomTo(this.layer.minZoomLevel)}else{this.layer.map.zoomToExtent(B,true)}}}},changeLang:function(B){if(this.zoomable){this.div.title=OpenLayers.i18n(this.displayClass+".title");if(this.panel_div){this.panel_div.title=this.div.title}}},CLASS_NAME:"Geoportal.Control.ZoomToLayerMaxExtent"});Geoportal.Format.GPX=OpenLayers.Class(Geoportal.Format,OpenLayers.Format.XML,{defaultVersion:"1.0",version:null,parser:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B])},read:function(D){if(typeof D=="string"){D=OpenLayers.Format.XML.prototype.read.apply(this,[D])}if(!D){return null}var C=D.nodeType==9?D.documentElement:D;var B=this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=B){var E=Geoportal.Format.GPX["v"+B.replace(/\./g,"_")];if(!E){throw OpenLayers.i18n("GPX.version",{gpxVersion:B})}this.parser=new E(this.options)}return this.parser.read(C)},write:function(D,C){var B=(C&&C.version)||this.version||this.defaultVersion;if(!this.parser||this.parser.VERSION!=B){var E=Geoportal.Format.GPX["v"+B.replace(/\./g,"_")];if(!E){throw OpenLayers.i18n("GPX.version",{gpxVersion:B})}this.parser=new E(this.options)}return this.parser.write(D,C)},CLASS_NAME:"Geoportal.Format.GPX"});Geoportal.Format.GPX.v1=OpenLayers.Class(Geoportal.Format,OpenLayers.Format.XML,{gpxns:null,creator:null,extractWaypoints:true,extractTracks:true,extractRoutes:true,extractAttributes:true,handleHeight:false,regExes:{trimSpace:(/^\s*|\s*$/g),removeSpace:(/\s*/g),splitSpace:(/\s+/),trimComma:(/\s*,\s*/g)},initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);if(!this.externalProjection){this.externalProjection=new OpenLayers.Projection("EPSG:4326",{domainOfVaditity:new OpenLayers.Bounds(-180,-90,180,90)})}else{if(typeof (this.externalProjection)=="string"){this.externalProjection=new OpenLayers.Projection(this.externalProjection,{domainOfVaditity:new OpenLayers.Bounds(-180,-90,180,90)})}}},read:function(C){var B={};return this.parseData(C,B)},parseData:function(F,J){var C=[];this.version=F.getAttribute("version");this.creator=F.getAttribute("creator");var H=["trk","rte","wpt"];for(var G=0,E=H.length;G<E;++G){var I=H[G];var B=this.getElementsByTagNameNS(F,"*",I);if(B.length==0){continue}var D=[];switch(I.toLowerCase()){case"trk":if(this.extractTracks){D=this.parseTracks(B,J)}break;case"rte":if(this.extractRoutes){D=this.parseRoutes(B,J)}break;case"wpt":if(this.extractWaypoints){D=this.parseWayPoints(B,J)}break;default:break}if(D.length>0){C=C.concat(D)}}return C},parseTracks:function(B,M){var E=[];for(var J=0,F=B.length;J<F;J++){var C=B[J];var I={};if(this.extractAttributes){I=this.parseAttributes(C.childNodes,"trk")}var D=this.getElementsByTagNameNS(C,C.namespaceURI,"trkseg");for(var H=0,G=D.length;H<G;H++){var K=this.extractSegment(D[H],"trkpt");var L=new OpenLayers.Feature.Vector(K,I,this.style);if(L){E.push(L)}else{}}}return E},parseRoutes:function(B,J){var D=[];for(var G=0,E=B.length;G<E;G++){var C=B[G];var F={};if(this.extractAttributes){F=this.parseAttributes(C.childNodes,"rte")}var H=this.extractSegment(C,"rtept");var I=new OpenLayers.Feature.Vector(H,F,this.style);if(I){D.push(I)}else{}}return D},parseWayPoints:function(B,J){var C=[];for(var G=0,E=B.length;G<E;G++){var D=B[G];var F={};if(this.extractAttributes){F=this.parseAttributes(D.childNodes,"wpt")}var H=new OpenLayers.Geometry.Point(D.getAttribute("lon"),D.getAttribute("lat"));H.transform(this.externalProjection,this.internalProjection);var I=new OpenLayers.Feature.Vector(H,F,this.style);if(I){C.push(I)}else{}}return C},extractSegment:function(G,H){var F=this.getElementsByTagNameNS(G,G.namespaceURI,H);var C=[];for(var E=0,D=F.length;E<D;E++){var B=new OpenLayers.Geometry.Point(F[E].getAttribute("lon"),F[E].getAttribute("lat"));C.push(B)}var I=new OpenLayers.Geometry.LineString(C);I.transform(this.externalProjection,this.internalProjection);return I},parseAttributes:function(D,J){var G={};G.typeName=J;for(var F=0,H=D.length;F<H;F++){var I=D[F];if(I.nodeType==1){var C=I.nodeName;if(I.childNodes.length>0){for(var E=0,B=I.childNodes.length;E<B;E++){if((I.childNodes[E].nodeType==3&&B==1)||I.childNodes[E].nodeType==4){var K=I.childNodes[E].nodeValue.replace(this.regExes.trimSpace,"");G[C]=K;break}}}}}return G},write:function(E,C){if(!(E instanceof Array)){E=[E]}var G=this.createElementNS(this.gpxns,"gpx");if(!this.version){this.version=this.VERSION}G.setAttribute("version",this.version);if(!this.creator){this.creator=this.CLASS_NAME}G.setAttribute("creator",this.creator);for(var D=0,B=E.length;D<B;++D){var F=this.createFeatureXML(E[D]);if(F){G.appendChild(F)}}return OpenLayers.Format.XML.prototype.write.apply(this,[G])},createFeatureXML:function(B){this.featureToSerialize=B;if(!this.featureToSerialize.attributes.name){this.featureToSerialize.attributes.name=this.featureToSerialize.fid}var C=this.buildGeometryNode(B.geometry);this.featureToSerialize=null;return C},buildGeometryNode:function(E){E=E.clone();E.transform(this.internalProjection,this.externalProjection);var D=E.CLASS_NAME;var C=D.substring(D.lastIndexOf(".")+1);var B=this.buildGeometry[C.toLowerCase()];return B.apply(this,[E])},buildGeometry:{point:function(G){var B=this.featureToSerialize.attributes.typeName||this.featureToSerialize.layer.options.typename;if(B==undefined){B="wpt"}var F=this.createElementNS(this.gpxns,B);this.buildCoordinatesAttributes(F,G);for(var E in this.featureToSerialize.attributes){var C=this.createElementNS(this.gpxns,E);var D=this.featureToSerialize.attributes[E];C.appendChild(this.createTextNode(D));F.appendChild(C)}return F},multipoint:function(B){return this.buildGeometry.point.apply(this,[B.components[0]])},linestring:function(J){var L=this.featureToSerialize.attributes.typeName||this.featureToSerialize.layer.options.typename;if(L==undefined){L="trk"}var C=this.createElementNS(this.gpxns,L);for(var K in this.featureToSerialize.attributes){var H=this.createElementNS(this.gpxns,K);var G=this.featureToSerialize.attributes[K];H.appendChild(this.createTextNode(G));C.appendChild(H)}var B="pt";switch(this.featureToSerialize.attributes.typeName){case"trk":C.appendChild(this.createElementNS(this.gpxns,"trkseg"));B="trkpt";break;case"rte":B="rtept";break;default:break}for(var F=0,D=J.components.length;F<D;F++){var I=J.components[F];var E=this.createElementNS(this.gpxns,B);this.buildCoordinatesAttributes(E,I);C.appendChild(E)}return C},multilinestring:function(B){return this.buildGeometry.linestring.apply(this,[B.components[0]])},linearring:function(B){return null},polygon:function(B){return this.buildGeometry.linestring.apply(this,[B.components[0]])},multipolygon:function(B){return this.buildGeometry.polygon.apply(this,[B.components[0]])}},buildCoordinatesAttributes:function(E,F){var D=F.components?F.components:[F];for(var C=0,B=D.length;C<B;C++){E.setAttribute("lat",OpenLayers.String.sprintf("%.6f",D[C].y));E.setAttribute("lon",OpenLayers.String.sprintf("%.6f",D[C].x))}},CLASS_NAME:"Geoportal.Format.GPX.v1"});Geoportal.Format.Geoconcept=OpenLayers.Class(Geoportal.Format,{SUPPORTED_CRSS:[{Type:1,TimeZone:null,projCode:["EPSG:27572","EPSG:27582","IGNF:LAMBE"]},{Type:2,TimeZone:null,projCode:["EPSG:27561","IGNF:LAMB1"]},{Type:3,TimeZone:null,projCode:["EPSG:27562","IGNF:LAMB2"]},{Type:4,TimeZone:null,projCode:["EPSG:27563","IGNF:LAMB3"]},{Type:5,TimeZone:null,projCode:["EPSG:27564","IGNF:LAMB4"]},{Type:13,TimeZone:null,projCode:["EPSG:3785","EPSG:900913"]},{Type:15,TimeZone:1,projCode:["EPSG:2988","IGNF:WALL78UTM1S"]},{Type:15,TimeZone:5,projCode:["EPSG:2977","IGNF:TAHAAUTM05S"]},{Type:15,TimeZone:6,projCode:["EPSG:3305","IGNF:MOOREA87U6S"]},{Type:15,TimeZone:6,projCode:["EPSG:3304","IGNF:TAHI79UTM6S"]},{Type:15,TimeZone:7,projCode:["EPSG:2978","EPSG:3302","IGNF:NUKU72U7S","IGNF:IGN63UTM7S"]},{Type:15,TimeZone:38,projCode:["EPSG:2980","IGNF:MAYO50UTM38S"]},{Type:15,TimeZone:39,projCode:["EPSG:32739","IGNF:UTM39SW84"]},{Type:15,TimeZone:42,projCode:["EPSG:32742","IGNF:UTM42SW84"]},{Type:15,TimeZone:43,projCode:["EPSG:32743","IGNF:UTM43SW84"]},{Type:15,TimeZone:58,projCode:["EPSG:32758","IGNF:IGN72UTM58S"]},{Type:17,TimeZone:20,projCode:["EPSG:2973","EPSG:2970","EPSG:2969","IGNF:MART38UTM20","IGNF:GUAD48UTM20","IGNF:GUADFM49U20"]},{Type:17,TimeZone:21,projCode:["EPSG:2987","IGNF:STPM50UTM21"]},{Type:17,TimeZone:22,projCode:["EPSG:2971","IGNF:CSG67UTM22"]},{Type:101,TimeZone:null,projCode:["EPSG:4326","CRS:84","IGNF:WGS84G"]},{Type:102,TimeZone:null,projCode:["IGNF:ED50G"]},{Type:105,TimeZone:null,projCode:["IGNF:NTFP"]},{Type:107,TimeZone:null,projCode:["IGNF:WGS72G"]},{Type:222,TimeZone:null,projCode:["IGNF:MILLER"]},{Type:501,TimeZone:null,projCode:["EPSG:32620","IGNF:RRAFGUADU20"]},{Type:502,TimeZone:null,projCode:["EPSG:32620","IGNF:RRAFMARTU20"]},{Type:503,TimeZone:null,projCode:["EPSG:32740","IGNF:RGM04UTM38S"]},{Type:504,TimeZone:null,projCode:["EPSG:2975","IGNF:RGR92UTM40S"]},{Type:505,TimeZone:null,projCode:["EPSG:2972","IGNF:UTM22RGFG95"]},{Type:506,TimeZone:null,projCode:["EPSG:32701","IGNF:UTM01SWG84"]},{Type:507,TimeZone:null,projCode:["EPSG:32621","IGNF:RGSPM06U21"]},{Type:508,TimeZone:null,projCode:["EPSG:3296","IGNF:RGPFUTM5S"]},{Type:509,TimeZone:null,projCode:["EPSG:3297","IGNF:RGPFUTM6S"]},{Type:510,TimeZone:null,projCode:["EPSG:3298","IGNF:RGPFUTM7S"]},{Type:511,TimeZone:null,projCode:["IGNF:CROZ63UTM39S"]},{Type:513,TimeZone:null,projCode:["IGNF:RGNCUTM57S"]},{Type:514,TimeZone:null,projCode:["IGNF:RGNCUTM58S"]},{Type:515,TimeZone:null,projCode:["IGNF:RGNCUTM59S"]},{Type:516,TimeZone:null,projCode:["IGNF:KERG62UTM42S"]},{Type:520,TimeZone:null,projCode:["IGNF:REUN47GAUSSL"]},{Type:1002,TimeZone:null,projCode:["EPSG:27571","IGNF:LAMB1C"]},{Type:1003,TimeZone:null,projCode:["EPSG:27572","IGNF:LAMB2C"]},{Type:1004,TimeZone:null,projCode:["EPSG:27573","IGNF:LAMB3C"]},{Type:1005,TimeZone:null,projCode:["EPSG:27574","IGNF:LAMB4C"]},{Type:1006,TimeZone:null,projCode:["EPSG:2154","IGNF:LAMB93"]},{Type:1007,TimeZone:null,projCode:["IGNF:RGNCLAM"]},{Type:2501,TimeZone:null,projCode:["IGNF:RGF93CC42"]},{Type:2502,TimeZone:null,projCode:["IGNF:RGF93CC43"]},{Type:2503,TimeZone:null,projCode:["IGNF:RGF93CC44"]},{Type:2504,TimeZone:null,projCode:["IGNF:RGF93CC45"]},{Type:2505,TimeZone:null,projCode:["IGNF:RGF93CC46"]},{Type:2506,TimeZone:null,projCode:["IGNF:RGF93CC47"]},{Type:2507,TimeZone:null,projCode:["IGNF:RGF93CC48"]},{Type:2508,TimeZone:null,projCode:["IGNF:RGF93CC49"]},{Type:2509,TimeZone:null,projCode:["IGNF:RGF93CC50"]},{Type:2012,TimeZone:null,projCode:["IGNF:GEOPORTALFXX"]},{Type:2016,TimeZone:null,projCode:["IGNF:GEOPORTALANF"]},{Type:2017,TimeZone:null,projCode:["IGNF:GEOPORTALGUF"]},{Type:2018,TimeZone:null,projCode:["IGNF:GEOPORTALREU"]},{Type:2019,TimeZone:null,projCode:["IGNF:GEOPORTALMYT"]},{Type:2020,TimeZone:null,projCode:["IGNF:GEOPORTALSPM"]},{Type:2021,TimeZone:null,projCode:["IGNF:GEOPORTALNCL"]},{Type:2022,TimeZone:null,projCode:["IGNF:GEOPORTALWLF"]},{Type:2023,TimeZone:null,projCode:["IGNF:GEOPORTALPYF"]},{Type:2040,TimeZone:null,projCode:["IGNF:GEOPORTALCRZ"]},{Type:2042,TimeZone:null,projCode:["IGNF:GEOPORTALKER"]},{Type:5030,TimeZone:null,projCode:["IGNF:RGM04GEO"]},{Type:5031,TimeZone:null,projCode:["IGNF:RGFG95GEO"]}],separator:"\t",typename:null,subTypename:null,format:2,unit:"m",charset:"ANSI",dimensions:2,extractAttributes:true,maxFeatures:0,read:function(E){var C=[];var L=E.split("\n");var F,D,B,K,G;for(F=0,D=L.length;F<D;F++){var J=L[F];if(J.charAt(0)=="/"){K=L[F].indexOf(" ");if(K<0){B=J.substring(K).replace("\r","")}else{B=J.substring(0,K);G=J.substring(K).replace("\r","")}switch(B){case"//$DELIMITER":break;case"//$SYSCOORD":var H=parseInt(G.substring(G.indexOf(":")+1,G.indexOf("}")));H=this.findCRS(H,"Type");if(H!=-1){this.externalProjection=new OpenLayers.Projection(this.SUPPORTED_CRSS[H].projCode[0])}break;case"//$FORMAT":if(parseInt(G.substring(G.indexOf(":")+1).replace(/ /g,""))==1){this.format=1}break;case"//$UNIT":this.unit=G.substring(G.indexOf(":")+1).replace(/ /g,"");switch(G){case"Distance":this.unit=this.unit||"m";break;case"Angle":this.unit=this.unit||"d";break;default:this.unit="m";break}break;case"//$QUOTED-TEXT":this.quoted=!(G.replace(/"/g,"")=="no");break;case"//$CHARSET":this.charset=G.replace(/ /g,"");break;case"//$3DOBJECT":this.dimensions=3;break;case"//$FIELD":break;default:break}continue}var I=this.readFeature(J);if(I){C.push(I);if(this.maxFeatures>0&&this.maxFeatures==C.length){break}}else{}}return C},readFeature:function(F){var I=F.split(this.separator);if(I.length<7){return null}var E=this.parseAttributes(I);var K=parseInt(I[4])+5;var M;var N,L,J=null;N=parseFloat(I[K++]);L=parseFloat(I[K++]);if(this.dimensions==3){J=parseFloat(F[K++])}if(I.length<K+1){M=new OpenLayers.Geometry.Point(N,L);if(this.dimensions==3){M.z=J}M.transform(this.externalProjection,this.internalProjection);return new OpenLayers.Feature.Vector(M,E)}var C=true;var G=parseInt(I[K+2]);if(G*this.dimensions==I.length-K-3){K+=3}else{G=parseInt(F[K++]);C=false}var O=[];var B=new OpenLayers.Geometry.Point(N,L);if(this.dimensions==3){B.z=J}O.push(B);O=this.readComponent(I,O,K,G);if(C){M=new OpenLayers.Geometry.LineString(O)}else{var H=[];var D=new OpenLayers.Geometry.LinearRing(O);H.push(D);M=new OpenLayers.Geometry.Polygon(H)}M.transform(this.externalProjection,this.internalProjection);return new OpenLayers.Feature.Vector(M,E)},readComponent:function(D,F,G,B){var C=G+this.dimensions*B;if(C>data.length){return F}for(i=G;i<C;i+=dim){var E=new OpenLayers.Geometry.Point(parseFloat(data[i]),parseFloat(data[i+1]));if(this.dimensions==3){E.z=parseFloat(data[i+2])}F.push(E)}return F},parseAttributes:function(C){var E={id:C[0],type:C[1],stype:C[2],name:C[3]};var B=parseInt(C[4]);var D=Math.min(C.length,B);if(this.extractAttributes){for(var F=0;F<D;F++){if(attributs.lenght<F){E[attributs[F]]=C[5+F]}else{E["att"+F]=C[5+F]}}}return E},write:function(E){if(!(E instanceof Array)){E=[E]}var F='//$DELIMITER "tab"\n//$QUOTED-TEXT "no"\n//$CHARSET ANSI\n//$FORMAT 2\n//$UNIT ';var B=this.externalProjection;if(B&&B instanceof OpenLayers.Projection){if(B.getProjName()=="longlat"){F+="Angle:deg\n"}else{F+="Distance:m\n"}F+=this.writeCRS(B)}for(var D=0,C=E.length;D<C;D++){F+=this.writeFeature(E[D])}return F},writeCRS:function(B){var C=this.findCRS(B.projCode);var D="//$SYSCOORD {Type: ";if(C==-1){D+="-1"}else{D+=this.SUPPORTED_CRSS[C].Type;if(this.SUPPORTED_CRSS[C].TimeZone){D+=", TimeZone: "+this.SUPPORTED_CRSS[C].TimeZone}}D+="}\n";return D},writeFeature:function(B){var C="";C+="-1"+this.separator;C+=this.typename?this.typename:B.layer?B.layer.name||B.layer.CLASS_NAME:B.CLASS_NAME;C+=this.separator;C+=this.subTypename||B.geometry.CLASS_NAME.substring(B.geometry.CLASS_NAME.lastIndexOf(".")+1)+this.separator;C+=B.attributes&&B.attributes.name?B.attributes.name:B.layer&&B.layer.name?B.layer.name:B.CLASS_NAME;C+=this.separator;C+=this.writeAttributes(B.fid||B.id||"",B.attributes);C+=this.writeGeometry(B.geometry);return C+"\n"},writeAttributes:function(F,B){var E="";var D=1;if(B){for(var C in B){D++}}E+=D+this.separator;E+=feature.id+this.separator;if(B){for(var C in B){if(B.hasOwnProperty(C)){E+=B[C]?B[C].replace(/[\r\n]/g,"\\n"):"";E+=this.separator}}}return gtx},writeGeometry:function(E){E=E.clone();E.transform(this.internalProjection,this.externalProjection);var D=E.CLASS_NAME;var C=D.substring(D.lastIndexOf(".")+1);var B=this.buildGeometry[C.toLowerCase()];return B.apply(this,[E])},buildGeometry:{point:function(B){return this.buildCoordinates(B)},multipoint:function(B){return null},linestring:function(B){return this.buildCoordinates(B)},linearring:function(B){return this.buildCoordinates(B,true)},multilinestring:function(B){return null},polygon:function(F){var E="";var D=F.components;for(var C=0,B=D.length;C<B;++C){if(C>0){E+=this.separator}E=this.buildCoordinates(D[C],true);if(C==0){E+=this.separator+(B-1)+this.separator}}return E},multipolygon:function(H){var G="";for(var D=0,C=H.components.length;D<C;D++){if(D>0){G+=this.separator}var F=H.componentTypes[D];var E=F.substring(F.lastIndexOf(".")+1);var B=this.buildGeometry[E.toLowerCase()];G+=B.apply(this,[H.components[D]]);if(D==0){G+=this.separator+(C-1)+this.separator}}return G}},buildCoordinates:function(G,F){var E;var D=G.components;if(D){var B=D.length;if(F){B--}E=D[0].x+this.separator+D[0].y+this.separator;if(!F){E+=D[B-1].x+this.separator+D[B-1].y+this.separator}E+=(B-1);for(var C=1;C<B;C++){E+=this.separator+D[C].x+this.separator+D[C].y}}else{E=G.x+this.separator+G.y}return E},findCRS:function(I,F){var G=-1;for(var E=0,B=this.SUPPORTED_CRSS.length;E<B&&G==-1;E++){var H=this.SUPPORTED_CRSS[E];switch(F){case"Type":if(H.Type==I){G=E}break;case"projCode":default:for(var C=0,D=H.projCode.length;C<D;C++){if(I==H.projCode[C]){G=E;break}}break}}return G},CLASS_NAME:"Geoportal.Format.Geoconcept"});Geoportal.Format.XLS=OpenLayers.Class(Geoportal.Format,OpenLayers.Format.XML,{defaultVersion:"1.1",defaultCoreService:"LocationUtilityService",version:null,coreService:null,parser:null,read:function(F){if(typeof F=="string"){F=OpenLayers.Format.XML.prototype.read.apply(this,[F])}if(F){var C=F.nodeType==9?F.documentElement:F;var B=this.version||this.defaultVersion;var D=this.coreService||this.defaultCoreService;if(!this.parser||this.parser.VERSION!=B||this.parser.CORESERVICE!=D){var E=Geoportal.Format.XLS["v"+B.replace(/\./g,"_")];var H=E?E[D]:null;if(!H){throw OpenLayers.i18n("XLS.version",{xlsVersion:B,coreService:D})}this.parser=new H(this.options)}var G=this.parser.read(C);return G}return null},write:function(E,C){var B=(C&&C.version)||this.version||this.defaultVersion;var D=(C&&C.coreService)||this.coreService||this.defaultCoreService;if(!this.parser||this.parser.VERSION!=B||this.parser.CORESERVICE!=D){var F=Geoportal.Format.XLS["v"+B.replace(/\./g,"_")][D];if(!F){throw OpenLayers.i18n("XLS.version",{xlsVersion:B,coreService:D})}this.parser=new F(this.options)}return this.parser.write(E)},CLASS_NAME:"Geoportal.Format.XLS"});Geoportal.GeoRMHandler={};Geoportal.GeoRMHandler.Updater=OpenLayers.Class({GeoRMKey:null,ServerUrl:"http://jeton-api.ign.fr/",ttl:600000,token:null,maps:[],QueryUrl:null,lastUpdate:0,status:0,script:null,reload:false,DOMhead:null,EVENT_TYPES:["tokenupdatestart","tokenupdateend","tokenloaded"],events:null,onTokenLoaded:function(B){B.setCenter(B.getCenter(),B.getZoom(),false,true)},initialize:function(E,C,B,D){OpenLayers.Util.extend(this,D);this.DOMhead=(document.getElementsByTagName("head").length?document.getElementsByTagName("head")[0]:document.body);this.GeoRMKey=E;this.lastUpdate=0;if(C){this.ServerUrl=C}if(this.ServerUrl.charAt(this.ServerUrl.length-1)!="/"){this.ServerUrl+="/"}if(B){this.ttl=1000*B}this.QueryUrl=this.ServerUrl+"getToken?key="+this.GeoRMKey+"&output=json&callback=Geoportal.GeoRMHandler.U"+this.GeoRMKey+".callback&";this.events=new OpenLayers.Events(this,null,this.EVENT_TYPES);if(this.eventListeners instanceof Object){this.events.on(this.eventListeners)}OpenLayers.Event.observe(window,"unload",this.destroy)},addMap:function(D){for(var C=0,B=this.maps.length;C<B;C++){if(this.maps[C]===D){return }}this.maps.push(D)},destroy:function(){OpenLayers.Event.stopObserving(window,"unload",this.destroy);if(this.GeoRMKey){this.GeoRMKey=null}if(this.ServerUrl){this.ServerUrl="http://jeton-api.ign.fr/"}if(this.token){this.token=null}if(this.maps){this.maps=[]}if(this.QueryUrl){this.QueryUrl=null}if(this.script){this.script=null}if(this.DOMhead){this.DOMhead=null}},getToken:function(){var B=(new Date()).getTime();var C=(!this.token)||(this.lastUpdate+this.ttl<B);if(this.lastUpdate+this.ttl/2<B){if(this.status==0){this.lastUpdate=B;this.updateToken()}}if(C&&this.status>=0){this.token=null;this.reload=true;return null}return this.token},updateToken:function(){if(this.events.triggerEvent("updatetokenstart")===false){return }if(this.script){this.DOMhead.removeChild(this.script);this.script=null}this.status++;if(this.status>=10){this.status=0;if(this.events.triggerEvent("updatetokenstop")!==false){OpenLayers.Console.error(OpenLayer.i18n("geoRM.failed",{key:this.GeoRMKey}))}return }this.script=document.createElement("script");this.script.setAttribute("type","text/javascript");var C=this.QueryUrl;for(var D in this.token){C+=D+"="+this.token[D]+"&"}if(this.transport=="referrer"){if(Geoportal.Cookies.cookiesEnabled()){if(Geoportal.Cookies.get(Geoportal.GeoRMHandler.GEORM_REFERRER_COOKIENAME)===undefined){C+="cookie=referrer,"+encodeURIComponent(document.location.href)+"&"}}else{OpenLayers.Console.warn(OpenLayers.i18n("cookies.not.enabled"))}}this.script.setAttribute("src",C);this.DOMhead.appendChild(this.script);if(this.timeout){window.clearTimeout(this.timeout)}var B=this.status*this.ttl/10;this.timeout=window.setTimeout("Geoportal.GeoRMHandler.U"+this.GeoRMKey+".updateToken()",B)},callback:function(D){if(this.events.triggerEvent("updatetokenend")===false){return }if(D==null){OpenLayers.Console.error(OpenLayers.i18n("geoRM.getToken",{key:this.GeoRMKey}))}else{if(this.status>0){this.token=D;if(this.timeout){window.clearTimeout(this.timeout);this.timeout=null}this.status=-1;if(this.reload){for(var C=0,B=this.maps.length;C<B;C++){if(this.events.triggerEvent("tokenloaded")!==false){this.onTokenLoaded(this.maps[C])}}this.reload=false}this.status=0}}},CLASS_NAME:"Geoportal.GeoRMHandler.Updater"});Geoportal.GeoRMHandler.addKey=function(E,C,B,F,D){if(!Geoportal.GeoRMHandler["U"+E]){Geoportal.GeoRMHandler["U"+E]=new Geoportal.GeoRMHandler.Updater(E,C,B,D);Geoportal.GeoRMHandler["U"+E].getToken()}Geoportal.GeoRMHandler["U"+E].addMap(F);return Geoportal.GeoRMHandler["U"+E]};Geoportal.GeoRMHandler.GEORM_REFERRER_COOKIENAME="__rfrrric__";Geoportal.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.Grid,{gridOrigin:null,nativeTileSize:null,nativeResolutions:null,resample:false,initialize:function(D,C,E,B){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments);if(!this.gridOrigin){this.gridOrigin=new OpenLayers.LonLat(0,0)}if(!this.nativeTileSize){this.nativeTileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT)}this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH)},setMap:function(B){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments);this.gridOrigin.transform(this.getNativeProjection(),this.map.getProjection())},destroy:function(){if(this.gridOrigin){this.gridOrigin=null}if(this.nativeTileSize){this.nativeTileSize=null}if(this.nativeResolutions){this.nativeResolutions=null}this.resample=false;OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new Geoportal.Layer.Grid(this.name,this.url,this.params,this.options)}B=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[B]);if(this.tileSize!=null){B.tileSize=this.tileSize.clone()}if(this.gridOrigin!=null){B.gridOrigin=this.gridOrigin.clone()}if(this.nativeTileSize!=null){B.nativeTileSize=this.nativeTileSize.clone()}if(this.nativeResolutions!=null){B.nativeResolutions=this.nativeResolutions.slice(0)}B.grid=[];return B},initResolutions:function(){OpenLayers.Layer.prototype.initResolutions.apply(this,arguments);if(!(this instanceof Geoportal.Layer.WMSC)){return }var B=null;for(var E=0,D=this.map.getNumLayers();E<D;E++){var C=this.map.layers[E];if(C.isBaseLayer){if(this.getNativeProjection()&&this.getNativeProjection().equals(C.getNativeProjection())){B=C;break}}}if(!B){for(var E=0,D=this.map.getNumLayers();E<D;E++){var C=this.map.layers[E];if(C.isBaseLayer){if(this.getNativeProjection()&&this.getNativeProjection().isCompatibleWith(C.getNativeProjection())){B=C;break}}}}this.maxResolution=B.resolutions[this.minZoomLevel];this.minResolution=B.resolutions[this.maxZoomLevel];this.scales=B.scales.slice(0);this.minScale=this.scales[this.minZoomLevel];this.maxScale=this.scales[this.maxZoomLevel]},moveTo:function(E,B,F){OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments);E=E||this.map.getExtent();if(E!=null){var D=!this.grid.length||B;if(this.resample){D=true}var C=this.getTilesBounds();if(this.singleTile){if(D||(!F&&!C.containsBounds(E))){this.initSingleTile(E)}}else{if(D||!C.containsBounds(E,true)){this.initGriddedTiles(E)}else{this.moveGriddedTiles(E)}}}},calculateGridLayout:function(B,P,F){var L=F*this.tileSize.w;var D=F*this.tileSize.h;var J=B.left-this.gridOrigin.lon;var M=Math.floor(J/L)-this.buffer;var K=J/L-M;var G=-K*this.tileSize.w;var N=this.gridOrigin.lon+M*L;var C=B.top-(this.gridOrigin.lat+D);var I=Math.ceil(C/D)+this.buffer;var O=I-C/D;var E=-O*this.tileSize.h;var H=this.gridOrigin.lat+I*D;return{tilelon:L,tilelat:D,tileoffsetlon:N,tileoffsetlat:H,tileoffsetx:G,tileoffsety:E}},initGriddedTiles:function(b){var K=new OpenLayers.LonLat(1,1);K.transform(this.getNativeProjection(),this.map.getProjection());var m=this.map.getResolution();var C=m;if(this.nativeResolutions){var O=0;for(var q=Math.max(0,this.minZoomLevel),S=Math.min(this.nativeResolutions.length,this.maxZoomLevel+1);q<S;q++){var h=this.nativeResolutions[q]*K.lon/m;if(h>1){h=1/h}if(h>O){O=h;C=this.nativeResolutions[q]}}}this.resample=(C/m*K.lat!=1||C/m*K.lon!=1);this.tileSize.h=this.nativeTileSize.h*C/m*K.lat;this.tileSize.w=this.nativeTileSize.w*C/m*K.lon;var E=this.map.getSize();var F=Math.ceil(E.h/this.tileSize.h)+Math.max(1,2*this.buffer);var W=Math.ceil(E.w/this.tileSize.w)+Math.max(1,2*this.buffer);var D=this.maxExtent;var a=this.calculateGridLayout(b,D,m);var l=a.tileoffsetx;var j=a.tileoffsety;if(!this.resample){l=Math.round(l);j=Math.round(j)}var r=a.tileoffsetlon;var U=a.tileoffsetlat;var V=a.tilelon;var B=a.tilelat;var T=l;var Z=r;var M=0;var Q=parseInt(this.map.layerContainerDiv.style.left,10);var Y=parseInt(this.map.layerContainerDiv.style.top,10);do{var P=this.grid[M++];if(!P){P=[];this.grid.push(P)}r=Z;l=T;var u=0;do{var d=new OpenLayers.Bounds(r,U,r+V,U+B);var g=l;g-=Q;var f=j;f-=Y;var N=Math.round(g);var L=Math.round(f);var I=new OpenLayers.Pixel(N,L);var G=P[u++];var J=Math.round(g+this.tileSize.w)-N;var R=Math.round(f+this.tileSize.h)-L;var H=new OpenLayers.Size(J,R);if(!G){G=this.addTile(d,I,H);this.addTileMonitoringHooks(G);P.push(G)}else{G.moveTo(d,I,false);G.setSize(H)}r+=V;l+=this.tileSize.w}while((r<=b.right+V*this.buffer)||u<W);U-=B;j+=this.tileSize.h}while((U>=b.bottom-B*this.buffer)||M<F);this.removeExcessTiles(M,u);this.spiralTileLoad()},CLASS_NAME:"Geoportal.Layer.Grid"});Geoportal.Layer.WFS=OpenLayers.Class(OpenLayers.Layer.WFS,{CLASS_NAME:"Geoportal.Layer.WFS"});Geoportal.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.WMS,{CLASS_NAME:"Geoportal.Layer.WMS"});Geoportal.Layer.WMSC=OpenLayers.Class(Geoportal.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",exceptions:"application/vnd.ogc.se_inimage",format:"image/jpeg"},isBaseLayer:false,initialize:function(E,D,F,C){var B=[];F=OpenLayers.Util.upperCaseObject(F);B.push(E,D,F,C);Geoportal.Layer.Grid.prototype.initialize.apply(this,B);OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS));if(this.params.TRANSPARENT&&this.params.TRANSPARENT.toString().toLowerCase()=="true"){if((C==null)||(!C.isBaseLayer)){this.isBaseLayer=false}if(this.params.FORMAT=="image/jpeg"){this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"}}},destroy:function(){Geoportal.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(B){if(B==null){B=new Geoportal.Layer.WMSC(this.name,this.url,this.params,this.options)}B=Geoportal.Layer.Grid.prototype.clone.apply(this,[B]);return B},getURL:function(B){if(this.gutter){B=this.adjustBoundsByGutter(B)}var C=B.clone();C.transform(this.map.getProjection(),this.getNativeProjection());var D={BBOX:C.toBBOX(),WIDTH:this.nativeTileSize.w,HEIGHT:this.nativeTileSize.h,TILED:true};return decodeURIComponent(this.getFullRequestString(D))},mergeNewParams:function(D){var C=OpenLayers.Util.upperCaseObject(D);var B=[C];Geoportal.Layer.Grid.prototype.mergeNewParams.apply(this,B)},getFullRequestString:function(C){var B=this.getNativeProjection()||this.map.getProjection();this.params.SRS=(B=="none")?null:B;return Geoportal.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},addTile:function(E,B,D){var C=this.getURL(E);return new Geoportal.Tile.Image(this,B,E,C,D)},getDataExtent:function(){return this.maxExtent},changeBaseLayer:function(B){if(OpenLayers.Layer.prototype.changeBaseLayer.apply(this,arguments)===false){return false}if(!this.isBaseLayer){if(this.getCompatibleProjection(B.layer)!=null){if(this.aggregate==undefined){this.displayInLayerSwitcher=true}if(typeof (this.savedStates[B.layer.id])=="object"){if(this.savedStates[B.layer.id].opacity!=undefined){this.opacity=undefined;this.setOpacity(this.savedStates[B.layer.id].opacity)}this.setVisibility(this.savedStates[B.layer.id].visibility)}else{this.setVisibility(this.getVisibility()&&this.calculateInRange())}return true}if(this.getCompatibleProjection(B.baseLayer)!=null){if(!this.savedStates[B.baseLayer.id]){this.savedStates[B.baseLayer.id]={}}this.savedStates[B.baseLayer.id].visibility=this.getVisibility();this.savedStates[B.baseLayer.id].opacity=this.opacity}if(this.aggregate==undefined){this.displayInLayerSwitcher=false}this.setVisibility(false)}return true},getCompatibleProjection:function(D){var C=OpenLayers.Layer.prototype.getCompatibleProjection.apply(this,arguments);if(C==null){return C}if(D==null){D=this.map.baseLayer;if(D==null){return undefined}}var E=D.getNativeProjection();if(C.isCompatibleWith(E)){var B=this.restrictedExtent||this.maxExtent;if(!B){return C}if(this.map==null){B=B.clone().transform(C,E)}if(D.maxExtent.containsBounds(B,true,true)||B.containsBounds(D.maxExtent,true,true)){return C}}return null},CLASS_NAME:"Geoportal.Layer.WMSC"});Geoportal.OLS.AbstractBody=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.AbstractBody"});Geoportal.OLS.AbstractHeader=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.AbstractHeader"});Geoportal.OLS.AbstractLocation=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.AbstractLocation"});Geoportal.OLS.AbstractRequestParameters=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.AbstractRequestParameters"});Geoportal.OLS.AbstractResponseParameters=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.AbstractResponseParameters"});Geoportal.OLS.AbstractStreetLocator=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.AbstractStreetLocator"});Geoportal.OLS.Error=OpenLayers.Class(Geoportal.OLS,{errorCode:null,severity:null,locationID:null,locationPath:null,message:null,initialize:function(B){this.errorCode=null;this.severity="Warning";this.locationID=null;this.locationPath=null;this.message=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.errorCode=null;this.severity=null;this.locationID=null;this.locationPath=null;this.message=null;Geoportal.OLS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.Error"});Geoportal.OLS.GeocodeMatchCode=OpenLayers.Class(Geoportal.OLS,{accuracy:null,matchType:null,initialize:function(B){this.accuracy=null;this.matchType=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.accuracy=null;this.matchType=null;Geoportal.OLS.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.GeocodeMatchCode({accuracy:this.accuracy,matchType:this.matchType});return B},CLASS_NAME:"Geoportal.OLS.GeocodeMatchCode"});Geoportal.OLS.LUS=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.LUS"});Geoportal.OLS.Place=OpenLayers.Class(Geoportal.OLS,{classification:null,name:null,initialize:function(B){this.classification=null;this.name=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.classification=null;this.name=null;Geoportal.OLS.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.Place();B.classification=this.classification;B.name=this.name;return B},CLASS_NAME:"Geoportal.OLS.Place"});Geoportal.OLS.PostalCode=OpenLayers.Class(Geoportal.OLS,{name:null,initialize:function(B){this.name=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.name=null;Geoportal.OLS.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.PostalCode();B.name=this.name;return B},CLASS_NAME:"Geoportal.OLS.PostalCode"});Geoportal.OLS.Street=OpenLayers.Class(Geoportal.OLS,{directionalPrefix:null,typePrefix:null,officialName:null,typeSuffix:null,directionalSuffix:null,muniOctant:null,name:null,initialize:function(B){this.directionalPrefix=null;this.typePrefix=null;this.officialName=null;this.typeSuffix=null;this.directionalSuffix=null;this.muniOctant=null;this.name=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.directionalPrefix=null;this.typePrefix=null;this.officialName=null;this.typeSuffix=null;this.directionalSuffix=null;this.muniOctant=null;this.name=null;Geoportal.OLS.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.Street();B.directionalPrefix=this.directionalPrefix;B.typePrefix=this.typePrefix;B.officialName=this.officialName;B.typeSuffix=this.typeSuffix;B.directionalSuffix=this.directionalSuffix;B.muniOctant=this.muniOctant;B.name=this.name;return B},CLASS_NAME:"Geoportal.OLS.Street"});Geoportal.OLS.UOM=OpenLayers.Class(Geoportal.OLS,{CLASS_NAME:"Geoportal.OLS.UOM"});Geoportal.OLS.XLS=OpenLayers.Class(Geoportal.OLS,{version:"1.1",lang:null,_header:null,_body:null,initialize:function(B){this.version="1.1";this.lang=null;this._header=null;this._body=[];Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.version=null;this.lang=null;if(this._header){this._header.destroy();this._header=null}if(this._body){for(var C=0,B=this._body.length;C<B;C++){this._body[C].destroy();this._body[C]=null}this._body=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},addBody:function(B){if(!this._body){this._body=[]}if(B){this._body.push(B)}},getNbBodies:function(){return this._body?this._body.length:0},getBodies:function(){return this._body?this._body:null},getErrors:function(){var D=[];if(this._header&&this._header.errorList&&this._header.errorList.getNbErrors()>0){D=D.concat(this._header.errorList.getErrors())}for(var E=0,C=this.getNbBodies();E<C;E++){var B=this.getBodies()[E];if(B.errorList&&B.errorList.getNbErrors()>0){D=D.concat(B.errorList.getErrors())}}if(D.length==0){D=null}return D},CLASS_NAME:"Geoportal.OLS.XLS"});Geoportal.Popup.Anchored=OpenLayers.Class(Geoportal.Popup,{BORDER:2,anchor:null,relativePosition:null,border:"",initialize:function(D,G,L,E,F,B,J,H,I,K){var C=[D,G,L,E,B,I,K];Geoportal.Popup.prototype.initialize.apply(this,C);this.anchor=(F!=null?F:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)});this.border=this.BORDER;this.setBorder(this.border+"px solid #000000");this.backgroundColor=J||this.backgroundColor;this.opacity=H||this.opacity;this.panMapIfOutOfView=K&&K.layer&&K.layer.options&&K.layer.options.panMapIfOutOfView||false},destroy:function(){this.anchor=null;this.relativePosition=null;Geoportal.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition();Geoportal.Popup.prototype.show.apply(this,arguments);if(this.panMapIfOutOfView){this.panIntoView()}},moveTo:function(C){var B=this.relativePosition;this.relativePosition=this.calculateRelativePosition(C);var D=this.calculateNewPx(C);Geoportal.Popup.prototype.moveTo.apply(this,[D]);if(this.relativePosition!=B){this.updateRelativePosition()}},setSize:function(C){Geoportal.Popup.prototype.setSize.apply(this,arguments);if((this.lonlat)&&(this.map)){var B=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(B)}},calculateRelativePosition:function(B){return"tr"},updateRelativePosition:function(){},panIntoView:function(){if(this.map){var F=0;var D=0;var G=this.map.getCenter();var J=this.map.getLayerPxFromLonLat(G);var E=this.map.getSize().w;var B=this.map.getSize().h;var I=this.map.getLayerPxFromLonLat(this.lonlat);var C=this.div.style.width;C=parseInt(C.replace("px",""));var H=this.div.style.height;H=parseInt(H.replace("px",""));if(E<C||B<H){this.panIntoView();return }F=I.x-J.x+(C/2);D=I.y-J.y-(H/2);if(Math.abs(F)>50||Math.abs(D)>50){this.map.pan(F,D)}}},calculateNewPx:function(C){var F=C.offset(this.anchor.offset);var B=this.size||this.contentSize;var E=(this.relativePosition&&this.relativePosition.charAt(0)=="t");F.y+=(E)?-B.h:this.anchor.size.h;var D=(this.relativePosition&&this.relativePosition.charAt(1)=="l");F.x+=(D)?-B.w:this.anchor.size.w;return F},CLASS_NAME:"Geoportal.Popup.Anchored"});Geoportal.Popup.Anchored._creat4KML=function(){var B;var C=OpenLayers.Util.extend({},this.layer.formatOptions);OpenLayers.Util.applyDefaults(C,{size:null,closeBox:true,onPopupClose:Geoportal.Popup.onPopupClose,backgroundColor:"#ffffff",opacity:0.75});var F;if(this.style){F=null;F=this.style.balloonStyle;if(F!=null){var D=/\$\{([a-zA-Z0-9_\-\.]*)\}/;while(F.match(D)){var E=RegExp.$1;E=(this.attributes[E]?(this.attributes[E].value?this.attributes[E].value:this.attributes[E]):"");F=F.replace(D,E)}}else{F=(this.attributes.name?this.attributes.name+"<br/>":"")+(this.attributes.description?this.attributes.description:"");F=Geoportal.Util.cleanContent(F)}B=new Geoportal.Popup.Anchored("chicken",this.geometry.getBounds().getCenterLonLat(),C.size,this.style.textColor?"<div class='gpPopupBody' style='"+this.style.textColor+";'>"+F+"</div>":"<div class='gpPopupBody'>"+F+"</div>",null,C.closeBox,this.style.bgColor,this.style.bgColorOpacity,C.onPopupClose,this)}else{F=(this.attributes.description?this.attributes.description:"");F=Geoportal.Util.cleanContent(F);B=new Geoportal.Popup.Anchored("chicken",this.geometry.getBounds().getCenterLonLat(),C.size,"<div class='gpPopupHead'>"+(this.attributes.name?this.attributes.name:"")+"</div><div class='gpPopupBody'>"+F+"</div>",null,C.closeBox,C.backgroundColor,C.opacity,C.onPopupClose,this)}B=Geoportal.Popup.completePopup(B,this.layer.formatOptions);this.popup=B;return this.popup};Geoportal.Popup.Anchored.createPopUpForKMLFeature=function(B){B.createPopup=OpenLayers.Function.bind(Geoportal.Popup.Anchored._creat4KML,B)};Geoportal.Popup.Anchored._creat4GPX=function(){var C=OpenLayers.Util.extend({},this.layer.formatOptions);OpenLayers.Util.applyDefaults(C,{size:this.layer.map.getSize(),closeBox:true,onPopupClose:Geoportal.Popup.onPopupClose,backgroundColor:"#ffffff",opacity:0.75});var D=(this.attributes.desc?this.attributes.desc+"<br/>":"");D+=(this.attributes.cmt?this.attributes.cmt+"<br/>":"");D+=(this.attributes.ele?this.attributes.ele:"");D=Geoportal.Util.cleanContent(D);var B=new Geoportal.Popup.Anchored("chicken",this.geometry.getBounds().getCenterLonLat(),this.layer.map.getSize(),"<div class='gpPopupHead'>"+(this.attributes.name?this.attributes.name:"")+"</div><div class='gpPopupBody'>"+D+"</div>",null,C.closeBox,C.backgroundColor,C.opacity,C.onPopupClose,this);B=Geoportal.Popup.completePopup(B,this.layer.formatOptions);this.popup=B;return this.popup};Geoportal.Popup.Anchored.createPopUpForGPXFeature=function(B){B.createPopup=OpenLayers.Function.bind(Geoportal.Popup.Anchored._creat4GPX,B)};Geoportal.Popup.Anchored._creat4GML=function(){var E=OpenLayers.Util.extend({},this.layer.formatOptions);OpenLayers.Util.applyDefaults(E,{size:this.layer.map.getSize(),closeBox:true,onPopupClose:Geoportal.Popup.onPopupClose,backgroundColor:"#ffffff",opacity:0.75});var F="<table border='1' cellspacing='0' cellpadding='0'>";var D="";for(var C in this.attributes){if(this.attributes.hasOwnProperty(C)){if(C.toLowerCase()=="name"){D=this.attributes[C]||""}F+="<tr><td class='gpAttName'>"+C+"</td><td class='gpAttValue'>"+(this.attributes[C]||"")+"</td></tr>"}}F+="</table>";var B=new Geoportal.Popup.Anchored("chicken",this.geometry.getBounds().getCenterLonLat(),E.size,"<div class='gpPopupHead'>"+D+"</div><div class='gpPopupBody'>"+F+"</div>",null,E.closeBox,E.backgroundColor,E.opacity,E.onPopupClose,this);B=Geoportal.Popup.completePopup(B,this.layer.formatOptions);this.popup=B;return this.popup};Geoportal.Popup.Anchored.createPopUpForGMLFeature=function(B){B.createPopup=OpenLayers.Function.bind(Geoportal.Popup.Anchored._creat4GML,B)};Geoportal.Tile.Image=OpenLayers.Class(OpenLayers.Tile.Image,{setSize:function(B){if(this.frame!=null){OpenLayers.Util.modifyDOMElement(this.frame,null,null,B);this.size=B;if(this.imgDiv!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,B)}}},resetBackBuffer:function(){this.showTile();if(this.backBufferTile&&(this.isFirstDraw||!this.layer.numLoadingTiles)){this.isFirstDraw=false;var B=this.layer.maxExtent;var C=(B&&this.bounds.intersectsBounds(B,false));if(C){this.backBufferTile.position=this.position;this.backBufferTile.bounds=this.bounds;this.backBufferTile.size=this.size;this.backBufferTile.imageSize=this.size||this.layer.imageSize;this.backBufferTile.imageOffset=this.layer.imageOffset;this.backBufferTile.resolution=this.layer.getResolution();this.backBufferTile.renderTile()}}},positionImage:function(){if(this.layer==null){return }OpenLayers.Util.modifyDOMElement(this.frame,null,this.position,this.size);var B=this.size||this.layer.getImageSize();if(this.layerAlphaHack){OpenLayers.Util.modifyAlphaImageDiv(this.imgDiv,null,null,B,this.url)}else{OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,B);this.imgDiv.src=this.url}},initImgDiv:function(){var E=this.layer.imageOffset;var C=this.size||this.layer.getImageSize();if(this.layerAlphaHack){this.imgDiv=OpenLayers.Util.createAlphaImageDiv(null,E,C,null,"relative",null,null,null,true)}else{this.imgDiv=OpenLayers.Util.createImage(null,E,C,null,"relative",null,null,true)}this.imgDiv.className="olTileImage";this.frame.style.zIndex=this.isBackBuffer?0:1;this.frame.appendChild(this.imgDiv);this.layer.div.appendChild(this.frame);if(this.layer.opacity!=null){OpenLayers.Util.modifyDOMElement(this.imgDiv,null,null,null,null,null,null,this.layer.opacity)}this.imgDiv.map=this.layer.map;this.imgDiv.layer=this.layer;var D=function(){if(this.isLoading){this.isLoading=false;this.events.triggerEvent("loadend")}};if(this.layerAlphaHack){OpenLayers.Event.observe(this.imgDiv.childNodes[0],"load",OpenLayers.Function.bind(D,this))}else{OpenLayers.Event.observe(this.imgDiv,"load",OpenLayers.Function.bind(D,this))}var B=function(){if(this.imgDiv._attempts>OpenLayers.IMAGE_RELOAD_ATTEMPTS){D.call(this)}};OpenLayers.Event.observe(this.imgDiv,"error",OpenLayers.Function.bind(B,this))},CLASS_NAME:"Geoportal.Tile.Image"});Geoportal.Control.EditingToolbar=OpenLayers.Class(Geoportal.Control.Panel,{DEFAULT_OPTIONS:{"OpenLayers.Handler.Point":{title:"",displayClass:"olControlDrawFeaturePoint",featureAdded:function(B){B.state=OpenLayers.State.INSERT}},"OpenLayers.Handler.Path":{title:"",displayClass:"olControlDrawFeaturePath",featureAdded:function(B){B.state=OpenLayers.State.INSERT}},"OpenLayers.Handler.Polygon":{title:"",displayClass:"olControlDrawFeaturePolygon",featureAdded:function(B){B.state=OpenLayers.State.INSERT}},"OpenLayers.Handler.RegularPolygon":{title:"",displayClass:"olControlDrawFeatureRegularPolygon",featureAdded:function(B){B.state=OpenLayers.State.INSERT}},"OpenLayers.Control.DragFeature":{title:""},"OpenLayers.Control.ModifyFeature":{title:""},"Geoportal.Control.DeleteFeature":{title:""},"OpenLayers.Control.SelectFeature":{title:""}},layer:null,geometryType:"OpenLayers.Geometry.Point",initialize:function(E,G,C){Geoportal.Control.Panel.prototype.initialize.apply(this,[C]);this.DEFAULT_OPTIONS["OpenLayers.Handler.Point"].title=this.displayClass+".drawpoint";this.DEFAULT_OPTIONS["OpenLayers.Handler.Path"].title=this.displayClass+".drawline";this.DEFAULT_OPTIONS["OpenLayers.Handler.Polygon"].title=this.displayClass+".drawpolygon";this.DEFAULT_OPTIONS["OpenLayers.Handler.RegularPolygon"].title=this.displayClass+".drawpolygon";this.DEFAULT_OPTIONS["OpenLayers.Control.DragFeature"].title=this.displayClass+".dragfeature";this.DEFAULT_OPTIONS["OpenLayers.Control.ModifyFeature"].title=this.displayClass+".modifyfeature";this.DEFAULT_OPTIONS["Geoportal.Control.DeleteFeature"].title=this.displayClass+".deletefeature";this.DEFAULT_OPTIONS["OpenLayers.Control.SelectFeature"].title=this.displayClass+".selectfeature";this.layer=E;var F=null;if(G=="OpenLayers.Geometry.Point"){F=OpenLayers.Handler.Point}else{if(G=="OpenLayers.Geometry.LineString"){F=OpenLayers.Handler.Path}else{if(G=="OpenLayers.Geometry.Polygon"){if(this.regularPolygon){F=OpenLayers.Handler.RegularPolygon}else{F=OpenLayers.Handler.Polygon}}else{G=null}}}this.geometryType=G;if(!C){C={}}if(F){this.addControls(new OpenLayers.Control.DrawFeature(this.layer,F,OpenLayers.Util.extend(OpenLayers.Util.applyDefaults({},this.DEFAULT_OPTIONS[F.prototype.CLASS_NAME]),C.drawFeatureOptions)))}this.addControls(new OpenLayers.Control.DragFeature(this.layer,OpenLayers.Util.extend(OpenLayers.Util.applyDefaults({},this.DEFAULT_OPTIONS["OpenLayers.Control.DragFeature"]),C.dragFeatureOptions)));if(this.geometryType&&this.geometryType!="OpenLayers.Geometry.Point"){this.addControls(new OpenLayers.Control.ModifyFeature(this.layer,OpenLayers.Util.extend(OpenLayers.Util.applyDefaults({},this.DEFAULT_OPTIONS["OpenLayers.Control.ModifyFeature"]),C.modifyFeatureOptions)))}this.addControls(new Geoportal.Control.DeleteFeature(this.layer,OpenLayers.Util.extend(OpenLayers.Util.applyDefaults({},this.DEFAULT_OPTIONS["Geoportal.Control.DeleteFeature"]),C.deleteFeatureOptions)));this.addControls(new OpenLayers.Control.SelectFeature(this.layer,OpenLayers.Util.extend(OpenLayers.Util.applyDefaults({},this.DEFAULT_OPTIONS["OpenLayers.Control.SelectFeature"]),C.selectFeatureOptions)));for(var D=0,B=this.controls.length;D<B;D++){if(this.controls[D].events){this.controls[D].events.register("activate",this.controls[D],this.onActivate);if(this.layer.map){this.layer.map.events.register("changelayer",this.controls[D],this.onChangeLayer)}this.layer.events.register("visibilitychanged",this.controls[D],this.onVisibilityChange)}}},destroy:function(){for(var C=0,B=this.controls.length;C<B;C++){if(this.controls[C].events){this.layer.events.unregister("visibilitychanged",this.controls[C],this.onVisibilityChange);if(this.layer.map){this.layer.map.events.unregister("changelayer",this.controls[C],this.onChangeLayer)}this.controls[C].events.unregister("activate",this.controls[C],this.onActivate)}}Geoportal.Control.Panel.prototype.destroy.apply(this,arguments)},draw:function(B){Geoportal.Control.Panel.prototype.draw.apply(this,arguments);if(this.panelVisibility){this.activateControl(this.getControlsByClass("Geoportal.Control.PanelToggle")[0])}else{this.activateControl(this.controls[0])}return this.div},onActivate:function(B){if(!this.active){return }if(!B){return }if(this.layer&&!this.layer.getVisibility()){if(!this.layer.calculateInRange()){this.deactivate();return }this.layer.setVisibility(true)}},onChangeLayer:function(C){if(!this.active){return }if(!C){return }if(C.layer!=this.layer){return }if(!C.property){return }if(C.property!="visibility"){return }if(!this.layer.getVisibility()){this.deactivate();var B=this.layer.map.getControlsByClass("OpenLayers.Control.Navigation");if(B&&B.length>0){var D=B[0];D.activate()}}},onVisibilityChange:function(B){if(!this.active){return }if(!B){return }if(B.object!=this.layer){return }},CLASS_NAME:"Geoportal.Control.EditingToolbar"});Geoportal.Control.Form=OpenLayers.Class(Geoportal.Control,{formControl:null,labels:null,buttons:null,htmlElements:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.formControl=null;Geoportal.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.prototype.setMap.apply(this,arguments)},activate:function(){if(!Geoportal.Control.prototype.activate.apply(this,arguments)){return false}this.formControl=new Geoportal.Control.Floating(this,{id:OpenLayers.Util.createUniqueID("_gcf_")+this.id,headTitle:this.displayClass+".title",onClose:this.closeForm});this.labels={};this.buttons={};this.htmlElements={};return true},deactivate:function(){if(this.formControl){if(this.htmlElements){for(var B in this.htmlElements){OpenLayers.Event.stopObservingElement(this.htmlElements[B])}}this.htmlElements=null;this.buttons=null;this.labels=null;this.formControl.deactivate();this.formControl.destroy();this.formControl=null}if(!Geoportal.Control.prototype.deactivate.apply(this,arguments)){return false}return true},closeForm:function(){this.deactivate();var B=this.map.getControlsByClass(/.*\.Control\.NavToolbar/)[0];if(B&&!B.controls[1].active){B.activateControl(B.controls[0])}},buildInputTextField:function(E,D){var G,F;if(!D.hidden){G=document.createElement("label");G.id="lbl"+D.id+this.id;G.setAttribute("for",D.id+this.id);G.appendChild(document.createTextNode(OpenLayers.i18n(this.displayClass+"."+D.id)));if(D.mandatory===true){G.style.fontWeight="bold"}this.labels[this.displayClass+"."+D.id]=G;E.appendChild(G)}F=document.createElement("input");F.id=D.id+this.id;if(D.name){F.name=D.name}else{F.name=F.id}if(!D.hidden){F.type="text"}else{F.type="hidden"}if(D.value==undefined){D.value=""}F.value=D.value;if(D.size==undefined){D.size=80}if(D.size!=-1){F.size=D.size}if(D.length==undefined){D.length=128}if(D.length!=-1){F.maxLength=D.length}F.disabled=D.disabled?true:false;F.hasFocus=false;if(!D.hidden){F.kbControl=this.map.getControlsByClass(OpenLayers.Control.KeyboardDefaults.prototype.CLASS_NAME)[0];if(D.callbacks&&D.callbacks.length>0){for(var C=0,B=D.callbacks.length;C<B;C++){OpenLayers.Event.observe(F,D.callbacks[C].evt,OpenLayers.Function.bind(D.callbacks[C].func,this,F));this.htmlElements[D.callbacks[C].evt+D.id+this.id]=F}}G.appendChild(F);E.appendChild(document.createElement("br"));G=document.createElement("span");G.id="help"+D.id+this.id;G.className="gpFormSmall";G.appendChild(document.createTextNode(OpenLayers.i18n(this.displayClass+"."+D.id+".help")));this.labels[this.displayClass+"."+D.id+".help"]=G;E.appendChild(G);E.appendChild(document.createElement("br"))}else{E.appendChild(F)}return F},buildSelectField:function(E,D){var G,F;G=document.createElement("label");G.id="lbl"+D.id+this.id;G.setAttribute("for",D.id+this.id);G.appendChild(document.createTextNode(OpenLayers.i18n(this.displayClass+"."+D.id)));if(D.mandatory===true){G.style.fontWeight="bold"}this.labels[this.displayClass+"."+D.id]=G;E.appendChild(G);F=document.createElement("select");F.id=D.id+this.id;if(D.name){F.name=D.name}else{F.name=F.id}F.size=D.length?D.length:1;if(D.options&&D.options.length>0){for(var C=0,B=D.options.length;C<B;C++){var H=document.createElement("option");H.value=D.options[C].value;H.selected=D.options[C].selected?true:false;H.appendChild(document.createTextNode(OpenLayers.i18n(D.options[C].text)));this.labels[D.options[C].text]=H;F.appendChild(H)}}F.hasFocus=false;F.kbControl=this.map.getControlsByClass(OpenLayers.Control.KeyboardDefaults.prototype.CLASS_NAME)[0];if(D.callbacks&&D.callbacks.length>0){for(var C=0,B=D.callbacks.length;C<B;C++){OpenLayers.Event.observe(F,D.callbacks[C].evt,OpenLayers.Function.bind(D.callbacks[C].func,this,F));this.htmlElements[D.callbacks[C].evt+D.id+this.id]=F}}G.appendChild(F);E.appendChild(document.createElement("br"));G=document.createElement("span");G.id="help"+D.id+this.id;G.className="gpFormSmall";G.appendChild(document.createTextNode(OpenLayers.i18n(this.displayClass+"."+D.id+".help")));this.labels[this.displayClass+"."+D.id+".help"]=G;E.appendChild(G);E.appendChild(document.createElement("br"));return F},buildCheckboxField:function(E,D){var G,F;G=document.createElement("label");G.id="lbl"+D.id+this.id;G.setAttribute("for",D.id+this.id);G.appendChild(document.createTextNode(OpenLayers.i18n(this.displayClass+"."+D.id)));this.labels[this.displayClass+"."+D.id]=G;E.appendChild(G);F=document.createElement("input");F.id=D.id+this.id;if(D.name){F.name=D.name}else{F.name=F.id}F.value=F.id;F.type="checkbox";F.disabled=D.disabled?true:false;F.checked=D.checked?true:false;F.defaultChecked=D.defaultChecked?true:false;F.style.autocomplete="off";if(D.callbacks&&D.callbacks.length>0){for(var C=0,B=D.callbacks.length;C<B;C++){OpenLayers.Event.observe(F,D.callbacks[C].evt,OpenLayers.Function.bind(D.callbacks[C].func,this,F));this.htmlElements[D.callbacks[C].evt+D.id+this.id]=F}}G.appendChild(F);E.appendChild(document.createElement("br"));G=document.createElement("span");G.id="help"+D.id+this.id;G.className="gpFormSmall";G.appendChild(document.createTextNode(OpenLayers.i18n(this.displayClass+"."+D.id+".help")));this.labels[this.displayClass+"."+D.id+".help"]=G;E.appendChild(G);E.appendChild(document.createElement("br"));return F},buildButton:function(D,B,C){var E;E=document.createElement("input");E.className=this.displayClass+"Button";E.type="button";E.id=B+this.id;E.name=E.id;E.value=OpenLayers.i18n(this.displayClass+".button."+B);if(C){OpenLayers.Event.observe(E,"click",OpenLayers.Function.bind(C,this,E));this.htmlElements["click"+B+this.id]=E}this.buttons[this.displayClass+".button."+B]=E;D.appendChild(E);return E},buildImageButton:function(E,C,B,D){var F;F=document.createElement("input");F.className=this.displayClass+"ImageButton";F.type="image";F.id=C+this.id;F.name=F.id;F.src=B;F.alt=F.title=OpenLayers.i18n(this.displayClass+".imageButton."+C);if(D){OpenLayers.Event.observe(F,"click",OpenLayers.Function.bind(D,this,F));this.htmlElements["click"+C+this.id]=F}this.buttons[this.displayClass+".imageButton."+C]=F;E.appendChild(F);return F},buildResultsField:function(B){var C=document.createElement("div");C.className=this.displayClass+"Results";C.id="results"+this.id;C.style.display="none";C.innerHTML="";B.appendChild(C)},changeLang:function(C){if(this.title){this.div.title=OpenLayers.i18n(this.title)}if(this.formControl){if(this.labels){for(var B in this.labels){if(this.labels[B]){this.labels[B].childNodes[0].innerHTML=OpenLayers.i18n(B)}}}if(this.buttons){for(var B in this.buttons){if(this.buttons[B]){if(this.buttons[B].type=="image"){this.buttons[B].alt=this.buttons[B].title=OpenLayers.i18n(B)}else{this.buttons[B].value=OpenLayers.i18n(B)}}}}}},CLASS_NAME:"Geoportal.Control.Form"});Geoportal.Control.Form.focusOn=function(B){if(B.kbControl){if(B.kbControl.active){B.kbControl.deactivate()}}B.hasFocus=true;B.focus()};Geoportal.Control.Form.focusOff=function(B){if(B.kbControl){if(!B.kbControl.active){B.kbControl.activate()}}B.hasFocus=false;B.blur()};Geoportal.Control.LayerOpacitySlider=OpenLayers.Class(Geoportal.Control.SliderBase,{axis:"horizontal",layer:null,getLevel:function(){return Math.round(this.layer.opacity*100)},getMaxAbsoluteLevels:function(){return 101},getMaxSelectableLevel:function(){return 100},setOpacity:function(B){if(B==0){B=0.001}else{B=B/100}this.layer.setOpacity(B)},initialize:function(C,B){Geoportal.Control.SliderBase.prototype.initialize.apply(this,[B]);this.layer=C;if(this.layer&&typeof (this.layer.opacity)==="number"){this.initialLevel=Math.round(this.layer.opacity*100);if(this.initialLevel<0){this.initialLevel=0}if(this.initialLevel>100){this.initialLevel=100}}},singleClick:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }var C=B.xy.x/this.levelBarIntervalLength;C=this.adjustLevel(C);this.setOpacity(C);this.moveSlider();OpenLayers.Event.stop(B)},sliderDrag:function(B){if(this.mouseDragStart!=null){var C=(this.mouseDragStart.x-B.xy.x)/this.levelBarIntervalLength;this.mouseDragStart=B.xy.clone();C=this.adjustLevel(this.getLevel()-C);this.setOpacity(C);this.updateSlider(this.levelToPos(C));this.onSliderMove(C);OpenLayers.Event.stop(B)}},sliderUp:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }if(this.mouseDragStart){this.div.style.cursor="";this.map.events.un({mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var C=(this.mouseDragStart.x-B.xy.x)/this.levelBarIntervalLength;C=this.adjustLevel(this.getLevel()-C);this.setOpacity(C);this.moveSlider();this.mouseDragStart=null;OpenLayers.Event.stop(B)}},CLASS_NAME:"Geoportal.Control.LayerOpacitySlider"});Geoportal.Control.MeasureToolbar=OpenLayers.Class(Geoportal.Control.Panel,{LABELS:["waiting.measurement","length.measurement","area.measurement"],ACCURACIES:{dd:9,mi:3,ft:2,"in":1,km:3,m:0},targetElement:null,initialize:function(C){Geoportal.Control.Panel.prototype.initialize.apply(this,[C]);var E=new OpenLayers.Style(null,{rules:[new OpenLayers.Rule({symbolizer:{Point:{fillColor:"#99CCFF",fillOpacity:1,strokeColor:"#99CCFF",strokeWidth:2,strokeOpacity:1,pointRadius:6,graphicName:"cross"},Line:{fillColor:"#99CCFF",strokeColor:"#99CCFF",strokeWidth:2,strokeOpacity:1,strokeDashstyle:"dot"},Polygon:{fillColor:"#99CCFF",fillOpacity:0.25,strokeColor:"#99CCFF",strokeWidth:2,strokeOpacity:1,strokeDashstyle:"dot"}}})]});if(!C){C={}}this.addControls([new OpenLayers.Control.Measure(OpenLayers.Handler.Path,OpenLayers.Util.extend({handlerOptions:{style:"default",layerOptions:{styleMap:new OpenLayers.StyleMap({"default":E})},persist:true},type:OpenLayers.Control.TYPE_TOGGLE,title:"olControlMeasurePath.title",displayClass:"olControlMeasurePath",targetElement:this.targetElement},C.pathOptions)),new OpenLayers.Control.Measure(OpenLayers.Handler.Polygon,OpenLayers.Util.extend({handlerOptions:{style:"default",layerOptions:{styleMap:new OpenLayers.StyleMap({"default":E})},persist:true},type:OpenLayers.Control.TYPE_TOGGLE,title:"olControlMeasurePolygon.title",displayClass:"olControlMeasurePolygon",targetElement:this.targetElement},C.polygonOptions))]);this.labels=[];for(var D=0,B=this.LABELS.length;D<B;D++){this.labels.push(OpenLayers.i18n(this.LABELS[D]))}},destroy:function(){Geoportal.Control.Panel.prototype.destroy.apply(this,arguments)},activate:function(){if(Geoportal.Control.Panel.prototype.activate.apply(this,arguments)){for(var C=0,B=this.controls.length;C<B;C++){var D=this.controls[C];if(D.events){D.events.on({measure:OpenLayers.Function.bind(this.handleMeasurements,this),measurepartial:OpenLayers.Function.bind(this.handleMeasurements,this)});D.events.register("activate",D,this.onActivate);D.events.register("deactivate",D,this.onDeactivate)}}return true}else{return false}},deactivate:function(){if(Geoportal.Control.Panel.prototype.deactivate.apply(this,arguments)){for(var C=0,B=this.controls.length;C<B;C++){var D=this.controls[C];if(D.events){D.events.un({measure:OpenLayers.Function.bind(this.handleMeasurements,this),measurepartial:OpenLayers.Function.bind(this.handleMeasurements,this)});D.events.unregister("activate",D,this.onActivate);D.events.unregister("deactivate",D,this.onDeactivate)}}return true}else{return false}},onActivate:function(B){if(!this.active){return }if(!B){return }if(this.map){var C=this.map.getProjection();if(C&&C.getProjName()=="longlat"){this.displaySystem="geographic"}else{this.displaySystem="metric"}}if(this.targetElement){this.targetElement.style.display="block";this.targetElement.innerHTML=OpenLayers.i18n("waiting.measurement")}},onDeactivate:function(B){if(this.active){return }if(!B){return }if(this.targetElement){this.targetElement.style.display="none"}},draw:function(){return Geoportal.Control.Panel.prototype.draw.apply(this,arguments)},handleMeasurements:function(B){if(!B){return }if(this.targetElement){var C=this.labels[B.order]+":<br/>"+B.measure.toFixed(this.ACCURACIES[B.units])+" "+B.units+(B.order==2?"<sup>2</sup>":"");this.targetElement.innerHTML=C}else{var C=this.labels[B.order]+": "+B.measure.toFixed(this.ACCURACIES[B.units])+" "+B.units+(B.order==2?"^2":"");OpenLayers.Console.info(C)}},changeLang:function(C){if(this.title){this.div.title=OpenLayers.i18n(this.title)}this.labels=[];for(var D=0,B=this.LABELS.length;D<B;D++){this.labels.push(OpenLayers.i18n(this.LABELS[D]))}if(this.targetElement){this.targetElement.innerHTML=OpenLayers.i18n("waiting.measurement")}},CLASS_NAME:"Geoportal.Control.MeasureToolbar"});Geoportal.Control.NavToolbar=OpenLayers.Class(Geoportal.Control.Panel,{initialize:function(B){Geoportal.Control.Panel.prototype.initialize.apply(this,[B]);this.addControls([new OpenLayers.Control.Navigation({title:"olControlDragPan.title"}),new OpenLayers.Control.ZoomBox({title:"olControlZoomBox.title"})])},draw:function(){Geoportal.Control.Panel.prototype.draw.apply(this,arguments);this.activateControl(this.controls[0]);return this.div},CLASS_NAME:"Geoportal.Control.NavToolbar"});Geoportal.Control.PanelToggle=OpenLayers.Class(Geoportal.Control,{type:OpenLayers.Control.TYPE_TOGGLE,panel:null,panelVisibility:false,initialize:function(B,C){Geoportal.Control.prototype.initialize.apply(this,[C]);this.panel=B;this.panel.panelVisibility=this.panelVisibility;this.panel.redraw=function(){if(this.active){for(var F=0,D=this.controls.length;F<D;F++){var G=this.controls[F];if(!G.panel_div){G.panel_div=this.div.removeChild(this.div.childNodes[0])}var E=G.panel_div;if(this.panelVisibility){E.className=this.controls[F].displayClass+"ItemActive"}else{E.className=this.controls[F].displayClass+"ItemInactive"}if(E.parentNode){E=E.parentNode.removeChild(E)}if(G instanceof Geoportal.Control.PanelToggle){if(this.panelVisibility){E.title=OpenLayers.i18n(G.displayClass+".opened")}else{E.title=OpenLayers.i18n(G.displayClass+".closed")}}this.div.appendChild(E);G.panel_div=null}}};this.panel.activateControl=function(F){if(!this.active){return false}if(F.type==OpenLayers.Control.TYPE_BUTTON){F.trigger();this.redraw();return }if(F.type==OpenLayers.Control.TYPE_TOGGLE){if(F.active){F.deactivate()}else{if(!(F instanceof Geoportal.Control.PanelToggle)&&this.map){this.map.events.triggerEvent("controlactivated",{control:F})}F.activate()}this.redraw();return }for(var E=0,D=this.controls.length;E<D;E++){if(this.controls[E]!=F){if(this.controls[E].type!=OpenLayers.Control.TYPE_TOGGLE){this.controls[E].deactivate()}}}if(this.map){this.map.events.triggerEvent("controlactivated",{control:F})}F.activate()}},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.redraw();return this.div},redraw:function(){if(this.panelVisibility){this.panel_div.className=this.displayClass+"ItemActive";this.div.title=this.panel_div.title=OpenLayers.i18n(this.displayClass+".opened")}else{this.panel_div.className=this.displayClass+"ItemInactive";this.div.title=this.panel_div.title=OpenLayers.i18n(this.displayClass+".closed")}},activate:function(){if(this.active){return false}if(this.handler){this.handler.activate()}this.active=true;this.panelVisibility=this.panel.panelVisibility=true;this.events.triggerEvent("activate");return true},deactivate:function(){if(!this.active){return false}if(this.handler){this.handler.deactivate()}this.active=false;this.panelVisibility=this.panel.panelVisibility=false;this.events.triggerEvent("deactivate");return true},changeLang:function(B){if(this.panelVisibility){this.div.title=OpenLayers.i18n(this.displayClass+".opened")}else{this.div.title=OpenLayers.i18n(this.displayClass+".closed")}},CLASS_NAME:"Geoportal.Control.PanelToggle"});Geoportal.Control.ZoomSlider=OpenLayers.Class(Geoportal.Control.SliderBase,{minpos:0,maxpos:0,getLevel:function(){var B=this.map.getZoom();return B},getMaxAbsoluteLevels:function(){return this.map.getNumZoomLevels()},initialize:function(){Geoportal.Control.SliderBase.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.map){this.map.events.un({zoomend:this.moveSlider,changebaselayer:this.redraw,scope:this})}Geoportal.Control.SliderBase.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.SliderBase.prototype.setMap.apply(this,arguments);this.map.events.register("changebaselayer",this,this.redraw)},draw:function(B){Geoportal.Control.SliderBase.prototype.draw.apply(this,arguments);var C=parseInt(this.levelBarDiv.style.height);this.minpos=C+this.levelToPos(this.getMinSelectableLevel())+this.sliderImgHeight;this.maxpos=C+this.levelToPos(this.getMaxSelectableLevel())+3*this.sliderImgHeight/2;this.map.events.register("zoomend",this,this.moveSlider);return this.div},singleClick:function(B){if(!OpenLayers.Event.isLeftClick(B)){return }var C=OpenLayers.Util.pagePosition(B.object)[1];var E=B.xy.y;var D=(E-C)/this.levelBarIntervalLength;if(!this.map.fractionalZoom){D=Math.floor(D)}D=this.adjustLevel(D);this.map.zoomTo(D);this.moveSlider();OpenLayers.Event.stop(B)},sliderDrag:function(C){if(this.mouseDragStart!=null){var B=this.mouseDragStart.y-C.xy.y;var E=OpenLayers.Util.pagePosition(this.levelBarDiv);var D=C.clientY-E[1];if((this.minpos<=D)&&(D<this.maxpos)){var F=parseInt(this.slider.style.top);this.updateSlider(F-B);this.mouseDragStart=C.xy.clone()}OpenLayers.Event.stop(C)}},sliderUp:function(D){if(!OpenLayers.Event.isLeftClick(D)){return }if(this.downEventStart){this.div.style.cursor="";this.map.events.un({mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var C=this.mouseDragStart.y-D.xy.y;var E=parseInt(this.slider.style.top);var B=E-C;var F=this.posToLevel(B);if(!this.map.fractionalZoom){F=Math.floor(F)}F=this.adjustLevel(F);this.map.zoomTo(F);this.moveSlider();this.mouseDragStart=null;this.downEventStart=null;OpenLayers.Event.stop(D)}},CLASS_NAME:"Geoportal.Control.ZoomSlider"});Geoportal.Format.GPX.v1_0=OpenLayers.Class(Geoportal.Format.GPX.v1,{VERSION:"1.0",gpxns:"http://www.topografix.com/GPX/1/0",CLASS_NAME:"Geoportal.Format.GPX.v1_0"});Geoportal.Layer.GXT=OpenLayers.Class(OpenLayers.Layer.Vector,{loaded:false,formatOptions:null,initialize:function(E,D,C){var B=[];B.push(E,C);OpenLayers.Layer.Vector.prototype.initialize.apply(this,B);this.url=D},setVisibility:function(B,C){OpenLayers.Layer.Vector.prototype.setVisibility.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadGXT()}},moveTo:function(D,B,C){OpenLayers.Layer.Vector.prototype.moveTo.apply(this,arguments);if(this.visibility&&!this.loaded){this.loadGXT()}},loadGXT:function(){if(!this.loaded){if(this.events.triggerEvent("loadstart")===false){return }OpenLayers.Request.GET({url:this.url,success:this.requestSuccess,failure:this.requestFailure,scope:this});this.loaded=true}},setUrl:function(B){this.url=B;this.destroyFeatures();this.loaded=false;this.loadGXT()},requestSuccess:function(C){var E=C.responseText;var B={};OpenLayers.Util.extend(B,this.formatOptions);if(this.map){B.internalProjection=this.map.getProjection()}var D=new Geoportal.Format.Geoconcept(B);this.addFeatures(D.read(E));this.events.triggerEvent("loadend")},requestFailure:function(B){OpenLayers.Console.userError(OpenLayers.i18n("errorLoadingGXT",{url:this.url}));this.events.triggerEvent("loadend")},CLASS_NAME:"Geoportal.Layer.GXT"});Geoportal.OLS.AbstractAddress=OpenLayers.Class(Geoportal.OLS.AbstractLocation,{addressee:null,countryCode:"__",initialize:function(B,C){this.addressee=null;Geoportal.OLS.AbstractLocation.prototype.initialize.apply(this,[OpenLayers.Util.extend(C,{countryCode:B})])},destroy:function(){this.addressee=null;this.countryCode=null;Geoportal.OLS.AbstractLocation.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.AbstractAddress(this.countryCode);B.addressee=this.addressee;return B},CLASS_NAME:"Geoportal.OLS.AbstractAddress"});Geoportal.OLS.AbstractPosition=OpenLayers.Class(Geoportal.OLS.AbstractLocation,{CLASS_NAME:"Geoportal.OLS.AbstractPosition"});Geoportal.OLS.Building=OpenLayers.Class(Geoportal.OLS.AbstractStreetLocator,{num:null,subdivision:null,name:null,initialize:function(B){this.num=null;this.subdivision=null;this.name=null;Geoportal.OLS.AbstractStreetLocator.prototype.initialize.apply(this,arguments)},destroy:function(){this.num=null;this.subdivision=null;this.name=null;Geoportal.OLS.AbstractStreetLocator.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.Building();B.num=this.num;B.subdivision=this.subdivision;B.name=this.name;return B},CLASS_NAME:"Geoportal.OLS.Building"});Geoportal.OLS.ErrorList=OpenLayers.Class(Geoportal.OLS,{highestSeverity:"Warning",errors:null,initialize:function(B){this.highestSeverity="Warning";this.errors=[];Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.highestSeverity=null;if(this.errors){for(var C=0,B=this.errors.length;C<B;C++){this.errors[C].destroy();this.errors[C]=null}this.errors=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},addError:function(B){if(!this.errors){this.errors=[]}if(B){this.errors.push(B)}},getNbErrors:function(){return this.errors?this.errors.length:0},getErrors:function(){return this.errors?this.errors:null},CLASS_NAME:"Geoportal.OLS.ErrorList"});Geoportal.OLS.LUS.ReverseGeocodePreference=OpenLayers.Class(Geoportal.OLS.LUS,{value:null,initialize:function(C,B){this.value=C;Geoportal.OLS.LUS.prototype.initialize.apply(this,[B])},destroy:function(){this.value=null;Geoportal.OLS.LUS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.LUS.ReverseGeocodePreference"});Geoportal.OLS.StreetAddress=OpenLayers.Class(Geoportal.OLS,{_streetLocation:null,streets:null,initialize:function(B){this._streetLocation=null;this.streets=[];Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){if(this._streetLocation){this._streetLocation.destroy();this._streetLocation=null}if(this.streets){for(var C=0,B=this.streets.length;C<B;C++){this.streets[C].destroy();this.streets[C]=null}this.streets=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},clone:function(){var D=new Geoportal.OLS.StreetAddress();if(this._streetLocation){D._streetLocation=this._streetLocation.clone()}if(this.streets){for(var C=0,B=this.streets.length;C<B;C++){D.streets.push(this.streets[C].clone())}}return D},setStreetLocation:function(B){if(this._streetLocation){this._streetLocation.destroy();this._streetLocation=null}this._streetLocation=B},addStreet:function(B){if(!this.streets){this.streets=[]}if(B){this.streets.push(B)}},getNbStreets:function(){return this.streets?this.streets.length:0},getStreets:function(){return this.streets?this.streets:null},CLASS_NAME:"Geoportal.OLS.StreetAddress"});Geoportal.OLS.UOM.AbstractMeasure=OpenLayers.Class(Geoportal.OLS.UOM,{value:null,accuracy:null,initialize:function(B){this.value=null;this.accuracy=null;Geoportal.OLS.UOM.prototype.initialize.apply(this,arguments)},destroy:function(){this.value=null;this.accuracy=null;Geoportal.OLS.UOM.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.AbstractMeasure"});Geoportal.OLS.UOM.TimeStamp=OpenLayers.Class(Geoportal.OLS.UOM,{begin:null,duration:null,initialize:function(C,B){this.begin=C;this.duration=null;Geoportal.OLS.UOM.prototype.initialize.apply(this,[B])},destroy:function(){this.begin=null;this.duration=null;Geoportal.OLS.UOM.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.TimeStamp"});Geoportal.Control.AddImageLayer=OpenLayers.Class(Geoportal.Control.Form,{SUPPORTED_CLASSES:["OpenLayers.Layer.WMS","Geoportal.Layer.WMSC"],type:OpenLayers.Control.TYPE_TOGGLE,initialize:function(B){Geoportal.Control.Form.prototype.initialize.apply(this,arguments);if(!this.supportedClasses){this.supportedClasses=[];for(var C=this.SUPPORTED_CLASSES.length-1;C>=0;C--){this.supportedClasses.unshift(this.SUPPORTED_CLASSES[C])}}if(!this.layerImageOptions){this.layerImageOptions={}}},activate:function(){if(!Geoportal.Control.Form.prototype.activate.apply(this,arguments)){return false}var B=document.createElement("form");B.id="__addilayer__"+this.id;B.name=B.id;B.action="javascript:void(null)";this.addilayer(B);this.map.addControl(this.formControl);this.formControl.activate();this.formControl.addContent(B);return true},deactivate:function(){return Geoportal.Control.Form.prototype.deactivate.apply(this,arguments)},addilayer:function(E){this.buildInputTextField(E,{id:"layerUrl",mandatory:true,size:40,disabled:false,callbacks:[{evt:"click",func:this.onClick}]});var D=[];for(var C=0,B=this.supportedClasses.length;C<B;C++){var F={value:this.supportedClasses[C],selected:(C==0),text:this.displayClass+".layerType."+this.supportedClasses[C].split(".").pop()};D.push(F)}this.buildSelectField(E,{id:"layerType",mandatory:true,options:D,callbacks:[{evt:"click",func:this.onClick},{evt:"change",func:this.onChange}]});this.buildButton(E,"cancel",this.closeForm);this.buildButton(E,"add",this.onClick);this.wImg=this.buildImageButton(E,"wait",Geoportal.Util.getImagesLocation()+"loading.gif");this.wImg.style.display="none";this.buildResultsField(E)},onClick:function(D,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(D.id.match(/^layer(Url|Type)/)&&OpenLayers.String.contains(D.id,this.id)){if(!D.hasFocus){var H=OpenLayers.Util.getElement("layerUrl"+this.id);if(H&&D.id!=H.id&&H.hasFocus){Geoportal.Control.Form.focusOff(H)}H=OpenLayers.Util.getElement("layerType"+this.id);if(H&&D.id!=H.id&&H.hasFocus){Geoportal.Control.Form.focusOff(H)}Geoportal.Control.Form.focusOn(D)}return false}if(D.id.match(/^add/)){D=OpenLayers.Util.getElement("layerType"+this.id);var E=OpenLayers.String.trim(D.options[D.selectedIndex].value);if(E==""){return false}D.options[0].selected=true;var G=E.match(/.*\.Layer\.(WMS|WMSC)$/);if(G){var C=OpenLayers.Util.getElement("layerUrl"+this.id);if(!C){return false}C=OpenLayers.String.trim(C.value);if(C.length==0){return false}this.wImg.style.display="";var F=OpenLayers.Request.GET({async:true,url:C,params:{SERVICE:"WMS",REQUEST:"GetCapabilities"},success:this.successedInLoadingUrl,failure:this.failedOnLoadingUrl,scope:{cntrl:this,serviceType:G[1]}})}else{OpenLayers.Console.error("type "+E+" not supported");this.closeForm()}}return false},onChange:function(C,B){},successedInLoadingUrl:function(E){if(!E){this.cntrl.wImg.style.display="none";return }var a=E.responseXML;if(!a&&E.responseText){a=OpenLayers.parseXMLString(E.responseText);var V=OpenLayers.Request.XMLHttpRequest.getParseErrorText(a);if(V!=OpenLayers.Request.XMLHttpRequest.PARSED_OK){this.cntrl.wImg.style.display="none";OpenLayers.Console.userError(OpenLayers.i18n(V));return }}var L=new OpenLayers.Format.WMSCapabilities();var B=null;try{B=L.read(a)}catch(Y){this.cntrl.wImg.style.display="none";OpenLayers.Console.userError(Y);return }if(B.exceptions){var G="";for(var S=0,R=B.exceptions.length;S<R;S++){G+=B.exceptions[S]+"\n"}this.cntrl.wImg.style.display="none";OpenLayers.Console.userError(G);return }var U=OpenLayers.Util.getElement("results"+this.cntrl.id);U.innerHTML="";var Q=0;var N=this.cntrl.map.getMaxExtent();for(var S=0,T=B.capability.layers.length;S<T;S++){var K=B.capability.layers[S];var F=null;if(K.llbbox&&K.llbbox.length>0){F=OpenLayers.Bounds.fromArray(K.llbbox);F.transform(OpenLayers.Projection.CRS84,this.cntrl.map.getProjection())}if(!F&&K.bbox){for(var D in K.bbox){var P=new OpenLayers.Projection(D);if(this.cntrl.map.getProjection().isCompatibleWith(P)){F=OpenLayers.Bounds.fromArray(K.bbox[D].bbox);F.transform(P,this.cntrl.map.getProjection());break}}}if(!F){continue}if(F){if(!N.containsBounds(F,true,true)&&!F.containsBounds(N,true,true)){continue}}var I={};var J=0;if(K.srs.length>20){if(K.bbox){for(var D in K.bbox){var P=new OpenLayers.Projection(D);if(this.cntrl.map.getProjection().isCompatibleWith(P)){I[D]=H;J++;Q++}}}}else{for(var H=0,W=K.srs.length;H<W;H++){var D=K.srs[H];if(this.cntrl.map.getProjection().isCompatibleWith(D)){I[D]=H;J++;Q++}}}if(J>0){var D=null;if(this.cntrl.map.getProjection().projCode in I){D=this.cntrl.map.getProjection().projCode}if(!D&&Geoportal.Catalogue.TERRITORIES&&this.cntrl.map.baseLayer.territory){var Z=Geoportal.Catalogue.TERRITORIES[this.cntrl.map.baseLayer.territory].displayCRS;for(var H=0,W=Z.length;H<W;H++){if(Z[H] in I){D=Z[H];break}}}if(!D){for(D in I){break}}var O=document.createElement("div");O.className="gpWMSCapsLayersResult";if((Q%2)==1){O.className+="Alternate"}var M=document.createElement("span");M.innerHTML=K.title;M.style.cursor="pointer";var C={cntrl:this.cntrl,serviceType:this.serviceType,caps:B,layerIndex:S,crs:D};OpenLayers.Event.observe(M,"click",OpenLayers.Function.bindAsEventListener(this.cntrl.onLayerNameClick,C));O.appendChild(M);U.appendChild(O)}}if(Q==0){var O=document.createElement("div");O.className="gpWMSCapsLayersResult";var M=document.createElement("span");M.innerHTML=OpenLayers.i18n("wms.caps.no.compatible.srs");O.appendChild(M);U.appendChild(O)}this.cntrl.wImg.style.display="none";U.style.display=""},onLayerNameClick:function(P){if(P||window.event){OpenLayers.Event.stop(P?P:window.event)}this.cntrl.wImg.style.display="";var N=this.caps.capability.layers[this.layerIndex];var B=this.crs;var W={VERSION:this.caps.version,LAYERS:N.name};var O={"application/vnd.ogc.se_inimage":false,"application/vnd.ogc.se_blank":false,"application/vnd.ogc.se_xml":false};for(var K=0,H=this.caps.capability.exception.formats.length;K<H;K++){O[this.caps.capability.exception.formats[K]]=true}W.exceptions=O["application/vnd.ogc.se_inimage"]?"application/vnd.ogc.se_inimage":O["application/vnd.ogc.se_blank"]?"application/vnd.ogc.se_blank":"application/vnd.ogc.se_xml";O={"image/jpeg":false,"image/png":false,"image/gif":false};for(var K=0,H=N.formats.length;K<H;K++){O[N.formats[K]]=true}W.format=O["image/png"]?"image/png":O["image/gif"]?"image/gif":"image/jpeg";if(N.opaque==false&&W.format!="image/jpeg"){W.transparent=true}if(N.styles&&N.styles.length>0){W.styles=N.styles[0].name}var I=null;var R=new OpenLayers.Projection(B);if(N.bbox[B]){I=OpenLayers.Bounds.fromArray(N.bbox[B].bbox)}else{if(N.llbbox&&N.llbbox.length>0){I=OpenLayers.Bounds.fromArray(N.llbbox);if(R.getProjName()!="longlat"||!OpenLayers.Projection.CRS84.isCompatibleWith(R)){I.transform(OpenLayers.Projection.CRS84,R)}}}var D={projection:B,units:R.getUnits(),singleTile:true,maxExtent:I,visibility:true};switch(this.serviceType){case"WMS":if(N.minScale){D.minZoomLevel=this.cntrl.map.getZoomForResolution(OpenLayers.Util.getResolutionFromScale(N.minScale,this.cntrl.map.getProjection().getUnits()));if(!this.cntrl.map.isValidZoomLevel(D.minZoomLevel)){D.minZoomLevel=undefined}}if(D.minZoomLevel==undefined){D.minZoomLevel=this.cntrl.map.baseLayer.minZoomLevel}if(N.maxScale){D.maxZoomLevel=this.cntrl.map.getZoomForResolution(OpenLayers.Util.getResolutionFromScale(N.maxScale,this.cntrl.map.getProjection().getUnits()));if(!this.cntrl.map.isValidZoomLevel(D.maxZoomLevel)){D.maxZoomLevel=undefined}}if(D.maxZoomLevel==undefined){D.maxZoomLevel=this.cntrl.map.baseLayer.maxZoomLevel}break;case"WMSC":var T=this.caps.capability.vendorSpecificCaps.tilesets;for(var F=0,G=T.length;F<G;F++){var Q=T[F];if(Q.srs[0]!=B){continue}var L=!(Q.layers&&Q.layers.length==0)?true:false;if(!L){for(var M=0,C=Q.layers.length;M<C;M++){if(N.name==Q.layers[M]){L=true;break}}}if(!L){continue}if(Q.width!=OpenLayers.Map.TILE_WIDTH||Q.height!=OpenLayers.Map.TILE_HEIGHT){D.nativeTileSize=new OpenLayers.Size(Q.width,Q.height)}if(!R.equals(this.cntrl.map.getProjection())){D.nativeResolutions=Q.resolutions.slice(0)}}break;default:break}D.description="";if(N["abstract"]){D.description+=N["abstract"]}if(N.attribution){if(N.attribution.title){if(D.description.length>0){D.description+="<br/>"}D.description+=N.attribution.title}if(N.attribution.href&&!N.attribution.logo){if(D.description.length>0){D.description+="<br/>"}D.description+='<a href="'+N.attribution.href+'" target="_blank">'+N.title+"</a>"}}D.originators=[{logo:"logo"+N.name}];if(N.attribution&&N.attribution.logo&&N.attribution.logo.href){D.originators[0].pictureUrl=N.attribution.logo.href}else{D.originators[0].pictureUrl=Geoportal.Util.getImagesLocation()+"logo_unknownAuthority.gif"}if(N.attribution&&N.attribution.href){D.originators[0].url=N.attribution.href}else{if(N.AuthorityURL&&N.AuthorityURL[0]&&N.AuthorityURL[0].href){D.originators[0].url=N.AuthorityURL[0].href}else{D.originators[0].url="javascript:void(0)"}}if(N.metadataURLs&&N.metadataURLs.length>0){D.metadataURL=N.metadataURLs[0].href}if(N.dataURLs&&N.dataURLs.length>0){D.dataURL=N.dataURLs[0].href}if(N.styles&&N.styles.length>0){D.legends=[];for(var V=0,S=N.styles.length,U=0;V<S;V++){var E=N.styles[V];if(E.legend&&E.legend.href){D.legends[U]={style:E.name,title:E.title,href:E.legend.href,width:E.legend.width,height:E.legend.height};++U}}if(D.legends.length==0){D.legends=null}}this.cntrl.wImg.style.display="none";var J=this.cntrl.map.addLayer(this.serviceType,N.title,this.caps.capability.request.getmap.href,W,OpenLayers.Util.extend(D,this.cntrl.layerImageOptions));this.cntrl.closeForm()},failedOnLoadingUrl:function(B){this.cntrl.closeForm();OpenLayers.Console.userError(B.statusText)},CLASS_NAME:"Geoportal.Control.AddImageLayer"});Geoportal.Control.AddVectorLayer=OpenLayers.Class(Geoportal.Control.Form,{SUPPORTED_CLASSES:["OpenLayers.Geometry.Point","OpenLayers.Geometry.LineString","OpenLayers.Geometry.Polygon"],type:OpenLayers.Control.TYPE_TOGGLE,supportedClasses:null,initialize:function(B){Geoportal.Control.Form.prototype.initialize.apply(this,arguments);if(!this.supportedClasses){this.supportedClasses=[];for(var C=this.SUPPORTED_CLASSES.length-1;C>=0;C--){this.supportedClasses.unshift(this.SUPPORTED_CLASSES[C])}}if(!this.layerVectorOptions){this.layerVectorOptions={}}},activate:function(){if(!Geoportal.Control.Form.prototype.activate.apply(this,arguments)){return false}var B=document.createElement("form");B.id="__addvlayer__"+this.id;B.name=B.id;B.action="javascript:void(null)";this.addvlayer(B);this.map.addControl(this.formControl);this.formControl.activate();this.formControl.addContent(B);return true},deactivate:function(){return Geoportal.Control.Form.prototype.deactivate.apply(this,arguments)},addvlayer:function(C){this.buildInputTextField(C,{id:"layerName",mandatory:true,size:20,length:20,callbacks:[{evt:"click",func:this.onClick}],value:"____________________"});var B=[];var I=false,H=false;var G=false,J=false;for(var E=0,F=this.supportedClasses.length;E<F;E++){var D={value:this.supportedClasses[E],selected:(E==0),text:this.displayClass+".layerType."+this.supportedClasses[E].split(".").pop()};if(this.supportedClasses[E].match(/^OpenLayers\.Geometry\.(LineString|Polygon)$/)){I=true;if(E==0){H=true}}if(this.supportedClasses[E].match(/^(.*\.Format\.(KML|GPX|OSM)|OpenLayers.Layer.WFS)$/)){G=true;if(E==0){J=true}}B.push(D)}this.buildSelectField(C,{id:"layerType",mandatory:true,options:B,callbacks:[{evt:"click",func:this.onClick},{evt:"change",func:this.onChange}]});if(I){this.buildCheckboxField(C,{id:"layerFreeHand",disabled:!H})}if(G){this.buildInputTextField(C,{id:"layerUrl",size:40,disabled:!J,callbacks:[{evt:"click",func:this.onClick}]})}this.buildButton(C,"cancel",this.closeForm);this.buildButton(C,"add",this.onClick);this.wImg=this.buildImageButton(C,"wait",Geoportal.Util.getImagesLocation()+"loading.gif");this.wImg.style.display="none";this.buildResultsField(C)},onClick:function(D,M){if(M||window.event){OpenLayers.Event.stop(M?M:window.event)}if(D.id.match(/^layer(Name|Type|Url)/)&&OpenLayers.String.contains(D.id,this.id)){if(!D.hasFocus){var T=OpenLayers.Util.getElement("layerName"+this.id);if(T&&D.id!=T.id&&T.hasFocus){Geoportal.Control.Form.focusOff(T)}T=OpenLayers.Util.getElement("layerType"+this.id);if(T&&D.id!=T.id&&T.hasFocus){Geoportal.Control.Form.focusOff(T)}T=OpenLayers.Util.getElement("layerUrl"+this.id);if(T&&D.id!=T.id&&T.hasFocus){Geoportal.Control.Form.focusOff(T)}Geoportal.Control.Form.focusOn(D)}return false}if(D.id.match(/^add/)){D=OpenLayers.Util.getElement("layerType"+this.id);var S=OpenLayers.String.trim(D.options[D.selectedIndex].value);if(S==""){return false}D.options[0].selected=true;var P=S.match(/^OpenLayers\.Geometry\.(Point|LineString|Polygon)$/);var H=S.match(/.*\.Format\.KML$/);var R=S.match(/.*\.Format\.GPX$/);var I=S.match(/.*\.Format\.OSM$/);var K=H||R||I;var C=S.match(/.*\.Layer\.(WFS)$/);var E=C;if(!P&&!K&&!E){return false}D=OpenLayers.Util.getElement("layerName"+this.id);var U=OpenLayers.String.trim(D.value);if(U==""&&!E){return false}D.value="";var B=false;D=OpenLayers.Util.getElement("layerFreeHand"+this.id);if(D!=null){B=D.checked;if(S.match(/Point$/)){B=false}D.checked=false}var L=null;if(P){this.wImg.style.display="";L=new OpenLayers.Layer.Vector(U,OpenLayers.Util.extend({projection:this.map.getDisplayProjection().clone(),styleMap:this.styleMapTemplates?this.styleMapTemplates[S]:null,view:{drop:true,zoomToExtent:true}},this.layerVectorOptions[S]));this.map.addLayer(L);var O=OpenLayers.Util.applyDefaults({},{id:"edit_"+L.id,div:OpenLayers.Util.getElement("edit_"+L.id),drawFeatureOptions:OpenLayers.Util.extend({handlerOptions:{style:"default",layerOptions:{styleMap:this.styleMapTemplates?this.styleMapTemplates[S]:null},freehand:B}},this.drawFeatureOptions[S]),dragFeatureOptions:OpenLayers.Util.extend({},this.dragFeatureOptions[S]),modifyFeatureOptions:OpenLayers.Util.extend({},this.modifyFeatureOptions[S]),deleteFeatureOptions:OpenLayers.Util.extend({},this.deleteFeatureOptions[S]),selectFeatureOptions:OpenLayers.Util.extend({multiple:false,clickout:true,toggle:true,hover:false,box:false},this.selectFeatureOptions[S])});O=OpenLayers.Util.extend(O,this.editingToolbarOptions[S]);var N=new Geoportal.Control.EditingToolbar(L,S,O);this.map.addControl(N);L.setVisibility(false)}else{if(K){var J=OpenLayers.Util.getElement("layerUrl"+this.id);if(!J){return false}J=OpenLayers.String.trim(J.value);if(J.length==0){return false}this.wImg.style.display="";var F=OpenLayers.Util.extend({visibility:true,styleMap:this.styleMapTemplates?this.styleMapTemplates[S]:null},this.layerVectorOptions[S]);if(!F.eventListeners){F.eventListeners={}}var Q=F.eventListeners.loadend;F.eventListeners.loadend=function(){if(typeof (Q)=="function"){Q()}var V=this.getDataExtent();if(V){if(V.getWidth()==0||V.getHeight()==0){}else{this.map.zoomToExtent(V)}}};L=this.map.addLayer(H?"KML":R?"GPX":"OSM",U,J,F,{})}else{if(E){var J=OpenLayers.Util.getElement("layerUrl"+this.id);if(!J){return false}J=OpenLayers.String.trim(J.value);if(J.length==0){return false}this.wImg.style.display="";var G=OpenLayers.Request.GET({async:true,url:J,params:{SERVICE:"WFS",REQUEST:"GetCapabilities"},success:this.successedInLoadingUrl,failure:this.failedOnLoadingUrl,scope:{cntrl:this,serviceType:C[1],name:U}});return false}else{OpenLayers.Console.error("type "+S+" not supported")}}}}this.wImg.style.display="none";this.closeForm();return false},onChange:function(D,B){var C=D.id;C=C.replace(/^layerType/,"layerName");var E=OpenLayers.Util.getElement(C);if(E){if(D.options[D.selectedIndex].value.match(/^OpenLayers.Layer.WFS$/)){E.disabled=true}else{E.disabled=false}}C=C.replace(/^layerName/,"layerFreeHand");E=OpenLayers.Util.getElement(C);if(E){if(D.options[D.selectedIndex].value=="OpenLayers.Geometry.LineString"||D.options[D.selectedIndex].value=="OpenLayers.Geometry.Polygon"){E.disabled=false}else{E.disabled=true;E.checked=false}}C=C.replace(/^layerFreeHand/,"layerUrl");E=OpenLayers.Util.getElement(C);if(E){if(D.options[D.selectedIndex].value.match(/^(.*\.Format\.(KML|GPX|OSM)|OpenLayers.Layer.WFS)$/)){E.disabled=false}else{E.value="";E.disabled=true}}},successedInLoadingUrl:function(D){if(!D){this.cntrl.wImg.style.display="none";return }var U=D.responseXML;if(!U&&D.responseText){U=OpenLayers.parseXMLString(D.responseText);var R=OpenLayers.Request.XMLHttpRequest.getParseErrorText(U);if(R!=OpenLayers.Request.XMLHttpRequest.PARSED_OK){this.cntrl.wImg.style.display="none";OpenLayers.Console.userError(OpenLayers.i18n(R));return }}var G=new OpenLayers.Format.WFSCapabilities();var B=null;try{B=G.read(U)}catch(T){this.cntrl.wImg.style.display="none";OpenLayers.Console.userError(T);return }if(B.exceptions){var F="";for(var N=0,L=B.exceptions.length;N<L;N++){F+=B.exceptions[N]+"\n"}this.cntrl.wImg.style.display="none";OpenLayers.Console.userError(F);return }var Q=OpenLayers.Util.getElement("results"+this.cntrl.id);Q.innerHTML="";var S=0;var I=this.cntrl.map.getMaxExtent();switch(B.version){case"1.0.0":case"1.1.0":for(var N=0,O=B.featureTypeList.featureTypes.length;N<O;N++){var P=B.featureTypeList.featureTypes[N];if(P.bbox.length>0){var E=new OpenLayers.Bounds();for(var M=0,K=P.bbox.length;M<K;M++){E.extend(OpenLayers.Bounds.fromArray(P.bbox[M]))}E.transform(OpenLayers.Projection.CRS84,this.cntrl.map.getProjection());if(!I.containsBounds(E,true,true)&&!E.containsBounds(I,true,true)){continue}}var J=document.createElement("div");J.className="gpWFSCapsFeatureTypesResult";if((S%2)==1){J.className+="Alternate"}var H=document.createElement("span");H.innerHTML=P.title;H.style.cursor="pointer";var C={cntrl:this.cntrl,serviceType:this.serviceType,name:this.name,caps:B,featureTypeIndex:S};OpenLayers.Event.observe(H,"click",OpenLayers.Function.bindAsEventListener(this.cntrl.onFeatureTypeNameClick,C));J.appendChild(H);Q.appendChild(J);S++}break;default:break}if(S==0){var J=document.createElement("div");J.className="gpWFSCapsFeatureTypesResult";var H=document.createElement("span");switch(B.version){case"1.0.0":case"1.1.0":H.innerHTML=OpenLayers.i18n("wfs.caps.no.feature.found");break;default:H.innerHTML=OpenLayers.i18n("wfs.caps.unsupported.version",{version:B.version});break}J.appendChild(H);Q.appendChild(J)}this.cntrl.wImg.style.display="none";Q.style.display=""},onFeatureTypeNameClick:function(K){if(K||window.event){OpenLayers.Event.stop(K?K:window.event)}this.cntrl.wImg.style.display="";var G=this.caps.featureTypeList.featureTypes[this.featureTypeIndex];var D={VERSION:this.caps.version,TYPENAME:G.name};var J=null;if(G.bbox.length>0){J=new OpenLayers.Bounds();for(var E=0,F=G.bbox.length;E<F;E++){J.extend(OpenLayers.Bounds.fromArray(G.bbox[E]))}var C=new OpenLayers.Projection(G.srs);J.transform(OpenLayers.Projection.CRS84,C)}var L={projection:G.srs,maxExtent:J,visibility:true};var I="OpenLayers.Layer.WFS";switch(this.serviceType){case"WFS":break;default:break}if(G["abstract"]){L.description=G["abstract"]}L.originators=[{logo:"logo"+G.name,pictureUrl:Geoportal.Util.getImagesLocation()+"logo_unknownAuthority.gif",url:(G.href?G.href:"javascript:void(0)")}];if(G.metadataURLs&&G.metadataURLs.length>0){L.metadataURL=G.metadataURLs[0].href}this.cntrl.wImg.style.display="none";var B=null;switch(this.caps.version){case"1.0.0":case"1.1.0":B=this.caps.capability.operations.GetFeature.post.href;break;default:break}var H=this.cntrl.map.addLayer(this.serviceType,G.title||this.name,B,D,OpenLayers.Util.extend(L,this.cntrl.layerVectorOptions[I]));this.cntrl.closeForm()},failedOnLoadingUrl:function(B){this.cntrl.closeForm();OpenLayers.Console.userError(B.statusText)},CLASS_NAME:"Geoportal.Control.AddVectorLayer"});Geoportal.Control.LayerOpacity=OpenLayers.Class(Geoportal.Control,{layer:null,opacitable:false,slider:null,initialize:function(C,B){Geoportal.Control.prototype.initialize.apply(this,[B]);this.layer=C;this.opacitable=typeof (this.layer.opacity)=="number";if(!this.opacitable){if(this.div){this.div.title="";if(this.panel_div){this.panel_div.title=this.div.title}}}},destroy:function(){this.deactivate();if(this.slider){this.slider.destroy()}this.slider=null;this.layer=null;Geoportal.Control.prototype.destroy.apply(this,arguments)},activate:function(){this.slider.activate();return Geoportal.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.slider){this.slider.deactivate()}return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.redraw();this.activate();return this.div},redraw:function(){if(this.opacitable){this.panel_div.innerHTML="";var B=document.createElement("div");B.id="trackSlider_"+this.layer.id;B.className="gpControlLayerOpacityTrackSliderClass";this.panel_div.appendChild(B);var D=document.createElement("div");D.id="Opacity_"+this.layer.id;D.className="gpControlLayerOpacityOpacityClass";D.appendChild(document.createTextNode(""+Math.round(this.layer.opacity*100)+"%"));this.panel_div.appendChild(D);var C=Geoportal.Util.getImagesLocation();this.slider=new Geoportal.Control.LayerOpacitySlider(this.layer,{id:B.id,div:B,levelBarImgWidth:50,levelBarImgHeight:5,levelBarImg:C+"bg_handle.gif",sliderImgWidth:7,sliderImgHeight:11,sliderImg:C+"cursor.gif",_opacityDiv:D,onDraw:function(E){this._opacityDiv.firstChild.nodeValue=E+"%"},onSliderMove:function(E){this._opacityDiv.firstChild.nodeValue=E+"%"}});this.map.addControl(this.slider,new OpenLayers.Pixel(0,3))}return this.div},refreshOpacity:function(){if(this.opacitable&&this.slider){this.slider.moveSlider()}},changeLang:function(B){if(this.opacitable){this.div.title=OpenLayers.i18n(this.displayClass+".title");if(this.panel_div){this.panel_div.title=this.div.title}}},CLASS_NAME:"Geoportal.Control.LayerOpacity"});Geoportal.Control.MousePosition=OpenLayers.Class(Geoportal.Control,{prefix:"",separator:", ",suffix:"",numDigits:0,displayProjection:null,pssKey:null,selectUnits:null,currentUnit:Number.NaN,lonInput:null,latInput:null,zoneInput:null,pss:null,displaySystemUnits:{longlat:["sexa","deg","gon","rad"],utm:["km","m","cm"],proj:["km","m","cm"]},initialize:function(C){Geoportal.Control.prototype.initialize.apply(this,arguments);this.pss={};for(var B in Geoportal.Control.MousePosition.PSS){if(Geoportal.Control.MousePosition.PSS.hasOwnProperty(B)){this.pss[B]={};for(var D in Geoportal.Control.MousePosition.PSS[B]){if(Geoportal.Control.MousePosition.PSS[B].hasOwnProperty(D)){if(typeof (Geoportal.Control.MousePosition.PSS[B][D])=="string"){this.pss[B][D]=OpenLayers.String.format(Geoportal.Control.MousePosition.PSS[B][D],{id:this.id,lon:"${lon}",lat:"${lat}",zone:"${zone}"})}else{this.pss[B][D]=Geoportal.Control.MousePosition.PSS[B][D]}}}}}this.pss.longlat.abscissa=this.displayClass+".longitude";this.pss.longlat.ordinate=this.displayClass+".latitude";this.pss.utm.abscissa=this.displayClass+".easting";this.pss.utm.ordinate=this.displayClass+".northing";this.pss.utm.zone=this.displayClass+".utmZone";this.pss.proj.abscissa=this.displayClass+".easting";this.pss.proj.ordinate=this.displayClass+".northing";this.setPssKey()},destroy:function(){if(this.map){this.map.events.unregister("mousemove",this,this.redraw);this.map.events.unregister("moveend",this,this.redraw);this.map.events.unregister("changebaselayer",this,this.changeBaseLayer);this.map.events.unregister("changedisplayprojection",this,this.changeDisplayProjection)}if(this.selectUnits!=null){OpenLayers.Event.stopObservingElement(this.selectUnits);this.selectUnits=null}this.lonInput=null;this.latInput=null;this.zoneInput=null;this.pss=null;Geoportal.Control.prototype.destroy.apply(this,arguments)},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.div.className=this.displayClass;this.redraw();return this.div},redraw:function(B){var C=null;if(B==null||B.xy==undefined){C=this.map.getCenter();if(!C){C=new OpenLayers.LonLat(0,0)}}else{C=this.map.getLonLatFromPixel(B.xy)}if(!C){return }C.transform(this.map.getProjection(),this.displayProjection);this.formatOutput(C)},formatOutput:function(C){if(this.displayProjection&&!this.pssKey){this.setPssKey()}var E;switch(this.pssKey){case"longlat":if(this.units[this.currentUnit]=="sexa"){E=this.displayDMS(C)}else{E=this.displayDEC(C)}break;case"utm":E=this.displayMRGS(C);break;default:E=this.displayEN(C);break}if(typeof (E)=="string"){while(this.div.childNodes.length>0){this.div.removeChild(this.div.firstChild)}var B=document.createElement("div");B.style.border="0px";B.style.padding="0px";B.style.margin="0px";B.innerHTML=E;this.div.appendChild(B);var D=this.map.getControlsByClass(OpenLayers.Control.KeyboardDefaults.prototype.CLASS_NAME)[0];this.selectUnits=OpenLayers.Util.getElement("__sdsu__"+this.id);if(this.selectUnits!=null){this.selectUnits.hasFocus=false;this.selectUnits.kbControl=D;if(this.selectUnits.kbControl){OpenLayers.Event.observe(this.selectUnits,"click",OpenLayers.Function.bind(this.onClick,this,this.selectUnits));OpenLayers.Event.observe(this.selectUnits,"change",OpenLayers.Function.bind(this.onChangeUnit,this,this.selectUnits))}}var F=this.map.getControlsByClass(Geoportal.Control.Information.prototype.CLASS_NAME)[0];this.lonInput=OpenLayers.Util.getElement("__lon__"+this.id);if(this.lonInput!=null){this.lonInput.hasFocus=false;this.lonInput.kbControl=D;this.lonInput.ciControl=F;if(this.lonInput.kbControl){OpenLayers.Event.observe(this.lonInput,"click",OpenLayers.Function.bind(this.onClick,this,this.lonInput));OpenLayers.Event.observe(this.lonInput,"focus",OpenLayers.Function.bind(this.onClick,this,this.lonInput));OpenLayers.Event.observe(this.lonInput,"change",OpenLayers.Function.bind(this.onChangeLonLat,this,this.lonInput));OpenLayers.Event.observe(this.lonInput,"blur",OpenLayers.Function.bind(this.onChangeLonLat,this,this.lonInput))}}this.latInput=OpenLayers.Util.getElement("__lat__"+this.id);if(this.latInput!=null){this.latInput.hasFocus=false;this.latInput.kbControl=D;this.latInput.ciControl=F;if(this.latInput.kbControl){OpenLayers.Event.observe(this.latInput,"click",OpenLayers.Function.bind(this.onClick,this,this.latInput));OpenLayers.Event.observe(this.latInput,"focus",OpenLayers.Function.bind(this.onClick,this,this.latInput));OpenLayers.Event.observe(this.latInput,"change",OpenLayers.Function.bind(this.onChangeLonLat,this,this.latInput));OpenLayers.Event.observe(this.latInput,"blur",OpenLayers.Function.bind(this.onChangeLonLat,this,this.latInput))}}this.zoneInput=OpenLayers.Util.getElement("__zone__"+this.id)}else{if(this.lonInput!=null){this.lonInput.value=E.lon}if(this.latInput!=null){this.latInput.value=E.lat}if(this.zoneInput!=null){this.zoneInput.value=E.zone}if(this.units[this.currentUnit]=="sexa"){if(this.lonInput!=null){this.lonInput.size=16}if(this.latInput!=null){this.latInput.size=16}}else{if(this.lonInput!=null){this.lonInput.size=11}if(this.latInput!=null){this.latInput.size=11}}}},setPssKey:function(){if(!this.displayProjection){this.pssKey=null;return }switch(this.displayProjection.getProjName()){case"longlat":case"utm":this.pssKey=this.displayProjection.getProjName();break;default:this.pssKey="proj";break}this.setPSS()},setPSS:function(){var C=this.pss[this.pssKey];var E=OpenLayers.i18n(C.abscissa);var D=OpenLayers.i18n(C.ordinate);var B=OpenLayers.i18n(C.zone!==undefined?C.zone:"");this.prefix=C.prefix.replace(/@abscissa@/g,E).replace(/@ordinate@/g,D).replace(/@zone@/g,B);this.separator=C.separator.replace(/@abscissa@/g,E).replace(/@ordinate@/g,D).replace(/@zone@/g,B);this.suffix=C.suffix.replace(/@abscissa@/g,E).replace(/@ordinate@/g,D).replace(/@zone@/g,B);this.units=this.displaySystemUnits[this.pssKey].slice(0);this.currentUnit=(isNaN(this.currentUnit)?C.defaultUnit:this.currentUnit);if(this.selectUnits!=null){OpenLayers.Event.stopObservingElement(this.selectUnits);this.selectUnits=null}this.lonInput=null;this.latInput=null;this.zoneInput=null;if(this.div){while(this.div.childNodes.length>0){this.div.removeChild(this.div.firstChild)}}},displayDMS:function(C){var J=OpenLayers.i18n(this.displayClass+".north");var D=OpenLayers.i18n(this.displayClass+".south");var G=OpenLayers.i18n(this.displayClass+".east");var B=OpenLayers.i18n(this.displayClass+".west");var I=Geoportal.Util.degToDMS(C.lon,[G,B]);var H=Geoportal.Util.degToDMS(C.lat,[J,D]);if(this.selectUnits==null){var F=this.prefix+this.separator+this.getSuffix();F=OpenLayers.String.format(F,{lon:I.replace(/"/g,"&quot;").replace(/ /g,"&nbsp;"),lat:H.replace(/"/g,"&quot;").replace(/ /g,"&nbsp;")});return F}return{lon:I,lat:H}},displayDEC:function(C){var E=1,B=11,H=6;if(this.units[this.currentUnit]=="gon"){E=1.1111111111111112}else{if(this.units[this.currentUnit]=="rad"){E=0.017453292519943295;H=8}}var G=OpenLayers.String.sprintf("%*.*f",B,H,C.lon*E);var F=OpenLayers.String.sprintf("%*.*f",B,H,C.lat*E);if(this.selectUnits==null){var D=this.prefix+this.separator+this.getSuffix();D=OpenLayers.String.format(D,{lon:G.replace(/ /g,"&nbsp;"),lat:F.replace(/ /g,"&nbsp;")});return D}return{lon:G,lat:F}},displayEN:function(B){var D=1;if(this.units[this.currentUnit]=="km"){D=0.001}else{if(this.units[this.currentUnit]=="cm"){D=100}}var F=OpenLayers.String.sprintf("%*.*f",10,this.numDigits,B.lon*D);var E=OpenLayers.String.sprintf("%*.*f",10,this.numDigits,B.lat*D);if(this.selectUnits==null){var C=this.prefix+this.separator+this.getSuffix();C=OpenLayers.String.format(C,{lon:F.replace(/ /g,"&nbsp;"),lat:E.replace(/ /g,"&nbsp;")});return C}return{lon:F,lat:E}},displayMRGS:function(C){var E=1;if(this.units[this.currentUnit]=="km"){E=0.001}else{if(this.units[this.currentUnit]=="cm"){E=100}}var G=OpenLayers.String.sprintf("%*.*f",10,this.numDigits,C.lon*E);var F=OpenLayers.String.sprintf("%*.*f",10,this.numDigits,C.lat*E);var B=OpenLayers.Projection.getMGRSZone(this.displayProjection.getProperty("zone"),C.clone().transform(this.map.getProjection(),OpenLayers.Projection.CRS84));if(this.selectUnits==null){var D=this.prefix+this.separator+this.getSuffix();D=OpenLayers.String.format(D,{lon:G.replace(/ /g,"&nbsp;"),lat:F.replace(/ /g,"&nbsp;"),zone:B});return D}return{lon:G,lat:F,zone:B}},changeLang:function(B){this.setPSS();this.redraw()},changeBaseLayer:function(B){if(B){this.displayProjection=B.layer.displayProjection?B.layer.displayProjection.clone():B.layer.getNativeProjection().clone();this.pssKey=null;this.redraw()}},changeDisplayProjection:function(B){if(B){if(!(this.displayProjection.getProjName()==B.displayProjection.getProjName()||(this.displayProjection.isUTMZoneProjection()&&B.displayProjection.isUTMZoneProjection()))){this.currentUnit=Number.NaN}this.displayProjection=B.displayProjection;this.pssKey=null;this.redraw();this.keepSelectedUnit=undefined}},onClick:function(E,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(E.hasFocus){return }Geoportal.Control.Form.focusOn(E);if(E==this.lonInput||E==this.latInput){if(E.ciControl){E.ciControl.setSelectable()}var D=Geoportal.Util.getComputedStyle(E,"color")||"#000000";var C=Geoportal.Util.getComputedStyle(E,"background-color")||"#FFFFFF";E.style.color=C;E.style.backgroundColor=D}},onChangeUnit:function(C,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(!C.hasFocus){return }this.currentUnit=C.selectedIndex;Geoportal.Control.Form.focusOff(C);this.redraw()},onChangeLonLat:function(F,J){if(J||window.event){OpenLayers.Event.stop(J?J:window.event)}if(!F.hasFocus){return }Geoportal.Control.Form.focusOff(F);if(F.ciControl){F.ciControl.setSelectable(false)}var G=Geoportal.Util.getComputedStyle(F,"color")||"#FFFFFF";var E=Geoportal.Util.getComputedStyle(F,"background-color")||"#000000";F.style.color=E;F.style.backgroundColor=G;var I=this.lonInput.value,C=this.latInput.value;if(this.units[this.currentUnit]!="sexa"){I=parseFloat(I);C=parseFloat(C)}else{I=Geoportal.Util.dmsToDeg(I);C=Geoportal.Util.dmsToDeg(C)}if(!isNaN(I)&&!isNaN(C)){var B=1;switch(this.units[this.currentUnit]){case"gon":B=1.1111111111111112;break;case"rad":B=0.017453292519943295;break;case"km":B=0.001;break;case"cm":B=100;break;default:break}I/=B;C/=B;var H=new OpenLayers.LonLat(I,C);H.transform(this.displayProjection,this.map.getProjection());var D=(this.map.getProjection()?this.map.getProjection().getProjName()=="longlat"?0.000028:1:undefined);if(!this.map.getCenter().equals(H,D)){this.map.setCenter(H)}}},getSuffix:function(){var D='<select id="__sdsu__${id}" name="__sdsu__${id}" size="1" class="gpSelectUnits">';D=OpenLayers.String.format(D,{id:this.id});for(var C=0,B=this.units.length;C<B;C++){D+='<option value="'+C+'"'+(C==this.currentUnit?' selected="selected"':"")+">"+OpenLayers.i18n(this.displayClass+"."+this.units[C])+"</option>"}D+="</select>";return D+this.suffix},setMap:function(){Geoportal.Control.prototype.setMap.apply(this,arguments);this.map.events.register("mousemove",this,this.redraw);this.map.events.register("moveend",this,this.redraw);this.map.events.register("changebaselayer",this,this.changeBaseLayer);this.map.events.register("changedisplayprojection",this,this.changeDisplayProjection)},updateSize:function(){if(this.div.parentNode){var D=Geoportal.Util.getComputedStyle(this.div.parentNode,"width",true);if(!D){return }var C=1;var B=Geoportal.Util.getComputedStyle(this.div,"width",true);if(!B){return }while((D<B)&&C>0.1){C-=0.1;this.div.style.fontSize=C.toFixed(1)+"em";B=Geoportal.Util.getComputedStyle(this.div,"width",true)}if(C<0.1){this.div.style.fontSize="0.5em";this.div.style.left="5%"}else{this.div.style.left=(100*(D-B)/(2*D)).toFixed(0)+"%"}}},CLASS_NAME:"Geoportal.Control.MousePosition"});Geoportal.Control.MousePosition.PSS={longlat:{abscissa:"",ordinate:"",prefix:'<form id="__lamp__${id}" name="__lamp__${id}" action="javascript:void(null)"><b>@abscissa@ :</b> <input id="__lon__${id}" class="gpLong" type="text" value="${lon}" size="11"/>',separator:'&nbsp;&nbsp;<b>@ordinate@ :</b> <input id="__lat__${id}" class="gpLat" type="text" value="${lat}" size="11"/>',suffix:"</form>",defaultUnit:1},utm:{abscissa:"",ordinate:"",prefix:'<form id="__lamp__${id}" name="__lamp__${id}" action="javascript:void(null)"><b>@zone@ :</b> <input id="__zone__${id}" class="gpZone" type="text" value="${zone}" size="3"/>&nbsp;&nbsp;<b>@abscissa@ :</b> <input id="__lon__${id}" class="gpLong" type="text" value="${lon}" size="11"/>',separator:'&nbsp;&nbsp;<b>@ordinate@ :</b> <input id="__lat__${id}" class="gpLat" type="text" value="${lat}" size="11"/>',suffix:"</form>",defaultUnit:1},proj:{abscissa:"",ordinate:"",prefix:'<form id="__lamp__${id}" name="__lamp__${id}" action="javascript:void(null)"><b>@abscissa@ :</b> <input id="__lon__${id}" class="gpLong" type="text" value="${lon}" size="11"/>',separator:'&nbsp;&nbsp;<b>@ordinate@ :</b> <input id="__lat__${id}" class="gpLat" type="text" value="${lat}" size="11"/>',suffix:"</form>",defaultUnit:1}};Geoportal.Control.ZoomBar=OpenLayers.Class(Geoportal.Control,{slider:null,nameScaleDivID:null,initialize:function(){Geoportal.Control.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.slider){if(this.map){this.map.removeControl(this.slider)}this.slider.destroy();this.slider=null}if(this.map){this.map.events.unregister("zoomend",this,this.moveZoomBar);this.map.events.unregister("changebaselayer",this,this.redraw)}Geoportal.Control.prototype.destroy.apply(this,arguments)},redraw:function(){if(this.div!=null){if(this.slider){this.slider.destroy();this.slider=null}this.div.innerHTML=""}this.draw(this.position)},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this._addZoomBar();return this.div},_addZoomBar:function(){this.nameScaleDivID=OpenLayers.Util.createUniqueID("nameScale");var C=document.createElement("div");C.id=this.nameScaleDivID;C.className="nameScale";this.div.appendChild(C);var B=document.createElement("div");B.innerHTML=OpenLayers.i18n(this.displayClass+".world");C.appendChild(B);B=document.createElement("div");B.innerHTML=OpenLayers.i18n(this.displayClass+".state");C.appendChild(B);B=document.createElement("div");B.innerHTML=OpenLayers.i18n(this.displayClass+".country");C.appendChild(B);B=document.createElement("div");B.innerHTML=OpenLayers.i18n(this.displayClass+".town");C.appendChild(B);B=document.createElement("div");B.innerHTML=OpenLayers.i18n(this.displayClass+".street");C.appendChild(B);B=document.createElement("div");B.innerHTML=OpenLayers.i18n(this.displayClass+".house");C.appendChild(B);var D="Geoportal_Control_ZoomSlider"+this.map.id;C=document.createElement("div");C.id=D;if(C.style.styleFloat==undefined){C.style.cssFloat="left"}else{C.style.styleFloat="left"}this.div.appendChild(C);var J=0;var I=this.map.getNumZoomLevels()-1;if(this.map.baseLayer instanceof Geoportal.Map){var H=undefined;if(this.map.baseLayer.name=="_WLD_world_"){var G=this.map.getCenter().transform(this.map.getProjection(),OpenLayers.Projection.CRS84);var K=this.map.catalogue.findTerritory(G);if(K!="WLD"){var E=this.map.getLayersByName("_"+K+"_territory_");if(E.length>0){H=E[0].maxZoomLevel}}}if(H==undefined){I=this.map.baseLayer.maxZoomLevel}}else{if(this.map.baseLayer.minZoomLevel!=undefined){J=this.map.baseLayer.minZoomLevel}if(this.map.baseLayer.maxZoomLevel!=undefined&&this.map.baseLayer.maxZoomLevel!=this.map.baseLayer.minZoomLevel){I=this.map.baseLayer.maxZoomLevel}}if(I>this.map.getNumZoomLevels()-1){I=this.map.getNumZoomLevels()-1}var F=Geoportal.Util.getImagesLocation();this.slider=new Geoportal.Control.ZoomSlider({div:OpenLayers.Util.getElement(D),levelBarImgWidth:10,levelBarImgHeight:130,levelBarImg:F+"bg_zoomVertical.gif",sliderImgWidth:15,sliderImgHeight:7,sliderImg:F+"zoom_curseur.gif",getMinSelectableLevel:function(){return J},getMaxSelectableLevel:function(){return I}});this.map.addControl(this.slider,new OpenLayers.Pixel(10,0))},changeLang:function(B){var C=OpenLayers.Util.getElement(this.nameScaleDivID);C.childNodes[0].innerHTML=OpenLayers.i18n(this.displayClass+".world");C.childNodes[1].innerHTML=OpenLayers.i18n(this.displayClass+".state");C.childNodes[2].innerHTML=OpenLayers.i18n(this.displayClass+".country");C.childNodes[3].innerHTML=OpenLayers.i18n(this.displayClass+".town");C.childNodes[4].innerHTML=OpenLayers.i18n(this.displayClass+".street");C.childNodes[5].innerHTML=OpenLayers.i18n(this.displayClass+".house")},CLASS_NAME:"Geoportal.Control.ZoomBar"});Geoportal.Control.ZoomBar.ZOOMRANGE=21;Geoportal.OLS.Address=OpenLayers.Class(Geoportal.OLS.AbstractAddress,{name:null,postalCode:null,streetAddress:null,places:null,initialize:function(B,C){this.name=null;this.postalCode=null;this.streetAddress=null;this.places=[];Geoportal.OLS.AbstractAddress.prototype.initialize.apply(this,arguments)},destroy:function(){this.name=null;if(this.postalCode){this.postalCode.destroy();this.postalCode=null}if(this.streetAddress){this.streetAddress.destroy();this.streetAddress=null}if(this.places){for(var C=0,B=this.places.length;C<B;C++){this.places[C].destroy();this.places[C]=null}this.places=null}Geoportal.OLS.AbstractAddress.prototype.destroy.apply(this,arguments)},clone:function(){var D=new Geoportal.OLS.Address(this.countryCode);D.addressee=this.addressee;D.name=this.name;if(this.postalCode){D.postalCode=this.postalCode.clone()}if(this.streetAddress){D.streetAddress=this.streetAddress.clone()}if(this.places){for(var C=0,B=this.places.length;C<B;C++){D.places.push(this.places[C].clone())}}return D},addPlace:function(B){if(!this.places){this.places=[]}if(B){this.places.push(B)}},getNbPlaces:function(){return this.places?this.places.length:0},getPlaces:function(){return this.places?this.places:null},toString:function(){var H="";if(!this.streetAddress){H+=this.name}else{var B=this.streetAddress._streetLocation;if(B){if(B instanceof Geoportal.OLS.Building){if(B.num){H+=B.num}if(B.subdivision){H+=B.subdivision}H+=", "}}for(var E=0,D=this.streetAddress.getNbStreets();E<D;E++){var I=this.streetAddress.getStreets()[E];if(I.name!=null){H+=I.name}else{H+=I.typePrefix+" "+I.officialName+" "+I.typeSuffix}H+=", "}}var F=this.getNbPlaces();if(F>0){for(var G=0;G<F;G++){var C=this.getPlaces()[G];if(C.classification&&C.name){if(C.classification){H+=" "+OpenLayers.i18n(C.classification)}if(C.name){H+=" ["+C.name+"]"}H+=", "}}}if(this.postalCode&&this.postalCode.name){H+=" ["+this.postalCode.name+"]"}H=H.replace(/^(\s*,)+/,"").replace(/(\s*,)+$/,"");return H},toHTMLString:function(){var F="";if(!this.streetAddress){F+="<b>"+this.name+"</b>"}else{var B=this.streetAddress._streetLocation;if(this.streetAddress._streetLocation){if(B instanceof Geoportal.OLS.Building){if(B.num){F+=B.num}if(B.subdivision){F+=B.subdivision}F+=",&nbsp;"}}for(var E=0,D=this.streetAddress.getNbStreets();E<D;E++){var G=this.streetAddress.getStreets()[E];if(G.name){F+="<b>"+G.name+"</b>"}else{F+="<b>"+G.typePrefix+" "+G.officialName+" "+G.typeSuffix+"</b>"}F+="<br/>"}}var D=this.getNbPlaces();if(D>0){for(var E=0;E<D;E++){var C=this.getPlaces()[E];if(C.classification&&C.name){if(C.classification){F+=" "+OpenLayers.i18n(C.classification)}if(C.name){F+=" ["+C.name+"]"}F+="<br/>"}}}if(this.postalCode&&this.postalCode.name){F+=OpenLayers.i18n("geocoded.address.popup.postalCode")+"&nbsp;: "+this.postalCode.name}return F},CLASS_NAME:"Geoportal.OLS.Address"});Geoportal.OLS.Request=OpenLayers.Class(Geoportal.OLS.AbstractBody,{methodName:null,version:null,requestID:null,maximumResponses:null,_requestParameters:null,initialize:function(C,B,E,D){this.methodName=C;this.version=B;this.requestID=E;this.maximumResponses=null;this._requestParameters=null;Geoportal.OLS.prototype.initialize.apply(this,[D])},destroy:function(){this.methodName=null;this.version=null;this.requestID=null;this.maximumResponses=null;if(this._requestParameters){this._requestParameters.destroy();this._requestParameters=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},getRequestParameters:function(){return this._requestParameters?this._requestParameters:null},setRequestParameters:function(B){this._requestParameters=B},CLASS_NAME:"Geoportal.OLS.Request"});Geoportal.OLS.RequestHeader=OpenLayers.Class(Geoportal.OLS.AbstractHeader,{clientName:null,clientPassword:null,sessionID:null,srsName:null,MSID:null,initialize:function(B){this.clientName=null;this.clientPassword=null;this.sessionID=null;this.srsName=null;this.MSID=null;Geoportal.OLS.AbstractHeader.prototype.initialize.apply(this,arguments)},destroy:function(){this.clientName=null;this.clientPassword=null;this.sessionID=null;this.srsName=null;this.MSID=null;Geoportal.OLS.AbstractHeader.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.RequestHeader"});Geoportal.OLS.Response=OpenLayers.Class(Geoportal.OLS.AbstractBody,{version:null,requestID:null,numberOfResponses:null,errorList:null,_responseParameters:null,initialize:function(B,C){this.version=B;this.requestID=null;this.numberOfResponses=null;this.errorList=null;this._responseParameters=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.version=null;this.requestID=null;this.numberOfResponses=1;if(this.errorList){this.errorList.destroy();this.errorList=null}if(this._responseParameters){this._responseParameters.destroy();this._responseParameters=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},getResponseParameters:function(){return this._responseParameters?this._responseParameters:null},setResponseParameters:function(B){this._responseParameters=B},CLASS_NAME:"Geoportal.OLS.Response"});Geoportal.OLS.ResponseHeader=OpenLayers.Class(Geoportal.OLS.AbstractHeader,{sessionID:null,errorList:null,initialize:function(B){this.sessionID=null;this.errorList=null;Geoportal.OLS.AbstractHeader.prototype.initialize.apply(this,arguments)},destroy:function(){this.sessionID=null;if(this.errorList){this.errorList.destroy();this.errorList=null}Geoportal.OLS.AbstractHeader.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.ResponseHeader"});Geoportal.OLS.UOM.Angle=OpenLayers.Class(Geoportal.OLS.UOM.AbstractMeasure,{uom:"DecimalDegrees",initialize:function(C,B){this.value=C;Geoportal.OLS.UOM.AbstractMeasure.prototype.initialize.apply(this,[B]);this.uom="DecimalDegrees"},destroy:function(){this.uom="DecimalDegrees";Geoportal.OLS.UOM.AbstractMeasure.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.Angle"});Geoportal.OLS.UOM.Distance=OpenLayers.Class(Geoportal.OLS.UOM.AbstractMeasure,{uom:"M",initialize:function(C,B){this.value=C;this.uom="M";Geoportal.OLS.UOM.AbstractMeasure.prototype.initialize.apply(this,[B])},destroy:function(){this.uom=null;Geoportal.OLS.UOM.AbstractMeasure.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.Distance"});Geoportal.OLS.UOM.Speed=OpenLayers.Class(Geoportal.OLS.UOM.AbstractMeasure,{uom:"KPH",initialize:function(C,B){this.value=C;this.uom="KPH";Geoportal.OLS.UOM.AbstractMeasure.prototype.initialize.apply(this,[B])},destroy:function(){this.uom=null;Geoportal.OLS.UOM.AbstractMeasure.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.Speed"});Geoportal.OLS.UOM.Time=OpenLayers.Class(Geoportal.OLS.UOM.TimeStamp,{utcOffset:null,initialize:function(C,B){this.begin=C;this.utcOffset=null;Geoportal.OLS.UOM.TimeStamp.prototype.initialize.apply(this,[B])},destroy:function(){this.utcOffset=null;Geoportal.OLS.UOM.TimeStamp.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.Time"});Geoportal.Control.BasicLayerToolbar=OpenLayers.Class(Geoportal.Control.Panel,{layer:null,panelToggleCntrlId:null,removeLayerCntrlId:null,opacitySliderCntrlId:null,zoomToLayerMaxExtentCntrlId:null,initialize:function(C,B){Geoportal.Control.Panel.prototype.initialize.apply(this,[B]);this.layer=C;var D=null;if(!B){B={}}if(!B.panelToggleOptions){B.panelToggleOptions={}}this.panelToggleCntrlId=B.panelToggleOptions.id||(B.panelToggleOptions.div?B.panelToggleOptions.div.id:null)||"panelToggle_"+this.layer.id;this.addControls(new Geoportal.Control.PanelToggle(this,OpenLayers.Util.extend({id:this.panelToggleCntrlId},B.panelToggleOptions)));if(!B.removeLayerOptions){B.removeLayerOptions={}}this.removeLayerCntrlId=B.removeLayerOptions.id||(B.removeLayerOptions.div?B.removeLayerOptions.div.id:null)||"layerDrop_"+this.layer.id;this.addControls(new Geoportal.Control.RemoveLayer(this.layer,OpenLayers.Util.extend({id:this.removeLayerCntrlId,title:"gpControlRemoveLayer.title"},B.removeLayerOptions)));if(!B.layerOpacityOptions){B.layerOpacityOptions={}}if(this.layer.opacity&&typeof (this.layer.opacity)==="number"){this.opacitySliderCntrlId=B.layerOpacityOptions.id||(B.layerOpacityOptions.div?B.layerOpacityOptions.div.id:null)||"layerOpacity_"+this.layer.id;this.addControls(new Geoportal.Control.LayerOpacity(this.layer,OpenLayers.Util.extend({id:this.opacitySliderCntrlId,title:"gpControlLayerOpacity.title"},B.layerOpacityOptions)))}if(!B.zoomToLayerMaxExtentOptions){B.zoomToLayerMaxExtentOptions={}}this.zoomToLayerMaxExtentCntrlId=B.zoomToLayerMaxExtentOptions.id||(B.zoomToLayerMaxExtentOptions.div?B.zoomToLayerMaxExtentOptions.div.id:null)||"layerZoom_"+this.layer.id;this.addControls(new Geoportal.Control.ZoomToLayerMaxExtent(this.layer,OpenLayers.Util.extend({id:this.zoomToLayerMaxExtentCntrlId,title:"gpControlZoomToLayerMaxExtent.title"},B.zoomToLayerMaxExtentOptions)))},draw:function(B){Geoportal.Control.Panel.prototype.draw.apply(this,arguments);if(this.panelVisibility){this.activateControl(this.getControlsByClass("Geoportal.Control.PanelToggle")[0])}return this.div},onClick:function(C,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(!(C instanceof Geoportal.Control.LayerOpacity)){this.activateControl(C)}},CLASS_NAME:"Geoportal.Control.BasicLayerToolbar"});Geoportal.Control.Information=OpenLayers.Class(Geoportal.Control,{controls:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,arguments);this.controls=[]},destroy:function(){if(this.controls){for(var C=0,B=this.controls.length;C<B;C++){this.controls[C].deactivate();this.controls[C].destroy()}this.controls=null}Geoportal.Control.prototype.destroy.apply(this,arguments)},redraw:function(){if(this.div){for(var C=0,B=this.controls.length;C<B;C++){this.controls[C].redraw()}}},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.loadContents();return this.div},loadContents:function(){var C=document.createElement("div");C.id="gs_"+this.id;C.className="gpControlGraphicScale olControlNoSelect";this.div.appendChild(C);var B=new Geoportal.Control.GraphicScale({id:C.id,div:C});this.controls.push(B);this.map.addControl(B);C=document.createElement("div");C.id="pj_"+this.id;C.className="gpControlProjections olControlNoSelect";this.div.appendChild(C);B=new Geoportal.Control.Projections({id:C.id,div:C,displayProjections:this.displayProjections});this.controls.push(B);this.map.addControl(B);C=document.createElement("div");C.id="mp_"+this.id;C.className="gpControlMousePosition olControlNoSelect";this.div.appendChild(C);B=new Geoportal.Control.MousePosition({id:C.id,div:C});this.controls.push(B);this.map.addControl(B);C=document.createElement("div");C.id="cp_"+this.id;C.className="gpControlCopyright olControlNoSelect";this.div.appendChild(C);B=new Geoportal.Control.Copyright({id:C.id,div:C,copyright:this.options?this.options.copyright:undefined});this.controls.push(B);this.map.addControl(B)},updateSize:function(){if(this.controls){for(var C=0,B=this.controls.length;C<B;C++){var D=this.controls[C];if(D.updateSize){D.updateSize()}}}},CLASS_NAME:"Geoportal.Control.Information"});Geoportal.Control.LayerToolbar=OpenLayers.Class(Geoportal.Control.Panel,{addVectorLayerCntrlId:null,addImageLayerCntrlId:null,initialize:function(B){Geoportal.Control.Panel.prototype.initialize.apply(this,[B]);var C=null;if(!B){B={}}if(!B.addVectorLayerOptions&&!B.addImageLayerOptions){B.addVectorLayerOptions={};B.addImageLayerOptions={}}if(B.addVectorLayerOptions){this.addVectorLayerCntrlId=B.addVectorLayerOptions.id||(B.addVectorLayerOptions.div?B.addVectorLayerOptions.div.id:null)||"addvector_"+this.id;this.addControls(new Geoportal.Control.AddVectorLayer(OpenLayers.Util.extend({id:this.addVectorLayerCntrlId,title:"gpControlAddVectorLayer.title"},OpenLayers.Util.applyDefaults(B.addVectorLayerOptions,{editingToolbarOptions:{}}))))}if(B.addImageLayerOptions){this.addImageLayerCntrlId=B.addImageLayerOptions.id||(B.addImageLayerOptions.div?B.addImageLayerOptions.div.id:null)||"addimage_"+this.id;this.addControls(new Geoportal.Control.AddImageLayer(OpenLayers.Util.extend({id:this.addImageLayerCntrlId,title:"gpControlAddImageLayer.title"},B.addImageLayerOptions)))}},CLASS_NAME:"Geoportal.Control.LayerToolbar"});Geoportal.Format.XLS.v1_1=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.1",namespaces:{xls:"http://www.opengis.net/xls",sch:"http://www.ascc.net/xml/schematron",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"xls",schemaLocation:"http://schemas.opengis.net/ols/1.1.0/XLS.xsd",lang:null,gmlParser:null,initialize:function(B){OpenLayers.Format.XML.prototype.initialize.apply(this,[B]);if(!this.externalProjection){this.externalProjection=new OpenLayers.Projection("EPSG:4326",{domainOfValidity:new OpenLayers.Bounds(-180,-90,180,90)})}this.gmlParser=new OpenLayers.Format.GML({externalProjection:this.externalProjection.clone(),extractAttributes:false,xy:false});this.gmlParser.buildGeometry.point=function(G){var D=this.createElementNS(this.gmlns,"gml:Point");var F=this.createElementNS(this.gmlns,"gml:pos");var C;if(this.xy){C=G.x+" "+G.y}else{C=G.y+" "+G.x}var E=this.createTextNode(C);F.appendChild(E);D.appendChild(F);return D}},read:function(C){var D=new Geoportal.OLS.XLS({version:this.version||this.VERSION});var B=this.readers.xls.XLS.apply(this,[C,D]);if(!B){D.destroy();D=null}return D},readers:{xls:{XLS:function(E,F){F.version=E.getAttribute("version")||this.VERSION;F.lang=E.getAttribute("lang");this.readChildNodes(E,F);if(!F._header){OpenLayers.Console.error(OpenLayers.i18n("Not.conformal.XLS",{part:"Header"}));return null}if(F._header.errorList&&F._header.errorList.getNbErrors()>0){this.reportError(F._header.errorList);return null}if(!F._body){OpenLayers.Console.error(OpenLayers.i18n("Not.conformal.XLS",{part:"Body"}));return null}var C=F.getNbBodies();if(C>0){var B=F.getBodies();for(var D=0;D<C;D++){if(B[D].errorList&&B[D].errorList.getNbErrors()>0){this.reportError(B[D].errorList)}}}return F},ResponseHeader:function(C,D){var B=new Geoportal.OLS.ResponseHeader();B.sessionID=C.getAttribute("sessionID");D._header=B;this.readChildNodes(C,B)},ErrorList:function(C,D){var B=new Geoportal.OLS.ErrorList();B.highestSeverity=C.getAttribute("highestSeverity");D.errorList=B;this.readChildNodes(C,B)},Error:function(D,C){var B=new Geoportal.OLS.Error();B.errorCode=D.getAttribute("errorCode");B.severity=D.getAttribute("severity");B.locationID=D.getAttribute("locationID");B.locationPath=D.getAttribute("locationPath");B.message=D.getAttribute("message");C.addError(B)},Response:function(B,C){var D=new Geoportal.OLS.Response();D.version=B.getAttribute("version")||this.VERSION;D.requestID=B.getAttribute("requestID");D.numberOfResponses=parseInt(B.getAttribute("numberOfResponses"));if(isNaN(D.numberOfResponses)){D.numberOfResponses=null}C.addBody(D);this.readChildNodes(B,D)},Address:function(C,D){var B=new Geoportal.OLS.Address();B.countryCode=C.getAttribute("countryCode");B.addressee=C.getAttribute("addressee");this.readChildNodes(C,B);if(D.addAddress){D.addAddress(B)}else{D.address=B}},GeocodeMatchCode:function(D,C){var B=new Geoportal.OLS.GeocodeMatchCode();B.accuracy=parseFloat(D.getAttribute("accuracy"));if(isNaN(B.accuracy)){B.accuracy=null}B.matchType=D.getAttribute("matchType");C.geocodeMatchCode=B},freeFormAddress:function(C,B){B.name=C.childNodes.length>0?C.childNodes[0].nodeValue:""},StreetAddress:function(D,C){var B=new Geoportal.OLS.StreetAddress();C.streetAddress=B;this.readChildNodes(D,B)},Place:function(D,C){var B=new Geoportal.OLS.Place();B.classification=D.getAttribute("type");B.name=D.childNodes.length>0?D.childNodes[0].nodeValue:"";C.addPlace(B)},PostalCode:function(E,B){var D=E.childNodes.length>0?E.childNodes[0].nodeValue:"";var C=new Geoportal.OLS.PostalCode({name:D});B.postalCode=C},Building:function(D,B){var C=new Geoportal.OLS.Building();C.num=D.getAttribute("number");C.subdivision=D.getAttribute("subdivision");C.name=D.getAttribute("buildingName");B.setStreetLocation(C)},Street:function(C,B){var D=new Geoportal.OLS.Street();D.directionalPrefix=C.getAttribute("directionalPrefix");D.typePrefix=C.getAttribute("typePrefix");D.officialName=C.getAttribute("officialName");D.typeSuffix=C.getAttribute("typeSuffix");D.directionalSuffix=C.getAttribute("directionalSuffix");D.muniOctant=C.getAttribute("muniOctant");D.name=C.childNodes.length>0?C.childNodes[0].nodeValue:"";B.addStreet(D)},RequestHeader:function(C,D){var B=new Geoportal.OLS.RequestHeader();B.clientName=C.getAttribute("clientName");B.clientPassword=C.getAttribute("clientPassword");B.sessionID=C.getAttribute("sessionID");B.srsName=C.getAttribute("srsName");B.MSID=C.getAttribute("MSID");D._header=B},Request:function(C,D){var B=new Geoportal.OLS.Request();B.methodName=C.getAttribute("methodName");B.version=C.getAttribute("version")||this.VERSION;B.requestID=C.getAttribute("requestID");B.maximumResponses=parseInt(C.getAttribute("maximumResponses"));if(isNaN(B.maximumResponses)){B.maximumResponses=null}D.addBody(B);this.readChildNodes(C,B)},Position:function(B,C){var D=new Geoportal.OLS.Position();C.position=D;this.readChildNodes(B,D)},Ellipse:function(B,C){},CircularArc:function(B,C){},QoP:function(B,D){var C=new Geoportal.OLS.QualityOfPosition();C.responseReq=B.getAttribute("responseReq");C.responseTimer=B.getAttribute("responseTimer");D.qop=C;this.readChildNodes(B,C)},Time:function(C,D){var B=new Geoportal.OLS.UOM.Time();B.begin=C.getAttribute("begin");B.duration=C.getAttribute("duration");B.utcOffset=parseInt(C.getAttribute("utcOffset"));if(isNaN(B.utcOffset)){B.utcOffset=null}D.time=B},Speed:function(B,D){var C=new Geoportal.OLS.UOM.Speed();C.value=parseFloat(B.getAttribute("value"));if(isNaN(C.value)){C.value=0}C.accuracy=parseFloat(B.getAttribute("accuracy"));if(isNaN(C.accuracy)){C.accuracy=null}C.uom=B.getAttribute("uom");D.speed=C},Direction:function(B,D){var C=new Geoportal.OLS.UOM.Angle();C.value=parseFloat(B.getAttribute("value"));if(isNaN(C.value)){C.value=0}C.accuracy=parseFloat(B.getAttribute("accuracy"));if(isNaN(C.accuracy)){C.accuracy=null}C.uom=B.getAttribute("uom");D.direction=C},HorizontalAcc:function(C,D){var B=new Geoportal.OLS.HorizontalAcc();D.hAccuracy=B;this.readChildNodes(C,B)},VerticalAcc:function(C,D){var B=new Geoportal.OLS.VerticalAcc();D.vAccuracy=B;this.readChildNodes(C,B)},Distance:function(B,C){var D=new Geoportal.OLS.UOM.Distance();D.value=parseFloat(B.getAttribute("value"));if(isNaN(D.value)){D.value=0}D.accuracy=parseFloat(B.getAttribute("accuracy"));if(isNaN(D.accuracy)){D.accuracy=null}D.uom=B.getAttribute("uom");if(C.setAccuracy){C.setAccuracy(D)}else{C.distance=D}},Angle:function(C,D){var B=new Geoportal.OLS.UOM.Angle();B.value=parseFloat(C.getAttribute("value"));if(isNaN(B.value)){B.value=0}B.accuracy=parseFloat(C.getAttribute("accuracy"));if(isNaN(B.accuracy)){B.accuracy=null}B.uom=C.getAttribute("uom");if(D.setAccuracy){D.setAccuracy(B)}else{D.angle=B}}},gml:{Point:function(C,D){var B=this.gmlParser.parseGeometry.point.apply(this.gmlParser,[C]);if(B){B.transform(this.externalProjection,this.internalProjection);D.lonlat=B}},CircleByCenterPoint:function(B,C){},Polygon:function(B,C){},MultiPolygon:function(B,C){}}},write:function(B){var C=B.CLASS_NAME.split(".").pop();return this.writers.xls[C].apply(this,[B])},writers:{xls:{XLS:function(D){var F={attributes:{}};if(D.version){OpenLayers.Util.extend(F.attributes,{version:D.version})}if(D.lang){OpenLayers.Util.extend(F.attributes,{lang:D.lang})}var E=this.createElementNSPlus("xls:XLS",F);this.writeNode(E,"",D._header);for(var C=0,B=D.getNbBodies();C<B;C++){this.writeNode(E,"",D.getBodies()[C])}return E},ResponseHeader:function(B){var C=this.createElementNSPlus("xls:ResponseHeader");if(B.sessionID){C.setAttribute("sessionID",B.sessionID)}if(B.errorList){this.writeNode(C,"ErrorList",B.errorList)}return C},ErrorList:function(D){var E=this.createElementNSPlus("xls:ErrorList");if(D.highestSeverity!=null){E.setAttribute("highestSeverity",D.highestSeverity)}for(var C=0,B=D.getNbErrors();C<B;C++){this.writeNode(E,"",D.getErrors()[C])}return E},Error:function(C){var D={attributes:{}};if(C.errorCode!=null){OpenLayers.Util.extend(D.attributes,{errorCode:C.errorCode})}if(C.severity!=null){OpenLayers.Util.extend(D.attributes,{severity:C.severity})}if(C.locationID!=null){OpenLayers.Util.extend(D.attributes,{locationID:C.locationID})}if(C.locationPath!=null){OpenLayers.Util.extend(D.attributes,{locationPath:C.locationPath})}if(C.message!=null){OpenLayers.Util.extend(D.attributes,{message:C.message})}var B=this.createElementNSPlus("xls:Error",D);return B},Response:function(C){var B=this.createElementNSPlus("xls:Response",{attributes:{version:C.version,requestID:C.requestID}});if(typeof (C.numberOfResponses)=="number"&&!isNaN(C.numberOfResponses)){B.setAttribute("numberOfResponses",C.numberOfResponses)}if(C.errorList){this.writeNode(B,"ErrorList",C.errorList)}if(C.getResponseParameters()){this.writeNode(B,"",C.getResponseParameters())}return B},Address:function(C){var E=this.createElementNSPlus("xls:Address");E.setAttribute("countryCode",C.countryCode);if(C.addressee!=null){E.setAttribute("addressee",C.addressee)}if(C.name!=null){this.writeNode(E,"xls:freeFormAddress",C)}else{if(C.streetAddress){this.writeNode(E,"xls:StreetAddress",C.streetAddress)}for(var D=0,B=C.getNbPlaces();D<B;D++){this.writeNode(E,"xls:Place",C.getPlaces()[D])}if(C.postalCode){this.writeNode(E,"xls:PostalCode",C.postalCode)}}return E},GeocodeMatchCode:function(B){var C=this.createElementNSPlus("xls:GeocodeMatchCode");if(typeof (B.accuracy)=="number"&&!isNaN(B.accuracy)){C.setAttribute("accuracy",B.accuracy)}if(B.matchType!=null){C.setAttribute("matchCode",B.matchType)}return C},freeFormAddress:function(B){var C=this.createElementNSPlus("xls:freeFormAddress",{value:B.name});return C},StreetAddress:function(C){var E=this.createElementNSPlus("xls:StreetAddress");if(C._streetLocation){this.writeNode(E,"",C._streetLocation)}for(var D=0,B=C.getNbStreets();D<B;D++){this.writeNode(E,"xls:Street",C.getStreets()[D])}return E},Place:function(C){var B=this.createElementNSPlus("xls:Place",{attributes:{type:C.classification},value:C.name});return B},PostalCode:function(B){var C=this.createElementNSPlus("xls:PostalCode",{value:B.name});return C},Building:function(B){var D={attributes:{}};if(B.num!=null){OpenLayers.Util.extend(D.attributes,{number:B.num})}if(B.subdivision!=null){OpenLayers.Util.extend(D.attributes,{subdivision:B.subdivision})}if(B.name!=null){OpenLayers.Util.extend(D.attributes,{buildingName:B.name})}var C=this.createElementNSPlus("xls:Building",D);return C},Street:function(B){var D={attributes:{}};if(B.directionalPrefix!=null){OpenLayers.Util.extend(D.attributes,{directionalPrefix:B.directionalPrefix})}if(B.typePrefix!=null){OpenLayers.Util.extend(D.attributes,{typePrefix:B.typePrefix})}if(B.officialName!=null){OpenLayers.Util.extend(D.attributes,{officialName:B.officialName})}if(B.typeSuffix!=null){OpenLayers.Util.extend(D.attributes,{typeSuffix:B.typeSuffix})}if(B.directionalSuffix!=null){OpenLayers.Util.extend(D.attributes,{directionalSuffix:B.directionalSuffix})}if(B.muniOctant!=null){OpenLayers.Util.extend(D.attributes,{muniOctant:B.muniOctant})}if(B.name!=null){D.value=B.name}var C=this.createElementNSPlus("xls:Street",D);return C},RequestHeader:function(B){var D={attributes:{}};if(B.clientName!=null){OpenLayers.Util.extend(D.attributes,{clientName:B.clientName})}if(B.clientPassword!=null){OpenLayers.Util.extend(D.attributes,{clientPassword:B.clientPassword})}if(B.sessionID!=null){OpenLayers.Util.extend(D.attributes,{sessionID:B.sessionID})}if(B.srsName!=null){OpenLayers.Util.extend(D.attributes,{srsName:B.srsName})}if(B.MSID!=null){OpenLayers.Util.extend(D.attributes,{MSID:B.MSID})}var C=this.createElementNSPlus("xls:RequestHeader",D);return C},Request:function(B){var C=this.createElementNSPlus("xls:Request",{attributes:{methodName:B.methodName,version:B.version,requestID:B.requestID}});if(typeof (B.maximumResponses)=="number"&&!isNaN(B.maximumResponses)){C.setAttribute("maximumResponses",B.maximumResponses)}if(B.getRequestParameters()){this.writeNode(C,"",B.getRequestParameters())}return C},Position:function(C){var B=this.createElementNSPlus("xls:Position");if(C.levelOfConf!=null){B.setAttribute("levelOfConf",C.levelOfConf)}this.writeNode(B,"gml:Point",C.lonlat);if(C.qop){this.writeNode(B,"xls:QoP",C.qop)}if(C.time){this.writeNode(B,"xls:Time",C.time)}if(C.speed){this.writeNode(B,"xls:Speed",C.speed)}if(C.direction){this.writeNode(B,"xls:Direction",C.direction)}return B},Ellipse:function(B){return this.createCommentNode("xls:Ellipse : not yet supported")},CircularArc:function(B){return this.createCommentNode("xls:CircularArc : not yet supported")},QoP:function(C){var B=this.createElementNSPlus("xls:QoP");if(C.responseReq!=null){B.setAttribute("responseReq",C.responseReq)}if(C.responseTimer!=null){B.setAttribute("responseTimer",C.responseTimer)}this.writeNode(B,"xls:HorizontalAcc",C.hAccuracy);this.writeNode(B,"xls:VerticalAcc",C.vAccuracy);return B},Time:function(B){var C=this.createElementNSPlus("xls:Time",{attributes:{begin:B.begin}});if(B.duration!=null){C.setAttribute("duration",B.duration)}if(typeof (B.utcOffset)=="number"&&!isNaN(B.utcOffset)){C.setAttribute("utcOffset",B.utcOffset)}return C},Speed:function(C){var B=this.createElementNSPlus("xls:Speed",{attributes:{value:C.value}});if(C.accuracy){B.setAttribute("accuracy",C.accuracy)}if(C.uom){B.setAttribute("uom",C.uom)}return B},Direction:function(C){var B=this.createElementNSPlus("xls:Direction",{attributes:{value:C.value}});if(C.accuracy){B.setAttribute("accuracy",C.accuracy)}if(C.uom){B.setAttribute("uom",C.uom)}return B},HorizontalAcc:function(B){var C=this.createElementNSPlus("xls:HorizontalAcc");this.writeNode(C,"",B._doa);return C},VerticalAcc:function(C){var B=this.createElementNSPlus("xls:VerticalAcc");this.writeNode(B,"xls:Distance",C.distance);return B},Distance:function(C){var B=this.createElementNSPlus("xls:Distance",{attributes:{value:C.value}});if(C.accuracy){B.setAttribute("accuracy",C.accuracy)}if(C.uom){B.setAttribute("uom",C.uom)}return B},Angle:function(B){var C=this.createElementNSPlus("xls:Angle",{attributes:{value:B.value}});if(B.accuracy){C.setAttribute("accuracy",B.accuracy)}if(B.uom){C.setAttribute("uom",B.uom)}return C}},gml:{Point:function(C){var B=this.gmlParser.buildGeometryNode.apply(this.gmlParser,[C]);return B},CircleByCenterPoint:function(B){return this.createCommentNode("gml:CircleByCenterPoint : not yet supported")},Polygon:function(B){return this.createCommentNode("gml:Polygon : not yet supported")},MultiPolygon:function(B){return this.createCommentNode("gml:MultiPolygon : not yet supported")}}},getNamespacePrefix:function(C){var D=null;if(C==null){D=this.namespaces[this.defaultPrefix]}else{var B=false;for(D in this.namespaces){if(this.namespaces[D]==C){B=true;break}}if(!B){D=null}}return D},readChildNodes:function(D,F){var C=D.childNodes;var B,K,H,G,J;for(var E=0,I=C.length;E<I;++E){B=C[E];if(B.nodeType==1){G=this.getNamespacePrefix(B.namespaceURI);J=B.nodeName.split(":").pop();K=this.readers[G];if(K){H=K[J];if(H){H.apply(this,[B,F])}}}}},reportError:function(F){var G=F.getErrors();for(var C=0,B=G.length;C<B;C++){var D=G[C];var E="XLS ("+(F.highestSeverity!=null?F.highestSeverity:"Warning")+") : ["+D.errorCode+(D.locationID?","+D.locationID:"")+(D.locationPath?","+D.locationPath:"")+(D.message?","+D.message:"")+"]";if(D.severity&&D.severity!="Warning"){OpenLayers.Console.error(E)}else{OpenLayers.Console.warn(E)}}},getNodeName:function(B){return B.CLASS_NAME.split(".").pop()},writeNode:function(F,B,E){var G,I;if(!B){B=this.getNodeName(E)}var H=B.indexOf(":");if(H>0){G=B.substring(0,H);I=B.substring(H+1)}else{G=this.getNamespacePrefix(F.namespaceURI);I=B}var J=this.writers[G];if(J){var D=J[I];if(D){var C=D.apply(this,[E]);F.appendChild(C);return C}}return null},createElementNSPlus:function(C,B){B=B||{};var F=C.indexOf(":");var E=B.uri||this.namespaces[B.prefix];if(!E){E=this.namespaces[C.substring(0,F)]}if(!E){E=this.namespaces[this.defaultPrefix]}var D=this.createElementNS(E,C);if(B.attributes){this.setAttributes(D,B.attributes)}if(B.value){D.appendChild(this.createTextNode(B.value))}return D},setAttributes:function(E,G){var F,H,C,D;for(var B in G){F=G[B].toString();D=this.namespaces[B.substring(0,B.indexOf(":"))]||null;this.setAttributeNS(E,D,B,F)}},CLASS_NAME:"Geoportal.Format.XLS.v1_1"});Geoportal.OLS.HorizontalAcc=OpenLayers.Class({_doa:null,initialize:function(B){this._doa=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){if(this._doa){this._doa.destroy();this._doa=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},setAccuracy:function(B){if(this._doa){this._doa.destroy();this._doa=null}this._doa=B},CLASS_NAME:"Geoportal.OLS.HorizontalAcc"});Geoportal.OLS.LUS.GeocodeRequest=OpenLayers.Class(Geoportal.OLS.LUS,Geoportal.OLS.AbstractRequestParameters,{addresses:null,initialize:function(B){this.addresses=[];Geoportal.OLS.AbstractRequestParameters.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.addresses){for(var C=0,B=this.addresses.length;C<B;C++){this.addresses[C].destroy();this.addresses[C]=null}this.addresses=null}Geoportal.OLS.AbstractRequestParameters.prototype.destroy.apply(this,arguments)},addAddress:function(B){if(!this.addresses){this.addresses=[]}if(B){this.addresses.push(B)}},getNbAddresses:function(){return this.addresses?this.addresses.length:0},getAddresses:function(){return this.addresses?this.addresses:null},CLASS_NAME:"Geoportal.OLS.LUS.GeocodeRequest"});Geoportal.OLS.LUS.GeocodedAddress=OpenLayers.Class(Geoportal.OLS.LUS,{address:null,lonlat:null,geocodeMatchCode:null,initialize:function(C,B,D){this.address=C;this.lonlat=B;this.geocodeMatchCode=null;Geoportal.OLS.LUS.prototype.initialize.apply(this,[D])},destroy:function(){if(this.address){this.address.destroy();this.address=null}if(this.geocodeMatchCode){this.geocodeMatchCode.destroy();this.geocodeMatchCode=null}this.lonlat=null;Geoportal.OLS.LUS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.LUS.GeocodedAddress"});Geoportal.OLS.LUS.SearchCentreDistance=OpenLayers.Class(Geoportal.OLS.LUS,Geoportal.OLS.UOM.Distance,{initialize:function(C,B){Geoportal.OLS.UOM.Distance.prototype.initialize.apply(this,arguments)},destroy:function(){Geoportal.OLS.UOM.Distance.prototype.destroy.apply(this,arguments)},clone:function(){var B=new Geoportal.OLS.LUS.SearchCentreDistance({value:this.value,accuracy:this.accuracy,uom:this.uom});return B},CLASS_NAME:"Geoportal.OLS.LUS.SearchCentreDistance"});Geoportal.OLS.UOM.Distance.Altitude=OpenLayers.Class(Geoportal.OLS.UOM.Distance,{initialize:function(C,B){Geoportal.OLS.UOM.Distance.prototype.initialize.apply(this,arguments)},destroy:function(){Geoportal.OLS.UOM.Distance.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.UOM.Distance.Altitude"});Geoportal.OLS.VerticalAcc=OpenLayers.Class({distance:null,initialize:function(B){this.distance=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.distance){this.distance.destroy();this.distance=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.VerticalAcc"});Geoportal.Control.LayerSwitcher=OpenLayers.Class(Geoportal.Control,{ascending:true,layerStates:null,layersDiv:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,entityBuffer:null,initialize:function(B){Geoportal.Control.prototype.initialize.apply(this,arguments);this.layerStates=[]},destroy:function(){OpenLayers.Event.stopObservingElement(this.div);if(!this.outsideViewport){OpenLayers.Event.stopObservingElement(this.minimizeDiv);OpenLayers.Event.stopObservingElement(this.maximizeDiv)}if(this.map){for(var D=0,C=this.layerStates.length;D<C;D++){for(var B in Geoportal.Control.LayerSwitcher.CNTRLKEYS){var E=this.map.getControl(B+"_"+this.layerStates[D].id);if(E){E.deactivate();E.destroy()}}}}this.layerStates=[];this.clearLayersArray("data");if(this.map){this.map.events.un({addlayer:this.redraw,changelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.map.events.un({removelayer:this.removeLayer,scope:this})}Geoportal.Control.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.prototype.setMap.apply(this,arguments);this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,changebaselayer:this.redraw,scope:this});this.map.events.on({removelayer:this.removeLayer,scope:this})},draw:function(B){Geoportal.Control.prototype.draw.apply(this,arguments);this.loadContents();if(!this.outsideViewport){this.minimizeControl()}this.redraw();return this.div},clearLayersArray:function(E){var F=this[E+"Layers"];if(F){for(var D=0,B=F.length;D<B;D++){var C=F[D];OpenLayers.Event.stopObservingElement(C.inputElem);OpenLayers.Event.stopObservingElement(C.labelSpan)}}this[E+"LayersDiv"].innerHTML="";this[E+"Layers"]=[]},checkRedraw:function(){var F=false;if(!this.layerStates.length||(this.map.layers.length!=this.layerStates.length)){F=true}else{for(var D=0,B=this.layerStates.length;D<B;D++){var E=this.layerStates[D];var C=this.map.layers[D];if((E.displayInLayerSwitcher!=C.displayInLayerSwitcher)||(E.name!=C.name)||(E.inRange!=C.inRange)||(E.id!=C.id)||(E.visibility!=C.visibility)||(E.opacity!=C.opacity)){F=true;break}}}return F},redraw:function(){if(!this.checkRedraw()){return this.div}var f,d,b=this.map.layers.length;var u;var S;this.layerStates=[];for(f=0;f<b;f++){u=this.map.layers[f];this.layerStates[f]={displayInLayerSwitcher:u.displayInLayerSwitcher,name:u.name,visibility:u.visibility,opacity:u.opacity,inRange:u.inRange,id:u.id};for(var V in Geoportal.Control.LayerSwitcher.CNTRLKEYS){var G=this.map.getControl(V+"_"+this.layerStates[f].id);if(G){var U=G.div;if(U.parentNode!=null){U.parentNode.removeChild(U)}}}}this.clearLayersArray("data");var K=false;S=this.map.layers.slice();if(!this.ascending){S.reverse();this.layerStates.reverse()}var T=this.dataLayersDiv;var I=false,D=false;for(f=b-1;f>=0;f--){u=S[f];var J=u.isBaseLayer;var N=this.layerStates[f];if(u.displayInLayerSwitcher&&!J){K=true;var a=document.createElement("div");a.id=this.id+"_"+u.id;a.className="gpLayerDivClass";if((this.dataLayers.length%2)==1){a.className+="Alternate"}T.appendChild(a);var R=document.createElement("div");R.className="gpLayerNameGroupDivClass";a.appendChild(R);var Q=u.getVisibility();var M=document.createElement("input");M.id="input_"+u.id;M.name=u.name;M.type="checkbox";M.value=u.name;M.checked=Q;M.defaultChecked=Q;M.className="gpLayerVisibilityClass";M.style.autocomplete="off";if(!u.inRange){M.disabled=true}var E={inputElem:M,layer:u,layerSwitcher:this};OpenLayers.Event.observe(M,"mouseup",OpenLayers.Function.bindAsEventListener(this.onInputClick,E));R.appendChild(M);var W=document.createElement("span");W.id="label_"+u.id;var m=OpenLayers.i18n(u.name);var Z=document.createElement("textarea");Z.innerHTML=m.replace(/</g,"&lt;").replace(/>/g,"&gt;");m=Z.value;Z=null;if(m.length>=Geoportal.Control.LayerSwitcher.LAYER_LABEL_MAXLENGTH){m=m.substring(0,Geoportal.Control.LayerSwitcher.LAYER_LABEL_REPLACEMENT_INDEX)+Geoportal.Control.LayerSwitcher.LAYER_LABEL_SUFFIX_REPLACEMENT}W.innerHTML=m;W.className="gpLayerSpanClass";W.title=OpenLayers.i18n(u.name);if(!u.inRange){W.className+="NotInRange"}if(u.description||u.queryable||u.dataURL||u.metadataURL||u.legends){W.style.cursor="help";OpenLayers.Event.observe(W,"click",OpenLayers.Function.bindAsEventListener(this.onLabelClick,E))}R.appendChild(W);var h=document.createElement("div");h.id="buttonsChangeOrder"+u.id;h.className="gpButtonsChangeOrderClass";R.appendChild(h);var F=document.createElement("div");F.id="buttonUp_"+u.id;F.className="gpButtonUp";if(!I){var O=true;for(d=f+1;d<b-1;d++){if(!S[d].isBaseLayer&&S[d].displayInLayerSwitcher){O=false;break}}if(O){F.className+="Deactive";I=true}}OpenLayers.Event.observe(F,"click",OpenLayers.Function.bindAsEventListener(this.onButtonUpClick,({layerSwitcher:this,layerRank:f})));h.appendChild(F);var r=document.createElement("div");r.id="buttonDown_"+u.id;r.className="gpButtonDown";if(!D){var O=true;for(d=f-1;d>=0;d--){if(!S[d].isBaseLayer&&S[d].displayInLayerSwitcher){O=false;break}}if(O){r.className+="Deactive";D=true}}OpenLayers.Event.observe(r,"click",OpenLayers.Function.bindAsEventListener(this.onButtonDownClick,({layerSwitcher:this,layerRank:f})));h.appendChild(r);var C="loading_"+u.id;var H=this.map.getControl(C);if(H){R.appendChild(H.div)}else{var q=document.createElement("div");q.id=C;q.className="gpControlLoading olControlNoSelect";H=new Geoportal.Control.Loading(u,{id:q.id,div:q});R.appendChild(q);this.map.addControl(H)}if((u.view&&(u.view.drop||u.view.zoomToExtent))||(u.opacity!=undefined)){C="basic_"+u.id;var L=this.map.getControl(C);if(L){a.appendChild(L.div);for(var P=0,v=L.controls.length;P<v;P++){if(L.controls[P] instanceof Geoportal.Control.LayerOpacity){L.controls[P].refreshOpacity();break}}}else{var g=document.createElement("div");g.id=C;g.className="gpControlBasicLayerToolbar olControlNoSelect";var L=new Geoportal.Control.BasicLayerToolbar(u,{id:g.id,div:g});a.appendChild(g);this.map.addControl(L)}}C="edit_"+u.id;var B=this.map.getControl(C);if(B){a.appendChild(B.div);if(B.div.childNodes.length>0){B.div.style.display=""}else{B.div.style.display="none"}}else{var Y=document.createElement("div");Y.id=C;Y.className="gpControlEditingToolbar olControlNoSelect";Y.style.display="none";a.appendChild(Y)}this.dataLayers.push({layer:u,inputElem:M,labelSpan:W})}}if(!this.outsideViewport){this.dataLbl.style.display=K?"":"none"}return this.div},onInputClick:function(B){if(B!=null){OpenLayers.Event.stop(B)}if(!this.inputElem.disabled){this.inputElem.checked=!this.inputElem.checked;this.layerSwitcher.updateMap()}},onLabelClick:function(H){var M=null;if(H!=null){M=OpenLayers.Events.prototype.getMousePosition.apply({includeXY:true,element:this.layerSwitcher.map.div,clearMouseCache:function(){OpenLayers.Events.prototype.clearMouseCache.apply(this)}},[H]);OpenLayers.Event.stop(H);if(M.x<0){M.x=0}if(M.y<0){M.y=0}}if(OpenLayers.Util.getElement("_mtdpopup_"+this.layer.id)){return }var C=document.createElement("div");if(this.layer.description){var I=document.createElement("div");I.id="abstract_"+this.layer.id;I.className="gpLayerAbstractDivClass";I.innerHTML=OpenLayers.i18n(this.layer.description);C.appendChild(I)}if(this.layer.legends){var G=document.createElement("div");G.id="legends_"+this.layer.id;G.className="gpLayerLegendsDivClass";var F=document.createElement("img");F.id="legend_"+this.layer.legends.style+"_"+this.layer.id;F.src=this.layer.legends[0].href;if(this.layer.legends[0].width&&this.layer.legends[0].height){F.width=this.layer.legends[0].width;F.height=this.layer.legends[0].height}if(this.layer.legends[0].title){F.alt=this.layer.legends[0].title;F.title=this.layer.legends[0].title}F.vspace=F.hspace=0;G.appendChild(F);C.appendChild(G)}if(this.layer.dataURL||this.layer.metadataURL){var J="width=750,height=350,menubar=no,status=no,scrollbars=yes,resizable=yes";var B=document.createElement("div");B.id="dataUrls_"+this.layer.id;B.className="gpLayerUrlsDivClass";if(this.layer.dataURL){var D=document.createElement("a");D.id="dataURL_"+this.layer.id;D.className="gpLayerDataURLClass";D.title=D.alt=OpenLayers.i18n("gpLayer.dataURL");D.appendChild(document.createTextNode(D.title));OpenLayers.Event.observe(D,"click",OpenLayers.Function.bindAsEventListener(function(N){window.open(this.url,"data",J)},{url:this.layer.dataURL}));B.appendChild(D)}if(this.layer.metadataURL){var L=document.createElement("a");L.id="metadataURL_"+this.layer.id;L.className="gpLayerMetadataURLClass";L.title=L.alt=OpenLayers.i18n("gpLayer.metadataURL");L.appendChild(document.createTextNode(L.title));OpenLayers.Event.observe(L,"click",OpenLayers.Function.bindAsEventListener(function(N){window.open(this.url,"metadata",J)},{url:this.layer.metadataURL}));B.appendChild(L)}C.appendChild(B)}var E=new OpenLayers.Size(Geoportal.Util.getComputedStyle(this.layerSwitcher.map.div,"width",true),Geoportal.Util.getComputedStyle(this.layerSwitcher.map.div,"height",true));E.w/=2;E.h/=4;var K=new Geoportal.Control.Floating(this,{id:"_mtdpopup_"+this.layer.id,headTitle:this.layer.name,size:E});K.onClose=OpenLayers.Function.bind(function(){this.destroy()},K);K.changeLang=OpenLayers.Function.bind(function(N){Geoportal.Control.Floating.prototype.changeLang.apply(this.cntrl,arguments);var O=OpenLayers.Util.getElement("abstract_"+this.layer.id);if(O){O.innerHTML=OpenLayers.i18n(this.layer.description)}O=OpenLayers.Util.getElement("metadataURL_"+this.layer.id);if(O){O.title=O.alt=OpenLayers.i18n("gpLayer.metadataURL");O.innerHTML="";O.appendChild(document.createTextNode(O.title))}O=OpenLayers.Util.getElement("dataURL_"+this.layer.id);if(O){O.title=O.alt=OpenLayers.i18n("gpLayer.dataURL");O.innerHTML="";O.appendChild(document.createTextNode(O.title))}},{cntrl:K,layer:this.layer});this.layerSwitcher.map.addControl(K,M);M=null;K.addContent(C)},onButtonUpClick:function(H){var E,I;var F=null;var G=false;var C=this.layerSwitcher.map.layers;I=C.length;var D=C[this.layerRank];for(var E=this.layerRank+1;E<I;E++){if(C[E].isBaseLayer||!C[E].displayInLayerSwitcher){continue}G=true;F=C[E];var B=F.div.style.zIndex;F.setZIndex(D.div.style.zIndex);D.setZIndex(B);break}if(G){C[this.layerRank]=F;C[E]=D;this.layerSwitcher.redraw()}if(H!=null){OpenLayers.Event.stop(H)}},onButtonDownClick:function(H){var E;var F=null;var G=false;var C=this.layerSwitcher.map.layers;var D=C[this.layerRank];for(E=this.layerRank-1;E>=1;E--){if(C[E].isBaseLayer||!C[E].displayInLayerSwitcher){continue}G=true;F=C[E];var B=F.div.style.zIndex;F.setZIndex(D.div.style.zIndex);D.setZIndex(B);break}if(G){C[this.layerRank]=F;C[E]=D;this.layerSwitcher.redraw()}if(H!=null){OpenLayers.Event.stop(H)}},onLayerClick:function(B){this.updateMap()},updateMap:function(){for(var C=0,B=this.dataLayers.length;C<B;C++){var D=this.dataLayers[C];D.layer.setVisibility(D.inputElem.checked)}},maximizeControl:function(B){this.showControls(false);if(B!=null){OpenLayers.Event.stop(B)}},minimizeControl:function(B){this.showControls(true);if(B!=null){OpenLayers.Event.stop(B)}},showControls:function(B){this.maximizeDiv.style.display=B?"":"none";this.minimizeDiv.style.display=B?"none":"";this.dataLayersDiv.style.display=B?"none":""},loadContents:function(){var E=OpenLayers.i18n(this.displayClass+".label");if(!this.div.className){this.div.className=""}this.div.className+=" gpMainDivClass";OpenLayers.Event.observe(this.div,"dblclick",OpenLayers.Function.bindAsEventListener(this.ignoreEvent,this));OpenLayers.Event.observe(this.div,"click",OpenLayers.Function.bindAsEventListener(this.ignoreEvent,this));OpenLayers.Event.observe(this.div,"mousedown",OpenLayers.Function.bindAsEventListener(this.mouseDown,this));OpenLayers.Event.observe(this.div,"mousemove",OpenLayers.Function.bindAsEventListener(this.ignoreEvent,this));OpenLayers.Event.observe(this.div,"mouseup",OpenLayers.Function.bindAsEventListener(this.mouseUp,this));this.layersDiv=document.createElement("div");this.layersDiv.id=this.id+"_layersDiv";this.layersDiv.className="gpLayersClass";if(!this.outsideViewport){this.dataLbl=document.createElement("div");this.dataLbl.id=this.id+"_layer_title";this.dataLbl.innerHTML=E;this.dataLbl.className="gpControlLabelClass";this.layersDiv.appendChild(this.dataLbl)}var G=document.createElement("form");G.id="__lrswtchr__"+this.id;G.name=G.id;G.action="javascript:void(null)";G.style.margin="0px";G.style.padding="0px";G.style.border="0px";this.dataLayersDiv=document.createElement("div");this.dataLayersDiv.id=this.id+"_layers_container";this.dataLayersDiv.className="gpGroupDivClass";this.layersDiv.appendChild(G);G.appendChild(this.dataLayersDiv);if(this.outsideViewport){this.dataLayersDiv.style.display="block"}this.div.appendChild(this.layersDiv);if(!this.outsideViewport){var H=Geoportal.Util.getImagesLocation();var B=new OpenLayers.Size(11,11);var C=H+"ico_win_plus.gif";this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.id+"_MaximizeDiv",null,B,C,"absolute");this.maximizeDiv.style.top="2px";this.maximizeDiv.style.right="";this.maximizeDiv.style.left="0px";this.maximizeDiv.style.display="none";this.maximizeDiv.style.cursor="pointer";OpenLayers.Event.observe(this.maximizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.maximizeControl,this));OpenLayers.Event.observe(this.maximizeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));this.div.appendChild(this.maximizeDiv);var F=H+"ico_win_moins.gif";var D=new OpenLayers.Size(11,11);this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv(this.id+"_MinimizeDiv",null,D,F,"absolute");this.minimizeDiv.style.top="2px";this.minimizeDiv.style.right="";this.minimizeDiv.style.left="0px";this.minimizeDiv.style.display="none";this.minimizeDiv.style.cursor="pointer";OpenLayers.Event.observe(this.minimizeDiv,"click",OpenLayers.Function.bindAsEventListener(this.minimizeControl,this));OpenLayers.Event.observe(this.minimizeDiv,"dblclick",OpenLayers.Function.bindAsEventListener(this.dblClick,this));this.div.appendChild(this.minimizeDiv)}},dblClick:function(B){if(B!=null){OpenLayers.Event.stop(B)}},ignoreEvent:function(B){OpenLayers.Event.stop(B)},mouseDown:function(B){this.isMouseDown=true;this.ignoreEvent(B)},mouseUp:function(B){if(this.isMouseDown){this.isMouseDown=false;this.ignoreEvent(B)}},removeLayer:function(C){if(C.layer){for(var D=this.layerStates.length-1;D>=0;D--){if(this.layerStates[D].id==C.layer.id){for(var B in Geoportal.Control.LayerSwitcher.CNTRLKEYS){var E=this.map.getControl(B+"_"+C.layer.id);if(E){E.deactivate();E.destroy()}}break}}}this.redraw()},changeLang:function(C){if(this.dataLbl){this.dataLbl.innerHTML=OpenLayers.i18n(this.displayClass+".label")}if(this.layerStates){for(var F=0,B=this.layerStates.length;F<B;F++){var I=this.layerStates[F];var E=this.map.layers[F];var H=OpenLayers.Util.getElement("label_"+E.id);if(H){H.title=OpenLayers.i18n(E.name);var G=OpenLayers.i18n(E.name);var D=document.createElement("textarea");D.innerHTML=G.replace(/</g,"&lt;").replace(/>/g,"&gt;");G=D.value;D=null;if(G.length>Geoportal.Control.LayerSwitcher.LAYER_LABEL_MAXLENGTH){G=G.substring(0,Geoportal.Control.LayerSwitcher.LAYER_LABEL_REPLACEMENT_INDEX)+Geoportal.Control.LayerSwitcher.LAYER_LABEL_SUFFIX_REPLACEMENT}H.innerHTML=G}}}},CLASS_NAME:"Geoportal.Control.LayerSwitcher"});Geoportal.Control.LayerSwitcher.CNTRLKEYS={loading:"",basic:"",edit:""};Geoportal.Control.LayerSwitcher.LAYER_LABEL_MAXLENGTH=18;Geoportal.Control.LayerSwitcher.LAYER_LABEL_REPLACEMENT_INDEX=14;Geoportal.Control.LayerSwitcher.LAYER_LABEL_SUFFIX_REPLACEMENT="...";Geoportal.Format.XLS.v1_0=OpenLayers.Class(Geoportal.Format.XLS.v1_1,{VERSION:"1.0",initialize:function(B){Geoportal.Format.XLS.v1_1.prototype.initialize.apply(this,[B])},CLASS_NAME:"Geoportal.Format.XLS.v1_0"});Geoportal.OLS.LUS.GeocodeResponseList=OpenLayers.Class(Geoportal.OLS.LUS,{numberOfGeocodedAddresses:null,geocodedAddresses:null,initialize:function(B){this.numberOfGeocodedAddresses=0;this.geocodedAddresses=[];Geoportal.OLS.LUS.prototype.initialize.apply(this,arguments)},destroy:function(){this.numberOfGeocodedAddresses=null;if(this.geocodedAddresses){for(var C=0,B=this.geocodedAddresses.length;C<B;C++){this.geocodedAddresses[C].destroy();this.geocodedAddresses[C]=null}this.geocodedAddresses=null}Geoportal.OLS.LUS.prototype.destroy.apply(this,arguments)},addGeocodedAddress:function(B){if(!this.geocodedAddresses){this.geocodedAddresses=[]}if(B){this.geocodedAddresses.push(B)}},getNbGeocodedAddresses:function(){return this.geocodedAddresses?this.geocodedAddresses.length:0},getGeocodedAddresses:function(){return this.geocodedAddresses?this.geocodedAddresses:null},CLASS_NAME:"Geoportal.OLS.LUS.GeocodeResponseList"});Geoportal.OLS.LUS.ReverseGeocodedLocation=OpenLayers.Class(Geoportal.OLS.LUS,{address:null,measure:null,lonlat:null,initialize:function(C,B,D){this.address=C;this.measure=null;this.lonlat=B;Geoportal.OLS.LUS.prototype.initialize.apply(this,[D])},destroy:function(){if(this.address){this.address.destroy();this.address=null}if(this.measure){this.measure.destroy();this.measure=null}this.lonlat=null;Geoportal.OLS.LUS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.LUS.ReverseGeocodedLocation"});Geoportal.OLS.QualityOfPosition=OpenLayers.Class({responseReq:null,responseTimer:null,hAccuracy:null,vAccuracy:null,initialize:function(B){this.responseReq=null;this.responseTimer=null;this.hAccuracy=null;this.vAccuracy=null;Geoportal.OLS.prototype.initialize.apply(this,arguments)},destroy:function(){this.responseReq=null;this.responseTimer=null;if(this.hAccuracy){this.hAccuracy.destroy();this.hAccuracy=null}if(this.vAccuracy){this.vAccuracy.destroy();this.vAccuracy=null}Geoportal.OLS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.OLS.QualityOfPosition"});Geoportal.OLS.LUS.GeocodeResponse=OpenLayers.Class(Geoportal.OLS.LUS,Geoportal.OLS.AbstractResponseParameters,{geocodeResponses:null,initialize:function(B){this.geocodeResponses=[];Geoportal.OLS.AbstractResponseParameters.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.geocodeResponses){for(var C=0,B=this.geocodeResponses.length;C<B;C++){this.geocodeResponses[C].destroy();this.geocodeResponses[C]=null}this.geocodeResponses=null}Geoportal.OLS.AbstractResponseParameters.prototype.destroy.apply(this,arguments)},addGeocodeResponseList:function(B){if(!this.geocodeResponses){this.geocodeResponses=[]}if(B){this.geocodeResponses.push(B)}},getNbGeocodeResponseList:function(){return this.geocodeResponses?this.geocodeResponses.length:0},getGeocodeResponseList:function(){return this.geocodeResponses?this.geocodeResponses:null},CLASS_NAME:"Geoportal.OLS.LUS.GeocodeResponse"});Geoportal.OLS.LUS.ReverseGeocodeResponse=OpenLayers.Class(Geoportal.OLS.LUS,Geoportal.OLS.AbstractResponseParameters,{reverseGeocodedLocations:null,initialize:function(B){this.reverseGeocodedLocations=[];Geoportal.OLS.AbstractResponseParameters.prototype.initialize.apply(this,arguments)},destroy:function(){if(this.reverseGeocodedLocations){for(var C=0,B=this.reverseGeocodedLocations.length;C<B;C++){this.reverseGeocodedLocations[C].destroy();this.reverseGeocodedLocations[C]=null}this.reverseGeocodedLocations=null}Geoportal.OLS.AbstractResponseParameters.prototype.destroy.apply(this,arguments)},addReverseGeocodedLocations:function(B){if(!this.reverseGeocodedLocations){this.reverseGeocodedLocations=[]}if(B){this.reverseGeocodedLocations.push(B)}},getNbReverseGeocodedLocations:function(){return this.reverseGeocodedLocations?this.reverseGeocodedLocations.length:0},getReverseGeocodedLocations:function(){return this.reverseGeocodedLocations?this.reverseGeocodedLocations:null},CLASS_NAME:"Geoportal.OLS.LUS.ReverseGeocodeResponse"});Geoportal.OLS.Position=OpenLayers.Class(Geoportal.OLS.AbstractPosition,{levelOfConf:null,lonlat:null,_aoi:null,qop:null,time:null,speed:null,direction:null,initialize:function(B,C){this.levelOfConf=null;this.lonlat=B;this._aoi=null;this.qop=null;this.time=null;this.speed=null;this.direction=null;Geoportal.OLS.AbstractPosition.prototype.initialize.apply(this,[C])},destroy:function(){this.levelOfConf=null;this.lonlat=null;this._aoi=null;if(this.qop){this.qop.destroy();this.qop=null}if(this.time){this.time.destroy();this.time=null}if(this.speed){this.speed.destroy();this.speed=null}if(this.direction){this.direction.destroy();this.direction=null}Geoportal.OLS.AbstractPosition.prototype.destroy.apply(this,arguments)},toString:function(){var B="";B+=this.lonlat.toString();return B},CLASS_NAME:"Geoportal.OLS.Position"});Geoportal.OLS.LUS.ReverseGeocodeRequest=OpenLayers.Class(Geoportal.OLS.LUS,Geoportal.OLS.AbstractRequestParameters,{position:null,preferences:null,initialize:function(B,C){this.position=B;this.preferences=[];Geoportal.OLS.AbstractRequestParameters.prototype.initialize.apply(this,[C])},destroy:function(){if(this.position){this.position.destroy();this.position=null}if(this.preferences){for(var C=0,B=this.preferences.length;C<B;C++){this.preferences[C].destroy();this.preferences[C]=null}this.preferences=null}Geoportal.OLS.AbstractRequestParameters.prototype.destroy.apply(this,arguments)},addPreference:function(B){if(!this.preferences){this.preferences=[]}if(B){this.preferences.push(B)}},getNbPreferences:function(){return this.preferences?this.preferences.length:0},getPreferences:function(){return this.preferences?this.preferences:null},CLASS_NAME:"Geoportal.OLS.LUS.ReverseGeocodeRequest"});Geoportal.Format.XLS.v1_1.LocationUtilityService=OpenLayers.Class(Geoportal.Format.XLS.v1_1,{CORESERVICE:"LocationUtilityService",schemaLocation:"http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",initialize:function(B){Geoportal.Format.XLS.v1_1.prototype.initialize.apply(this,[B]);this._addReaders();this._addWriters()},_addReaders:function(){this.readers.xls=OpenLayers.Util.applyDefaults(this.readers.xls,{GeocodeResponse:function(C,D){var B=new Geoportal.OLS.LUS.GeocodeResponse();D.setResponseParameters(B);this.readChildNodes(C,B)},ReverseGeocodeResponse:function(B,D){var C=new Geoportal.OLS.LUS.ReverseGeocodeResponse();D.setResponseParameters(C);this.readChildNodes(B,C)},GeocodeResponseList:function(D,C){var B=new Geoportal.OLS.LUS.GeocodeResponseList();B.numberOfGeocodedAddresses=parseInt(D.getAttribute("numberOfGeocodedAddresses"));if(isNaN(B.numberOfGeocodedAddresses)){B.numberOfGeocodedAddresses=0}if(isNaN(B.numberOfGeocodedAddresses)){B.numberOfGeocodedAddresses=1}C.addGeocodeResponseList(B);this.readChildNodes(D,B)},ReverseGeocodedLocation:function(B,D){var C=new Geoportal.OLS.LUS.ReverseGeocodedLocation();D.addReverseGeocodedLocations(C);this.readChildNodes(B,C)},GeocodedAddress:function(C,D){var B=new Geoportal.OLS.LUS.GeocodedAddress();D.addGeocodedAddress(B);this.readChildNodes(C,B)},SearchCentreDistance:function(C,D){var B=parseFloat(C.getAttribute("value"));if(isNaN(B)){B=0}var E=new Geoportal.OLS.LUS.SearchCentreDistance(B);E.accuracy=parseFloat(C.getAttribute("accuracy"));if(isNaN(E.accuracy)){E.accuracy=null}E.uom=C.getAttribute("uom");D.measure=E},GeocodeRequest:function(D,B){var C=new Geoportal.OLS.LUS.GeocodeRequest();B.setRequestParameters(C);this.readChildNodes(D,C)},ReverseGeocodeRequest:function(C,B){var D=new Geoportal.OLS.LUS.ReverseGeocodeRequest();B.setRequestParameters(D);this.readChildNodes(C,D)},ReverseGeocodePreference:function(C,D){var B=new Geoportal.OLS.LUS.ReverseGeocodePreference();B.value=C.childNodes.length>0?C.childNodes[0].nodeValue||"StreetAddress":"StreetAddress";D.addPreference(B)}})},_addWriters:function(){this.writers.xls=OpenLayers.Util.applyDefaults(this.writers.xls,{GeocodeResponse:function(C){var E=this.createElementNSPlus("xls:GeocodeResponse");for(var D=0,B=C.getNbGeocodeResponseList();D<B;D++){this.writeNode(E,"xls:GeocodeResponseList",C.getGeocodeResponseList()[D])}return E},ReverseGeocodeResponse:function(E){var D=this.createElementNSPlus("xls:ReverseGeocodeResponse");for(var C=0,B=E.getNbReverseGeocodedLocations();C<B;C++){this.writeNode(D,"xls:ReverseGeocodedLocation",E.getReverseGeocodedLocations()[C])}return D},GeocodeResponseList:function(D){var E=this.createElementNSPlus("xls:GeocodeResponseList",{attributes:{numberOfGeocodedAddresses:D.getNbGeocodedAddresses()}});for(var C=0,B=D.getNbGeocodedAddresses();C<B;C++){this.writeNode(E,"xls:GeocodedAddress",D.getGeocodedAddresses()[C])}return E},ReverseGeocodedLocation:function(B){var C=this.createElementNSPlus("xls:ReverseGeocodedLocation");this.writeNode(C,"gml:Point",B.lonlat);if(B.address){this.writeNode(C,"xls:Address",B.address)}if(B.searchCentreDistance){this.writeNode(C,"xls:SearchCentreDistance",B.searchCentreDistance)}return C},GeocodedAddress:function(C){var B=this.createElementNSPlus("xls:GeocodedAddress");this.writeNode(B,"gml:Point",C.lonlat);if(C.address){this.writeNode(B,"xls:Address",C.address)}if(C.geocodeMatchCode){this.writeNode(B,"xls:GeocodeMatchCode",C.geocodeMatchCode)}return B},SearchCentreDistance:function(B){var D={attributes:{value:B.value}};if(typeof (B.accuracy)=="number"&&!isNan(B.accuracy)){OpenLayers.Util.extend(D.attributes,{accuracy:B.accuracy})}if(B.uom!=null){OpenLayers.Util.extend(D.attributes,{uom:B.uom})}var C=this.createElementNSPlus("xls:SearchCentreDistance");return C},GeocodeRequest:function(C){var E=this.createElementNSPlus("xls:GeocodeRequest");for(var D=0,B=C.getNbAddresses();D<B;D++){this.writeNode(E,"xls:Address",C.getAddresses()[D])}return E},ReverseGeocodeRequest:function(E){var D=this.createElementNSPlus("xls:ReverseGeocodeRequest");if(E.position){this.writeNode(D,"xls:Position",E.position)}var B=E.getNbPreferences();if(B>0){for(var C=0;C<B;C++){this.writeNode(D,"xls:ReverseGeocodePreference",E.getPreferences()[C])}}return D},ReverseGeocodePreference:function(B){var C=this.createElementNSPlus("xls:ReverseGeocodePreference",{value:B.value});return C}})},CLASS_NAME:"Geoportal.Format.XLS.v1_1.LocationUtilityService"});Geoportal.Format.XLS.v1_0.LocationUtilityService=OpenLayers.Class(Geoportal.Format.XLS.v1_1.LocationUtilityService,{initialize:function(B){Geoportal.Format.XLS.v1_0.prototype.initialize.apply(this,[B]);this._addReaders();this._addWriters()},CLASS_NAME:"Geoportal.Format.XLS.v1_0.LocationUtilityService"});Geoportal.Layer.OpenLS=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:false,postOptions:null,version:"1.1",format:null,formatOptions:null,ols:null,initialize:function(C,B){OpenLayers.Layer.Vector.prototype.initialize.apply(this,[C,B]);this.postOptions=OpenLayers.Util.applyDefaults(this.postOptions,{url:"http://localhost/",async:true,headers:{"Content-Type":"text/xml; charset:UTF-8"},callback:function(){},success:this.success,failure:this.failure,scope:this});this.formatOptions=OpenLayers.Util.applyDefaults(this.formatOptions,{version:this.version,externalProjection:new OpenLayers.Projection("EPSG:4326",{domainOfValidity:new OpenLayers.Bounds(-180,-90,180,90)})});this.version=this.formatOptions.version},destroy:function(){if(this.format){if(typeof (this.format)=="object"){this.format.destroy()}this.format=null}this.formatOptions=null;this.postOptions=null;if(this.ols){this.ols.destroy();this.ols=null}OpenLayers.Layer.Vector.prototype.destroy.apply(this,arguments)},setMap:function(B){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments);if(B&&B.getProjection()){if(!this.formatOptions.internalProjection){this.formatOptions.internalProjection=B.getProjection().clone()}}if(!this.format){this.format=Geoportal.Format.XLS}if(typeof (this.format)=="function"){this.format=new this.format(this.formatOptions)}},success:function(C){if(this.ols){this.ols.destroy();this.ols=null}if(!C){return }this.ols=this.format.read(C.responseXML);if(!this.ols){return }var B=this.ols?this.ols.getErrors():null;if(B){this.ols.destroy();this.ols=null;return }if(this.ols.getNbBodies()<=0){this.ols.destroy();this.ols=null;return }},failure:function(B){if(this.ols){this.ols.destroy();this.ols=null}},CLASS_NAME:"Geoportal.Layer.OpenLS"});Geoportal.Layer.OpenLS.Core=OpenLayers.Class(Geoportal.Layer.OpenLS,{clientName:null,clientPassword:null,MSID:null,maximumResponses:50,initialize:function(C,B){Geoportal.Layer.OpenLS.prototype.initialize.apply(this,[C,B])},destroy:function(){this.clientName=null;this.clientPassword=null;this.MSID=null;Geoportal.Layer.OpenLS.prototype.destroy.apply(this,arguments)},CLASS_NAME:"Geoportal.Layer.OpenLS.Core"});Geoportal.Layer.OpenLS.Core.LocationUtilityService=OpenLayers.Class(Geoportal.Layer.OpenLS.Core,{queriedAddresses:null,initialize:function(D,C){Geoportal.Layer.OpenLS.Core.prototype.initialize.apply(this,[D,C]);this.formatOptions.coreService="LocationUtilityService";this.queriedAddresses=[];this.reportError=false;if(!this.style||!C||!(C.style||C.styleMap)){var B=Geoportal.Util.getImagesLocation()+"xy-target.gif";this.styleMap.styles["default"].defaultStyle=OpenLayers.Util.applyDefaults({externalGraphic:B,graphicOpacity:1,pointRadius:8},this.styleMap.styles["default"].defaultStyle);this.styleMap.styles.select.defaultStyle=OpenLayers.Util.applyDefaults({externalGraphic:B,graphicOpacity:1,pointRadius:15},this.styleMap.styles.select.defaultStyle);this.styleMap.styles.temporary.defaultStyle=OpenLayers.Util.applyDefaults({externalGraphic:B,graphicOpacity:1,pointRadius:8},this.styleMap.styles.temporary.defaultStyle)}if(!C||!C.onFeatureInsert){this.onFeatureInsert=this.createPopupForAddress}this.selectCntrl=new OpenLayers.Control.SelectFeature(this,{onSelect:Geoportal.Control.selectFeature,onUnselect:Geoportal.Control.unselectFeature,hover:true})},destroy:function(){this.cleanQueries();this.selectCntrl=null;Geoportal.Layer.OpenLS.Core.prototype.destroy.apply(this,arguments)},setMap:function(E){if(E){Geoportal.Layer.OpenLS.prototype.setMap.apply(this,arguments);if(this.selectCntrl){E.addControl(this.selectCntrl)}if(E.apiKey&&E.catalogue){var C;for(var D=0,B=E.apiKey.length;D<B;D++){C=E.apiKey[D];if(E.catalogue[C].layers[this.name]){this.GeoRM=this.options.GeoRM=Geoportal.GeoRMHandler.addKey(C,E.catalogue[C].tokenServer.url,E.catalogue[C].tokenServer.ttl,E,{transport:E.catalogue[C].transport,eventListeners:{tokenloaded:this.onTokenLoaded,scope:this}});break}}}}},onTokenLoaded:function(B){if(typeof (this.wait)=="object"){this.wait.clbk.apply(this,this.wait.args);this.wait=null;return false}return true},GEOCODE:function(D,K){if(this.GeoRM){if(!this.GeoRM.getToken(this,arguments)){this.wait={clbk:Geoportal.Layer.OpenLS.Core.LocationUtilityService.prototype.GEOCODE,args:[D,K]};return }}if(!(D instanceof Array)){D=[D]}var C=new Geoportal.OLS.LUS.GeocodeRequest();if(!this.queriedAddresses){this.queriedAddresses=[]}for(var E=0,I=D.length;E<I;E++){this.queriedAddresses[E]={hash:D[E].toString(),features:null};C.addAddress(D[E].clone())}var G=new Geoportal.OLS.XLS({version:this.format.version,_header:new Geoportal.OLS.RequestHeader({sessionID:""})});G.addBody(new Geoportal.OLS.Request("GeocodeRequest",this.format.version,"",{maximumResponses:this.maximumResponses,_requestParameters:C}));var B=this.format.write(G);var H=OpenLayers.Format.XML.prototype.write.apply(this.format,[B]);B=null;G.destroy();G=null;C=null;var J=OpenLayers.Util.applyDefaults(K,this.postOptions);if(this.GeoRM){J.url=this.map.catalogue[this.GeoRM.GeoRMKey].layers[this.name].url;J.params=this.GeoRM.token}if(J.onSuccess&&J.scopeOn){this.options.onSuccess=J.onSuccess;this.options.scopeOn=J.scopeOn;J.success=function(L){this.postOptions.scope.GcSuccess.apply(this.postOptions.scope,[L]);if(this.options.scopeOn&&this.options.onSuccess){this.options.onSuccess.apply(this.options.scopeOn,[L])}}}else{J.success=function(L){this.postOptions.scope.GcSuccess.apply(this.postOptions.scope,[L])}}if(J.onFailure&&J.scopeOn){this.options.onFailure=J.onFailure;this.options.scopeOn=J.scopeOn;J.failure=function(L){this.postOptions.scope.LUSFailure.apply(this.postOptions.scope,[L]);if(this.options.scopeOn&&this.options.onFailure){this.options.onFailure.apply(this.options.scopeOn,[L])}}}else{J.failure=function(L){this.postOptions.scope.LUSFailure.apply(this.postOptions.scope,[L])}}var F=OpenLayers.Request.POST(OpenLayers.Util.applyDefaults({data:H},J));H=null;J=null},REVERSE_GEOCODE:function(I,C){if(this.GeoRM){if(!this.GeoRM.getToken(this,arguments)){this.wait={clbk:Geoportal.Layer.OpenLS.Core.LocationUtilityService.prototype.REVERSE_GEOCODE,args:[I,C]};return }}var H=new Geoportal.OLS.LUS.ReverseGeocodeRequest(I);H.addPreference(new Geoportal.OLS.LUS.ReverseGeocodePreference("StreetAddress"));if(!this.queriedAddresses){this.queriedAddresses=[]}this.queriedAddresses[0]={hash:I.toString(),features:null};var E=new Geoportal.OLS.XLS({version:this.format.version,_header:new Geoportal.OLS.RequestHeader({sessionID:""})});E.addBody(new Geoportal.OLS.Request("ReverseGeocodeRequest",this.format.version,"",{maximumResponses:this.maximumResponses,_requestParameters:H}));var F=this.format.write(E);var B=OpenLayers.Format.XML.prototype.write.apply(this.format,[F]);F=null;E.destroy();E=null;H=null;var G=OpenLayers.Util.applyDefaults(C,this.postOptions);if(this.GeoRM){G.url=this.map.catalogue[this.GeoRM.GeoRMKey].layers[this.name].url;G.params=this.GeoRM.token}if(G.onSuccess&&G.scopeOn){this.options.onSuccess=G.onSuccess;this.options.scopeOn=G.scopeOn;G.success=function(J){this.postOptions.scope.RvGcSuccess.apply(this.postOptions.scope,[J]);if(this.options.scopeOn&&this.options.onSuccess){this.options.onSuccess.apply(this.options.scopeOn,[J])}}}else{G.success=function(J){this.postOptions.scope.RvGcSuccess.apply(this.postOptions.scope,[J])}}if(G.onFailure&&G.scopeOn){this.options.onFailure=G.onSuccess;this.options.scopeOn=G.scopeOn;G.failure=function(J){this.postOptions.scope.LUSFailure.apply(this.postOptions.scope,[J]);if(this.options.scopeOn&&this.options.onFailure){this.options.onFailure.apply(this.options.scopeOn,[J])}}}else{G.failure=function(J){this.postOptions.scope.LUSFailure.apply(this.postOptions.scope,[J])}}var D=OpenLayers.Request.POST(OpenLayers.Util.applyDefaults({data:B},G));B=null;G=null},GcSuccess:function(D){Geoportal.Layer.OpenLS.prototype.success.apply(this,arguments);if(!this.ols){this.queriedAddresses=null;return }var H=this.ols.getBodies()[0];if(!H){this.queriedAddresses=null}else{var G=H.getResponseParameters();if(!G||G.getNbGeocodeResponseList()<=0){this.queriedAddresses=null}else{for(var F=0,C=G.getNbGeocodeResponseList();F<C;F++){var B=G.getGeocodeResponseList()[F];if(!B||B.getNbGeocodedAddresses()<=0){this.queriedAddresses=null}else{for(var E=0,I=B.getNbGeocodedAddresses();E<I;E++){var J=B.getGeocodedAddresses()[E];if(!J||!J.address||!(J.address.name||J.address.streetAddress)){continue}var K=new OpenLayers.Feature.Vector(J.lonlat,{address:J.address.clone(),geocodeMatchCode:J.geocodeMatchCode.clone()},null);if(!this.queriedAddresses[F].features){this.queriedAddresses[F].features=[]}this.queriedAddresses[F].features.push(K)}}}}}this.ols.destroy();this.ols=null},RvGcSuccess:function(H){Geoportal.Layer.OpenLS.prototype.success.apply(this,arguments);if(!this.ols){this.queriedAddresses=null;return }var B=this.ols.getBodies()[0];if(!B){this.queriedAddresses=null}else{var G=B.getResponseParameters();if(!G||G.getNbReverseGeocodedLocations()<=0){this.queriedAddresses=null}else{for(var F=0,E=G.getNbReverseGeocodedLocations();F<E;F++){var D=G.getReverseGeocodedLocations()[F];if(!D||!D.lonlat||!D.address){continue}var C=new OpenLayers.Feature.Vector(D.lonlat,{address:D.address.clone(),measure:(D.measure?D.measure.clone():null)},null);if(!this.queriedAddresses[0].features){this.queriedAddresses[0].features=[]}this.queriedAddresses[0].features.push(C)}}}this.ols.destroy();this.ols=null},LUSFailure:function(B){OpenLayers.Console.warn(B.status+" : "+B.statusText);this.queriedAddresses=null},createPopupForAddress:function(C){var B=function(){var E="";E+='<div class="gpPopupBody">';var F=C.attributes.address;E+=F.toHTMLString();E+="</div>";var D=new Geoportal.Popup.Anchored("chicken",this.geometry.getBounds().getCenterLonLat(),new OpenLayers.Size(80,40),E,null,false,"#ffffff",0.75,null,C);this.popup=D};C.createPopup=OpenLayers.Function.bind(B,C)},cleanQueries:function(){if(this.queriedAddresses){for(var C=0,B=this.queriedAddresses.length;C<B;C++){var D=this.queriedAddresses[C];if(D.features){D.features=null}this.queriedAddresses[C]=null}this.queriedAddresses=null}},CLASS_NAME:"Geoportal.Layer.OpenLS.Core.LocationUtilityService"});Geoportal.Control.LocationUtilityService=OpenLayers.Class(Geoportal.Control.Form,{type:OpenLayers.Control.TYPE_TOGGLE,layer:null,matchTypes:null,drawLocation:true,onSelectAddress:function(B){},initialize:function(C,B){Geoportal.Control.Form.prototype.initialize.apply(this,[B]);this.layer=C},destroy:function(){if(this.map){if(this.layer){this.map.removeLayer(this.layer)}this.map=null}if(this.layer){this.layer.destroy();this.layer=null}Geoportal.Control.Form.prototype.destroy.apply(this,arguments)},setMap:function(B){Geoportal.Control.Form.prototype.setMap.apply(this,arguments);if(B){B.addLayer(this.layer)}},activate:function(){if(!Geoportal.Control.Form.prototype.activate.apply(this,arguments)){return false}this.layer.selectCntrl.deactivate();this.layer.destroyFeatures();var B=document.createElement("form");B.id="__searchlus__"+this.id;B.name=B.id;B.action="javascript:void(null)";this.loadContent(B);this.map.addControl(this.formControl);this.formControl.activate();this.formControl.addContent(B);return true},deactivate:function(){this.layer.cleanQueries();return Geoportal.Control.Form.prototype.deactivate.apply(this,arguments)},loadContent:function(B){this.buildButton(B,"cancel",this.closeForm);this.buildButton(B,"search",this.onSearchClick);this.wImg=this.buildImageButton(B,"wait",Geoportal.Util.getImagesLocation()+"loading.gif");this.wImg.style.display="none";this.buildResultsField(B)},onSearchClick:function(C,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}var D=OpenLayers.Util.getElement("results"+this.id);D.innerHTML="";D.style.display="none";return false},LUSSuccess:function(H){if(!this.layer.queriedAddresses){this.LUSFailure(H);return }this.wImg.style.display="none";var D=this.layer.queriedAddresses[0].features;if(!D){return }var M=OpenLayers.Util.getElement("results"+this.id);M.innerHTML="";for(var J=0,E=D.length;J<E;J++){var L=D[J];var B=document.createElement("div");B.className="gpLUSResult";if((J%2)==1){B.className+="Alternate"}if(L.attributes.geocodeMatchCode){var F=document.createElement("div");F.className="gpGeocodeMatchCode";if(L.attributes.geocodeMatchCode.accuracy<=1){F.className+="Accuracy075to100"}else{if(L.attributes.geocodeMatchCode.accuracy<=0.75){F.className+="Accuracy050to075"}else{if(L.attributes.geocodeMatchCode<=0.5){F.className+="Accuracy025to050"}else{if(L.attributes.geocodeMatchCode<=0.25){F.className+="Accuracy000to025"}}}}var I=document.createElement("img");I.className="gpGeocodeMatchCodeMatchType";I.style.alt="";I.src=Geoportal.Util.getImagesLocation()+"OLSnone.gif";if(L.attributes.geocodeMatchCode.matchType){I.style.alt=L.attributes.geocodeMatchCode.matchType;if(this.matchTypes){for(var G=0,K=this.matchTypes.length;G<K;G++){if(!this.matchTypes[G].re||L.attributes.geocodeMatchCode.matchType.match(this.matchTypes[G].re)){I.src=this.matchTypes[G].src;break}}}}F.appendChild(I);B.appendChild(F)}var O=document.createElement("span");O.style.cursor="pointer";var C={cntrl:this,feature:L};var N=L.attributes.address;O.innerHTML=N.toString();if(N.name){C.zoom=Math.round(this.map.numZoomLevels/2)}else{C.zoom=this.map.numZoomLevels-5}OpenLayers.Event.observe(O,"click",OpenLayers.Function.bindAsEventListener(this.onResultClick,C));B.appendChild(O);M.appendChild(B)}M.style.display=""},LUSFailure:function(D){this.wImg.style.display="none";var E=OpenLayers.Util.getElement("results"+this.id);E.innerHTML="";var C=document.createElement("div");C.className="gpLUSResult";var B=document.createElement("span");B.innerHTML=OpenLayers.i18n("lus.not.match");C.appendChild(B);E.appendChild(C);E.style.display=""},onResultClick:function(B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}if(this.cntrl.map){var C=new OpenLayers.LonLat(this.feature.geometry.x,this.feature.geometry.y);this.cntrl.map.setCenter(C,this.zoom,false,false);C=null;if(this.cntrl.drawLocation){this.cntrl.layer.destroyFeatures();this.cntrl.layer.addFeatures([this.feature]);this.cntrl.layer.selectCntrl.activate()}}if(!B.ctrlKey){this.cntrl.closeForm()}this.cntrl.onSelectAddress(this.feature)},CLASS_NAME:"Geoportal.Control.LocationUtilityService"});Geoportal.Control.LocationUtilityService.GeoNames=OpenLayers.Class(Geoportal.Control.LocationUtilityService,{initialize:function(C,B){Geoportal.Control.LocationUtilityService.prototype.initialize.apply(this,arguments);this.drawLocation=false},loadContent:function(B){var C=this.buildInputTextField(B,{id:"name",mandatory:true,size:80,length:80,callbacks:[{evt:"click",func:this.onSearchClick}]});Geoportal.Control.LocationUtilityService.prototype.loadContent.apply(this,arguments);Geoportal.Control.Form.focusOn(C)},onSearchClick:function(E,C){Geoportal.Control.LocationUtilityService.prototype.onSearchClick.apply(this,arguments);if(E.id.match(/^name/)&&OpenLayers.String.contains(E.id,this.id)){if(!E.hasFocus){Geoportal.Control.Form.focusOn(E)}return false}if(E.id.match(/^search/)){var B=new Geoportal.OLS.Address("FR");var D=OpenLayers.String.trim(OpenLayers.Util.getElement("name"+this.id).value);if(D==""){return false}B.name=D;this.wImg.style.display="";this.layer.GEOCODE([B],{onSuccess:this.LUSSuccess,onFailure:this.LUSFailure,scopeOn:this});B.destroy();B=null;return false}this.closeForm();return false},CLASS_NAME:"Geoportal.Control.LocationUtilityService.GeoNames"});Geoportal.Control.LocationUtilityService.Geocode=OpenLayers.Class(Geoportal.Control.LocationUtilityService,{initialize:function(C,B){Geoportal.Control.LocationUtilityService.prototype.initialize.apply(this,arguments)},loadContent:function(B){var C=this.buildInputTextField(B,{id:"address",mandatory:true,size:80,length:80,callbacks:[{evt:"click",func:this.onSearchClick}]});this.buildInputTextField(B,{id:"municipality",mandatory:true,size:50,length:50,callbacks:[{evt:"click",func:this.onSearchClick}]});this.buildInputTextField(B,{id:"postalcode",size:20,length:20,callbacks:[{evt:"click",func:this.onSearchClick}]});Geoportal.Control.LocationUtilityService.prototype.loadContent.apply(this,arguments);Geoportal.Control.Form.focusOn(C)},onSearchClick:function(F,D){Geoportal.Control.LocationUtilityService.prototype.onSearchClick.apply(this,arguments);if(F.id.match(/^(address|municipality|postalcode)/)&&OpenLayers.String.contains(F.id,this.id)){if(!F.hasFocus){e=OpenLayers.Util.getElement("address"+this.id);if(e&&F.id!=e.id&&e.hasFocus){Geoportal.Control.Form.focusOff(e)}e=OpenLayers.Util.getElement("municipality"+this.id);if(e&&F.id!=e.id&&e.hasFocus){Geoportal.Control.Form.focusOff(e)}e=OpenLayers.Util.getElement("postalcode"+this.id);if(e&&F.id!=e.id&&e.hasFocus){Geoportal.Control.Form.focusOff(e)}Geoportal.Control.Form.focusOn(F)}return false}if(F.id.match(/^search/)){var C=new Geoportal.OLS.Address("FR");var E=OpenLayers.String.trim(OpenLayers.Util.getElement("address"+this.id).value);if(E==""){return false}var G=new Geoportal.OLS.Street();G.name=E;E=OpenLayers.String.trim(OpenLayers.Util.getElement("municipality"+this.id).value);if(E==""){return false}var B=new Geoportal.OLS.StreetAddress();B.addStreet(G);C.streetAddress=B;E=OpenLayers.String.trim(OpenLayers.Util.getElement("municipality"+this.id).value);var H=new Geoportal.OLS.Place({classification:"Municipality",name:E});C.addPlace(H);E=OpenLayers.String.trim(OpenLayers.Util.getElement("postalcode"+this.id).value);C.postalCode=new Geoportal.OLS.PostalCode({name:E});this.wImg.style.display="";this.layer.GEOCODE([C],{onSuccess:this.LUSSuccess,onFailure:this.LUSFailure,scopeOn:this});C.destroy();C=null;return false}this.closeForm();return false},CLASS_NAME:"Geoportal.Control.LocationUtilityService.Geocode"});Geoportal.Control.LocationUtilityService.ReverseGeocode=OpenLayers.Class(Geoportal.Control.LocationUtilityService,{rvgcvl:null,accuracy:1000000,initialize:function(C,B){Geoportal.Control.LocationUtilityService.prototype.initialize.apply(this,arguments)},activate:function(){Geoportal.Control.LocationUtilityService.prototype.activate.apply(this,arguments);if(this.rvgcvl){var E=OpenLayers.Util.getElement("longitude"+this.id);var C=OpenLayers.Util.getElement("latitude"+this.id);OpenLayers.Event.observe(E,"change",OpenLayers.Function.bind(this.updateLocation,this,E,C));OpenLayers.Event.observe(C,"change",OpenLayers.Function.bind(this.updateLocation,this,E,C));var D=new OpenLayers.Geometry.Point(this.map.getCenter().lon,this.map.getCenter().lat);var B=new OpenLayers.Feature.Vector(D);this.rvgcvl.addFeatures([B]);this.rvgcvl.slctCntrl.activate()}return true},deactivate:function(){if(this.rvgcvl){var B=this.rvgcvl.slctCntrl;B.deactivate();this.map.removeControl(B);this.rvgcvl.slctCntrl=null;B=this.rvgcvl.dragCntrl;B.deactivate();this.map.removeControl(B);this.rvgcvl.dragCntrl=null;this.rvgcvl.destroyFeatures();this.map.removeLayer(this.rvgcvl);this.rvgcvl=null}return Geoportal.Control.LocationUtilityService.prototype.deactivate.apply(this,arguments)},loadContent:function(E){var F=new OpenLayers.Geometry.Point(this.map.getCenter().lon,this.map.getCenter().lat);F.transform(this.map.getProjection(),OpenLayers.Projection.CRS84);this.buildInputTextField(E,{id:"longitude",mandatory:true,size:12,length:12,callbacks:[{evt:"click",func:this.onSearchClick}],value:F.x});this.buildInputTextField(E,{id:"latitude",mandatory:true,size:12,length:12,callbacks:[{evt:"click",func:this.onSearchClick}],value:F.y});var C=Geoportal.Util.getImagesLocation()+"xy-target.gif";this.rvgcvl=new OpenLayers.Layer.Vector("__rvgc_LL__",{projection:this.map.getProjection(),styleMap:new OpenLayers.StyleMap({"default":new OpenLayers.Style(OpenLayers.Util.applyDefaults({externalGraphic:C,graphicOpacity:1,pointRadius:8},OpenLayers.Feature.Vector.style["default"])),select:new OpenLayers.Style(OpenLayers.Util.applyDefaults({externalGraphic:C,graphicOpacity:1,pointRadius:15},OpenLayers.Feature.Vector.style.select)),temporary:new OpenLayers.Style(OpenLayers.Util.applyDefaults({externalGraphic:C,graphicOpacity:1,pointRadius:8},OpenLayers.Feature.Vector.style.temporary))}),eventListeners:{beforefeaturesadded:function(){this.destroyFeatures();return true},featureadded:function(G){G.feature.state=OpenLayers.State.INSERT;return true}},displayInLayerSwitcher:false});this.map.addLayer(this.rvgcvl);var B=new OpenLayers.Control.SelectFeature(this.rvgcvl,{multiple:false,hover:true,onSelect:function(G){this.layer.dragCntrl.activate()},onUnselect:function(G){this.layer.dragCntrl.deactivate()}});this.rvgcvl.slctCntrl=B;this.map.addControl(B);var D=new OpenLayers.Control.DragFeature(this.rvgcvl,{onDrag:OpenLayers.Function.bind(this.updateLLForm,this),onComplete:OpenLayers.Function.bind(this.updateLLForm,this)});this.rvgcvl.dragCntrl=D;this.map.addControl(D);Geoportal.Control.LocationUtilityService.prototype.loadContent.apply(this,arguments)},onSearchClick:function(C,B){Geoportal.Control.LocationUtilityService.prototype.onSearchClick.apply(this,arguments);if(C.id.match(/^(longitude|latitude)/)&&OpenLayers.String.contains(C.id,this.id)){if(!C.hasFocus){e=OpenLayers.Util.getElement("longitude"+this.id);if(e&&C.id!=e.id&&e.hasFocus){Geoportal.Control.Form.focusOff(e)}e=OpenLayers.Util.getElement("longitude"+this.id);if(e&&C.id!=e.id&&e.hasFocus){Geoportal.Control.Form.focusOff(e)}Geoportal.Control.Form.focusOn(C)}return false}if(C.id.match(/^search/)){var I=OpenLayers.Util.getElement("longitude"+this.id);var D=OpenLayers.Util.getElement("latitude"+this.id);if(!I||!D){return false}var H=parseFloat(I.value);var G=parseFloat(D.value);if(isNaN(H)||isNaN(G)){return false}var F=new OpenLayers.Geometry.Point(H,G);F.transform(this.map.getDisplayProjection(),OpenLayers.Projection.CRS84);var E=new Geoportal.OLS.Position(F);this.wImg.style.display="";this.layer.REVERSE_GEOCODE(E,{onSuccess:this.LUSSuccess,onFailure:this.LUSFailure,scopeOn:this});F=null;E.destroy();E=null;return false}this.closeForm();return false},updateLLForm:function(C,B){if(!C||!C.geometry||!C.geometry.x){return }var E=new OpenLayers.Geometry.Point(C.geometry.x,C.geometry.y);E.transform(this.map.getProjection(),OpenLayers.Projection.CRS84);var F=OpenLayers.Util.getElement("longitude"+this.id);F.value=Math.round(E.x*this.accuracy)/this.accuracy;var D=OpenLayers.Util.getElement("latitude"+this.id);D.value=Math.round(E.y*this.accuracy)/this.accuracy},updateLocation:function(H,D,B){if(B||window.event){OpenLayers.Event.stop(B?B:window.event)}var C=this.rvgcvl.features[0];if(!C||!H||!D){return true}var G=parseFloat(H.value);var E=parseFloat(D.value);if(!isNaN(G)&&!isNaN(E)){this.rvgcvl.destroyFeatures();var F=new OpenLayers.Geometry.Point(G,E);F.transform(OpenLayers.Projection.CRS84,this.map.getProjection());C=new OpenLayers.Feature.Vector(F);this.rvgcvl.addFeatures([C]);this.map.setCenter(new OpenLayers.LonLat(F.x,F.y),this.map.getZoom())}return true},CLASS_NAME:"Geoportal.Control.LocationUtilityService.ReverseGeocode"});Geoportal.Control.SearchToolbar=OpenLayers.Class(Geoportal.Control.Panel,{geonamesCntrlId:null,geocodeCntrlId:null,reverseGeocodeCntrlId:null,initialize:function(C){C=C||{};Geoportal.Control.Panel.prototype.initialize.apply(this,[C]);var H=null;if(C.geonamesOptions){if(C.geonamesOptions.control){H=C.geonamesOptions.control;this.geonamesCntrlId=H.id}else{C.geonamesOptions.layerOptions=C.geonamesOptions.layerOptions||{};var I=OpenLayers.Util.extend({},C.geonamesOptions.layerOptions);var G=new Geoportal.Layer.OpenLS.Core.LocationUtilityService(I.name||OpenLayers.Util.createUniqueID("LUS.Geonames"),I);this.geonamesCntrlId=C.geonamesOptions.id||(C.geonamesOptions.div?C.geonamesOptions.div.id:null)||"gn_"+this.id;H=new Geoportal.Control.LocationUtilityService.GeoNames(G,OpenLayers.Util.extend({id:this.geonamesCntrlId,title:"gpControlLocationUtilityService.geonames.title"},C.geonamesOptions))}this.addControls([H])}if(C.geocodeOptions){if(C.geocodeOptions.control){H=C.geocodeOptions.control;this.geocodeCntrlId=H.id}else{C.geocodeOptions.layerOptions=C.geocodeOptions.layerOptions||{};var B=OpenLayers.Util.extend({},C.geocodeOptions.layerOptions);var E=new Geoportal.Layer.OpenLS.Core.LocationUtilityService(B.name||OpenLayers.Util.createUniqueID("LUS.Geocode"),B);this.geocodeCntrlId=C.geocodeOptions.id||(C.geocodeOptions.div?C.geocodeOptions.div.id:null)||"gc_"+this.id;H=new Geoportal.Control.LocationUtilityService.Geocode(E,OpenLayers.Util.extend({id:this.geocodeCntrlId,title:"gpControlLocationUtilityService.geocode.title"},C.geocodeOptions))}this.addControls([H])}if(C.reverseGeocodeOptions){if(C.reverseGeocodeOptions.control){H=C.reverseGeocodeOptions.control;this.reverseGeocodeCntrlId=H.id}else{C.reverseGeocodeOptions.layerOptions=C.reverseGeocodeOptions.layerOptions||{};var D=OpenLayers.Util.extend({},C.reverseGeocodeOptions.layerOptions);var F=new Geoportal.Layer.OpenLS.Core.LocationUtilityService(D.name||OpenLayers.Util.createUniqueID("LUS.ReverseGeocode"),D);this.reverseGeocodeCntrlId=C.reverseGeocodeOptions.id||(C.reverseGeocodeOptions.div?C.reverseGeocodeOptions.div.id:null)||"rvgc_"+this.id;H=new Geoportal.Control.LocationUtilityService.ReverseGeocode(F,OpenLayers.Util.extend({id:this.reverseGeocodeCntrlId,title:"gpControlLocationUtilityService.reverse.geocode.title"},C.reverseGeocodeOptions))}this.addControls([H])}},CLASS_NAME:"Geoportal.Control.SearchToolbar"});Geoportal.Catalogue=OpenLayers.Class({map:null,urlServices:{},initialize:function(F,D){if(F){this.map=F}if(D.apiKey){if(!(D.apiKey instanceof Array)){D.apiKey=[D.apiKey]}var C;for(var E=0,B=D.apiKey.length;E<B&&D.apiKey[E]!=null;E++){C=D.apiKey[E];if(D[C]!=null){this[C]={tokenServer:D[C].tokenServer,geoRMKey:C,tokenTimeOut:D[C].tokenTimeOut,transport:D[C].transport||"json",bounds:D[C].bounds?OpenLayers.Bounds.fromArray(D[C].bounds):null,layers:D[C].resources,allowedGeoportalLayers:D[C].allowedGeoportalLayers}}else{this[C]={tokenServer:"http://localhost/",geoRMKey:C,tokenTimeOut:60000,layers:{},allowedGeoportalLayers:[]}}}}},destroy:function(){if(this.map){if(this.map.apiKey){var C;for(var D=0,B=this.map.apiKey.length;D<B;D++){C=this.map.apiKey[D];if(this[C]){this[C]=null}}this.map.apiKey=null}this.map=null}},_orderLayersStack:function(G){var C=[];var F;var E,H=G.length;for(E=0;E<H;E++){F={};var B=G[E];F.layerId=B;switch(F.layerId.split(":")[0]){case"ORTHOIMAGERY.ORTHOPHOTOS":F.weight=999;break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":F.weight=998;break;case"LANDCOVER.CORINELANDCOVER":F.weight=997;break;case"ELEVATION.SLOPS":F.weight=989;break;case"CADASTRALPARCELS.PARCELS":F.weight=979;break;case"HYDROGRAPHY.HYDROGRAPHY":F.weight=969;break;case"TRANSPORTNETWORKS.ROADS":F.weight=899;break;case"TRANSPORTNETWORKS.RAILWAYS":F.weight=898;break;case"TRANSPORTNETWORKS.RUNWAYS":F.weight=897;break;case"BUILDINGS.BUILDINGS":F.weight=799;break;case"UTILITYANDGOVERNMENTALSERVICES.ALL":F.weight=699;break;case"ADMINISTRATIVEUNITS.BOUNDARIES":F.weight=599;break;case"SEAREGIONS.LEVEL0":F.weight=499;break;default:F.weight=0;break}C.unshift(F)}C.sort(function(J,I){return I.weight-J.weight});H=C.length;var D=[];for(E=0;E<H;E++){F=C.shift();D[E]=F.layerId}return D},getTerritory:function(E){if(E==undefined){if(this.map){E=this.map.territory||"FXX"}else{E="FXX"}}if(Geoportal.Catalogue.TERRITORIES[E]==undefined){if(this.map){E=this.map.territory||"FXX"}else{E="FXX"}}for(var C=0,B=Geoportal.Catalogue.TERRITORIES[E].defaultCRS.length;C<B;C++){var D=Geoportal.Catalogue.TERRITORIES[E].defaultCRS[C];if(typeof (D)=="string"){Geoportal.Catalogue.TERRITORIES[E].defaultCRS[C]=new OpenLayers.Projection(D,{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[E].geobbox)})}}if(typeof (Geoportal.Catalogue.TERRITORIES[E].geoCRS[0])=="string"){Geoportal.Catalogue.TERRITORIES[E].geoCRS[0]=new OpenLayers.Projection(Geoportal.Catalogue.TERRITORIES[E].geoCRS[0],{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[E].geobbox)})}return E},findTerritory:function(E){for(var D in Geoportal.Catalogue.TERRITORIES){if(Geoportal.Catalogue.TERRITORIES.hasOwnProperty(D)){var B=Geoportal.Catalogue.TERRITORIES[D];if(D=="WLD"){continue}if(!B.geobbox){continue}var F=OpenLayers.Bounds.fromArray(B.geobbox);var C=F.containsLonLat(E);F=null;if(C){return D}}}return"WLD"},getNativeProjection:function(C,B){if(!B){B=Geoportal.Catalogue.TERRITORIES[C].defaultCRS[0]}if(typeof (B)=="string"){B=new OpenLayers.Projection(B,{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[C].geobbox)})}return B},getDisplayProjections:function(F,C,E){if(F==undefined){if(this.map){F=this.map.territory||"FXX"}else{F="FXX"}}var H=[];if(!C){if(!E){H.push(Geoportal.Catalogue.TERRITORIES[F].displayCRS[0])}else{H=Geoportal.Catalogue.TERRITORIES[F].displayCRS.slice(0)}}else{H.push(C)}for(var D=0,B=H.length;D<B;D++){var G=H[D];if(typeof (G)=="string"){G=new OpenLayers.Projection(G,{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[F].geobbox)});H[D]=G}}return H},getResolutions:function(F,D){var C=null;var E,B;if(D.equals(Geoportal.Catalogue.TERRITORIES[F].defaultCRS[0])){C=[];for(E=0,B=Geoportal.Catalogue.RESOLUTIONS.length;E<B;E++){C[E]=Geoportal.Catalogue.RESOLUTIONS[E]}return C}if(D.equals(Geoportal.Catalogue.TERRITORIES[F].geoCRS[0])){C=[];for(E=0,B=Geoportal.Catalogue.RESOLUTIONS.length;E<B;E++){var G=new OpenLayers.LonLat(Geoportal.Catalogue.RESOLUTIONS[E],0);G.transform(Geoportal.Catalogue.TERRITORIES[F].defaultCRS[0],D);C[E]=G.lon}return C}return C},getCenter:function(D,C){var B=new OpenLayers.LonLat(Geoportal.Catalogue.TERRITORIES[D].geocenter[0],Geoportal.Catalogue.TERRITORIES[D].geocenter[1]);if(C&&typeof (C)!="string"){B.transform(Geoportal.Catalogue.TERRITORIES[D].geoCRS[0],C)}return B},getExtent:function(F,D){var G=null;if(!F){if(this.map&&this.map.apiKey){var C;for(var E=0,B=this.map.apiKey.length;E<B;E++){C=this.map.apiKey[E];if(this[C]&&this[C].bounds){if(!G){G=this[C].bounds.clone()}else{G.extend(this[C].bounds.clone())}}}}if(G==null){G=new OpenLayers.Bounds(-180,-90,180,90)}}else{G=OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[F].geobbox)}if(D&&typeof (D)!="string"){G.transform(F?Geoportal.Catalogue.TERRITORIES[F].geoCRS[0]:OpenLayers.Projection.CRS84,D,true)}return G},getDefaultMinZoom:function(C){var D=Geoportal.Catalogue.RESOLUTIONS.length-1;for(var B in Geoportal.Catalogue.TERRITORIES[C].baseLayers){if(Geoportal.Catalogue.TERRITORIES[C].baseLayers.hasOwnProperty(B)){if(Geoportal.Catalogue.TERRITORIES[C].baseLayers[B].minZoomLevel<D){D=Geoportal.Catalogue.TERRITORIES[C].baseLayers[B].minZoomLevel}}}return D==Geoportal.Catalogue.RESOLUTIONS.length-1?0:D},getDefaultMaxZoom:function(D){var B=0;for(var C in Geoportal.Catalogue.TERRITORIES[D].baseLayers){if(Geoportal.Catalogue.TERRITORIES[D].baseLayers.hasOwnProperty(C)){if(Geoportal.Catalogue.TERRITORIES[D].baseLayers[C].maxZoomLevel>B){B=Geoportal.Catalogue.TERRITORIES[D].baseLayers[C].maxZoomLevel}}}return B==0?Geoportal.Catalogue.RESOLUTIONS.length-1:B},getDefaultZoom:function(D,B){if(!B){B=this.getNativeProjection(D)}for(var C in Geoportal.Catalogue.TERRITORIES[D].baseLayers){if(Geoportal.Catalogue.TERRITORIES[D].baseLayers.hasOwnProperty(C)){if(B.isCompatibleWith(C)){return Geoportal.Catalogue.TERRITORIES[D].baseLayers[C].defaultZoomLevel}}}return 5},_getOriginator:function(C,B,E){var D={logo:C,url:"#"};switch(C){case"planetobserver":D.url="http://www.planetobserver.com";break;case"spotimage":D.url="http://www.spotimage.fr";break;case"cnes":D.url="http://www.cnes.fr";break;case"ifen":D.url="http://www.ifen.fr/";break;case"ifn":D.url="http://www.ifn.fr/spip/sommaire.php3";break;case"ird":D.url="http://www.cayenne.ird.fr/";break;case"seasguyane":D.url="http://www.seas-guyane.org/";break;default:D.logo="ign";D.url="http://www.ign.fr";break}if(B&&E){D.minZoomLevel=B;D.maxZoomLevel=E}return D},getLayerGeoRMKey:function(F,C){if(this.map&&this.map.apiKey){var D;for(var E=0,B=this.map.apiKey.length;E<B;E++){D=this.map.apiKey[E];if(this[D]&&this[D].bounds&&this[D].bounds.intersectsBounds(this.getExtent(F),true)){for(var G in this[D].layers){if(G==C||G.match("^"+C+":")){return D}}}}}return null},getLayerParameters:function(K,E){var M={};var J=null;if(this.map&&this.map.apiKey){var D;for(var F=0,C=this.map.apiKey.length;F<C;F++){D=this.map.apiKey[F];if(this[D]){for(var H in this[D].layers){if(H==E||H.match("^"+E+":")){J=this[D].layers[H];break}}}if(J!=null){break}}}if(J==null){return null}M.resourceId=J.name+":"+J.type;M.url=J.url;M.params={layers:null,exceptions:"text/xml"};M.options={isBaseLayer:false,description:J.name+".description",visibility:false,opacity:1,view:{drop:false,zoomToExtent:false}};switch(J.type){case"WMS":M.classLayer=Geoportal.Layer.WMS;M.params=OpenLayers.Util.extend(M.params,{format:"image/png",transparent:true});M.options=OpenLayers.Util.extend(M.options,{buffer:0,singleTile:true});break;case"WFS":M.classLayer=Geoportal.Layer.WFS;M.options=OpenLayers.Util.extend(M.options,{});break;case"OPENLS":M=null;return M;default:M.classLayer=Geoportal.Layer.WMSC;M.options=OpenLayers.Util.extend(M.options,{transparent:true,buffer:0,gridOrigin:new OpenLayers.LonLat(0,0),nativeTileSize:new OpenLayers.Size(256,256),singleTile:false});break}var B=Geoportal.Catalogue.TERRITORIES[K].defaultCRS;switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":case"GEOGRAPHICALGRIDSYSTEMS.MAPS":M.options.visibility=true;break;default:break}switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":case"GEOGRAPHICALGRIDSYSTEMS.MAPS":case"ELEVATION.SLOPS":if(J.type=="WMSC"){M.params.format="image/jpeg"}break;default:if(J.type=="WMSC"){M.params.format="image/png";M.params.transparency=true}break}var I={};I.originators=[];var L="http://www.geocatalogue.fr/Detail.do?fileIdentifier=";switch(J.name){case"GEOGRAPHICALGRIDSYSTEMS.MAPS":case"ELEVATION.SLOPS":case"LANDCOVER.CORINELANDCOVER":I.opacity=0.3;break;case"CADASTRALPARCELS.PARCELS":case"HYDROGRAPHY.HYDROGRAPHY":case"TRANSPORTNETWORKS.ROADS":case"TRANSPORTNETWORKS.RAILWAYS":case"TRANSPORTNETWORKS.RUNWAYS":case"BUILDINGS.BUILDINGS":case"UTILITYANDGOVERNMENTALSERVICES.ALL":case"ADMINISTRATIVEUNITS.BOUNDARIES":case"SEAREGIONS.LEVEL0":I.opacity=0.5;break;default:break}switch(K){case"ATF":M=null;break;case"CHE":M=null;break;case"CRZ":switch(J.name){case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.opacity=1;I.minZoomLevel=5;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));break;default:M=null;break}break;case"EUE":case"FXX":default:switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,11));I.originators.push(this._getOriginator("spotimage",12,13));I.originators.push(this._getOriginator("cnes",12,13));I.originators.push(this._getOriginator("ign",14,17));I.metadataURL=L+"GL_PHOTO_FXX.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_FXX.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_FXX.xml";I.dataURL="http://professionnels.ign.fr/ficheProduitCMS.do?idDoc=5323461";I.maxExtent=new OpenLayers.Bounds(-6.841845,37.677499,13.684943,51.807208);break;case"LANDCOVER.CORINELANDCOVER":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ifen"));I.maxExtent=new OpenLayers.Bounds(-5.669834,41.012908,9.724787,51.609866);break;case"CADASTRALPARCELS.PARCELS":I.minZoomLevel=12;I.maxZoomLevel=18;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_PARCEL_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.141354,9.560094,41.333552,51.0894);break;case"HYDROGRAPHY.HYDROGRAPHY":I.minZoomLevel=9;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_HYDRO_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.403793,41.220068,9.716853,51.119943);break;case"TRANSPORTNETWORKS.ROADS":I.minZoomLevel=6;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ROUTE_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.128343,41.367868,9.555618,51.078081);break;case"TRANSPORTNETWORKS.RAILWAYS":I.minZoomLevel=6;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_RESFER_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-4.500134,41.115334,10.721169,51.181747);break;case"TRANSPORTNETWORKS.RUNWAYS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_AERIEN_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.069174,41.367598,9.549014,51.042292);break;case"BUILDINGS.BUILDINGS":I.minZoomLevel=8;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_BATI_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.139906,41.230776,9.558515,51.085654);break;case"UTILITYANDGOVERNMENTALSERVICES.ALL":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_SRVPUB_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.088097,41.364562,9.547709,51.067481);break;case"ADMINISTRATIVEUNITS.BOUNDARIES":I.minZoomLevel=9;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ADMIN_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.141354,41.333552,9.560094,51.0894);break;case"SEAREGIONS.LEVEL0":I.minZoomLevel=7;I.maxZoomLevel=16;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_LITO_FXX.xml";I.maxExtent=new OpenLayers.Bounds(-5.151038,41.333211,9.560094,51.089086);break;default:M=null;break}break;case"GLP":case"SBA":case"SMA":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("ign",9,17));I.metadataURL=L+"GL_PHOTO_GLP.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_GLP.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_GLP.xml";break;case"HYDROGRAPHY.HYDROGRAPHY":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_HYDRO_GLP.xml";break;case"TRANSPORTNETWORKS.ROADS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ROUTE_GLP.xml";break;case"TRANSPORTNETWORKS.RUNWAYS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_AERIEN_GLP.xml";break;case"BUILDINGS.BUILDINGS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_BATI_GLP.xml";break;case"ADMINISTRATIVEUNITS.BOUNDARIES":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ADMIN_GLP.xml";break;case"UTILITYANDGOVERNMENTALSERVICES.ALL":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_SRVPUB_GLP.xml";break;default:M=null;break}break;case"GUF":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("spotimage",9,11));I.originators.push(this._getOriginator("cnes",9,11));I.originators.push(this._getOriginator("ifn",9,11));I.originators.push(this._getOriginator("ird",9,11));I.originators.push(this._getOriginator("seasguyane",9,11));I.originators.push(this._getOriginator("ign",12,17));I.metadataURL=L+"GL_PHOTO_GUF.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_GUF.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_GUF.xml";break;case"HYDROGRAPHY.HYDROGRAPHY":I.minZoomLevel=11;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_HYDRO_GUF.xml";break;case"TRANSPORTNETWORKS.ROADS":I.minZoomLevel=11;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ROUTE_GUF.xml";break;case"TRANSPORTNETWORKS.RUNWAYS":I.minZoomLevel=11;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_AERIEN_GUF.xml";break;case"BUILDINGS.BUILDINGS":I.minZoomLevel=11;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_BATI_GUF.xml";break;case"UTILITYANDGOVERNMENTALSERVICES.ALL":I.minZoomLevel=11;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_SRVPUB_GUF.xml";break;case"ADMINISTRATIVEUNITS.BOUNDARIES":I.minZoomLevel=11;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ADMIN_GUF.xml";break;default:M=null;break}break;case"KER":switch(J.name){case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.opacity=1;I.minZoomLevel=5;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_KER.xml";break;default:M=null;break}break;case"MTQ":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("ign",9,17));I.metadataURL=L+"GL_PHOTO_MTQ.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_MTQ.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_MTQ.xml";break;case"HYDROGRAPHY.HYDROGRAPHY":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_HYDRO_MTQ.xml";break;case"TRANSPORTNETWORKS.ROADS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ROUTE_MTQ.xml";break;case"TRANSPORTNETWORKS.RUNWAYS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_AERIEN_MTQ.xml";break;case"BUILDINGS.BUILDINGS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_BATI_MTQ.xml";break;case"ADMINISTRATIVEUNITS.BOUNDARIES":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ADMIN_MTQ.xml";break;case"UTILITYANDGOVERNMENTALSERVICES.ALL":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_SRVPUB_MTQ.xml";break;default:M=null;break}break;case"MYT":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("ign",9,17));I.metadataURL=L+"GL_PHOTO_MYT.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_MYT.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_MYT.xml";break;case"HYDROGRAPHY.HYDROGRAPHY":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_HYDRO_MYT.xml";break;case"TRANSPORTNETWORKS.ROADS":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ROUTE_MYT.xml";break;case"TRANSPORTNETWORKS.RUNWAYS":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_AERIEN_MYT.xml";break;case"BUILDINGS.BUILDINGS":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_BATI_MYT.xml";break;case"ADMINISTRATIVEUNITS.BOUNDARIES":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ADMIN_MYT.xml";break;default:M=null;break}break;case"NCL":switch(J.name){case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.opacity=1;I.minZoomLevel=5;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_NCL.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_NCL.xml";break;default:M=null;break}break;case"PYF":switch(J.name){case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.opacity=1;I.minZoomLevel=5;I.maxZoomLevel=13;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_PYF.xml";break;default:M=null;break}break;case"REU":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("ign",9,17));I.metadataURL=L+"GL_PHOTO_REU.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_REU.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_REU.xml";break;case"HYDROGRAPHY.HYDROGRAPHY":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_HYDRO_REU.xml";break;case"TRANSPORTNETWORKS.ROADS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ROUTE_REU.xml";break;case"TRANSPORTNETWORKS.RUNWAYS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_AERIEN_REU.xml";break;case"BUILDINGS.BUILDINGS":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_BATI_REU.xml";break;case"ADMINISTRATIVEUNITS.BOUNDARIES":I.minZoomLevel=11;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ADMIN_REU.xml";break;case"UTILITYANDGOVERNMENTALSERVICES.ALL":I.minZoomLevel=14;I.maxZoomLevel=17;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_SRVPUB_REU.xml";break;default:M=null;break}break;case"ASP":M=null;break;case"SPM":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("ign",9,17));I.metadataURL=L+"GL_PHOTO_SPM.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_SPM.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_SPM.xml";break;default:M=null;break}break;case"WLD":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=0;I.maxZoomLevel=4;I.originators.push(this._getOriginator("planetobserver"));break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=0;I.maxZoomLevel=4;I.originators.push(this._getOriginator("ign"));break;default:M=null;break}break;case"WLF":switch(J.name){case"ORTHOIMAGERY.ORTHOPHOTOS":I.minZoomLevel=5;I.maxZoomLevel=17;I.originators.push(this._getOriginator("planetobserver",5,8));I.originators.push(this._getOriginator("ign",9,17));I.metadataURL=L+"GL_PHOTO_WLF.xml";break;case"GEOGRAPHICALGRIDSYSTEMS.MAPS":I.minZoomLevel=5;I.maxZoomLevel=15;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_CARTE_WLF.xml";break;case"ELEVATION.SLOPS":I.minZoomLevel=5;I.maxZoomLevel=12;I.originators.push(this._getOriginator("ign"));I.metadataURL=L+"GL_ALTI_WLF.xml";break;default:M=null;break}break}if(M){I.name=J.name;I.projection=null;for(var F=0,G=B.length;F<G;F++){if(typeof (B[F])=="string"){B[F]=new OpenLayers.Projection(B[F],{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[K].geobbox)})}else{B[F]=new OpenLayers.Projection(B[F].getCode(),{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[K].geobbox)})}if(B[F].equals(this.map.getProjection())){I.projection=new OpenLayers.Projection(B[F].getCode(),{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[K].geobbox)})}}if(!I.projection){I.projection=new OpenLayers.Projection(B[0].getCode(),{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[K].geobbox)})}M.params.layers=J.name;if((M.classLayer==Geoportal.Layer.WMSC)&&!I.projection.equals(this.map.getProjection())){I.nativeResolutions=Geoportal.Catalogue.RESOLUTIONS.slice(0)}if(I.maxExtent==undefined){I.maxExtent=this.getExtent(K)}I.maxExtent.transform(Geoportal.Catalogue.TERRITORIES[K].geoCRS[0],I.projection,true);OpenLayers.Util.extend(M.options,I)}return M},CLASS_NAME:"Geoportal.Catalogue"});Geoportal.Catalogue.RESOLUTIONS=[39135.75,19567.875,9783.9375,4891.96875,2445.984375,2048,1024,512,256,128,64,32,16,8,4,2,1,0.5,0.25,0.125,0.0625];Geoportal.Catalogue.TERRITORIES={ATF:{},CHE:{},CRZ:{geobbox:[47,-48,55,-44],geocenter:[51.866667,-46.433333],defaultCRS:["IGNF:GEOPORTALCRZ"],geoCRS:["IGNF:WGS84G"],displayCRS:["IGNF:WGS84G","CRS:84","EPSG:4326","IGNF:UTM39SW84","EPSG:32739"],baseLayers:{"IGNF:GEOPORTALCRZ":{minZoomLevel:5,maxZoomLevel:13,defaultZoomLevel:11}}},FXX:{geobbox:[-31.17,27.33,69.03,80.83],geocenter:[2.345274398,48.860832558],defaultCRS:["IGNF:GEOPORTALFXX"],geoCRS:["IGNF:RGF93G"],displayCRS:["IGNF:RGF93G","EPSG:4171","EPSG:4258","CRS:84","EPSG:4326","EPSG:3034","EPSG:3035","IGNF:LAMB93","EPSG:2154"],baseLayers:{"IGNF:GEOPORTALFXX":{minZoomLevel:5,maxZoomLevel:18,defaultZoomLevel:5}}},GLP:{geobbox:[-63.2,15.75,-60,17.5],geocenter:[-61.732777778,15.996111111],defaultCRS:["IGNF:GEOPORTALANF"],geoCRS:["IGNF:WGS84RRAFGEO"],displayCRS:["IGNF:WGS84RRAFGEO","CRS:84","EPSG:4326","IGNF:UTM20W84GUAD","EPSG:2969","EPSG:32620"],baseLayers:{"IGNF:GEOPORTALANF":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:13}}},GUF:{geobbox:[-62.1,-4.3,-46,11.5],geocenter:[-52.305277778,4.932222222],defaultCRS:["IGNF:GEOPORTALGUF"],geoCRS:["IGNF:RGFG95GEO"],displayCRS:["IGNF:RGFG95GEO","CRS:84","EPSG:4326","IGNF:UTM22RGFG95","EPSG:2972","EPSG:32622"],baseLayers:{"IGNF:GEOPORTALGUF":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:10}}},KER:{geobbox:[62,-53,76,-45],geocenter:[70.215278,-49.354167],defaultCRS:["IGNF:GEOPORTALKER"],geoCRS:["IGNF:WGS84G"],displayCRS:["IGNF:WGS84G","CRS:84","EPSG:4326","IGNF:UTM42SW84","EPSG:32742"],baseLayers:{"IGNF:GEOPORTALKER":{minZoomLevel:5,maxZoomLevel:13,defaultZoomLevel:11}}},MTQ:{geobbox:[-64,11.7,-59,15.7],geocenter:[-61.075,14.6],defaultCRS:["IGNF:GEOPORTALANF"],geoCRS:["IGNF:WGS84RRAFGEO"],displayCRS:["IGNF:WGS84RRAFGEO","CRS:84","EPSG:4326","IGNF:UTM20W84MART","EPSG:2989","EPSG:32620"],baseLayers:{"IGNF:GEOPORTALANF":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:13}}},MYT:{geobbox:[40,-17.5,56,3],geocenter:[45.228333333,-12.781666667],defaultCRS:["IGNF:GEOPORTALMYT"],geoCRS:["IGNF:RGM04GEO"],displayCRS:["IGNF:RGM04GEO","CRS:84","EPSG:4326","IGNF:RGM04UTM38S","EPSG:32738"],baseLayers:{"IGNF:GEOPORTALMYT":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:14}}},NCL:{geobbox:[160,-24.3,170,-17.1],geocenter:[166.433333,-22.283333],defaultCRS:["IGNF:GEOPORTALNCL"],geoCRS:["IGNF:RGNCGEO"],displayCRS:["IGNF:RGNCGEO","CRS:84","EPSG:4326","IGNF:RGNCUTM57S","EPSG:32757","IGNF:RGNCUTM58S","EPSG:32758","IGNF:RGNCUTM59S","EPSG:32759"],baseLayers:{"IGNF:GEOPORTALNCL":{minZoomLevel:5,maxZoomLevel:13,defaultZoomLevel:9}}},PYF:{geobbox:[-160,-28.2,-108,11],geocenter:[-149.569444,-17.536111],defaultCRS:["IGNF:GEOPORTALPYF"],geoCRS:["IGNF:RGPFGEO"],displayCRS:["IGNF:RGPFGEO","CRS:84","EPSG:4326","IGNF:RGPFUTM5S","EPSG:3296","EPSG:32705","IGNF:RGPFUTM6S","EPSG:3297","EPSG:32706","IGNF:RGPFUTM7S","EPSG:3298","EPSG:32707"],baseLayers:{"IGNF:GEOPORTALPYF":{minZoomLevel:5,maxZoomLevel:11,defaultZoomLevel:11}}},REU:{geobbox:[37.5,-26.2,60,-17.75],geocenter:[55.466666667,-20.875],defaultCRS:["IGNF:GEOPORTALREU"],geoCRS:["IGNF:RGR92GEO"],displayCRS:["IGNF:RGR92GEO","CRS:84","EPSG:4326","IGNF:RGR92UTM40S","EPSG:2975","EPSG:32740"],baseLayers:{"IGNF:GEOPORTALREU":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:13}}},SBA:{geobbox:[-63,17.75,-62.7,17.99],geocenter:[-62.85,17.895833],defaultCRS:["IGNF:GEOPORTALANF"],geoCRS:["IGNF:WGS84RRAFGEO"],displayCRS:["IGNF:WGS84RRAFGEO","CRS:84","EPSG:4326","IGNF:UTM20W84GUAD","EPSG:2969","EPSG:32620"],baseLayers:{"IGNF:GEOPORTALANF":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:14}}},SMA:{geobbox:[-63.19,18,-62.9,18.18],geocenter:[-63.088888,18.069722],defaultCRS:["IGNF:GEOPORTALANF"],geoCRS:["IGNF:WGS84RRAFGEO"],displayCRS:["IGNF:WGS84RRAFGEO","CRS:84","EPSG:4326","IGNF:UTM20W84GUAD","EPSG:2969","EPSG:32620"],baseLayers:{"IGNF:GEOPORTALANF":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:14}}},ASP:{geobbox:[77.45,-38.77,77.63,-37.75],geocenter:[77.53,-38.62],defaultCRS:["IGNF:GEOPORTALASP"],geoCRS:["IGNF:WGS84G"],displayCRS:["IGNF:WGS84G","CRS:84","EPSG:4326","IGNF:UTM43SW84","EPSG:32743"],baseLayers:{"IGNF:GEOPORTALASP":{minZoomLevel:5,maxZoomLevel:13,defaultZoomLevel:11}}},SPM:{geobbox:[-60,43.5,-50,52],geocenter:[-56.173611,46.780556],defaultCRS:["IGNF:GEOPORTALSPM"],geoCRS:["IGNF:RGSPM06GEO"],displayCRS:["IGNF:RGSPM06GEO","CRS:84","EPSG:4326","IGNF:RGSPM06U21","EPSG:32606"],baseLayers:{"IGNF:GEOPORTALSPM":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:14}}},WLD:{geobbox:[-180,-90,180,90],geocenter:[2.345274398,48.860832558],defaultCRS:["IGNF:MILLER"],geoCRS:[OpenLayers.Projection.CRS84],displayCRS:[OpenLayers.Projection.CRS84],baseLayers:{"IGNF:MILLER":{minZoomLevel:0,maxZoomLevel:4,defaultZoomLevel:4}}},WLF:{geobbox:[-178.5,-14.6,-175.8,-12.8],geocenter:[-176.173611,-13.283333],defaultCRS:["IGNF:GEOPORTALWLF"],geoCRS:["IGNF:WGS84G"],displayCRS:["IGNF:WGS84G","CRS:84","EPSG:4326","IGNF:UTM01SW84","EPSG:32701"],baseLayers:{"IGNF:GEOPORTALWLF":{minZoomLevel:5,maxZoomLevel:17,defaultZoomLevel:14}}}};Geoportal.Catalogue.TERRITORIES.EUE=OpenLayers.Util.extend({},Geoportal.Catalogue.TERRITORIES.FXX);Geoportal.Map=OpenLayers.Class(OpenLayers.Map,{catalogue:null,beforeOnBeforeMove:function(B){},afterOnBeforeMove:function(B){},initialize:function(I,E){OpenLayers.Map.prototype.initialize.apply(this,arguments);if(this.proxy){this.setProxyUrl(this.proxy)}this.events.register("beforemove",this,this.onBeforeMove);this.events.register("changebaselayer",this,this.changeBaseLayer);this.events.register("changedisplayprojection",this,this.changeDisplayProjection);this.events.register("changelayer",this,this.updateZoomLevels);if(this.catalogue){this.catalogue.map=this}if(this.catalogue&&this.apiKey){var D;this.allowedGeoportalLayers=[];for(var F=0,C=this.apiKey.length;F<C;F++){D=this.apiKey[F];if(this.catalogue[D]&&this.catalogue[D].allowedGeoportalLayers){for(var B=0,G=this.catalogue[D].allowedGeoportalLayers.length;B<G;B++){this.allowedGeoportalLayers.push(this.catalogue[D].allowedGeoportalLayers[B])}}}}var H=new Geoportal.Control.PermanentLogo();this.addControl(H)},destroy:function(){this.displayProjection=null;if(this.catalogue){if(this.apiKey){var C;for(var D=0,B=this.apiKey.length;D<B;D++){C=this.apiKey[D];if(this.catalogue[C]){this.catalogue[C].bounds=null;for(var E in this.catalogue[C].layers){if(this.catalogue[C].layers.hasOwnProperty(E)){this.catalogue[C].layers[E]=null}}this.catalogue[C].layers=null;this.catalogue[C]=null}}}this.catalogue.destroy();this.catalogue=null;this.allowedGeoportalLayers=null}this.events.unregister("changelayer",this,this.updateZoomLevels);this.events.unregister("changedisplayprojection",this,this.changeDisplayProjection);this.events.unregister("changebaselayer",this,this.changeBaseLayer);this.events.unregister("beforemove",this,this.onBeforeMove);OpenLayers.Map.prototype.destroy.apply(this,arguments)},onBeforeMove:function(M){this.beforeOnBeforeMove(M);var C=M.forceZoomChange||((this.isValidZoomLevel(M.zoom))&&(M.zoom!=this.getZoom()));var H=(this.getProjection()?this.getProjection().getProjName()=="longlat"?0.000028:1:undefined);var E=!(M.lonlat&&this.isValidLonLat(M.lonlat)&&M.lonlat.equals(this.center,H));if((C||E)&&this.baseLayer){var D=M.zoom-(this.center==null?this.baseLayer.minZoomLevel:this.getZoom());var K=M.lonlat?M.lonlat.clone():this.center;if(!K&&this.size){var B=new OpenLayers.Pixel(this.size.w/2,this.size.h/2);K=this.getLonLatFromViewPortPx(B)}if(!K){K=this.getMaxExtent().getCenterLonLat()}var L=((D<0&&typeof (this.baseLayer.minZoomLevel)=="number"&&M.zoom<this.baseLayer.minZoomLevel)||(D>0&&typeof (this.baseLayer.maxZoomLevel)=="number"&&M.zoom>this.baseLayer.maxZoomLevel));var O=(K&&!this.baseLayer.maxExtent.containsLonLat(K,false));if(L||O){for(var G=0,I=this.getNumLayers();G<I;G++){var F=this.layers[G];if(!F.isBaseLayer||F==this.baseLayer){continue}if((L&&(((D<0&&typeof (F.minZoomLevel)=="number"&&F.minZoomLevel<=M.zoom)||(D>0&&typeof (F.maxZoomLevel)=="number"&&M.zoom<=F.maxZoomLevel))))||O){var N=F.projection;var J=K.clone();var P=F.maxExtent;if(!P){if(N.domainOfValidity){P=N.domainOfValidity.clone();P.transform(OpenLayers.Projection.CRS84,N)}}if(P){J.transform(this.getProjection(),N);if(P.containsLonLat(J,false)){if((O||M.lonlat)&&!L){if(typeof (F.maxZoomLevel)=="number"&&M.zoom>F.maxZoomLevel){M.zoom=F.maxZoomLevel}else{if(typeof (F.minZoomLevel)=="number"&&M.zoom<F.minZoomLevel){M.zoom=F.minZoomLevel}}}this.setBaseLayer(F,K,M.zoom);return false}}J=null}}}if(C){if(M.zoom<this.baseLayer.minZoomLevel){M.zoom=this.baseLayer.minZoomLevel}if(M.zoom>this.baseLayer.maxZoomLevel){M.zoom=this.baseLayer.maxZoomLevel}}if(E){if(O){M.lonlat=this.center?this.center.clone():null}}}this.afterOnBeforeMove(M);return true},changeBaseLayer:function(B){if(!B){return }if(!(B.layer)){return }B.layer.visibility=!(B.layer instanceof Geoportal.Layer);this.units=B.layer.units;this.resolutions=B.layer.resolutions;B.layer.map.projection=B.layer.getNativeProjection().getCode();B.layer.map.displayProjection=B.layer.displayProjection?B.layer.displayProjection.clone():B.layer.getNativeProjection().clone()},changeDisplayProjection:function(B){if(B){this.displayProjection=B.displayProjection}},setLocale:function(B){OpenLayers.Lang.setCode(B);this.events.triggerEvent("changelang",{lang:B})},isMapReady:function(){return true},setCenter:function(B,C,D,E){if(typeof (C)=="number"){if(typeof (this.minZoomLevel)=="number"&&C<this.minZoomLevel){C=this.minZoomLevel}if(typeof (this.maxZoomLevel)=="number"&&C>this.maxZoomLevel){C=this.maxZoomLevel}}else{C=this.getZoom()}OpenLayers.Map.prototype.setCenter.apply(this,[B,C,D,E])},setLonLatCenter:function(F,E,B,D,G){var C=new OpenLayers.LonLat(F,E);if(C){this.setCenter(C,B,D,G)}},setCenterAtLonLat:function(F,E,B,D,G){if(typeof (F)=="string"){F=Geoportal.Util.dmsToDeg(F)}if(typeof (E)=="string"){E=Geoportal.Util.dmsToDeg(E)}var C=new OpenLayers.LonLat(F,E);if(C){C.transform(OpenLayers.Projection.CRS84,this.getProjection());this.setCenter(C,B,D,G)}},setProxyUrl:function(B){OpenLayers.Request.setProxyUrl(B)},getPopupDefaults:function(C){var D=false;if(C=="WFS"){D=true}var B={multipleKey:null,toggleKey:null,multiple:false,clickout:true,toggle:!D,hover:D,highlightOnly:false,box:false,onBeforeSelect:function(){},onSelect:(D?Geoportal.Control.hoverFeature:Geoportal.Control.selectFeature),onUnselect:Geoportal.Control.unselectFeature,scope:null,geometryTypes:null,callbacks:null,selectStyle:null};return B},addLayer:function(E,U,F,R,D){var T=null;var S=null;if(U&&!(typeof (U)=="string")){for(var M in U){if(U.hasOwnProperty(M)){var B={};B[M]=U[M];Geoportal.Lang.add(B);S=M;break}}}else{S=U}if(!S){S="#"+(this.getNumLayers()+1)}if(!D){D={}}var C={isBaseLayer:false,visibility:false,view:{drop:true,zoomToExtent:true}};var V=false;switch(E){case"WMS":C=OpenLayers.Util.extend(C,{opacity:0.5,buffer:0,singleTile:false});T=new OpenLayers.Layer.WMS(S,F,R,OpenLayers.Util.extend(C,D));break;case"MapServer":C=OpenLayers.Util.extend(C,{opacity:0.5,singleTile:false});T=new OpenLayers.Layer.MapServer(S,F,R,OpenLayers.Util.extend(C,D));break;case"WMS-C":C=OpenLayers.Util.extend(C,{opacity:0.5,buffer:0,singleTile:false,gridOrigin:new OpenLayers.LonLat(0,0),nativeTileSize:new OpenLayers.Size(256,256)});T=new Geoportal.Layer.WMSC(S,F,R,OpenLayers.Util.extend(C,D));break;case"WFS":C=OpenLayers.Util.extend(C,{extractAttributes:true,preFeatureInsert:Geoportal.Popup.setPointerCursorForFeature,styleMap:new OpenLayers.StyleMap({strokeColor:"black",strokeWidth:2,strokeOpacity:0.5,fillOpacity:0.2,fillColor:"black"})});T=new Geoportal.Layer.WFS(S,F,OpenLayers.Util.applyDefaults(R,{maxFeatures:50}),OpenLayers.Util.extend(C,D));V=true;break;case"KML":case"GPX":case"OSM":case"GML":C=OpenLayers.Util.extend(C,{projection:this.getProjection(),panMapIfOutOfView:true,preFeatureInsert:Geoportal.Popup.setPointerCursorForFeature,onFeatureInsert:Geoportal.Popup.Anchored.createPopUpForGMLFeature,format:OpenLayers.Format.GML,formatOptions:OpenLayers.Util.extend({internalProjection:this.getProjection()},D&&D.formatOptions?D.formatOptions:{})});switch(E){case"KML":C.onFeatureInsert=Geoportal.Popup.Anchored.createPopUpForKMLFeature;C.format=OpenLayers.Format.KML;C.formatOptions.extractStyles=true;break;case"GPX":C.onFeatureInsert=Geoportal.Popup.Anchored.createPopUpForGPXFeature;C.format=Geoportal.Format.GPX;break;case"OSM":C.onFeatureInsert=Geoportal.Popup.Anchored.createPopUpForGMLFeature;C.format=OpenLayers.Format.OSM;C.originators=[{logo:"osm",pictureUrl:"http://wiki.openstreetmap.org/Wiki.png",url:"http://wiki.openstreetmap.org/wiki/Main_Page"}];break;default:break}var G=R?R.eventListeners?R.eventListeners?["loadend"]:undefined:undefined:undefined;C.eventListeners={loadend:function(){if(G&&typeof (G)=="function"){G()}if(this.maxExtent!=null){return }var L=this.getDataExtent();if(L){if(L.getWidth()==0||L.getHeight()==0){this.setVisibility(false)}else{this.maxExtent=L;this.setVisibility(this.visibility&&this.calculateInRange())}}}};T=new OpenLayers.Layer.GML(S,F,OpenLayers.Util.extend(C,R));V=true;break;default:if(typeof (E)=="object"&&E instanceof OpenLayers.Layer){T=E;if(D.visibility!==undefined){T.visibility=D.visibility}V=D.hasOwnProperty("onSelect")||D.hasOwnProperty("onUnselect")||D.hasOwnProperty("onBeforeSelect");break}return null}var P=!(T instanceof OpenLayers.Layer.Vector)&&(typeof (T.minZoomLevel)=="number"&&typeof (T.maxZoomLevel)=="number");if(!T.isBaseLayer&&P){for(var N=0,O=this.layers.length;N<O;N++){var H=this.layers[N];if(!H.isBaseLayer){continue}if(T.territory){if(H.territory==T.territory){this.adjustZoomLevels(H,T);break}continue}if(T.getNativeProjection()&&T.getNativeProjection().isCompatibleWith(H.getNativeProjection())&&T.maxExtent!=null){var Q=T.maxExtent.clone();if(Q){Q.transform(this.getProjection(),H.getNativeProjection());if(Q.containsBounds(H.maxExtent,true,true)||H.maxExtent.containsBounds(Q,true,true)){this.adjustZoomLevels(H,T);break}}}}}if(!T.isBaseLayer&&T.getCompatibleProjection(this.baseLayer)===null){T.displayInLayerSwitcher=false}OpenLayers.Map.prototype.addLayer.apply(this,[T]);if(V){var I=this.getPopupDefaults(E);for(var K in I){if(D.hasOwnProperty(K)){I[K]=D[K]}}var J=new OpenLayers.Control.SelectFeature(T,I);this.addControl(J);if(T.visibility){J.activate()}T.map.events.on({changelayer:function(L){if(L.property&&L.property=="visibility"){if(this.layer==L.layer){if(this.layer.visibility){this.activate()}else{this.deactivate()}}}},scope:J})}if(T.isBaseLayer){this.events.register("preaddlayer",T,Geoportal.Layer.onPreAddLayer)}else{this.events.register("changebaselayer",T,T.changeBaseLayer)}return T},adjustZoomLevels:function(B,C){if(!B){return }var D=C.minZoomLevel,E=C.maxZoomLevel;if(D!=undefined&&(B.minZoomLevel==undefined||D<B.minZoomLevel)){B.minZoomLevel=D;if(B.resolutions){B.maxResolution=B.resolutions[D]}if(B.scales){B.minScale=B.scales[D]}}if(E!=undefined&&(B.maxZoomLevel==undefined||E>B.maxZoomLevel)){B.maxZoomLevel=E;if(B.resolutions){B.minResolution=B.resolutions[E]}if(B.scales){B.maxScale=B.scales[E]}}},updateZoomLevels:function(H){if(H.property!="visibility"){return }if(H.layer.isBaseLayer){return }if(H.layer.getCompatibleProjection(this.baseLayer)==null){return }if(H.layer instanceof OpenLayers.Layer.Vector){return }if(typeof (H.layer.minZoomLevel)!="number"){return }var J=H.layer.minZoomLevel;if(typeof (H.layer.maxZoomLevel)!="number"){return }var D=H.layer.maxZoomLevel;if(typeof (this.baseLayer.minZoomLevel)!="number"){return }var B=this.baseLayer.minZoomLevel;if(typeof (this.baseLayer.maxZoomLevel)!="number"){return }var I=this.baseLayer.maxZoomLevel;if(H.layer.getVisibility()){if(J>=B&&D<=I){return }if(J<I){B=J}if(D>I){I=D}}else{if(J!=B&&D!=I){return }B=Number.MAX_VALUE,I=Number.MIN_VALUE;for(var E=0,G=this.layers.length;E<G;E++){var F=this.layers[E];if(F.isBaseLayer){continue}if(F instanceof OpenLayers.Layer.Vector){continue}if(F.getCompatibleProjection(this.baseLayer)==null){continue}if(!F.getVisibility()){continue}if(typeof (F.minZoomLevel)!="number"){continue}if(F.minZoomLevel<B){B=F.minZoomLevel}if(typeof (F.maxZoomLevel)!="number"){continue}if(F.maxZoomLevel>I){I=F.maxZoomLevel}}if(B==Number.MAX_VALUE){B=this.baseLayer.minZoomLevel}if(I==Number.MIN_VALUE){I=this.baseLayer.maxZoomLevel}}var C=-1;if(B>this.baseLayer.minZoomLevel&&this.getZoom()<B){C=B}if(I<this.baseLayer.maxZoomLevel&&this.getZoom()>I){C=I}if(this.baseLayer.minZoomLevel!=B){this.baseLayer.minZoomLevel=B;this.baseLayer.minResolution=this.baseLayer.resolutions[B];this.baseLayer.minScale=this.baseLayer.scales[B]}if(this.baseLayer.maxZoomLevel!=I){this.baseLayer.maxZoomLevel=I;this.baseLayer.maxResolution=this.baseLayer.resolutions[I];this.baseLayer.maxScale=this.baseLayer.scales[I]}if(C!=-1){this.moveTo(null,C)}},CLASS_NAME:"Geoportal.Map"});Geoportal.Viewer=OpenLayers.Class({territory:"FXX",territories:null,map:null,projection:null,allowedDisplayProjections:null,displayProjection:null,nameInstance:"geoportalViewer",div:null,variables:{},viewerOptions:{},loadLayout:function(B){return null},loadControls:function(B){},completeLayout:function(B){},browser:null,initialize:function(I,B){if(!I){I="geoportalViewerDiv"}this.div=OpenLayers.Util.getElement(I);if(!this.div){OpenLayers.Console.error(OpenLayers.i18n("div.not.found",{id:I}));return }var D=navigator.userAgent.toLowerCase();this.browser={version:(D.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],safari:/webkit/.test(D),opera:/opera/.test(D),msie:/msie/.test(D)&&!/opera/.test(D),mozilla:/mozilla/.test(D)&&!/(compatible|webkit)/.test(D)};B=B||{};this._setOptions(B);var C=this.loadLayout(B.layoutOptions);this.div.oncontextmenu=function F(J){if(OpenLayers.Event.isRightClick(J)){return false}};if(!C){OpenLayers.Console.error(OpenLayers.i18n("div.not.found",{id:"mapId"}))}var H="__OpenLayersCss__";var G=Geoportal.Util.loadCSS(OpenLayers._getScriptLocation()+"theme/default/style.css",H,"");var E="";if(G[1]){if(OpenLayers.Util.alphaHack()){E="__IE6OpenLayersCss__";Geoportal.Util.loadCSS(OpenLayers._getScriptLocation()+"theme/default/ie6-style.css",E,"")}E="__GoogleOpenLayersCss__";E="__FramedCloudOpenLayersCss__";Geoportal.Util.loadCSS(OpenLayers._getScriptLocation()+"theme/default/framedCloud.css",E,"")}this.map=new Geoportal.Map(C,this.viewerOptions);E="__GeoportalCss__";G=Geoportal.Util.loadCSS(Geoportal._getScriptLocation()+"theme/geoportal/style.css",E,"");if(G[1]){if(this instanceof Geoportal.Viewer.Standard){E="__StandardCss__";Geoportal.Util.loadCSS(Geoportal._getScriptLocation()+"theme/geoportal/standard.css",E,"")}}if(B.theme){this.theme=B.theme;Geoportal.Util.loadCSS(B.theme,null,"")}this._addTerritoriesBaselayers();if(!this.allowedDisplayProjections){this.allowedDisplayProjections=this.viewerOptions.catalogue.getDisplayProjections(this.territory,null,true)}if(!this.displayProjection){this.displayProjection=this.allowedDisplayProjections[0].clone();this.getMap().displayProjection=this.displayProjection}this.loadControls(B.controlsOptions);this.completeLayout(B.layoutOptions)},destroy:function(){this.allowedDisplayProjections=null;this.projection=null;this.displayProjection=null;this.browser=null;if(this.div){this.div.innerHTML="";this.div=null}this.variables=null;this.viewerOptions=null;this.timeout=null},_setOptions:function(O){if(Geoportal._scriptName=="lib/Geoportal.js"){OpenLayers._scriptName="lib/OpenLayers.js"}else{OpenLayers._scriptName="GeoportalExtended.js"}var C=OpenLayers.Lang.getCode();if(O.proxy){Proj4js.setProxyUrl(O.proxy)}if(O.territory!=undefined){if(O.territory instanceof Array){if(O.territory.length>0){this.territories=O.territory.slice();O.territory=this.territories[0]}else{this.territories=[];O.territory=undefined}}else{this.territories=[];this.territories.push(O.territory)}}else{this.territories=[]}var B=["mode","territory","projection","displayProjection","nameInstance"];for(var F=0,H=B.length;F<H;F++){var D=B[F];if(O[D]!=undefined){this[D]=O[D]}}var N=this._initMap(O);if(this.territories.length==0){this.territories.push(this.territory)}var J=O.resolutions;if(!J){J=N.getResolutions(this.territory,this.projection)}var M=O.maxExtent;if(!M){M=N.getExtent(null,this.projection)}var E=O.minZoomLevel;var G=O.maxZoomLevel;var L=O.zoom;if(L==undefined){if(O.resolutions){if(E&&G){L=E+G}else{L=10}L=(L-(L%2))/2;L=L>=0?Math.floor(L):Math.ceil(L)}else{if(J){L=N.getDefaultZoom(this.territory,this.projection)}else{L=0}}}this.viewerOptions={catalogue:N,defaultCenter:O.center||N.getCenter(this.territory,this.projection),defaultZoom:L,controls:[],theme:null,tileSize:new OpenLayers.Size(256,256),projection:this.projection.getCode(),displayProjection:this.displayProjection,maxExtent:M};var K=null;if(O.resolutions||!J){K=["scales","resolutions","maxResolution","minResolution","maxScale","minScale","minExtent","maxExtent","numZoomLevels","maxZoomLevel"]}else{K=[]}K.push("events");K.push("restrictedExtent");K.push("fallThrough");K.push("eventListeners");K.push("proxy");K.push("apiKey");for(var D=0;D<K.length;D++){var I=K[D];if(O[I]!==undefined){this.viewerOptions[I]=O[I]}}this.viewerOptions.isMapReady=this.isMapReady;this.timeout={}},_initMap:function(C){var E=new Geoportal.Catalogue(null,C);this.territory=E.getTerritory(this.territory);this.projection=E.getNativeProjection(this.territory,this.projection);if(this.displayProjection){if(typeof (this.displayProjection)=="string"){this.displayProjection=[this.displayProjection]}this.allowedDisplayProjections=this.displayProjection;for(var D=0,B=this.allowedDisplayProjections.length;D<B;D++){var F=this.allowedDisplayProjections[D];if(typeof (F)=="string"){this.allowedDisplayProjections[D]=new OpenLayers.Projection(F,{domainOfValidity:OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[this.territory].geobbox)})}}this.displayProjection=this.allowedDisplayProjections[0].clone()}return E},_addTerritoriesBaselayers:function(){var M=this.viewerOptions.catalogue;var P=M.getExtent();var K=this.projection.equals(M.getNativeProjection(this.territory));var D=this.projection.equals(Geoportal.Catalogue.TERRITORIES[this.territory].geoCRS[0]);var C=this.projection.getProjName()=="longlat";var R=[];var I;for(var E=0,F=this.territories.length;E<F;E++){I=this.territories[E];if(I=="WLD"){this.territories[E]="!"+I;continue}if(!Geoportal.Catalogue.TERRITORIES.hasOwnProperty(I)||Geoportal.Catalogue.TERRITORIES[I].geobbox==undefined){continue}if(I!=M.getTerritory(I)){continue}var B=OpenLayers.Bounds.fromArray(Geoportal.Catalogue.TERRITORIES[I].geobbox);if(P.containsBounds(B,true,true)||B.containsBounds(P,true,true)){var L=(I==this.territory?this.projection:(K&&!C?Geoportal.Catalogue.TERRITORIES[I].defaultCRS[0]:(D&&C?Geoportal.Catalogue.TERRITORIES[I].geoCRS[0]:null)));if(!L){B=null;continue}var H=M.getNativeProjection(I);B.transform(Geoportal.Catalogue.TERRITORIES[I].geoCRS[0],L,true);var G=M.getDefaultMinZoom(I,H);var Q=M.getDefaultMaxZoom(I,H);var J={isBaseLayer:true,displayInLayerSwitcher:false,projection:L,units:L.getUnits(),nativeProjection:H,resolutions:M.getResolutions(I,L),minZoomLevel:G,maxZoomLevel:Q,maxExtent:B,territory:I,displayProjection:this.displayProjection||M.getDisplayProjections(I)[0],allowedDisplayProjections:this.allowedDisplayProjections||M.getDisplayProjections(I,null,true)};if(!H.equals(L)){J.nativeResolutions=M.getResolutions(I,H)}var S=new Geoportal.Layer("_"+I+"_territory_",J);if(I==this.territory){R.unshift(S)}else{R.push(S)}H=null;L=null}else{this.territories[E]="!"+this.territories[E]}B=null}P=null;var O=R.length;if(O>0){for(var N=0;N<O;N++){var S=R.shift();this.getMap().addLayer(S);S.minZoomLevel=undefined;S.maxZoomLevel=undefined}}R=null;if(K||D){this._addWorldBaseLayer(M)}},_addWorldBaseLayer:function(G){var B=G.getTerritory("WLD");var I=G.getNativeProjection(B);var C=G.getResolutions(B,I);var E=G.getDefaultMinZoom(B,I);var H=G.getDefaultMaxZoom(B,I);var F={isBaseLayer:true,displayInLayerSwitcher:false,projection:I,units:I.getUnits(),nativeProjection:I,resolutions:C,minZoomLevel:E,maxZoomLevel:H,maxExtent:G.getExtent(B,I),territory:B,displayProjection:this.displayProjection||G.getDisplayProjections(B)[0],allowedDisplayProjections:this.allowedDisplayProjections||G.getDisplayProjections(B,null,true)};var D=new Geoportal.Layer("_WLD_world_",F);this.getMap().addLayer(D);D.minZoomLevel=undefined;D.maxZoomLevel=undefined;this.territories.push("WLD")},addSphericalMercatorBaseLayer:function(E){var B=new OpenLayers.Projection("EPSG:3785");var D={isBaseLayer:true,displayInLayerSwitcher:false,projection:B,units:B.getUnits(),nativeProjection:B,maxResolution:156543.0339,numZoomLevels:18,maxExtent:new OpenLayers.Bounds(-20037508,-20037508,20037508,20037508.34),territory:"WSM",displayProjection:o.displayProjection,allowedDisplayProjections:o.allowedDisplayProjections.slice(0)};var C=new OpenLayers.Layer("_WMS_world_",D);this.getMap().addLayer(C);smBaselayer.minZoomLevel=undefined;smBaselayer.maxZoomLevel=undefined;return smBaselayer},isMapReady:function(){return true},getTerritory:function(){return this.territory},getMap:function(){return this.map},addGeoportalLayer:function(D,J){var B=this.getMap();var I;for(var F=0,E=this.territories.length;F<E;F++){I=this.territories[F];if(!Geoportal.Catalogue.TERRITORIES.hasOwnProperty(I)){continue}if(B.getLayersBy("territory",I).length==0){continue}var H=B.catalogue.getLayerParameters(I,D);if(!H){continue}var G=null;if(J!=undefined){if(J.minZoomLevel&&J.minZoomLevel>H.options.maxZoomLevel){J.minZoomLevel=H.options.minZoomLevel}if(J.maxZoomLevel&&J.maxZoomLevel>H.options.maxZoomLevel){J.maxZoomLevel=H.options.maxZoomLevel}H.options=OpenLayers.Util.extend(H.options,J)}H.options.territory=I;if(B.apiKey){var C=B.catalogue.getLayerGeoRMKey(I,H.resourceId);if(C!=null){H.options.GeoRM=Geoportal.GeoRMHandler.addKey(C,B.catalogue[C].tokenServer.url,B.catalogue[C].tokenServer.ttl,B,{transport:B.catalogue[C].transport})}}G=new H.classLayer(H.options.name,H.url,H.params,H.options);if(G){B.addLayer(G);B.events.register("changelayer",G,function(P){if(!P){return }if(!(P.property=="visibility"||P.property=="opacity")){return }if(P.layer===this){return }if(P.layer.getCompatibleProjection()==null){return }if(P.layer.name!=this.name){return }var L=P.layer[P.property];if(this.getCompatibleProjection()==null&&L!=this[P.property]){if(P.property=="visibility"){this.visibility=L;this.display(L);this.redraw()}else{this.setOpacity(L)}var O=this.map.getLayersBy("isBaseLayer",true);for(var N=0,K=O.length;N<K;N++){var M=O[N];if(M===this.map.baseLayer){continue}if(this.getCompatibleProjection(M)!=null){if(!this.savedStates[M.id]){this.savedStates[M.id]={}}this.savedStates[M.id][P.property]=L}}O=null}})}}},addGeoportalLayers:function(){var G=arguments.length>=1?arguments[0]:null;var C=arguments.length==2?arguments[1]:{};if(!G){G=this.getMap().allowedGeoportalLayers;if(!G){return }}var F=this.getMap().catalogue._orderLayersStack(G);var E=null;if(C.global!==undefined){E=OpenLayers.Util.extend({},C.global)}for(var D=0,B=F.length;D<B;D++){if(C[F[D]]!==undefined){this.addGeoportalLayer(F[D],OpenLayers.Util.applyDefaults(C[F[D]],E||{}))}else{this.addGeoportalLayer(F[D],E||C)}}},setSize:function(C,B){},addVariable:function(B,C){if(!B){return }if(this.variables[B]==undefined){this.variables[B]=C}},removeVariable:function(B){if(!B){return null}var C=this.variables[B];this.variables[B]=null;return C},getVariable:function(B){if(!B){return null}return this.variables[B]},CLASS_NAME:"Geoportal.Viewer"});Geoportal.Viewer.Default=OpenLayers.Class(Geoportal.Viewer,{mode:"normal",mapDiv:null,unloadDestroy:null,initialize:function(C,B){Geoportal.Viewer.prototype.initialize.apply(this,arguments);this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy,false);OpenLayers.Event.stopObserving(window,"unload",OpenLayers.Event.unloadCache,false);OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false)},destroy:function(){if(!this.unloadDestroy){return }OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.infoCntrl=null;this.lyrSwCntrl=null;this.toolBoxCntrl=null;this.logoCntrl=null;if(this.map){this.map=null}if(this.timeout){if(this.timeout[true]){window.clearTimeout(this.timeout[true]);this.timeout[true]=null}if(this.timeout[false]){window.clearTimeout(this.timeout[false]);this.timeout[false]=null}}Geoportal.Viewer.prototype.destroy.apply(this,arguments)},loadLayout:function(C){this.div.style.overflow="hidden";this.mapTbl=document.createElement("table");this.mapTbl.id=this.div.id+"_GpMap";this.mapTbl.cellSpacing=this.mapTbl.cellPadding="0";this.mapTbl.className="gpMainMap";var B=document.createElement("tbody");var D=document.createElement("tr");var E=document.createElement("td");E.id=this.div.id+"MapCell";E.className="gpMainMapCell";this.mapCell=E;this.mapDiv=document.createElement("div");this.mapDiv.id=this.div.id+"_OlMap";this.mapDiv.className="gpMap";E.appendChild(this.mapDiv);D.appendChild(E);B.appendChild(D);this.mapTbl.appendChild(B);this.mapInfoDiv=document.createElement("div");this.mapInfoDiv.id=this.div.id+"_Info";this.mapInfoDiv.className="gpControlInformation olControlNoSelect";D=document.createElement("tr");D.vAlign="bottom";E=document.createElement("td");E.id=this.div.id+"InfoCell";E.className="gpInfoCell";this.infoCell=E;E.appendChild(this.mapInfoDiv);D.appendChild(E);B.appendChild(D);this.div.appendChild(this.mapTbl);this.ready={w:-1,h:-1,b:0};this.mapDiv.style.width="1px";this.mapDiv.style.height="1px";return this.mapDiv.id},loadControls:function(B){var C=new OpenLayers.Control.KeyboardDefaults({});this.getMap().addControl(C);C=new Geoportal.Control.Logo({logoSize:Geoportal.Control.Logo.WHSizes[this.mode]});this.getMap().addControl(C);this.logoCntrl=C;C=new Geoportal.Control.ToolBox();this.getMap().addControl(C);this.toolBoxCntrl=C;var D=(this.getMap().controls[this.getMap().controls.length-1]).id;C=new Geoportal.Control.NavToolbar({div:OpenLayers.Util.getElement(D+"_navbar")});this.getMap().addControl(C,new OpenLayers.Pixel(0,2));C=new Geoportal.Control.ZoomBar({div:OpenLayers.Util.getElement(D+"_zoombar")});this.getMap().addControl(C,new OpenLayers.Pixel(0,0));if(this.mode=="mini"){C.div.style.display="none"}C=new Geoportal.Control.LayerSwitcher({});this.getMap().addControl(C,new OpenLayers.Pixel(0,0));if(this.mode=="mini"){C.div.style.display="none"}this.lyrSwCntrl=C;C=new Geoportal.Control.Information({div:this.mapInfoDiv,displayProjections:this.allowedDisplayProjections});this.getMap().addControl(C);if(this.mode=="mini"){C.div.style.display="none"}this.infoCntrl=C;C=this.getMap().getControlsByClass("Geoportal.Control.MousePosition");if(C.length>0){C=C[0]}else{C=null}},completeLayout:function(B){switch(this.mode){case"mini":this.setToolsPanelVisibility(false);this.setLayersPanelVisibility(false);this.setInformationPanelVisibility(false);break;default:this.openLayersPanel(true);this.openToolsPanel(true);this.setInformationPanelVisibility(true);break}},setSize:function(F,C){var D=this.div.offsetWidth-F;this.div.style.width=F+"px";var E=this.div.offsetHeight-C;this.div.style.height=C+"px";this.getMap().updateSize();if(this.infoCntrl){this.infoCntrl.updateSize()}if(this.logoCntrl){this.logoCntrl.changeLogoSize(Geoportal.Control.Logo.WHSizes[this.mode])}if(D!=0||E!=0){this.ready={w:-1,h:-1,b:0};var B=this.infoCntrl.div.style.display=="none"?false:true;this.setInformationPanelVisibility(true);if(!B){this.setInformationPanelVisibility(false)}}},setToolsPanelVisibility:function(B){if(this.mode=="mini"){B=false}if(this.toolBoxCntrl){this.toolBoxCntrl.div.style.display=B?this.toolBoxCntrl.div.style.display="":this.toolBoxCntrl.div.style.display="none"}},setLayersPanelVisibility:function(B){if(this.mode=="mini"){B=false}if(this.lyrSwCntrl){this.lyrSwCntrl.div.style.display=B?this.lyrSwCntrl.div.style.display="":this.lyrSwCntrl.div.style.display="none"}},openToolsPanel:function(B){if(this.mode=="mini"){B=false}if(this.toolBoxCntrl){this.toolBoxCntrl.showControls(!B)}},openLayersPanel:function(B){if(this.mode=="mini"){B=false}if(this.lyrSwCntrl){this.lyrSwCntrl.showControls(!B)}},setInformationPanelVisibility:function(B){if(this.timeout[B]){window.clearTimeout(this.timeout[B]);this.timeout[B]=null}if(this.mode=="mini"){B=false}if(this.infoCntrl){var G=false;if(!B&&this.timeout[!B]){G=true}else{var D=this.div.offsetHeight;var I=this.ready.h==-1;if(I){if(/\d(%|em)/.test(this.div.style.height)){D=Geoportal.Util.convertToPixels(this.div.style.height,false,this.div.parentNode)||D}var E=this.mapCell.offsetHeight-this.mapCell.clientHeight;var H=this.mapCell.offsetWidth-this.mapCell.clientWidth;var F=D-this.mapInfoDiv.offsetHeight-E;var C=this.div.offsetWidth-H;this.ready.h=F;this.ready.w=C;this.ready.b=E;G=!this.isMapReady();this.mapTbl.style.height=D+"px"}if(B){this.mapCell.style.height=this.ready.h+"px";this.infoCntrl.div.style.display=""}else{this.mapCell.style.height=(D-this.ready.b)+"px";this.infoCntrl.div.style.display="none"}this.infoCell.style.height=this.mapInfoDiv.offsetHeight+"px";this.mapCell.style.width=this.ready.w+"px";this.mapDiv.style.height=this.mapCell.style.height;this.mapDiv.style.width=this.mapCell.style.width;if(I){G=G||!this.isMapReady()}}if(G){if(B){this.ready.h=-1}this.timeout[B]=setTimeout(OpenLayers.Function.bind(function(J){this.setInformationPanelVisibility(J)},this,B),500)}else{this.getMap().updateSize()}}},isMapReady:function(){var B=(this.mapTbl!=null&&this.mapCell!=null&&this.infoCell!=null&&this.mapInfoDiv!=null&&this.div!=null&&!(this.mapCell.clientHeight==1)&&this.mapCell.clientHeight>this.infoCell.clientHeight&&this.mapInfoDiv.offsetHeight==this.infoCell.offsetHeight&&this.div.offsetWidth==this.div.scrollWidth&&this.div.offsetWidth==this.mapTbl.offsetWidth&&this.div.offsetWidth==this.mapTbl.scrollWidth&&this.div.offsetHeight==this.div.scrollHeight&&this.div.offsetHeight==this.mapTbl.offsetHeight&&this.div.offsetHeight==this.mapTbl.scrollHeight);return B},CLASS_NAME:"Geoportal.Viewer.Default"});Geoportal.Viewer.Standard=OpenLayers.Class(Geoportal.Viewer,{mapDiv:null,unloadDestroy:null,initialize:function(C,B){Geoportal.Viewer.prototype.initialize.apply(this,arguments);this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this);OpenLayers.Event.observe(window,"unload",this.unloadDestroy,false);OpenLayers.Event.stopObserving(window,"unload",OpenLayers.Event.unloadCache,false);OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,false)},destroy:function(){if(!this.unloadDestroy){return }OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy);this.unloadDestroy=null;this.sep2Div=null;this.toolboxDiv=null;this.infoTgDiv=null;this.rT=null;this.toolsDiv=null;this.mapInfoDiv=null;this.lT=null;this.layersDiv=null;this.fullScDiv=null;this.catalgDiv=null;this.sep1Div=null;this.infoCntrl=null;if(this.map){this.map=null}if(this.mapDiv){this.mapDiv=null}if(this.timeout){if(this.timeout[true]){window.clearTimeout(this.timeout[true]);this.timeout[true]=null}if(this.timeout[false]){window.clearTimeout(this.timeout[false]);this.timeout[false]=null}}Geoportal.Viewer.prototype.destroy.apply(this,arguments)},loadLayout:function(J){var C=navigator.userAgent.toLowerCase();this.div.style.overflow="hidden";this.mapTbl=document.createElement("table");this.mapTbl.id=this.div.id+"_GpMap";this.mapTbl.cellSpacing=this.mapTbl.cellPadding="0";this.mapTbl.className="gpMainMap";var I=document.createElement("tbody");var B=document.createElement("tr");var G=document.createElement("td");G.colSpan="3";G.className="gpViewerUpperSeparator";this.fullScDiv=document.createElement("div");this.fullScDiv.id=this.div.id+"_fullScreenToggle";this.fullScDiv.className="gpHorizontalUpperToggle";G.appendChild(this.fullScDiv);B.appendChild(G);I.appendChild(B);this.mapTbl.appendChild(I);this.catalgDiv=document.createElement("div");this.catalgDiv.id=this.div.id+"_Catalg";this.catalgDiv.className="gpLeftColumn";this.layersDiv=document.createElement("div");this.layersDiv.id=this.div.id+"_Layers";this.layersDiv.className="gpLeftColumnLayers";this.catalgDiv.appendChild(this.layersDiv);this.lT=document.createElement("div");this.lT.id=this.div.id+"_LayersToggle";this.lT.className="gpVerticalLeftToggle";this.catalgDiv.appendChild(this.lT);B=document.createElement("tr");G=document.createElement("td");G.vAlign="top";G.className="gpLeftColumnCell";this.leftCell=G;G.appendChild(this.catalgDiv);B.appendChild(G);var F=document.createElement("table");F.id=this.div.id+"_GpMap2";F.cellSpacing=F.cellPadding="0";F.className="gpMainMap";var H=document.createElement("tbody");var D=document.createElement("tr");var E=document.createElement("td");E.id=this.div.id+"MapCell";E.className="gpMainMapCell";this.mapCell=E;this.mapDiv=document.createElement("div");this.mapDiv.id=this.div.id+"_OlMap";this.mapDiv.className="gpMap";E.appendChild(this.mapDiv);D.appendChild(E);H.appendChild(D);F.appendChild(H);this.mapInfoDiv=document.createElement("div");this.mapInfoDiv.id=this.div.id+"_Info";this.mapInfoDiv.className="gpControlInformation olControlNoSelect";D=document.createElement("tr");D.vAlign="bottom";E=document.createElement("td");E.id=this.div.id+"InfoCell";E.className="gpInfoCell";this.infoCell=E;E.appendChild(this.mapInfoDiv);D.appendChild(E);H.appendChild(D);G=document.createElement("td");G.className="gpCentralColumnCell";G.appendChild(F);B.appendChild(G);this.toolsDiv=document.createElement("div");this.toolsDiv.id=this.div.id+"_Tools";this.toolsDiv.className="gpRightColumn";this.rT=document.createElement("div");this.rT.id=this.div.id+"_ToolsToggle";this.rT.className="gpVerticalRightToggle";this.toolsDiv.appendChild(this.rT);this.toolboxDiv=document.createElement("div");this.toolboxDiv.id=this.div.id+"_ToolBx";this.toolboxDiv.className="gpRightColumnTools";this.toolsDiv.appendChild(this.toolboxDiv);G=document.createElement("td");G.appendChild(this.toolsDiv);G.vAlign="top";G.className="gpRightColumnCell";this.rightCell=G;B.appendChild(G);I.appendChild(B);B=document.createElement("tr");G=document.createElement("td");G.colSpan="3";G.className="gpViewerLowerSeparator";this.infoTgDiv=document.createElement("div");this.infoTgDiv.id=this.div.id+"_infoToggle";this.infoTgDiv.className="gpHorizontalLowerToggle";G.appendChild(this.infoTgDiv);B.appendChild(G);I.appendChild(B);this.div.appendChild(this.mapTbl);OpenLayers.Event.observe(this.lT,"click",OpenLayers.Function.bindAsEventListener(this.onVHandleClick,{handle:this.lT,target:this.layersDiv,viewer:this}));OpenLayers.Event.observe(this.rT,"click",OpenLayers.Function.bindAsEventListener(this.onVHandleClick,{handle:this.rT,target:this.toolboxDiv,viewer:this}));this.ready={w:-1,h:-1,b:0};return this.mapDiv.id},onVHandleClick:function(D){var C=this.toOpen;if(C===undefined){C=this.target.style.display=="none"?true:false}if((C==true&&this.target.style.display=="none")||(C==false&&this.target.style.display!="none")){var B=Geoportal.Util.getComputedStyle(this.handle,"width",false);this.handle.className=this.handle.className=="gpVerticalLeftToggle"?"gpVerticalRightToggle":"gpVerticalLeftToggle";this.target.style.display=C?"":"none";if(C){this.target.parentNode.style.width=this.target.parentNode.savedWidth}else{this.target.parentNode.savedWidth=Geoportal.Util.getComputedStyle(this.target.parentNode,"width",false);this.target.parentNode.style.width=B}var E=this.viewer.mapCell.offsetWidth-this.viewer.mapCell.clientWidth;B=this.viewer.div.offsetWidth-this.viewer.mapTbl.rows[1].cells[0].offsetWidth-this.viewer.mapTbl.rows[1].cells[2].offsetWidth-E;this.viewer.ready.w=B;this.viewer.mapCell.style.width=this.viewer.ready.w+"px";this.viewer.mapDiv.style.width=this.viewer.mapCell.style.width;this.viewer.getMap().updateSize()}if(D!=null){OpenLayers.Event.stop(D)}},loadControls:function(B){var C=new OpenLayers.Control.KeyboardDefaults({});this.getMap().addControl(C);C=new Geoportal.Control.Logo({logoSize:Geoportal.Control.Logo.WHSizes.normal});this.getMap().addControl(C);C=new Geoportal.Control.LayerSwitcher({outsideViewport:true});this.getMap().addControl(C);this.layersDiv.appendChild(C.div);C=new Geoportal.Control.ToolBox({outsideViewport:true});this.getMap().addControl(C);this.toolboxDiv.appendChild(C.div);var D=(this.getMap().controls[this.getMap().controls.length-1]).id;C=new Geoportal.Control.NavToolbar({div:OpenLayers.Util.getElement(D+"_navbar")});this.getMap().addControl(C,new OpenLayers.Pixel(0,2));C=new Geoportal.Control.ZoomBar({div:OpenLayers.Util.getElement(D+"_zoombar")});this.getMap().addControl(C,new OpenLayers.Pixel(0,0));C=new Geoportal.Control.Information({div:this.mapInfoDiv,displayProjections:this.allowedDisplayProjections});this.getMap().addControl(C);this.infoCntrl=C},completeLayout:function(B){this.setInformationPanelVisibility(true)},setSize:function(F,C){var D=this.div.offsetWidth-F;this.div.style.width=F+"px";var E=this.div.offsetHeight-C;this.div.style.height=C+"px";this.getMap().updateSize();if(this.infoCntrl){this.infoCntrl.updateSize()}if(D!=0||E!=0){this.ready={w:-1,h:-1,b:0};var B=this.infoCntrl.div.style.display=="none"?false:true;this.setInformationPanelVisibility(true);if(!B){this.setInformationPanelVisibility(false)}}},openLayersPanel:function(B){if(this.lT){Geoportal.Viewer.Standard.prototype.onVHandleClick.apply({handle:this.lT,toOpen:B,target:this.layersDiv,viewer:this})}},openToolsPanel:function(B){if(this.rT){Geoportal.Viewer.Standard.prototype.onVHandleClick.apply({handle:this.rT,toOpen:B,target:this.toolboxDiv,viewer:this})}},setLayersPanelVisibility:function(B){this.openLayersPanel(B)},setToolsPanelVisibility:function(B){this.openToolsPanel(B)},setInformationPanelVisibility:function(B){if(this.timeout[B]){window.clearTimeout(this.timeout[B]);this.timeout[B]=null}if(this.infoCntrl){var G=false;if(!B&&this.timeout[!B]){G=true}else{var D=this.div.offsetHeight;var I=this.ready.h==-1;if(I){if(/\d(%|em)/.test(this.div.style.height)){D=Geoportal.Util.convertToPixels(this.div.style.height,false,this.div.parentNode)||D}var E=this.mapCell.offsetHeight-this.mapCell.clientHeight;var H=this.mapCell.offsetWidth-this.mapCell.clientWidth;var F=-this.mapTbl.rows[0].offsetHeight+D-this.mapInfoDiv.offsetHeight-this.mapTbl.rows[2].offsetHeight-E;var C=this.div.offsetWidth-this.mapTbl.rows[1].cells[0].offsetWidth-this.mapTbl.rows[1].cells[2].offsetWidth-H;this.ready.h=F;this.ready.w=C;this.ready.b=E;G=!this.isMapReady();this.mapTbl.style.height=D+"px";this.mapTbl.rows[1].cells[0].style.height=this.mapTbl.rows[1].cells[1].style.height=this.mapTbl.rows[1].cells[2].style.height=(-this.mapTbl.rows[0].offsetHeight+D-this.mapTbl.rows[2].offsetHeight-this.ready.b)+"px";this.toolsDiv.style.height=this.catalgDiv.style.height=this.mapCell.parentNode.parentNode.parentNode.style.height=(-this.mapTbl.rows[0].offsetHeight+D-this.mapTbl.rows[2].offsetHeight)+"px"}if(B){this.mapCell.style.height=this.ready.h+"px";this.infoCntrl.div.style.display=""}else{this.mapCell.style.height=(-this.mapTbl.rows[0].offsetHeight+D-this.mapTbl.rows[2].offsetHeight-this.ready.b)+"px";this.infoCntrl.div.style.display="none"}this.infoCell.style.height=this.mapInfoDiv.offsetHeight+"px";this.mapCell.style.width=this.ready.w+"px";this.mapDiv.style.height=this.mapCell.style.height;this.mapDiv.style.width=this.mapCell.style.width;if(I){G=G||!this.isMapReady()}}if(G){if(B){this.ready.h=-1}this.timeout[B]=setTimeout(OpenLayers.Function.bind(function(J){this.setInformationPanelVisibility(J)},this,B),500)}else{this.getMap().updateSize()}}},isMapReady:function(){var B=(this.mapTbl!=null&&this.mapCell!=null&&this.infoCell!=null&&this.mapInfoDiv!=null&&this.div!=null&&!(this.mapCell.clientHeight==1)&&this.mapCell.clientHeight>this.infoCell.clientHeight&&this.mapInfoDiv.offsetHeight==this.infoCell.offsetHeight&&this.div.offsetWidth==this.div.scrollWidth&&this.div.offsetWidth==this.mapTbl.offsetWidth&&this.div.offsetWidth==this.mapTbl.scrollWidth&&this.div.offsetHeight==this.div.scrollHeight&&this.div.offsetHeight==this.mapTbl.offsetHeight&&this.div.offsetHeight==this.mapTbl.scrollHeight);return B},CLASS_NAME:"Geoportal.Viewer.Standard"});
